[{"categories":["æˆ‘æ‰€çƒ­çˆ±çš„ç”Ÿæ´»å•Š"],"content":"æ¯æ¬¡ä¹°ä¸œè¥¿çº ç»“ä¸ªåŠå¤©ï¼Œæœ€åä¹°å›æ¥è¿˜ä¸ä¸€å®šåˆå¿ƒæ„ï¼Œæ‰€ä»¥æ‰“ç®—æ¢³ç†ä¸€ä¸‹è´­ç‰©çš„æµç¨‹ï¼Œå¸Œæœ›èƒ½æä¾›ä¸€äº›å‚è€ƒï¼Œç»™ä»¥åçš„è´­ç‰©èŠ‚çœä¸€äº›æ—¶é—´ï¼ŒåŒæ—¶å‡å°å†²åŠ¨æ¶ˆè´¹çš„æ¦‚ç‡ã€‚ ","date":"2022-01-04","objectID":"/2022/shopping-process/:0:0","tags":["ç”Ÿæ´»æŠ€èƒ½"],"title":"è´­ç‰©æµç¨‹","uri":"/2022/shopping-process/"},{"categories":["æˆ‘æ‰€çƒ­çˆ±çš„ç”Ÿæ´»å•Š"],"content":"æƒ³ä¹°ä¸œè¥¿çš„æ—¶åˆ» æŠŠå‡ ä¸ªç”µå•†å¹³å°çš„è´­ç‰©å†å²æµè§ˆäº†ä¸€éä¹‹åï¼Œæ ¹æ®å½“åˆä¹°ä¸œè¥¿çš„å‡ºå‘ç‚¹ï¼Œåˆ†æˆäº†ä»¥ä¸‹å‡ ç§ä¸åŒçš„æƒ…å†µã€‚ å·²æœ‰åŒç±»ç‰©å“ã€‚æ­¤æ—¶åˆåˆ†ä¸ºä¸‰ç§å­æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯åŸç‰©å“ç”¨å®Œäº†æˆ–åˆ°æœŸäº†ï¼Œå¸¸è§äºæœ‰ä¿è´¨æœŸçš„åŒ–å¦†å“ã€è¯ç‰©ä»¥åŠå„ç±»æ—¥å¸¸æ¶ˆè€—å“ï¼ˆç‰™åˆ·ã€å«ç”Ÿçº¸ç­‰ï¼‰ï¼›ç¬¬äºŒç§æ˜¯åŸç‰©å“æŸåï¼Œå¿…é¡»æ¢ï¼Œæˆ–è€…åŠæŸåï¼Œç”¨ç€å¾ˆä¸èˆ’æœï¼›ç¬¬ä¸‰ç§åˆ™æ˜¯åŸç‰©å“ä¸å–œæ¬¢ï¼Œå¯èƒ½æ˜¯æ—¥ç§¯æœˆç´¯çœ‹è…»äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯æœ¬æ¥å°±ä¸å–œæ¬¢ï¼Œå‹‰å‹‰å¼ºå¼ºç”¨åˆ°ç°åœ¨ã€‚ æ²¡æœ‰åŒç±»ç‰©å“ã€‚æ­¤æ—¶åˆ†ä¸ºä¸¤ç§å­æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯ç”±äºç”Ÿæ´»ä¸­é‡åˆ°çš„å„ç§é—®é¢˜è¯ç”Ÿçš„éœ€æ±‚ï¼Œç¬¬äºŒç§åˆ™æ˜¯æ¥è‡ªå„ç§æ–‡ç« è§†é¢‘æˆ–è€…æ¥è‡ªèº«è¾¹æœ‹å‹çš„å®‰åˆ©ï¼Œæˆ–è€…æ˜¯å•çº¯çš„å‡‘å•éœ€æ±‚ã€‚ æ‹¿æœ€è¿‘ä¸¤ä¸ªæœˆä¹°çš„ä¸œè¥¿ä¸¾ä¸ªä¾‹å­ ç‰©å“å ä¸€çº§åˆ†ç±» äºŒçº§è¯´æ˜ å°ç±³10sæ‰‹æœºå£³ å·²æœ‰ åŸç‰©å“ä¸å–œæ¬¢ å…æ‰“å­”å¹é£æœºç½®ç‰©æ¶ æ²¡æœ‰ æµ´å®¤å‚¨ç‰©æ¶æ‚ä¹±è¯ç”Ÿçš„æ”¶çº³éœ€æ±‚ Keepæ‰‹ç¯b2è…•å¸¦ å·²æœ‰ åŸç‰©å“æŸå åŒè€³æ³¡é¢ç¢—+ç­·å‹ºå¥—è£… æ²¡æœ‰ å‘¨æœ«åƒé¥­æ²¡æœ‰é¤å…·è¯ç”Ÿçš„éœ€æ±‚ è¯ç®± æ²¡æœ‰ è¯å“å’ŒåŒ»ç–—å™¨æ¢°å‚¨å¤‡å­˜æ”¾è¯ç”Ÿçš„éœ€æ±‚ ç¾½ç»’æœ å·²æœ‰ åŸç‰©å“åŠæŸå æŠ˜å è£¤æ¶ æ²¡æœ‰ è¢«å®‰åˆ© å“‘é“ƒ æ²¡æœ‰ å®¤å†…å¥èº«éœ€æ±‚ æ‰‹è´¦æœ¬ å·²æœ‰ åŸç‰©å“ç”¨å®Œäº† æ— ç—•è¡£æ¶ å·²æœ‰ åŸç‰©å“ä¸å–œæ¬¢ ","date":"2022-01-04","objectID":"/2022/shopping-process/:1:0","tags":["ç”Ÿæ´»æŠ€èƒ½"],"title":"è´­ç‰©æµç¨‹","uri":"/2022/shopping-process/"},{"categories":["æˆ‘æ‰€çƒ­çˆ±çš„ç”Ÿæ´»å•Š"],"content":"è´­ç‰©å†²åŠ¨è‡ªè¯„ åšåˆ°ç†æ€§æ¶ˆè´¹çš„æ ¸å¿ƒæ˜¯è¯ç”Ÿäº†è´­ä¹°æ¬²ååšä¸€ä¸ªè‡ªè¯„ï¼Œè‡ªè¯„çš„æ ¸å¿ƒæœ‰ä¸¤ç‚¹ï¼Œä¸€æ˜¯ä¹°è¿™ä¸ªç‰©å“æœ‰æ²¡æœ‰å¿…è¦ï¼ŒäºŒæ˜¯éœ€ä¸éœ€è¦ç«‹å³ä¹°ã€‚ å…³äºè´­ä¹°çš„å¿…è¦æ€§ï¼Œå…¶å®è¯„ä»·ç»´åº¦å¾ˆå¤šï¼Œå·²æœ‰çš„ç‰©å“ç”¨å®Œäº†ã€åˆ°æœŸäº†ã€æŸåäº†ï¼Œè¿™äº›éƒ½æ¯«æ— ç–‘é—®éœ€è¦é©¬ä¸Šè´­ä¹°ï¼Œä½†å‚¨å¤‡çš„ç‰©å“è¿˜æœ‰ä¸€åŠçªç„¶é‡åˆ°æ‰“æŠ˜äº†ï¼Œæ¯”å¦‚å«ç”Ÿçº¸ï¼Œæˆ–è€…ç‰©å“åŠæŸåï¼Œæ¯”å¦‚æ’æ’å‡ºç°äº†ç”µæµå£°ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šæœ‰ä¸€ç‚¹çº ç»“ã€‚æ›´è¿›ä¸€æ­¥çš„ï¼Œé‡åˆ°ç‰©å“ä¸å–œæ¬¢çš„æƒ…å†µï¼Œæ¯”å¦‚ä»¥å‰ä¹°çš„è¡£æœï¼Œå› ä¸ºæ²¡æ³•å’Œå…¶å®ƒè¡£æœæ­é…ï¼Œå˜å¾—ä¸å–œæ¬¢äº†ï¼Œæˆ–è€…ä¹°æ‰‹æœºé€çš„æ‰‹æœºå£³ï¼Œè™½ç„¶å¯ä»¥ä½¿ç”¨ï¼Œä½†å°±æ˜¯ä¸å–œæ¬¢ï¼Œè¿™æ—¶å€™æ˜¯å¦ä¹°ä¸€ä¸ªæ–°çš„æ¥æ›¿æ¢ï¼Œçº ç»“ç¨‹åº¦å°±æ›´å¤šä¸€ç‚¹ã€‚è¿™ä¸¤ç§æƒ…å†µæˆ‘ä¸€èˆ¬æ˜¯çœ‹å½“æœˆçš„é¢„ç®—æ˜¯å¦è¿˜è¶³å¤Ÿï¼Œä»¥åŠä¸ä¹‹åŒæ—¶çš„æ˜¯å¦æœ‰å…¶å®ƒè´­ä¹°éœ€æ±‚ï¼Œå¦‚æœé¢„ç®—è¶³å¤Ÿä¸”æ²¡æœ‰å…¶å®ƒè´­ä¹°éœ€æ±‚çš„è¯ï¼Œä¸€èˆ¬å°±ä¹°äº†ã€‚ å¦å¤–ï¼Œç”Ÿæ´»ä¸­è¯ç”Ÿçš„éœ€æ±‚ï¼Œä¹Ÿéœ€è¦åŒºåˆ†æ˜¯çœŸéœ€æ±‚è¿˜æ˜¯ä¼ªéœ€æ±‚ã€‚æˆ‘çš„åŠæ³•æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯åˆ¤æ–­ä¹°å›æ¥æ˜¯ç«‹å³æŠ•å…¥ä½¿ç”¨ï¼Œè¿˜æ˜¯ä½œä¸ºå‚¨å¤‡ï¼Œå¦ä¸€ä¸ªæ˜¯äº†è§£å®Œå•†å“æƒ…å†µåŠåˆ†æäº†è‡ªå·±çš„éœ€è¦åï¼Œåˆ¤æ–­æ˜¯å¦èƒ½æ»¡è¶³è‡ªå·±çš„éœ€è¦ã€‚æ¯”å¦‚ï¼Œå…æ‰“å­”å¹é£æœºç½®ç‰©æ¶æ˜¯ä¹°å›æ¥é©¬ä¸Šå°±ç”¨ä¸”ç«‹é©¬å°±èƒ½ä½¿å¾—æµ´å®¤ç©ºé—´ç„•ç„¶ä¸€æ–°çš„ï¼ŒåŒè€³æ³¡é¢ç¢—+ç­·å‹ºå¥—è£…åˆ™æ˜¯ç«‹é©¬å°±è§£å†³äº†å‘¨æœ«åƒé¥­é—®é¢˜çš„ï¼Œä½†ç”¨æ¥æ´—å†…è£¤è¢œå­çš„å°æ´—è¡£æœºï¼Œç»è¿‡äº†è§£åå°±å‘ç°å®Œå…¨å±äºé¸¡è‚‹ï¼Œæ²¡æ³•å®Œå…¨æ»¡è¶³éœ€æ±‚ï¼Œå› æ­¤å°±ä¸å¿…è´­ä¹°ã€‚ ","date":"2022-01-04","objectID":"/2022/shopping-process/:2:0","tags":["ç”Ÿæ´»æŠ€èƒ½"],"title":"è´­ç‰©æµç¨‹","uri":"/2022/shopping-process/"},{"categories":["æˆ‘æ‰€çƒ­çˆ±çš„ç”Ÿæ´»å•Š"],"content":"äº†è§£å•†å“æƒ…å†µ çº¿ä¸‹è¿˜æ˜¯çº¿ä¸Š æœ‰ç©ºçš„è¯çº¿ä¸‹é€›ä¸€åœˆï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æƒ³è¦çš„æ ·å¼ä»¥åŠå¤šå°‘é’± ç½‘ä¸Šæ ·å¼è¾ƒå¤šï¼Œä½†æ˜¯æ²¡æ³•ä¸Šæ‰‹çœ‹ï¼Œå¾ˆå¤šæ–¹é¢åªèƒ½ä¹°å›æ¥æ‰èƒ½çœ‹åˆ°ï¼Œé€€æ¢æˆæœ¬è¾ƒé«˜ å»å“ªå„¿ç¿»è¯„æµ‹æˆ–æ‰¾å’¨è¯¢ Bç«™å„ä¸“ä¸šç»†åˆ†æ–¹å‘çš„è¯„æµ‹ï¼Œæ™®é€šäººçš„å¼€ç®±ã€ä½¿ç”¨ä½“éªŒ çŸ¥ä¹çš„è´­ä¹°å»ºè®®ï¼Œä»…ä¾›å‚è€ƒ å°çº¢ä¹¦çš„è´­ä¹°å»ºè®®ï¼Œä»…ä¾›å‚è€ƒ åŒç±»æ¯”è¾ƒï¼Œ è¿™ä¸ªäº§å“æœ‰å‡ ç§ä¸åŒæ ·å¼ï¼Œæ¯ç§çš„ä¼˜ç¼ºç‚¹æ˜¯å•¥ ç¡®å®šäº§å“æ ·å¼åè‡ªå·±ç¿»å„ä¸ªå¹³å°å…¨ç½‘æ¯”ä»· ç¡®å®šå•†å“åå…¨ç½‘æ¯”ä»·ï¼Œä»¥åŠæŸ¥è¯¢å•†å“å†å²ä»·æ ¼ ä¸»è¦çœ‹æ ·å¼å–œä¸å–œæ¬¢ï¼ŒåŠŸèƒ½èƒ½ä¸èƒ½æ»¡è¶³è‡ªå·±éœ€è¦ï¼Œæ³¨æ„ä¸éœ€è¦ä¸ºå¤šä½™çš„åŠŸèƒ½ä»˜é¢å¤–çš„é’± é—®æ¸…æ¥šå®¢æœè‡ªå·±ä¸æ¸…æ¥šçš„äº‹é¡¹ ç½‘è´­èƒ½ä¸èƒ½æä»·ï¼Ÿ ä¹°å›æ¥èƒ½ä¸èƒ½é€€ æ³¨æ„ä¹°é€€è´§ä¿é™© æ³¨æ„ä¼šå‘˜æƒé™ä¸­çš„å…è´¹é€€æ¢è´§ æ³¨æ„é€€æ¢è´§çš„æ¡ä»¶ é€€ä¸äº†çš„å’‹å¤„ç† äºŒæ‰‹å›è¡€ï¼Œå¿ƒé‡Œè¦æƒ³ç€å–äº†è¿˜èƒ½å›ç‚¹è¡€ï¼Œä¸å–è¡€æœ¬æ— å½’ é€äºº æ‰”æ‰ å¦‚ä½•åšé‡‘é’±å’Œæ—¶é—´çš„å¹³è¡¡ï¼Œä»€ä¹ˆä»·ä½çš„ä¸œè¥¿å€¼å¾—ä»˜å‡ºä»€ä¹ˆæ ·çš„æ—¶é—´å’Œç²¾åŠ› ä¸€ä¸ªå‡ å—é’±çš„ä¸œè¥¿æŒ‘ä¸ªä¸€æ˜ŸæœŸï¼Œä¸å€¼å¾—ï¼Œè¿™ä¸ªä»·ä½å¯ä»¥å®šåˆ°10å—ã€20å—ï¼Œæ ¹æ®è‡ªå·±ç»æµæƒ…å†µçœ‹ æ¯ä¸ªæœˆåšé¢„ç®—ï¼Œè¶…å‡ºé¢„ç®—çš„éƒ¨åˆ†å¯ä»¥ä¸‹ä¸ªæœˆä¹° æƒ³ä¹°çš„ä¸œè¥¿è®°å½•åˆ°è¡¨æ ¼ ","date":"2022-01-04","objectID":"/2022/shopping-process/:3:0","tags":["ç”Ÿæ´»æŠ€èƒ½"],"title":"è´­ç‰©æµç¨‹","uri":"/2022/shopping-process/"},{"categories":["æˆ‘æ‰€çƒ­çˆ±çš„ç”Ÿæ´»å•Š"],"content":"æ€è€ƒä¸€äº›å…³äºæœªæ¥çš„æ‹…å¿§ï¼ŒåŒ…æ‹¬äººç”Ÿä¹‹è·¯ã€å©šå§»ã€è‡ªå·±æ„å¤–èº«äº¡ã€çˆ¶æ¯ç”Ÿç—…ç­‰ç­‰ã€‚ ","date":"2021-09-04","objectID":"/2021/sense-of-security-future/:0:0","tags":["ç”Ÿæ´»æŠ€èƒ½"],"title":"å®‰å…¨æ„Ÿå»ºç«‹-æœªæ¥","uri":"/2021/sense-of-security-future/"},{"categories":["æˆ‘æ‰€çƒ­çˆ±çš„ç”Ÿæ´»å•Š"],"content":"æœªæ¥ ç°åœ¨è¿™ä¸ªæ—¶ä»£ï¼Œå¤§å®¶éƒ½ç„¦è™‘æœªæ¥ï¼Œå°¤å…¶æ˜¯åƒé­å­ä¸€æ ·é«˜æ‚¬åœ¨æˆ‘ä»¬èº«åçš„æˆ¿ä»·ï¼Œæ›´æ˜¯è®©äººä¸æ•¢æ‡ˆæ€ ã€‚æœ€è¿‘ä¸€ä¸ªåä¸º äººç”Ÿé‡å¼€æ¨¡æ‹Ÿå™¨ çš„å°æ¸¸æˆçˆ†ç«ï¼Œç©çš„æ—¶å€™å°±å‘ç°ï¼Œæ— è®ºä½ è¿™ä¸€ç”Ÿæ˜¯å›°è‹¦è¿˜æ˜¯è¾‰ç…Œï¼Œç”šè‡³æ´»åˆ° 100 å²å¼€å¯ä¿®ä»™ä¹‹è·¯ï¼Œæœ€åä½ è¿˜æ˜¯å¿ä¸ä½ç‚¹ä¸‹æœ€åçš„ã€Œå†æ¬¡é‡å¼€ã€çš„é€‰é¡¹ï¼Œé‚£ä¹ˆï¼Œå¯¹äºç°å®é‡Œåªæœ‰ä¸€æ¬¡çš„äººç”Ÿï¼Œåˆå“ªæœ‰ä»€ä¹ˆç”˜æ„¿å‘¢ï¼Œå¿ƒé‡Œæ€•æ€»æ˜¯ä¼šæœ‰ã€Œå¦‚æœæˆ‘å½“åˆé€‰æ‹©äº†â€¦â€¦ã€è¿™æ ·çš„æƒ³æ³•å§ã€‚ç”µå½±ã€Šæ— å§“ä¹‹äººã€‹é‡Œï¼Œä¸»è§’å°¼è«æœ‰ç€èƒ½çœ‹åˆ°æœªæ¥çš„èƒ½åŠ›ï¼Œç„¶è€Œé¢å¯¹ä¸åŒé€‰æ‹©æ‰€è¡ç”Ÿçš„æ— æ•°æ—¶é—´çº¿ï¼Œç›´åˆ°æ­»äº¡ä¹Ÿæ²¡èƒ½åšå‡ºå†³å®šï¼ˆä»…æ˜¯æˆ‘çš„ç†è§£ï¼‰ï¼Œç™½ç™½è¹‰è·äº†ä¸€ç”Ÿï¼Œæ‰€ä»¥æˆ‘è§‰å¾—å…¶å®æœ€é‡è¦çš„æ˜¯åšå‡ºé€‰æ‹©ååšå®šçš„å¾€å‰èµ°ï¼Œè€Œä¸æ˜¯æ°¸è¿œçº ç»“ç„¶åè¢«åŠ¨åšå‡ºé€‰æ‹©ã€‚ å¾ˆå°å¾ˆå°å°±å¼€å§‹è¯»ä¹¦ï¼Œç„¶åä¸€æ¯•ä¸šå°±é™·å…¥ç°ä»£ç¤¾ä¼šå›´ç»•å©šå§»å’Œç”Ÿè‚²å½¢æˆçš„å›ºå®šæ¨¡æ¿ï¼Œä¹°æˆ¿ã€å½©ç¤¼ã€ç»“å©šã€ç”Ÿè‚²ï¼Œä¸¤ä»£äººç”šè‡³æ›´å¤šäººçš„ç§¯è“„è¢«è¿…é€ŸèŠ±å®Œï¼Œç„¶åé™·å…¥æŠšè‚²ç¬¬ä¸‰ä»£çš„è½®å›ï¼Œå†éš¾æŠ½èº«å»åšå…¶å®ƒå°è¯•ã€‚ä¸èƒ½è¯´æœªæ¥å†ä¹Ÿæ²¡æœ‰å¯èƒ½ï¼Œåªæ˜¯ä»¥æ™®éç†æ€§è€Œè¨€ï¼ˆç‹—å¤´ä¿å‘½ï¼‰ï¼ŒçœŸçš„å°±å°‘äº†å¤ªå¤šçš„å¯èƒ½ã€‚æˆ‘ä¸æ˜¯åšæŒç»ˆèº«å•èº«çš„äººï¼Œå¦‚æœä½ é—®æˆ‘ï¼Œæƒ³è¦ä¸€ä¸ªå¯ä»¥å…±åº¦ä½™ç”Ÿã€åˆ†äº«è‡ªå·±çš„æ‰€æœ‰å–œæ€’å“€ä¹çš„äººå—ï¼Ÿæˆ‘çš„ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œä½†å¦‚æœè¦ç»‘å®šæœªæ¥çš„äººç”Ÿï¼Œæˆ–è®¸è¦å†è€ƒè™‘ä¸€ä¸‹ã€‚ ","date":"2021-09-04","objectID":"/2021/sense-of-security-future/:1:0","tags":["ç”Ÿæ´»æŠ€èƒ½"],"title":"å®‰å…¨æ„Ÿå»ºç«‹-æœªæ¥","uri":"/2021/sense-of-security-future/"},{"categories":["æˆ‘æ‰€çƒ­çˆ±çš„ç”Ÿæ´»å•Š"],"content":"å¥åº· å‘¨æœŸæ€§çš„ä½“æ£€æ˜¯ç›‘æµ‹è‡ªèº«å¥åº·çŠ¶å†µçš„æœ‰æ•ˆæ‰‹æ®µï¼Œè¿™æ–¹é¢å…¶å®æˆ‘ä»¬å…³å¿ƒä¸¤ä»¶äº‹ï¼Œä¸€æ˜¯å»å“ªå„¿ä½“æ£€ï¼ŒäºŒæ˜¯åº”è¯¥ä½“æ£€å“ªäº›é¡¹ç›®ï¼Œ@åˆ€å®¢ç‰¹Leslie åœ¨ å¹´è½»äººçš„ä½“æ£€æŒ‡å— 01ï¼šä½“æ£€åœ¨æ£€æŸ¥ä»€ä¹ˆ ä¸­åšäº†è¯¦ç»†è§£é‡Šï¼Œå¹¶åœ¨æœ€åç»™å‡ºäº†ä¸€ä¸ªæ€»ç»“æ€§çš„æ€ç»´å¯¼å›¾ï¼ˆå¦‚ä¸‹ï¼‰ã€‚ å¦å¤–ï¼Œä¸é¦™åŒ»ç”Ÿä¹Ÿæœ‰ä¸€ç¯‡ åˆ«å†èŠ±å†¤æ‰é’±äº†ï¼Œè¦åšçš„ä½“æ£€é¡¹ç›®å°±è¿™äº› | å†…é™„ä½“æ£€æ¸…å• å‚è€ƒï¼Œæœ‰æ ¹æ®å…·ä½“å¹´é¾„çš„æ¨èã€‚ å…¶å®é™¤äº†è‡ªå·±å®šæœŸä½“æ£€å¤–ï¼Œæœ€éš¾çš„æ˜¯è¯´æœçˆ¶æ¯ä½“æ£€ï¼Œå’Œè¯´æœçˆ¶æ¯åšæŒé”»ç‚¼ä¸€æ ·éš¾ã€‚ çˆ¶æ¯ç—…äº†å¦‚ä½•é™ªåºŠ ","date":"2021-09-04","objectID":"/2021/sense-of-security-future/:2:0","tags":["ç”Ÿæ´»æŠ€èƒ½"],"title":"å®‰å…¨æ„Ÿå»ºç«‹-æœªæ¥","uri":"/2021/sense-of-security-future/"},{"categories":["æˆ‘æ‰€çƒ­çˆ±çš„ç”Ÿæ´»å•Š"],"content":"èº«åäº‹ ","date":"2021-09-04","objectID":"/2021/sense-of-security-future/:3:0","tags":["ç”Ÿæ´»æŠ€èƒ½"],"title":"å®‰å…¨æ„Ÿå»ºç«‹-æœªæ¥","uri":"/2021/sense-of-security-future/"},{"categories":["æˆ‘æ‰€çƒ­çˆ±çš„ç”Ÿæ´»å•Š"],"content":"é—å˜± è°ä¹Ÿä¸èƒ½è¯´è‡ªå·±æ°¸è¿œä¸ä¼šå‘ç”Ÿæ„å¤–ï¼Œå°¤å…¶æ˜¯æœ¬ç§‘æ¯•ä¸šçš„æ—¶å€™åŒä¸“ä¸šçš„åŒå­¦çŒæ­»ï¼Œçœ¼è§ç€å‰ä¸€å¤©è¿˜åœ¨æ¥¼é“å¤§å–Šå¤§å«çš„åŒå­¦ç¬¬äºŒå¤©å°±æ²¡äº†ï¼Œå¿ƒé‡Œè‡ªç„¶ä¼šè¯ç”Ÿäº›è®¸å¿§è™‘ã€‚åæ¥æœ‰æ—¶å€™å°±æƒ³ï¼Œå¦‚æœè‡ªå·±ä¹Ÿå‘ç”Ÿäº†è¿™æ ·çš„äº‹æ€ä¹ˆåŠï¼Œçˆ¶æ¯ä¼šä¸ä¼šå¤ªä¼¤å¿ƒï¼Œè¦ä¸è¦ç•™ä¸€å°ä¿¡å®‰æ…°ä¸€ä¸‹çˆ¶æ¯ï¼Œè‡ªå·±é‚£äº›çè§†çš„äº‹ç‰©çˆ¶æ¯ä¼šå¥½å¥½ä¿ç•™å—ï¼Œé“¶è¡Œå¡å¯†ç ã€ç½‘ä¸Šå„ç§è´¦æˆ·çš„å¯†ç æ²¡äººçŸ¥é“æ€ä¹ˆåŠï¼Œæ‰€ä»¥å¾ˆæ—©å°±åŠ¨äº†ç•™ä¸€ä»½é—å˜±çš„å¿µå¤´ï¼Œåªæ˜¯æœ€è¿‘æ‰æŠ½å‡ºæ—¶é—´åšè¿™ä»¶äº‹ ã€‚é¦–è¦å°±æ˜¯ä¸¤ä»½æ³•è§„çš„é˜…è¯» ğŸ‘‰ ã€Šä¸­åäººæ°‘å…±å’Œå›½æ°‘æ³•å…¸ã€‹ç¬¬å…­ç¼–ã€€ç»§æ‰¿ ğŸ‘‰ æœ€é«˜äººæ°‘æ³•é™¢å…³äºé€‚ç”¨ã€Šä¸­åäººæ°‘å…±å’Œå›½æ°‘æ³•å…¸ã€‹ç»§æ‰¿ç¼–çš„è§£é‡Š æ°‘æ³•å…¸ç¬¬å…­ç¼–ç¬¬ä¸‰ç« å³æ˜¯å…³äºé—å˜±ç»§æ‰¿å’Œé—èµ çš„ç›¸å…³æ¡ç›®ï¼Œå…¶ä¸­å°†é—å˜±åˆ†ä¸ºä»¥ä¸‹å‡ ç±» è‡ªä¹¦é—å˜±ï¼šç”±é—å˜±äººäº²ç¬”ä¹¦å†™ï¼Œç­¾åï¼Œæ³¨æ˜å¹´ã€æœˆã€æ—¥ã€‚ ä»£ä¹¦é—å˜±ï¼šåº”å½“æœ‰ä¸¤ä¸ªä»¥ä¸Šè§è¯äººåœ¨åœºè§è¯ï¼Œç”±å…¶ä¸­ä¸€äººä»£ä¹¦ï¼Œå¹¶ç”±é—å˜±äººã€ä»£ä¹¦äººå’Œå…¶ä»–è§è¯äººç­¾åï¼Œæ³¨æ˜å¹´ã€æœˆã€æ—¥ã€‚ æ‰“å°é—å˜±ï¼šåº”å½“æœ‰ä¸¤ä¸ªä»¥ä¸Šè§è¯äººåœ¨åœºè§è¯ã€‚é—å˜±äººå’Œè§è¯äººåº”å½“åœ¨é—å˜±æ¯ä¸€é¡µç­¾åï¼Œæ³¨æ˜å¹´ã€æœˆã€æ—¥ã€‚ ä»¥å½•éŸ³å½•åƒå½¢å¼ç«‹çš„é—å˜±ï¼šåº”å½“æœ‰ä¸¤ä¸ªä»¥ä¸Šè§è¯äººåœ¨åœºè§è¯ã€‚é—å˜±äººå’Œè§è¯äººåº”å½“åœ¨å½•éŸ³å½•åƒä¸­è®°å½•å…¶å§“åæˆ–è€…è‚–åƒï¼Œä»¥åŠå¹´ã€æœˆã€æ—¥ã€‚ é—å˜±äººåœ¨å±æ€¥æƒ…å†µä¸‹ï¼Œå¯ä»¥ç«‹å£å¤´é—å˜±ã€‚å£å¤´é—å˜±åº”å½“æœ‰ä¸¤ä¸ªä»¥ä¸Šè§è¯äººåœ¨åœºè§è¯ã€‚å±æ€¥æƒ…å†µæ¶ˆé™¤åï¼Œé—å˜±äººèƒ½å¤Ÿä»¥ä¹¦é¢æˆ–è€…å½•éŸ³å½•åƒå½¢å¼ç«‹é—å˜±çš„ï¼Œæ‰€ç«‹çš„å£å¤´é—å˜±æ— æ•ˆã€‚ å…¬è¯é—å˜±ï¼šç”±é—å˜±äººç»å…¬è¯æœºæ„åŠç†ã€‚ é¦–å…ˆè¦è€ƒè™‘é—å˜±çš„æœ‰æ•ˆæ€§ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œé™¤è‡ªä¹¦é—å˜±å¤–ï¼Œå…¶å®ƒå‡ ç§é—å˜±å‡åº”æœ‰è§è¯äººåœ¨åœºï¼Œè€Œæ°‘æ³•å…¸ä¸­è§„å®šè§è¯äººä¸å¯ä»¥æ˜¯ç»§æ‰¿äººã€ä¸ç»§æ‰¿äººæœ‰åˆ©å®³å…³ç³»çš„äººä»¥åŠ æ— æ°‘äº‹è¡Œä¸ºèƒ½åŠ›æˆ–é™åˆ¶æ°‘äº‹è¡Œä¸ºèƒ½åŠ›çš„äººï¼Œæ‰€ä»¥è¿™ä¸€æ¡é¦–å…ˆå°±å¯¹æˆ‘ä»¬æå‡ºäº†æŒ‘æˆ˜ã€‚å†è€ƒè™‘åˆ°å¹´è½»äººæ€æƒ³å˜åŒ–ã€è´¢äº§å˜åŒ–éƒ½æ¯”è¾ƒå¿«ï¼Œé—å˜±çš„æ›´æ–°é¢‘ç‡ä¹Ÿä¼šæ¯”è¾ƒå¿«ï¼Œå› æ­¤ï¼Œè‡ªä¹¦é—å˜±æ˜¯æˆ‘ä»¬æœ€å¥½çš„é€‰æ‹©ã€‚ å…·æœ‰å®Œå…¨çš„æ°‘äº‹è¡Œä¸ºèƒ½åŠ›ï¼šå¹´æ»¡18å‘¨å²ä¸”ç²¾ç¥çŠ¶æ€æ­£å¸¸çš„äºº è‡ªä¹¦é—å˜±çš„ç”Ÿæ•ˆæ¡ä»¶å¦‚ä¸‹ ç”±é—å˜±äººäº²ç¬”ä¹¦å†™ï¼Œç­¾åï¼Œæ³¨æ˜å¹´ã€æœˆã€æ—¥ ç«‹é—å˜±äººå¿…é¡»å…·æœ‰å®Œå…¨çš„æ°‘äº‹è¡Œä¸ºèƒ½åŠ›ã€‚æ— è¡Œä¸ºèƒ½åŠ›äººæ‰€ç«‹çš„é—å˜±ï¼Œå³ä½¿å…¶æœ¬äººåæ¥æœ‰äº†è¡Œä¸ºèƒ½åŠ›ï¼Œä»å±æ— æ•ˆé—å˜± é—å˜±å¿…é¡»è¡¨ç¤ºé—å˜±äººçš„çœŸå®æ„æ€ï¼Œå—æ¬ºè¯ˆã€èƒè¿«æ‰€ç«‹çš„é—å˜±æ— æ•ˆ ä¼ªé€ çš„é—å˜±æ— æ•ˆï¼Œé—å˜±è¢«ç¯¡æ”¹çš„ï¼Œç¯¡æ”¹çš„å†…å®¹æ— æ•ˆ é—å˜±äººä»¥é—å˜±å¤„åˆ†äº†å›½å®¶ã€é›†ä½“æˆ–è€…ä»–äººè´¢äº§çš„ï¼Œåº”å½“è®¤å®šè¯¥éƒ¨åˆ†é—å˜±æ— æ•ˆ ç¬¬ä¸€æ¡çš„æ ¸å¿ƒåœ¨äºäº²ç¬”ä¹¦å†™ã€äº²ç¬”ç­¾åä»¥åŠæ³¨æ˜å¹´ã€æœˆã€æ—¥ï¼Œå¦‚éœ€æ¶‚æ”¹ã€å¢åˆ è¿˜è¦åœ¨æ¶‚æ”¹ã€å¢åˆ å¤„ç­¾åå¹¶æ³¨æ˜æ—¶é—´ï¼Œå¦åˆ™ï¼Œæ¶‚æ”¹ã€å¢åˆ çš„å†…å®¹æ— æ•ˆã€‚è¿™é‡Œçš„æ—¥æœŸæ˜¯åœ¨æœ‰å¤šä»½é—å˜±æ—¶ç¡®å®šå„ä»½é—å˜±å…ˆåçš„å‡†æ®ï¼Œåªæœ‰æ—¥æœŸæœ€è¿‘çš„é—å˜±æœ‰æ•ˆã€‚å¦å¤–ï¼Œå…³äºå—èƒè¿«åˆ¤å®šçš„é—®é¢˜ï¼Œåªè¦æ²¡æœ‰è¯æ®è¯æ˜æ˜¯åœ¨å—åˆ°èƒè¿«çš„æƒ…å†µä¸‹ç«‹é—å˜±çš„ï¼Œå°±æ˜¯æ²¡æœ‰å—åˆ°èƒè¿«ã€‚æœ€åï¼Œé—å˜±æ ¼å¼å‚è€ƒä¸‹é¢çš„é“¾æ¥ï¼Œäº‹å®ä¸Šæˆ‘ä¹Ÿä¸ç¡®å®šç½‘ä¸Šè¿™äº›æ¨¡æ¿æ˜¯å¦å¯ç”¨ï¼Œä¸€ä¸ªæ¯”è¾ƒå¥½çš„åŠæ³•æ˜¯ç¬¬ä¸€æ¬¡å‰å¾€ä¸“ä¸šæœºæ„å’¨è¯¢å’Œæ‹Ÿå®šé—å˜±ï¼Œä¹‹åæŒ‰ç…§è¿™ä»½é—å˜±æ¨¡æ¿è‡ªå·±å†™å°±å¥½ï¼Œç›®å‰åœ¨ç½‘ä¸ŠæŸ¥åˆ°çš„å½±å“åŠ›å¤§çš„ä¸“ä¸šæœºæ„æ˜¯ ä¸­åé—å˜±åº“ ã€‚ ğŸ“ é—å˜±èŒƒæœ¬ã€æ ‡å‡†ç‰ˆã€‘ ä»¥å·²æœ‰çš„çŸ¥è¯†ï¼Œæˆ–è€…ä»æ°‘æ³•å…¸ä¸­å¯ä»¥çœ‹åˆ°ï¼Œé—äº§çš„ç¬¬ä¸€é¡ºåºç»§æ‰¿äººä¸ºé…å¶ã€å­å¥³ã€çˆ¶æ¯ï¼Œç¬¬äºŒé¡ºåºç»§æ‰¿äººä¸ºå…„å¼Ÿå§å¦¹ã€ç¥–çˆ¶æ¯ã€å¤–ç¥–çˆ¶æ¯ã€‚æ‰€ä»¥è¿™å°±æ„å‘³ç€å…¶å®ä»¥æˆ‘è‡ªå·±ï¼Œå¯èƒ½ä¹Ÿæ˜¯å¾ˆå¤šå¹´è½»äººçš„æƒ…å†µâ€”â€”æ²¡æœ‰é…å¶ï¼ˆæ›´åˆ«æå­å¥³ï¼‰ï¼Œå³ä½¿æˆ‘ä»¬æ²¡æœ‰ç•™é—å˜±ï¼Œæˆ–è€…é—å˜±æ— æ•ˆï¼Œæ‰€ç•™è´¢äº§ä¾æ³•ä¹Ÿæ˜¯çˆ¶æ¯ç»§æ‰¿ï¼Œå› æ­¤ç›®å‰æ›´åº”è¯¥å…³æ³¨çš„æ˜¯å¦‚ä½•å°†è‡ªå·±æ‹¥æœ‰çš„è´¢äº§æ¸…å•ã€æ‰€çè§†çš„ç‰©å“ã€å„ç§è´¦æˆ·å¯†ç ã€å¯¹çˆ¶æ¯æƒ³è¯´çš„è¯ç­‰ç•™ä¸€ä¸ªå¤‡ä»½ï¼Œå¹¶èƒ½åœ¨è‡ªå·±å»ä¸–ååŠæ—¶çš„é€è¾¾çˆ¶æ¯æ‰‹é‡Œã€‚å½“ç„¶ï¼Œä¹Ÿè¦ä¿è¯å¹³æ—¶ä¸ä¼šè¢«çˆ¶æ¯éšä¾¿æ‰¾åˆ°ï¼Œä¸ç„¶åˆæ˜¯ä¸€åœºå¤§å‹ç¤¾æ­»ç°åœºï¼Œè¿™ä¸ªåœ°æ–¹å°±è¦è‡ªå·±å¥½å¥½æ–Ÿé…Œäº†ã€‚å¯¹äºæˆ‘è‡ªå·±è€Œè¨€ï¼Œæˆ‘åœ¨ Notion é‡ŒåŠ¨æ€æ›´æ–°ç€ä¸€ä»½ç‰©å“æ¸…å•å’Œè´¦æˆ·å¯†ç æ¸…å•ï¼Œæ‰€ä»¥æˆ‘åªéœ€è¦å‡†å¤‡å¦‚ä¸‹ææ–™å³å¯ ç”µè„‘å¯†ç ï¼ŒNotionåŠè´¦æˆ·å¯†ç åŠå…¶å†…æ¸…å•çš„ç®€å•è¯´æ˜ï¼› å¯¹æˆ‘æœ‰é‡è¦æ„ä¹‰çš„ç‰©å“æ¸…å•ï¼Œæ¸…å•ä¸­æ¯ä¸ªç‰©å“çš„æ„ä¹‰ï¼› ä»¥ä½•ç§æ–¹å¼å®‰è‘¬ï¼› æƒ³å¯¹çˆ¶æ¯è¯´çš„è¯ã€‚ æ‰€æœ‰è¿™äº›æ”¾åœ¨ç«æ¼†å°ç« å°å¥½çš„ä¿¡å°é‡Œï¼Œçˆ¶æ¯ä¸ä¼šéšä¾¿æ‰“å¼€è¿™ç§å°å¥½çš„æ–‡ä»¶çš„ã€‚ ","date":"2021-09-04","objectID":"/2021/sense-of-security-future/:3:1","tags":["ç”Ÿæ´»æŠ€èƒ½"],"title":"å®‰å…¨æ„Ÿå»ºç«‹-æœªæ¥","uri":"/2021/sense-of-security-future/"},{"categories":["æˆ‘æ‰€çƒ­çˆ±çš„ç”Ÿæ´»å•Š"],"content":"è‘¬ç¤¼ çˆ¶æ¯ç»ˆæœ‰ç™¾å¹´ä¹‹åï¼Œäº‹å…ˆäº†è§£ä¸€ä¸‹ä¸§è‘¬åŠç†ç¨‹åºï¼Œå¯ä»¥é¿å…åˆ°æ—¶å€™çš„æ‰‹å¿™è„šä¹±ï¼Œä»¥ä¸‹æ˜¯ä¸­å›½æ®¡è‘¬åä¼šç»™å‡ºçš„å¤„ç†ç¨‹åº1ï¼š å¼€å…·æ­»äº¡è¯æ˜ï¼šå½“äº²äººå»ä¸–åï¼Œæ­»è€…å®¶å±æˆ–å•ä½å¿…é¡»å–å¾—æ­»äº¡è¯æ˜ï¼šæ­£å¸¸æ­»äº¡çš„ï¼Œç”±åŒ»ç–—å«ç”Ÿæœºæ„å‡ºå…·åŒ»å­¦æ­»äº¡è¯æ˜ï¼›éæ­£å¸¸æ­»äº¡çš„ï¼Œç”±åŒºã€å¿ä»¥ä¸Šå…¬å®‰ã€å¸æ³•éƒ¨é—¨å‡ºå…·æ­»äº¡è¯æ˜ã€‚ æ³¨é”€æˆ·å£ï¼šæ­»è€…å®¶å±æŒæ­»äº¡è¯æ˜ä¹¦åˆ°é©»åœ°æ´¾å‡ºæ‰€æ³¨é”€æˆ·å£ã€‚ è”ç³»ç«åŒ– æ‰“ç”µè¯æˆ–æ´¾äººå‰å¾€æ®¡ä»ªé¦†æˆ–æ®¡è‘¬æœåŠ¡ç«™è”ç³»ç«åŒ–ï¼Œç™»è®°æ­»è€…å§“åã€ä½å€ã€å¹´é¾„ã€æ€§åˆ«ã€æ­»äº¡åŸå› ã€æ­»äº¡æ—¶é—´ã€é—ä½“æ‰€åœ¨åœ°ã€æ­»è€…æˆ·å£æ‰€åœ¨åœ°ï¼› ç™»è®°å®¶å±å§“åã€ä½å€ã€ç”µè¯ã€ä¸æ­»è€…å…³ç³»ç­‰ï¼› é¢„å®šæ®¡è‘¬æœåŠ¡é¡¹ç›®ï¼ŒæœåŠ¡æ—¶é—´ã€‚ æ¥è¿é—ä½“ï¼šæŒ‰é¢„å®šæ—¶é—´ï¼Œå®¶å±æŒæ­»äº¡è¯æ˜åœ¨æŒ‡å®šåœ°ç‚¹ç­‰å€™çµè½¦æ¥è¿é—ä½“ã€‚ é—ä½“ç«åŒ–ï¼šé—ä½“è¿é€åˆ°æ®¡ä»ªé¦†ï¼Œç»è¿‡æ•´å®¹åä¸¾è¡Œå‘Šåˆ«ä»ªå¼ï¼Œç„¶åè¿›è¡Œç«åŒ–å¹¶é¢†å–ç«åŒ–è¯æ˜ï¼Œç«åŒ–å®Œæ¯•åé¢†å–éª¨ç°è£…å…¥å®ç°é€‰è´­çš„éª¨ç°ç›’ä¸­ã€‚ éª¨ç°å®‰æ”¾ï¼šå¯ä»¥ä¸´æ—¶éª¨ç°å¯„å­˜ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å„ç§è‘¬å¼å®‰æ”¾ã€‚ è‘¬å¼ç±»å‹é™¤äº†ä¼ ç»Ÿçš„åœŸè‘¬å¤–ï¼Œç«åŒ–åçš„éª¨ç°æœ‰å¦‚ä¸‹å­˜æ”¾æ–¹å¼ï¼šéª¨ç°å ‚ã€éª¨ç°å¢™ã€éª¨ç°å»Šã€éª¨ç°æ—ã€éª¨ç°å¢“ä»¥åŠå„ç§ç”Ÿæ€è‘¬ã€‚çˆ¶æ¯é€‰æ‹©ä½•ç§è‘¬å¼æ˜¯ä»–ä»¬çš„è‡ªç”±ï¼Œéœ€è¦å°Šé‡ï¼Œä½†å°±æˆ‘è‡ªå·±è€Œè¨€ï¼Œçœ¼è§ç€å¹¿å¤§çš„å†œæ‘åŸå¤´æ—ç«‹ï¼ŒåŸå¸‚çš„å¢“ç¢‘åˆè´µå‡ºå¤©é™…ï¼Œé—ä½“æèµ å’Œç”Ÿæ€è‘¬è¿›å…¥äº†æˆ‘çš„è§†çº¿ã€‚äº‹å®ä¸Šä»æˆ‘å°æ—¶å€™è¢«æ‘é‡Œçš„åŸå¤´å“åˆ°å¼€å§‹ï¼Œå°±ä¸‹å®šå†³å¿ƒè‡ªå·±ç»å¯¹ä¸è¦ä»¥è¿™ç§æ–¹å¼å®‰è‘¬ï¼Œé•¿å¤§ååˆçœ‹åˆ°éª¨ç°å ‚é‚£ä¸€ä¸ªä¸ªå°æ ¼å­ï¼Œæƒ³ç€è‡ªå·±æ´»ç€çš„æ—¶å€™ä½æ ¼å­é—´ï¼Œæ­»äº†è¿˜è¦ä½æ ¼å­é—´ï¼Œè¿˜ä¸å¦‚å°˜å½’å°˜åœŸå½’åœŸï¼Œæ›´åŠ åšå®šäº†ä¿¡å¿ƒï¼Œæ‰€ä»¥åœ¨ä¸Šé¢çš„é—å˜±ä¸­æ‰ä¼šä¸“é—¨åŠ å…¥è¿™ä¸€æ¡ã€‚ ä¸€äº›ç»†åˆ™å’Œæ³¨æ„äº‹é¡¹å¯ä»¥æŸ¥çœ‹æ°‘æ”¿éƒ¨å‘å¸ƒçš„ æ®¡è‘¬ç®¡ç†æ¡ä¾‹ï¼ˆ2012å¹´ä¿®æ­£æœ¬ï¼‰å’Œå„åœ°åŒºè‡ªå·±çš„æ®¡è‘¬ç®¡ç†åŠæ³•ï¼Œè¿™é‡Œè¦æ³¨æ„ï¼Œåœ¨æˆ‘è‡ªå·±æ‰€åœ¨åœ°åŒºçš„æ®¡è‘¬ç®¡ç†åŠæ³•ä¸­çœ‹åˆ°äº†å¦‚ä¸‹æè¿°ï¼Œåœ¨éœ€è¦ä¸æ–­ç¼´è´¹çš„æƒ…å†µä¸‹ï¼Œå‡ ä¹å·²ç»å¯ä»¥è‚¯å®šè‡ªå·±çš„å¢“ç©´ä¸€å®šä¼šæ²¦ä¸ºæ— ä¸»ç©´ä½ï¼Œè€Œç›®å‰æ²¡æœ‰æ‰¾åˆ°èµ„æ–™æè¿°ã€Œæ— ä¸»ç©´ä½ã€ç©¶ç«Ÿå¦‚ä½•å¤„ç†ï¼Œå› æ­¤ï¼Œè€ƒè™‘æµ·è‘¬ç­‰ç”Ÿæ€è‘¬åˆå¤šäº†ä¸€æ¡ç†ç”±ã€‚ å‡¡åœ¨å…¬å¢“å’Œéª¨ç°å­˜æ”¾è®¾æ–½å®‰æ”¾éª¨ç°ï¼Œåº”æŒ‰è§„å®šç¼´çº³è´¹ç”¨ã€‚é€¾æœŸä¸‰ä¸ªæœˆä¸ç¼´çº³çš„æŒ‰æ— ä¸»ç©´ä½å¤„ç†ã€‚ ä»¥å¤©æ´¥å¤©æµ·æµ·è‘¬æœåŠ¡ä¸­å¿ƒ å®˜ç½‘ ç»™å‡ºçš„æè¿°çœ‹ï¼Œæ•´ä½“æµç¨‹å¦‚ä¸‹ï¼š æå‰æ‰“è¿›ç”µè¯é¢„çº¦ç™»è®°ã€‚ ç¡®å®šæµ·è‘¬è¿›è¡Œçš„æ—¶é—´ï¼Œä»¥åŠéšè¡Œäººæ•°ã€‚ ç¼´çº³æµ·è‘¬å®šé‡‘ã€‚ åˆ°æŒ‡å®šåœ°ç‚¹è¿›è¡Œæµ·è‘¬æ´»åŠ¨ æµ·è‘¬æ´»åŠ¨çš„å…·ä½“æµç¨‹å¦‚ä¸‹ å…¨ä½“å‚åŠ æµ·è‘¬çš„ä¸§å®¶èµ·ç«‹,å‘æœ¬æ¬¡éª¨ç°æµ·è‘¬çš„å…ˆäººé»˜å“€ï¼› ä¸§å®¶å°†é²œèŠ±èŠ±ç“£ä¸éª¨ç°ç›¸æ‹Œï¼› ä¸§å®¶é™†ç»­å°†æ‹Œæœ‰é²œèŠ±çš„éª¨ç°æ’’å‘å¤§æµ· ï¼› å‘å…ˆäººæµ·è‘¬åœ°çŒ®èŠ±æµ·æ’’ç”¨å“ï¼Œé²œèŠ±ã€èŠ±ç“£ã€æ‰‹å¥—ã€å£ç½©ç­‰å‡å…è´¹æä¾›ã€‚ å—¯ï¼Œæˆ‘å†³å®šäº†ï¼Œæˆ‘ä»¥åå°±æµ·è‘¬ã€‚ ä¸­å›½æ®¡è‘¬åä¼šï¼Œä¸§è‘¬åŠç†ç¨‹åºï¼Œ2010-12.Â â†©ï¸ ","date":"2021-09-04","objectID":"/2021/sense-of-security-future/:3:2","tags":["ç”Ÿæ´»æŠ€èƒ½"],"title":"å®‰å…¨æ„Ÿå»ºç«‹-æœªæ¥","uri":"/2021/sense-of-security-future/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"å­¦ä¹  Go æ—¶æ”¶è—çš„ä¸€äº›ç½‘å€ï¼Œåšä¸€ä¸‹æ”¶å½•ï¼Œä½œä¸ºç»“å°¾ã€‚ Goæ–‡æ¡£-å›½å†… (go-zh.org) Goæ–‡æ¡£-å›½å¤– (golang.org) Goè¯­è¨€çˆ±å¥½è€…å‘¨åˆŠ(studygolang.com) Goè¯­è¨€ä¸­æ–‡ç½‘ è®ºå›(studygolang.com) Goè¯­è¨€æ ‡å‡†åº“æ–‡æ¡£ä¸­æ–‡ç‰ˆ(studygolang.com) ä¹¦ç±: the-way-to-go_ZH_CN åšå®¢: TYÂ·Loaferçš„Goå­¦ä¹ è®°å½• (tyloafer.github.io) Goè¯­è¨€å…¥é—¨æ•™ç¨‹ï¼ˆéå¸¸è¯¦ç»†ï¼‰ (biancheng.net) Goé¡¹ç›®åˆ—è¡¨ (awesome-go.com) LeetCode Goå®ç°(halfrost.com) Goè¯­è¨€å­¦ä¹ ä¹‹è·¯ç¬¬10å¤©(Goå¹¶å‘ç¼–ç¨‹) - çœŸçš„ç™½ç»™ - åšå®¢å›­ (cnblogs.com) Go è¯­è¨€è°ƒåº¦å™¨ä¸ Goroutine å®ç°åŸç† | Go è¯­è¨€è®¾è®¡ä¸å®ç° (draveness.me) ","date":"2021-07-05","objectID":"/2021/golang-learning-materials/:0:0","tags":["Goè¯­æ³•"],"title":"Golangå­¦ä¹ èµ„æ–™","uri":"/2021/golang-learning-materials/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"Go å®ç°ä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢çš„ 2048 æ¸¸æˆï¼Œä»…æ¶‰åŠ Git å’Œ Goï¼Œç”¨æ¥ç†Ÿæ‚‰åŸºæœ¬è¯­è¨€ç‰¹æ€§ã€‚åŸå‹é¡¹ç›®æ¥è‡ª https://github.com/chhabraamit/2048 ","date":"2020-10-08","objectID":"/2020/a-cli-implement-of-2048-game-using-go/:0:0","tags":["Goå®æˆ˜"],"title":"Goå®ç°2048å°æ¸¸æˆ","uri":"/2020/a-cli-implement-of-2048-game-using-go/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. ç¯å¢ƒå‡†å¤‡ Win10 ç¯å¢ƒï¼Œgo 1.14.3ï¼Œç¼–è¾‘å™¨ä¸º VScodeï¼Œä½¿ç”¨ Github ç®¡ç†ä»£ç ã€‚ é¦–å…ˆåœ¨ç½‘é¡µç«¯å»ºç«‹ Github ä»“åº“ï¼Œé€‰æ‹© MIT åè®®ï¼Œç„¶åå…‹éš†ä»“åº“åˆ°æœ¬åœ° $ git clone https://github.com/shuzang/2048.git åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º main.go æ–‡ä»¶ package main import \"fmt\" func main() { fmt.Println(\"Getting started!\") } åˆå§‹åŒ–é¡¹ç›® $ go mod init github.com/shuzang ","date":"2020-10-08","objectID":"/2020/a-cli-implement-of-2048-game-using-go/:1:0","tags":["Goå®æˆ˜"],"title":"Goå®ç°2048å°æ¸¸æˆ","uri":"/2020/a-cli-implement-of-2048-game-using-go/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. æ˜¾ç¤ºæ¸¸æˆé¢æ¿ 2048 çš„æ¸¸æˆç•Œé¢æ˜¯ä¸€ä¸ª 4Ã—4 çš„ç½‘æ ¼ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªäºŒç»´åˆ‡ç‰‡ä½œä¸ºåº•å±‚ç»“æ„å­˜å‚¨æ•°å­—ï¼Œç„¶åæŒ‰ç…§ç½‘æ ¼çš„å½¢å¼è¾“å‡ºåˆ°ç»ˆç«¯ï¼Œæ•°å­—éšæœºç”Ÿæˆã€‚ // game/board.go package game import ( \"fmt\" \"math/rand\" \"time\" ) // æ¸¸æˆç•Œé¢è§„æ ¼ const _rows, _cols = 4, 4 type Board interface { Display() } type board struct { board [][]int } /* æ˜¾ç¤º 4Ã—4 ç½‘æ ¼å½¢å¼çš„æ¸¸æˆç•Œé¢ */ func (b *board) Display() { b.board = generate() printHorizontalLine() for i := 0; i \u003c _rows; i++ { printVerticalLine() for j := 0; j \u003c _cols; j++ { // æ¯ä¸ªæ•°å­—å 7ä¸ªä½ç½®ï¼Œå¦‚æœä¸º0ï¼Œè¾“å‡ºç©ºå­—ç¬¦ if b.board[i][j] == 0 { fmt.Printf(\"%7s\", \"\") } else {// æ•°å­—ä¸ä¸º0ï¼Œä½¿å…¶ä½äºä¸­é—´ï¼Œæ–¹æ³•æ˜¯ä½¿å…¶å 4ä½ï¼Œç„¶åæ¥ç€è¾“å‡º3ä¸ªç©ºå­—ç¬¦ fmt.Printf(\"%4d%3s\", b.board[i][j], \"\") } printVerticalLine() } fmt.Println() printHorizontalLine() } } // è¾“å‡ºæ¨ªçº¿ï¼Œ4*7+5 = 33 func printHorizontal() { for i := 0; i \u003c 33; i++ { fmt.Printf(\"-\") } fmt.Println() } // è¾“å‡ºç«–çº¿ func printVertical() { fmt.Printf(\"|\") } // ç”Ÿæˆæ‰€éœ€çš„æ‰€æœ‰éšæœºæ•° func generate() [][]int { // Store all available numbers from 2 to 2048 nums := make([]int, 0) nums = append(nums, 0) for i := 2; i \u003c= 2048; i *= 2 { nums = append(nums, i) } // generate random numbers for init board rand.Seed(time.Now().UnixNano()) matrix := make([][]int, _rows) for i := 0; i \u003c _rows; i++ { matrix[i] = make([]int, _cols) } for i := 0; i \u003c _rows; i++ { for j := 0; j \u003c _cols; j++ { matrix[i][j] = nums[rand.Int()%len(nums)] } } return matrix } func NewBoard() *Board { return \u0026board{} } ç„¶åä¿®æ”¹ main.go å¦‚ä¸‹ // main.go package main import ( \"fmt\" \"github.com/shuzang/2048/game\" ) func main() { fmt.Println(\"Getting started!\") b := game.NewBoard() b.Display() } è¿è¡Œ go run main.go å¯ä»¥çœ‹åˆ°ä¸€ä¸ªä¸´æ—¶çš„æ¸¸æˆé¢æ¿ã€‚ ","date":"2020-10-08","objectID":"/2020/a-cli-implement-of-2048-game-using-go/:2:0","tags":["Goå®æˆ˜"],"title":"Goå®ç°2048å°æ¸¸æˆ","uri":"/2020/a-cli-implement-of-2048-game-using-go/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. æ·»åŠ å…ƒç´  ä¸Šé¢çš„ç¨‹åºéšæœºç”Ÿæˆäº† 16 ä¸ªæ•°å­—å¡«å……æ¸¸æˆé¢æ¿ï¼Œä½†è¿™åªæ˜¯åˆå§‹æµ‹è¯•ï¼Œæ­£å¼æ¸¸æˆçš„åšæ³•æ˜¯ï¼šåˆå§‹æ—¶éšæœºå¡«å……ä¸¤ä¸ªæ•°å­—ï¼Œç„¶åæ¯ä¸ªé”®ç›˜è¾“å…¥æ–°å¢ä¸€ä¸ªæ•°å­—ã€‚è¿™é‡Œè¿˜è¦æ³¨æ„æ¯ä¸€æ­¥ç”Ÿæˆçš„æ•°å­—æœ‰ä¸¤ç§é€‰æ‹©ï¼Œ2 æˆ– 4ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶è¿™ä¸¤ä¸ªæ•°å­—ç”Ÿæˆçš„æ¦‚ç‡ã€‚ æ‰€ä»¥æ·»åŠ æ–°å…ƒç´ è¢«æŠ½è±¡ä¸ºä¸€ä¸ªç‹¬ç«‹çš„å‡½æ•°ï¼Œå¦‚ä¸‹ // game/board.go type board struct { board [][]int nx, ny int } // è¢«æŠ˜å çš„ä»£ç ... // éšæœºå¡«å……ä¸€ä¸ªæ–°æ•°å­— func (b *board) AddElement() { rand.Seed(time.Now().UnixNano()) // éšæœºé€‰æ‹©ä¸€ä¸ªç©ºç™½ä½ç½® index := make([][2]int, 0) for i := 0; i \u003c _rows; i++ { for j := 0; j \u003c _cols; j++ { if b.board[i][j] == 0 { index = append(index, [2]int{i, j}) } } } next := rand.Int() % len(index) nx, ny := index[next][0], index[next][1] // æŒ‰æ¦‚ç‡é€‰æ‹©æ•°å­— 2 å’Œ 4 var number int if rand.Int()%100 \u003c 80 { number = 2 } else { number = 4 } // å°†æ•°å­—å¡«å……åˆ°é€‰æ‹©çš„ä½ç½® b.nx, b.ny = nx, ny b.board[nx][ny] = number } func NewBoard() *board { matrix := make([][]int, _rows) for i := 0; i \u003c _rows; i++ { matrix[i] = make([]int, _cols) } return \u0026board{board: matrix} } board ç»“æ„ä½“æ–°å¢äº† nx,ny ä¸¤ä¸ªå­—æ®µï¼Œæ˜¯ä¸ºäº†æ ‡è®°æ–°æ·»åŠ çš„å…ƒç´ åœ¨æ¸¸æˆé¢æ¿ä¸­çš„ä½ç½®ï¼Œæˆ‘ä»¬éœ€è¦å°†æ–°å…ƒç´ ä»¥ä¸åŒçš„é¢œè‰²è¡¨ç¤ºï¼Œè¿™é‡Œç”¨åˆ°äº† fatih/color åŒ…ã€‚ $ go get -v github.com/gatih/color å¯¼å…¥è¯¥åŒ…åä¿®æ”¹æ˜¾ç¤ºå‡½æ•°å¦‚ä¸‹ï¼Œç”¨ä¸åŒçš„é¢œè‰²è¾“å‡ºæ–°æ·»åŠ çš„å…ƒç´ ã€‚ // game/board.go func (b *board) Display() { c := color.New(color.FgCyan, color.Bold) printHorizontalLine() for i := 0; i \u003c _rows; i++ { printVerticalLine() for j := 0; j \u003c _cols; j++ { if b.board[i][j] == 0 { fmt.Printf(\"%7s\", \"\") } else if i == b.nx \u0026\u0026 j == b.ny { c.Printf(\"%4d%3s\", b.board[i][j], \"\") } else { fmt.Printf(\"%4d%3s\", b.board[i][j], \"\") } printVerticalLine() } fmt.Println() printHorizontalLine() } } ç›¸åº”çš„ï¼Œä¸»å‡½æ•°ä¿®æ”¹å¦‚ä¸‹ï¼Œæ·»åŠ  10 ä¸ªå…ƒç´ å¹¶è¾“å‡º // main.go func main() { fmt.Println(\"Getting started!\") b := game.NewBoard() for i := 0; i \u003c 10; i++ { b.Display() b.AddElement() } fmt.Println(\"Game over!\") } ","date":"2020-10-08","objectID":"/2020/a-cli-implement-of-2048-game-using-go/:3:0","tags":["Goå®æˆ˜"],"title":"Goå®ç°2048å°æ¸¸æˆ","uri":"/2020/a-cli-implement-of-2048-game-using-go/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. å…ˆæ¸…å±åæ˜¾ç¤º ä¸Šé¢çš„ç¨‹åºä¼šæŠŠæ¯ä¸€æ­¥çš„é¢æ¿éƒ½è¾“å‡ºåˆ°ç»ˆç«¯ï¼Œæˆ‘ä»¬åº”å½“æ·»åŠ çš„ä¸€ä¸ªåŠŸèƒ½æ˜¯ï¼Œæ¯ä¸€æ­¥åªè¾“å‡ºå½“å‰çš„æ¸¸æˆé¢æ¿ã€‚è¯¥åŠŸèƒ½é€šè¿‡æ¸…å±å‡½æ•°å®ç°ï¼Œæ³¨æ„ï¼Œæ¸…å±çš„å®ç°åœ¨ä¸åŒæ“ä½œç³»ç»Ÿå¯èƒ½ä¼šæœ‰åŒºåˆ«ï¼Œä¸‹é¢çš„å®ç°é€‚ç”¨äº Windows ç³»ç»Ÿã€‚ // game/board.go func (b *board) Display() { // clear screen, but only works on windows cmd := exec.Command(\"cmd\", \"/c\", \"cls\") cmd.Stdout = os.Stdout cmd.Run() c := color.New(color.FgCyan, color.Bold) printHorizontalLine() for i := 0; i \u003c _rows; i++ { printVerticalLine() for j := 0; j \u003c _cols; j++ { if b.board[i][j] == 0 { fmt.Printf(\"%7s\", \"\") } else if i == b.nx \u0026\u0026 j == b.ny { c.Printf(\"%4d%3s\", b.board[i][j], \"\") } else { fmt.Printf(\"%4d%3s\", b.board[i][j], \"\") } printVerticalLine() } fmt.Println() printHorizontalLine() } } ","date":"2020-10-08","objectID":"/2020/a-cli-implement-of-2048-game-using-go/:4:0","tags":["Goå®æˆ˜"],"title":"Goå®ç°2048å°æ¸¸æˆ","uri":"/2020/a-cli-implement-of-2048-game-using-go/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"5. è·å–é”®ç›˜è¾“å…¥ æ¸¸æˆçš„æ¯ä¸€æ­¥æ“ä½œè‚¯å®šéƒ½æ˜¯æ ¹æ®é”®ç›˜çš„è¾“å…¥æ¥çš„ï¼Œå¯ä»¥ä½¿ç”¨ {W, A, S, D} å’Œ æ–¹å‘é”®ï¼Œå¦‚æœä½¿ç”¨ fmt åŒ…ä¸­çš„è¾“å…¥å‡½æ•°ï¼Œé‚£ä¹ˆæ¯æ¬¡è¾“å…¥åéƒ½éœ€è¦æ‰‹åŠ¨æŒ‰ä¸‹å›è½¦ã€‚ä¸ºäº†ä¸å¿…æ¯æ¬¡è¾“å…¥å­—ç¬¦åéƒ½æ•²ä¸€ä¸‹å›è½¦é”®ï¼Œæˆ‘ä»¬ä½¿ç”¨ eiannone/keyboard åŒ… $ go get -v github.com/eiannone/keyboard å°†é”®ç›˜è¾“å…¥å¯¹åº”çš„å‡ ä¸ªæ“ä½œå®šä¹‰ä¸ºå‡ ä¸ªå¸¸é‡ï¼Œç„¶åè°ƒç”¨ keyboard åŒ…ä¸­çš„ GetKeyStrokes() å‡½æ•°æ¥æ”¶é”®ç›˜è¾“å…¥ï¼Œè¿”å›å¯¹åº”çš„å¸¸é‡ï¼Œæœ€ååœ¨ TakeInput() å‡½æ•°ä¸­æ ¹æ®ä¸åŒå¸¸é‡äº¤ç»™å¯¹åº”çš„æ“ä½œå‡½æ•°å¤„ç†ã€‚ // game/board.go type Key int // å‡ ä¸ªæ“ä½œå¸¸é‡ï¼Œå‘å››ä¸ªæ–¹å‘ç§»åŠ¨ã€é€€å‡ºå’Œé”™è¯¯æŒ‰é”® const ( UP Key = iota DOWN LEFT RIGHT QUIT ERROR_KEY ) func (b *board) TakeInput() bool { key, err := GetKeyStrokes() if err != nil { fmt.Printf(err.Error()) } if key == ERROR_KEY { b.TakeInput() } switch key { case UP: b.moveUp() case DOWN: b.moveDown() case LEFT: b.moveLeft() case RIGHT: b.moveRight() case QUIT: fmt.Println(\"You press ESC, game exit!\") return false } return true } func GetKeyStrokes() (Key, error) { char, key, err := keyboard.GetSingleKey() if err != nil { return ERROR_KEY, err } //fmt.Printf(\"You pressed: %c, key %X\\r\\n\", char, key) if int(char) == 0 { switch key { case keyboard.KeyArrowUp: return UP, nil case keyboard.KeyArrowDown: return DOWN, nil case keyboard.KeyArrowLeft: return LEFT, nil case keyboard.KeyArrowRight: return RIGHT, nil case keyboard.KeyEsc: return QUIT, nil default: return ERROR_KEY, errors.New(\"Invalid key, please press again!\") } } else { switch char { case 119: return UP, nil case 97: return LEFT, nil case 115: return DOWN, nil case 100: return RIGHT, nil default: return ERROR_KEY, errors.New(\"Invalid key, please press again!\") } } } æ¸¸æˆé€€å‡ºæœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ä¸ªæ˜¯ä¸Šé¢ç¨‹åºä¸­å®šä¹‰çš„ QUIT æ“ä½œï¼Œç”¨äºæ¸¸æˆè¿‡ç¨‹ä¸­ä¸»åŠ¨è¾“å…¥ ESC æŒ‰é”®é€€å‡ºï¼Œå¦ä¸€ä¸ªæ˜¯æ¸¸æˆé¢æ¿ 16 ä¸ªæ•°å­—å·²æ»¡ï¼ŒGame overï¼Œé€šè¿‡æ·»åŠ ä»¥ä¸‹å‡½æ•°å®ç° // game/board.go func (b *board) IsOver() bool { blank := 0 for i := 0; i \u003c _rows; i++ { for j := 0; j \u003c _cols; j++ { if b.board[i][j] == 0 { blank++ } } } return blank == 0 } æœ€åæ˜¯ç¨‹åºå¼€å§‹çš„é€»è¾‘ï¼Œå³è¾“å…¥ä»»æ„é”®å¼€å§‹ã€‚è¿™éƒ¨åˆ†é€»è¾‘åœ¨ main å‡½æ•°ä¸­ // main.go func main() { fmt.Println(\"Use {W A S D} or Arrow keys to move the board\") fmt.Printf(\"Press and key to start\\n\") _, _, err := keyboard.GetSingleKey() if err != nil { log.Fatalln(\"error while taking input to start the game\") } b := game.NewBoard() b.AddElement() b.AddElement() for true { if b.IsOver() { break } b.AddElement() b.Display() res := b.TakeInput() if !res { return } } fmt.Println(\"game over\") } ","date":"2020-10-08","objectID":"/2020/a-cli-implement-of-2048-game-using-go/:5:0","tags":["Goå®æˆ˜"],"title":"Goå®ç°2048å°æ¸¸æˆ","uri":"/2020/a-cli-implement-of-2048-game-using-go/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"6. æ•°å­—ç§»åŠ¨åˆå¹¶ æ¯ä¸ªé”®ç›˜è¾“å…¥éƒ½å¯¹åº”ä¸€ä¸ªæ“ä½œå‡½æ•°ï¼Œå››ä¸ªæ–¹å‘çš„æ•°å­—ç§»åŠ¨å’Œåˆå¹¶æ˜¯æ¸¸æˆçš„æ ¸å¿ƒé€»è¾‘ã€‚å¦‚ä¸‹ï¼Œå‘å·¦ç§»åŠ¨æ•°å­—å’Œåˆå¹¶å•ç‹¬å®ç°ï¼Œå‘å³ã€å‘ä¸Šå’Œå‘ä¸‹éƒ½èƒ½é€šè¿‡çŸ©é˜µæ—‹è½¬è½¬æ¢ä¸ºå‘å·¦ç§»åŠ¨å’Œåˆå¹¶çš„é—®é¢˜ã€‚ // game/board.go func (b *board) moveLeft() { for i := 0; i \u003c _rows; i++ { old := b.board[i] b.board[i] = moveRow(old) } } func (b *board) moveRight() { b.Reverse() b.moveLeft() b.Reverse() } func (b *board) moveUp() { b.leftRotate90() b.moveLeft() b.rightRotate90() } func (b *board) moveDown() { b.rightRotate90() b.moveLeft() b.leftRotate90() } func (b *board) rightRotate90() { matrix := make([][]int, _rows) for i := 0; i \u003c _rows; i++ { matrix[i] = make([]int, _cols) } for i := 0; i \u003c _rows; i++ { for j := 0; j \u003c _cols; j++ { matrix[j][_cols-1-i] = b.board[i][j] } } b.board = matrix } func (b *board) leftRotate90() { matrix := make([][]int, _rows) for i := 0; i \u003c _rows; i++ { matrix[i] = make([]int, _cols) } for i := 0; i \u003c _rows; i++ { for j := 0; j \u003c _cols; j++ { matrix[_cols-1-j][i] = b.board[i][j] } } b.board = matrix } func (b *board) Reverse() { for i := 0; i \u003c _rows; i++ { for j, k := 0, _cols-1; j \u003c k; j, k = j+1, k-1 { b.board[i][j], b.board[i][k] = b.board[i][k], b.board[i][j] } } } func moveRow(row []int) []int { index := 0 for i := 0; i \u003c len(row); i++ { if row[i] != 0 { row[index], row[i] = row[i], row[index] index++ } } for i := 0; i \u003c len(row)-1; i++ { if row[i] == row[i+1] { row[i] += row[i+1] row[i+1] = 0 i++ } } index = 0 for i := 0; i \u003c len(row); i++ { if row[i] != 0 { row[index], row[i] = row[i], row[index] index++ } } return row } ç”±äºè¿™éƒ¨åˆ†é€»è¾‘æ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦æµ‹è¯•ä¸€ä¸‹ // game/board_test.go package game import ( \"reflect\" \"testing\" ) func TestMoveRow(t *testing.T) { tests := []struct { name string input []int want []int }{ { name: \"one\", input: []int{2, 2, 0, 0}, want: []int{4, 0, 0, 0}, }, { name: \"two\", input: []int{2, 2, 4, 8}, want: []int{4, 4, 8, 0}, }, { name: \"three\", input: []int{2, 4, 4, 8}, want: []int{2, 8, 8, 0}, }, { name: \"four\", input: []int{2, 4, 8, 8}, want: []int{2, 4, 16, 0}, }, { name: \"five\", input: []int{2, 2, 2, 2}, want: []int{4, 4, 0, 0}, }, } for _, tt := range tests { t.Run(tt.name, func(t *testing.T) { if got := moveRow(tt.input); !reflect.DeepEqual(got, tt.want) { t.Errorf(\"moveRow() = %v, want %v\", got, tt.want) } }) } } func TestLeftRotate90(t *testing.T) { type fields struct { matrix [][]int } tests := []struct { name string fields fields want [][]int }{ { name: \"one\", fields: fields{ matrix: [][]int{ {1, 2, 3, 9}, {4, 5, 6, 10}, {6, 7, 8, 11}, {16, 17, 18, 111}, }, }, want: [][]int{ {9, 10, 11, 111}, {3, 6, 8, 18}, {2, 5, 7, 17}, {1, 4, 6, 16}, }, }, } for _, tt := range tests { t.Run(tt.name, func(t *testing.T) { b := \u0026board{board: tt.fields.matrix} b.leftRotate90() if !reflect.DeepEqual(b.board, tt.want) { t.Errorf(\"b.leftRotate90() = %v, want %v\", b.board, tt.want) } }) } } func TestRightRotate90(t *testing.T) { type fields struct { matrix [][]int } tests := []struct { name string fields fields want [][]int }{ { name: \"one\", fields: fields{ matrix: [][]int{ {1, 2, 3, 9}, {4, 5, 6, 10}, {6, 7, 8, 11}, {16, 17, 18, 111}, }, }, want: [][]int{ {16, 6, 4, 1}, {17, 7, 5, 2}, {18, 8, 6, 3}, {111, 11, 10, 9}, }, }, } for _, tt := range tests { t.Run(tt.name, func(t *testing.T) { b := \u0026board{board: tt.fields.matrix} if b.rightRotate90(); !reflect.DeepEqual(b.board, tt.want) { t.Errorf(\"b.rightRotate90() = %v, want %v\", b.board, tt.want) } }) } } ","date":"2020-10-08","objectID":"/2020/a-cli-implement-of-2048-game-using-go/:6:0","tags":["Goå®æˆ˜"],"title":"Goå®ç°2048å°æ¸¸æˆ","uri":"/2020/a-cli-implement-of-2048-game-using-go/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"7. åˆ†æ•°è®¡ç®— æ¸¸æˆæ­£å¸¸ç»“æŸåæ˜¾ç¤ºå½“å‰æœ€å¤§åˆ†æ•°å’Œæ€»åˆ†æ•°ï¼Œç®—æ˜¯ä¸€ä¸ªå°åŠŸèƒ½ã€‚ //game/board.go func (b *board) CountScore() (int, int) { total, max := 0, 0 matrix := b.board for i := 0; i \u003c _rows; i++ { for j := 0; j \u003c _cols; j++ { total += matrix[i][j] max = maxInts(max, matrix[i][j]) } } return max, total } func maxInts(a, b int) int { if a \u003e b { return a } return b } //main.go func main() { fmt.Println(\"Use {W A S D} or Arrow keys to move the board\") fmt.Printf(\"Press and key to start\\n\") _, _, err := keyboard.GetSingleKey() if err != nil { log.Fatalln(\"error while taking input to start the game\") } b := game.NewBoard() b.AddElement() b.AddElement() for true { if b.IsOver() { break } b.AddElement() b.Display() res := b.TakeInput() if !res { return } } fmt.Println(\"\\n********** game over **********\") max, total := b.CountScore() fmt.Printf(\"Max Score: %v \\n\", max) fmt.Printf(\"Total Score %v \\n\", total) } ","date":"2020-10-08","objectID":"/2020/a-cli-implement-of-2048-game-using-go/:7:0","tags":["Goå®æˆ˜"],"title":"Goå®ç°2048å°æ¸¸æˆ","uri":"/2020/a-cli-implement-of-2048-game-using-go/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"8. ä»£ç é‡æ„ æ‰€æœ‰åŠŸèƒ½å®Œæˆåï¼Œå¯¹ä»£ç è¿›è¡Œé‡æ„æ•´ç†ï¼ŒåŒ…æ‹¬ å°†æ•°å­—ç§»åŠ¨åˆå¹¶çš„ç›¸å…³ä»£ç ç§»åŠ¨åˆ°å•ç‹¬çš„ move.go æºæ–‡ä»¶ä¸­ï¼› ï¼ˆå¯é€‰ï¼‰å°†è¾“å…¥å’Œæ˜¾ç¤ºçš„ç›¸å…³å‡½æ•°éƒ½æ‹†åˆ†åˆ°å•ç‹¬çš„æºæ–‡ä»¶ä¸­ï¼› ä¸ºæ‰€æœ‰ä»£ç æ·»åŠ æ³¨é‡Šï¼Œå¹¶ç¼–å†™ README.md æ–‡æ¡£ï¼› ","date":"2020-10-08","objectID":"/2020/a-cli-implement-of-2048-game-using-go/:8:0","tags":["Goå®æˆ˜"],"title":"Goå®ç°2048å°æ¸¸æˆ","uri":"/2020/a-cli-implement-of-2048-game-using-go/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"9. ç»“æœä¸æ”¶è· å®Œæ•´çš„é¡¹ç›®ä»£ç å¯ä»¥æŸ¥çœ‹æˆ‘çš„ github ä»“åº“ï¼Œä¸åŸé¡¹ç›®æœ‰ä¸€äº›å®ç°ä¸Šçš„åŒºåˆ«ï¼Œå¹¶å®Œå–„äº†ä¸€äº›åŠŸèƒ½ã€‚ ç¼–å†™è¯¥é¡¹ç›®çš„æ”¶è·æœ‰ å¼€æºåè®®çš„é€‰æ‹©ï¼› å¯¹ç»“æ„ä½“å’Œæ¥å£ä½œç”¨å’Œæ„ä¹‰çš„æ€è€ƒï¼› ä¸€ä¸ªé¡¹ç›®æ˜¯ä»ç®€å•åˆ°å¤æ‚ä¸€æ­¥æ­¥å»ºç«‹çš„ï¼Œä¸è¦æƒ³ä¸€æ­¥ç™»å¤©åšçš„å¾ˆå®Œå–„ï¼› æ–¹æ³•ä¸­ (b *board) å’Œ (b board) çš„åŒºåˆ«ï¼› ä¸€äº›é‡è¦çš„å¯å®šåˆ¶çš„å‚æ•°å¯ä»¥æŠ½å–ä½œä¸ºä¸ºå¸¸é‡ï¼Œæ¯”å¦‚é¢æ¿è§„æ ¼ï¼Œå¸¸é‡å‘½åæ—¶å‰é¢æœ€å¥½åŠ ä¸‹åˆ’çº¿ _ åŠ ä»¥åŒºåˆ†ï¼› fmt.Printf å¯ä»¥è¾“å‡ºå›ºå®šé•¿åº¦çš„ç©ºå­—ç¬¦ç”¨äºå ä½ï¼Œfmt.Println() å¯ä»¥ç”¨æ¥æ¢è¡Œï¼› éšæœºæ•°çš„ç”Ÿæˆæ–¹æ³•ï¼Œä¸€ä¸ªå°æŠ€å·§æ˜¯ä½¿ç”¨æ•°ç»„å­˜æ”¾å¾…é€‰æ‹©æ•°å­—ï¼Œç„¶åéšæœºç”Ÿæˆæ•°ç»„é•¿åº¦èŒƒå›´å†…çš„æ•°å­—ä½œä¸ºç´¢å¼•è¿›è¡Œé€‰æ‹©ï¼› ç»“æ„ä½“å¯¹è±¡çš„ç”Ÿæˆå¯ä»¥ä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œæ¯”å¦‚ NewBoard å‡½æ•°ï¼› æ ¼å¼åŒ–è¾“å‡ºçš„é¢œè‰²æ§åˆ¶ï¼ˆfatih/coloråŒ…ï¼‰ï¼› æ¸…å±çš„å®ç°æ–¹æ³•ï¼› æ— éœ€å›è½¦ä¸æ–­è¯»å–é”®ç›˜è¾“å…¥çš„å®ç°æ–¹æ³•ï¼ˆeiannone/keyboardåŒ…ï¼‰; çŸ©é˜µæ—‹è½¬ç­‰å¤§é‡å…³äºäºŒç»´åˆ‡ç‰‡çš„ç®—æ³•å®ç°ï¼ˆPSï¼šåˆ·é¢˜è¿˜æ˜¯æœ‰ç”¨çš„ï¼‰ï¼› æµ‹è¯•ç”¨ä¾‹çš„ç¼–å†™ï¼› æ‰€æœ‰åŠŸèƒ½å®Œæˆåï¼Œæ ¹æ®æƒ…å†µè¿›è¡Œé‡æ„ï¼Œæ¯”å¦‚ä»£ç çš„è§£è€¦ç­‰ï¼Œç„¶åå®Œæˆæ·»åŠ æ³¨é‡Šã€ç¼–å†™æ–‡æ¡£ç­‰å·¥ä½œï¼› Go æ–‡æ¡£çš„ç¼–å†™ä¸ä½¿ç”¨ï¼› æ—¥å¿—ç³»ç»Ÿçš„ä½¿ç”¨ã€‚ ","date":"2020-10-08","objectID":"/2020/a-cli-implement-of-2048-game-using-go/:9:0","tags":["Goå®æˆ˜"],"title":"Goå®ç°2048å°æ¸¸æˆ","uri":"/2020/a-cli-implement-of-2048-game-using-go/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æœ¬ç¯‡ä»‹ç»å¦‚ä½•åˆ†æ Go çš„è°ƒç”¨æ ˆã€‚ æµ‹è¯•ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯Go 1.14.3ï¼Œä¸‹é¢ä»‹ç»å¦‚ä½•åœ¨Goè°ƒè¯•çš„æ—¶å€™æŸ¥çœ‹å †æ ˆè·Ÿè¸ªä¿¡æ¯åŠè¯†åˆ«ä¼ é€’çš„å‚æ•°ã€‚ ç¤ºä¾‹ç¨‹åºå¦‚ä¸‹ package main import ( \"runtime/debug\" ) func main() { slice := make([]string, 2, 4) Example(slice, \"hello\", 10) } func Example(slice []string, str string, i int) { debug.PrintStack() } åœ¨ç¨‹åºä¸­æˆ‘ä»¬ä½¿ç”¨äº† runtime/debug ä¸‹çš„ PrintStack() å‡½æ•°å°†è°ƒç”¨æ ˆçš„è¿”å›ä¿¡æ¯æ‰“å°åˆ°æ ‡å‡†é”™è¯¯è¾“å‡ºï¼Œå¦‚ä¸‹æ‰€ç¤º goroutine 1 [running]: runtime/debug.Stack(0x0, 0x0, 0x0) c:/go/src/runtime/debug/stack.go:24 +0xa8 runtime/debug.PrintStack() c:/go/src/runtime/debug/stack.go:16 +0x29 main.Example(0xc000077f38, 0x2, 0x4, 0x4a8534, 0x5, 0xa) f:/Gotest/main.go:13 +0x2e main.main() f:/Gotest/main.go:9 +0xb1 Process exiting with code: 0 æ³¨æ„ï¼Œåœ¨å…¶å®ƒç¼–ç¨‹è¯­è¨€å¦‚Cä¸­ï¼Œè¿è¡Œä¸€ä¸ªç¨‹åºä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œï¼Œåœ¨Goä¸­ï¼Œå¯åŠ¨çš„æ˜¯ä¸€ä¸ª Goroutineã€‚ä¸Šé¢ç¬¬ä¸€è¡Œå°±è¯´æ˜äº†å¯åŠ¨äº†ä¸€ä¸ª Goroutineï¼ŒGoroutine ID ä¸º1ï¼Œå…¶åå„è¡Œæ˜¯ä¸åŒå±‚æ¬¡çš„è°ƒç”¨ï¼Œæœ€æ·±çš„è°ƒç”¨æœ€å…ˆæ‰“å°ï¼Œæœ€æµ…çš„è°ƒç”¨æœ€åæ‰“å°ã€‚å„è¡Œè¯´æ˜å¦‚ä¸‹ ç¬¬8ã€9è¡Œï¼šmain package çš„ main å‡½æ•°ï¼Œä»£ç æ–‡ä»¶è·¯å¾„ä¸º f:/Gotest/main.goï¼Œè°ƒç”¨å‡ºç°åœ¨ main.go æ–‡ä»¶çš„ç¬¬9è¡Œ ç¬¬6ã€7è¡Œï¼šmain å‡½æ•°è°ƒç”¨ Example å‡½æ•° ç¬¬4ã€5è¡Œï¼šExample å‡½æ•°è°ƒç”¨ debug.PrintStack å‡½æ•° ç¬¬2ï¼Œ3è¡Œï¼šdebug.PrintStack å‡½æ•°è°ƒç”¨ debug.Stack å‡½æ•° Example å‡½æ•°ä¼ å‚ä¿¡æ¯å¦‚ä¸‹ // è°ƒç”¨ slice := make([]string, 2, 4) Example(slice, \"hello\", 10) // æ ˆè¿½è¸ª main.Example(0xc000077f38, 0x2, 0x4, 0x4a8534, 0x5, 0xa) å †æ ˆè·Ÿè¸ªä¿¡æ¯ä¸­ï¼Œå‰ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä»£è¡¨åˆ‡ç‰‡çš„æŒ‡é’ˆã€é•¿åº¦ã€å®¹é‡ï¼Œç¬¬4å’Œç¬¬5ä¸ªå‚æ•°ä»£è¡¨å­—ç¬¦ä¸²çš„æŒ‡é’ˆå’Œå¤§å°ï¼Œæœ€åä¸€ä¸ªå‚æ•°æŒ‡å‘æ•´å‹æ•°å€¼ // åˆ‡ç‰‡ Pointer: 0xc000077f38 Length: 0x2 Capacity: 0x4 // å­—ç¬¦ä¸² Pointer: 0x4a8534 Length: 0x5 // æ•´æ•° base 16: 0xa å¦‚æœæ˜¯è°ƒç”¨æ–¹æ³•ï¼Œè·Ÿè¸ªä¿¡æ¯ä¼šæ˜¾ç¤ºæ¥æ”¶è€… // ç¨‹åº package main import ( \"fmt\" \"runtime/debug\" ) type trace struct{} func main() { slice := make([]string, 2, 4) var t trace t.Example(slice, \"hello\", 10) } func (t *trace) Example(slice []string, str string, i int) { fmt.Printf(\"Receiver Address: %p\\n\", t) debug.PrintStack() } // å †æ ˆä¿¡æ¯ Receiver Address: 0x5781c8 goroutine 1 [running]: runtime/debug.Stack(0x15, 0xc000071ef0, 0x1) C:/Go/src/runtime/debug/stack.go:24 +0xae runtime/debug.PrintStack() C:/Go/src/runtime/debug/stack.go:16 +0x29 main.(*trace).Example(0x5781c8, 0xc000071f48, 0x2, 0x4, 0x4c04bb, 0x5, 0xa) D:/gopath/src/example/example/main.go:17 +0x7c main.main() D:/gopath/src/example/example/main.go:13 +0x9a ä¼ é€’çš„å‚æ•°å…¨éƒ¨ä¸ºå€¼ç±»å‹æ—¶ï¼Œå¯èƒ½ä¼šé˜²æ­¢ä¸€ä¸ª32ä½çš„å­—ä¸­ // ç¨‹åº import ( \"runtime/debug\" ) func main() { Example(true, false, true, 25) } func Example(b1, b2, b3 bool, i uint8) { debug.PrintStack() } // å †æ ˆä¿¡æ¯ goroutine 1 [running]: runtime/debug.Stack(0x4, 0xc00007a010, 0xc000077f88) C:/Go/src/runtime/debug/stack.go:24 +0xae runtime/debug.PrintStack() C:/Go/src/runtime/debug/stack.go:16 +0x29 main.Example(0xc019010001) D:/gopath/src/example/example/main.go:12 +0x27 main.main() D:/gopath/src/example/example/main.go:8 +0x30 å¯ä»¥çœ‹åˆ° Example çš„å‚æ•°åªæœ‰ä¸€ä¸ªï¼Œå®é™…ä¸Šåº•å±‚å››ä¸ªå‚æ•°æ”¾åœ¨ä¸€ä¸ªå­—ä¸­ // Parameter values true, false, true, 25 // Word value Bits Binary Hex Value 00-07 0000 0001 01 true 08-15 0000 0000 00 false 16-23 0000 0001 01 true 24-31 0001 1001 19 25 ","date":"2020-08-15","objectID":"/2020/golang-deep-learning-9-call-stack/:0:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 9-è°ƒç”¨æ ˆ","uri":"/2020/golang-deep-learning-9-call-stack/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æœ¬ç¯‡ä»‹ç» Go çš„å †æ ˆå’Œé€ƒé€¸åˆ†æã€‚ ","date":"2020-08-15","objectID":"/2020/golang-deep-learning-8-stack-heap-and-escape-analysis/:0:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 8-å †æ ˆä¸é€ƒé€¸åˆ†æ","uri":"/2020/golang-deep-learning-8-stack-heap-and-escape-analysis/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. å †æ ˆ æ ˆæ˜¯ä¸€ç§åå…¥å…ˆå‡ºçš„ç»“æ„ï¼Œè®¡ç®—æœºä¸­ä¹Ÿæœ‰ä¸€å—æ»¡è¶³è¯¥ç‰¹æ€§çš„åŠ¨æ€å†…å­˜åŒºåŸŸï¼Œç¨‹åºå¯ä»¥å°†æ•°æ®å‹å…¥æ ˆä¸­æˆ–è€…å°†æ•°æ®ä»æ ˆä¸­å¼¹å‡ºï¼Œä»è€Œä½¿æ ˆåŠ¨æ€çš„å¢å¤§æˆ–å‡å°ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œå †ä¹Ÿæ˜¯è®¡ç®—æœºä¸­çš„ä¸€ä¸­å†…å­˜åŒºåŸŸã€‚å †ä¸æ ˆçš„åŒºåˆ«å¦‚ä¸‹ æ ˆä¸€èˆ¬ç”±æ“ä½œç³»ç»Ÿæ¥åˆ†é…å’Œé‡Šæ”¾ï¼Œå †ç”±ç¨‹åºå‘˜é€šè¿‡ç¼–ç¨‹è¯­è¨€æ¥ç”³è¯·åˆ›å»ºä¸é‡Šæ”¾ã€‚ æ ˆç”¨æ¥å­˜æ”¾å‡½æ•°çš„å‚æ•°ã€è¿”å›å€¼ã€å±€éƒ¨å˜é‡ã€å‡½æ•°è°ƒç”¨æ—¶çš„ä¸´æ—¶ä¸Šä¸‹æ–‡ç­‰ï¼Œå †ç”¨æ¥å­˜æ”¾å…¨å±€å˜é‡ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ç†è§£æ•°æ®å­˜æ”¾çš„è§„åˆ™ï¼šåªè¦æ˜¯å±€éƒ¨çš„ã€å ç”¨ç©ºé—´ç¡®å®šçš„æ•°æ®ï¼Œä¸€èˆ¬éƒ½å­˜æ”¾åœ¨stack é‡Œé¢ï¼Œå¦åˆ™å°±æ”¾åœ¨ heap é‡Œé¢ã€‚ æ ˆçš„è®¿é—®é€Ÿåº¦ç›¸å¯¹æ¯”å †å¿«ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€ä¸ªstackï¼Œæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€ä¸ªheapï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œstack æ˜¯çº¿ç¨‹ç‹¬å çš„ï¼Œheap æ˜¯çº¿ç¨‹å…±ç”¨çš„ã€‚ stack åˆ›å»ºçš„æ—¶å€™ï¼Œå¤§å°æ˜¯ç¡®å®šçš„ï¼Œæ•°æ®è¶…è¿‡è¿™ä¸ªå¤§å°ï¼Œå°±å‘ç”Ÿstack overflow é”™è¯¯ï¼Œè€Œheapçš„å¤§å°æ˜¯ä¸ç¡®å®šçš„ï¼Œéœ€è¦çš„è¯å¯ä»¥ä¸æ–­å¢åŠ ã€‚ æ ˆæ˜¯ç”±é«˜åœ°å€å‘ä½åœ°å€å¢é•¿çš„ï¼Œè€Œå †æ˜¯ç”±ä½åœ°å€å‘é«˜åœ°å€å¢é•¿çš„ã€‚ åœ¨ C/C++ ä¸­ï¼Œç¨‹åºå‘˜ç”³è¯·çš„å†…å­˜ç©ºé—´ä½¿ç”¨å®Œæ¯•åéœ€è¦è‡ªå·±é‡Šæ”¾ï¼Œåœ¨ Javaã€Go ç­‰è¯­è¨€ä¸­ï¼Œæä¾›äº†ä¸€ç§ä¸»åŠ¨é‡Šæ”¾ç”³è¯·çš„å†…å­˜ç©ºé—´çš„åŠŸèƒ½ï¼Œè¿™å°±æ˜¯åƒåœ¾å›æ”¶æœºåˆ¶ã€‚ ","date":"2020-08-15","objectID":"/2020/golang-deep-learning-8-stack-heap-and-escape-analysis/:1:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 8-å †æ ˆä¸é€ƒé€¸åˆ†æ","uri":"/2020/golang-deep-learning-8-stack-heap-and-escape-analysis/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. Goçš„å †æ ˆ é¦–å…ˆï¼ŒGo æ˜¯è‡ªå·±ç®¡ç†å†…å­˜çš„ï¼Œè€Œä¸æ˜¯äº¤ç»™æ“ä½œç³»ç»Ÿï¼Œå®ƒæ¯æ¬¡ä»æ“ä½œç³»ç»Ÿç”³è¯·ä¸€å¤§å—å†…å­˜ï¼Œç„¶åæŒ‰ç…§ Google çš„ TCMalloc ç®—æ³•è¿›è¡Œå†…å­˜åˆ†é…ï¼Œä¹Ÿåˆ’åˆ†ä¸ºå †ã€æ ˆç­‰å¾ˆå¤šåŒºåŸŸã€‚ è¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³å¿ƒå˜é‡ç©¶ç«Ÿæ”¾åœ¨å †è¿˜æ˜¯æ ˆé‡Œï¼Œå®˜æ–¹æœ‰è¿™ä¹ˆä¸€æ®µè§£é‡Š åªè¦æœ‰å¯¹å˜é‡çš„å¼•ç”¨ï¼Œå˜é‡å°±ä¼šå­˜åœ¨ï¼Œè€Œå®ƒå­˜å‚¨çš„ä½ç½®ä¸è¯­è¨€çš„è¯­ä¹‰æ— å…³ã€‚å¦‚æœå¯èƒ½ï¼Œå˜é‡ä¼šè¢«åˆ†é…åˆ°å…¶å‡½æ•°çš„æ ˆï¼Œä½†å¦‚æœç¼–è¯‘å™¨æ— æ³•è¯æ˜å‡½æ•°è¿”å›ä¹‹åå˜é‡æ˜¯å¦ä»ç„¶è¢«å¼•ç”¨ï¼Œå°±å¿…é¡»åœ¨å †ä¸Šåˆ†é…è¯¥å˜é‡ï¼Œé‡‡ç”¨åƒåœ¾å›æ”¶æœºåˆ¶è¿›è¡Œç®¡ç†ï¼Œä»è€Œé¿å…æŒ‡é’ˆæ‚¬ç©ºã€‚æ­¤å¤–ï¼Œå±€éƒ¨å˜é‡å¦‚æœéå¸¸å¤§ï¼Œä¹Ÿä¼šå­˜åœ¨å †ä¸Šã€‚ åœ¨ç¼–è¯‘å™¨ä¸­ï¼Œå¦‚æœå˜é‡å…·æœ‰åœ°å€ï¼Œå°±ä½œä¸ºå †åˆ†é…çš„å€™é€‰ï¼Œä½†å¦‚æœé€ƒé€¸åˆ†æå¯ä»¥ç¡®å®šå…¶ç”Ÿå­˜å‘¨æœŸä¸ä¼šè¶…è¿‡å‡½æ•°è¿”å›ï¼Œå°±ä¼šåˆ†é…åœ¨æ ˆä¸Šã€‚ æ€»ä¹‹ï¼Œåˆ†é…åœ¨å †è¿˜æ˜¯æ ˆå®Œå…¨ç”±ç¼–è¯‘å™¨ç¡®å®šã€‚ æ‰€ä»¥ Go é‡Œå˜é‡åˆ†é…åœ¨ç”±ç¼–è¯‘å™¨å†³å®šï¼Œæˆ‘ä»¬è™½ç„¶æ— æ³•é€šè¿‡å˜é‡çš„ç±»å‹åˆ¤æ–­å®ƒçš„å­˜å‚¨ä½ç½®ï¼Œä½†å¯ä»¥é€šè¿‡æ‰“å°ç¨‹åºçš„æ±‡ç¼–ä»£ç æ¥æŸ¥çœ‹ï¼Œä¸»è¦ä½¿ç”¨ go tool compile å‘½ä»¤ï¼Œç¤ºä¾‹ç¨‹åºå¦‚ä¸‹ package main import \"fmt\" func main() { var a [1]int c := a[:] fmt.Println(c) } ä½¿ç”¨ -S å‚æ•°ç¼–è¯‘ï¼Œå¯ä»¥è¾“å‡ºè¯¦ç»†å†…å®¹ã€‚å¯ä»¥çœ‹åˆ°ç¬¬ 6 è¡Œä»£ç å‡ºç°äº† runtime.newobjectï¼Œè¿™å°±è¯´æ˜ main.go ç¬¬6è¡Œ çš„æ•°ç»„å˜é‡ a åˆ†é…åœ¨å †ä¸Šã€‚åä¹‹ï¼Œå¦‚æœæ²¡æœ‰å‘ç° runtime.newobject è°ƒç”¨ï¼Œå°±è¯´æ˜åˆ†é…åœ¨æ ˆä¸Šã€‚ $ go tool compile -S main.go ... 0x0028 00040 (main.go:6) PCDATA $0, $1 0x0028 00040 (main.go:6) PCDATA $1, $0 0x0028 00040 (main.go:6) LEAQ type.[1]int(SB), AX 0x002f 00047 (main.go:6) PCDATA $0, $0 0x002f 00047 (main.go:6) MOVQ AX, (SP) 0x0033 00051 (main.go:6) CALL runtime.newobject(SB) 0x0038 00056 (main.go:6) PCDATA $0, $1 0x0038 00056 (main.go:6) MOVQ 8(SP), AX 0x003d 00061 (main.go:8) PCDATA $0, $0 0x003d 00061 (main.go:8) MOVQ AX, (SP) 0x0041 00065 (main.go:8) MOVQ $1, 8(SP) 0x004a 00074 (main.go:8) MOVQ $1, 16(SP) ... ä½¿ç”¨ -m å‚æ•°å¯ä»¥è¾“å‡ºä¼˜åŒ–åçš„æè¿°ï¼Œè¿™é‡Œå°±çœ‹èµ·æ¥å¾ˆæ¸…æ¥šäº†ï¼Œå¯ä»¥çœ‹åˆ° main.go ç¬¬ 6 è¡Œçš„å˜é‡ a åˆ†é…åˆ°äº†å †ä¸Šï¼Œåœ¨ç¬¬ 8 è¡Œæ—¶ï¼Œå˜é‡ c é€ƒé€¸åˆ°äº†å †ä¸Šã€‚å…³äºé€ƒé€¸æˆ‘ä»¬åœ¨ä¸‹ä¸€å°èŠ‚ä»‹ç»ã€‚ $ go tool compile -m main.go main.go:8:13: inlining call to fmt.Println main.go:6:6: moved to heap: a main.go:8:13: c escapes to heap main.go:8:13: []interface {} literal does not escape \u003cautogenerated\u003e:1: .this does not escape \u003cautogenerated\u003e:1: .this does not escape ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ go build å‘½ä»¤ä¸­æ·»åŠ  -gcflag=-m å‚æ•°ï¼Œæ„æ€æ˜¯ç¼–è¯‘çš„åŒæ—¶ä»¥ -m å‚æ•°è¿è¡Œ go tool compile å‘½ä»¤ï¼Œç»“æœæ˜¯ç›¸åŒçš„ã€‚ $ go build -gcflags=-m main.go # command-line-arguments .\\main.go:8:13: inlining call to fmt.Println .\\main.go:6:6: moved to heap: a .\\main.go:8:13: c escapes to heap .\\main.go:8:13: []interface {} literal does not escape \u003cautogenerated\u003e:1: .this does not escape \u003cautogenerated\u003e:1: .this does not escape ","date":"2020-08-15","objectID":"/2020/golang-deep-learning-8-stack-heap-and-escape-analysis/:2:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 8-å †æ ˆä¸é€ƒé€¸åˆ†æ","uri":"/2020/golang-deep-learning-8-stack-heap-and-escape-analysis/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. é€ƒé€¸åˆ†æ å‰é¢å·²ç»æåˆ°ï¼ŒGo ä¸­å˜é‡åˆ†é…åœ¨æ ˆè¿˜æ˜¯å †ä¸Šå®Œå…¨ç”±ç¼–è¯‘å™¨å†³å®šï¼Œè€ŒåŸæœ¬çœ‹èµ·æ¥åº”è¯¥åˆ†é…åœ¨æ ˆä¸Šçš„å˜é‡ï¼Œå¦‚æœå…¶ç”Ÿå‘½å‘¨æœŸè·å¾—äº†å»¶é•¿ï¼Œè¢«åˆ†é…åœ¨äº†å †ä¸Šï¼Œå°±è¯´å®ƒå‘ç”Ÿäº†é€ƒé€¸ã€‚ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨åœ°å»åˆ¤æ–­å˜é‡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯å¦è·å¾—äº†å»¶é•¿ï¼Œæ•´ä¸ªåˆ¤æ–­çš„è¿‡ç¨‹å°±å«é€ƒé€¸åˆ†æã€‚ package main func main() { a := test() println(a) } func test() *int { b := 2 return \u0026b } ä¸¾ä¸ªä¾‹å­ï¼Œä¸Šé¢çš„ç¨‹åºä¸­ b ä½œä¸ºå±€éƒ¨å˜é‡ï¼Œå¦‚æœæ˜¯åœ¨ C è¯­è¨€ä¸­ï¼Œreturn \u0026b è¿™æ ·çš„å†™æ³•æ— æ³•é€šè¿‡ï¼Œå› ä¸º b åœ¨å‡½æ•°è¿”å›åå·²ç»æ¶ˆå¤±äº†ï¼Œä½†åœ¨ Go ä¸­ï¼Œç¼–è¯‘å™¨åšäº†ä¸€ä¸‹é€ƒé€¸åˆ†æï¼Œå‘ç°è¿”å› \u0026b è¯´æ˜ä¹‹å b è¿˜è¦ç”¨ï¼Œäºæ˜¯å°±æŠŠ b åˆ†é…åœ¨äº†å †ä¸Šã€‚ $ go tool compile -m main.go main.go:8:6: can inline test main.go:3:6: can inline main main.go:4:11: inlining call to test main.go:9:2: moved to heap: b ç„¶åæˆ‘ä»¬ä¸¾å¦å¤–ä¸€ä¸ªä¾‹å­å¦‚ä¸‹ï¼Œä¸€ä¸ªæœ€ç®€å•çš„è¾“å‡º package main import \"fmt\" func main() { a := 1 fmt.Println(a) } ç»“æœå‘ç°å˜é‡ a ä¾ç„¶é€ƒé€¸äº† $ go tool compile -m main.go main.go:7:13: inlining call to fmt.Println main.go:7:13: a escapes to heap main.go:7:13: []interface {} literal does not escape \u003cautogenerated\u003e:1: .this does not escape \u003cautogenerated\u003e:1: .this does not escape è¿™æ˜¯å› ä¸ºè¾“å‡ºå…¶å®æ˜¯è°ƒç”¨äº† fmt åŒ…çš„ Println å‡½æ•°ï¼Œå˜é‡çš„ç”Ÿå‘½å‘¨æœŸä¾ç„¶å¾—åˆ°äº†æ‰©å±•ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ println å‡½æ•°ï¼Œå°±ä¸ä¼šå‘ç”Ÿé€ƒé€¸ package main func main() { a := 1 println(a) } $ go tool compile -m main.go main.go:3:6: can inline main æ‰€ä»¥ç°åœ¨æˆ‘ä»¬å¯ä»¥æ›´å¥½çš„ç†è§£å®˜æ–¹è¯´æ˜ä¸­çš„è¿™å¥è¯ï¼šå¦‚æœå˜é‡å…·æœ‰åœ°å€ï¼Œå°±ä½œä¸ºå †åˆ†é…çš„å€™é€‰ï¼Œä½†å¦‚æœé€ƒé€¸åˆ†æå¯ä»¥ç¡®å®šå…¶ç”Ÿå­˜å‘¨æœŸä¸ä¼šè¶…è¿‡å‡½æ•°è¿”å›ï¼Œå°±ä¼šåˆ†é…åœ¨æ ˆä¸Šã€‚ å˜é‡å‘ç”Ÿé€ƒé€¸çš„æƒ…å†µå¯ä»¥æ€»ç»“å¦‚ä¸‹ åœ¨æ–¹æ³•å†…æŠŠå±€éƒ¨å˜é‡æŒ‡é’ˆè¿”å› å±€éƒ¨å˜é‡åŸæœ¬åº”è¯¥åœ¨æ ˆä¸­åˆ†é…ï¼Œåœ¨æ ˆä¸­å›æ”¶ã€‚ä½†æ˜¯ç”±äºè¿”å›æ—¶è¢«å¤–éƒ¨å¼•ç”¨ï¼Œå› æ­¤å…¶ç”Ÿå‘½å‘¨æœŸå¤§äºæ ˆï¼Œåˆ™æº¢å‡ºã€‚ å‘é€æŒ‡é’ˆæˆ–å¸¦æœ‰æŒ‡é’ˆçš„å€¼åˆ° channel ä¸­ã€‚ åœ¨ç¼–è¯‘æ—¶ï¼Œæ˜¯æ²¡æœ‰åŠæ³•çŸ¥é“å“ªä¸ª goroutine ä¼šåœ¨ channel ä¸Šæ¥æ”¶æ•°æ®ã€‚æ‰€ä»¥ç¼–è¯‘å™¨æ²¡æ³•çŸ¥é“å˜é‡ä»€ä¹ˆæ—¶å€™æ‰ä¼šè¢«é‡Šæ”¾ã€‚ åœ¨ä¸€ä¸ªåˆ‡ç‰‡ä¸Šå­˜å‚¨æŒ‡é’ˆæˆ–å¸¦æŒ‡é’ˆçš„å€¼ã€‚ ä¸€ä¸ªå…¸å‹çš„ä¾‹å­å°±æ˜¯ []*string ã€‚è¿™ä¼šå¯¼è‡´åˆ‡ç‰‡çš„å†…å®¹é€ƒé€¸ã€‚å°½ç®¡å…¶åé¢çš„æ•°ç»„å¯èƒ½æ˜¯åœ¨æ ˆä¸Šåˆ†é…çš„ï¼Œä½†å…¶å¼•ç”¨çš„å€¼ä¸€å®šæ˜¯åœ¨å †ä¸Šã€‚ slice çš„èƒŒåæ•°ç»„è¢«é‡æ–°åˆ†é…äº†ï¼Œå› ä¸º append æ—¶å¯èƒ½ä¼šè¶…å‡ºå…¶å®¹é‡( cap )ã€‚ slice åˆå§‹åŒ–çš„åœ°æ–¹åœ¨ç¼–è¯‘æ—¶æ˜¯å¯ä»¥çŸ¥é“çš„ï¼Œå®ƒæœ€å¼€å§‹ä¼šåœ¨æ ˆä¸Šåˆ†é…ã€‚å¦‚æœåˆ‡ç‰‡èƒŒåçš„å­˜å‚¨è¦åŸºäºè¿è¡Œæ—¶çš„æ•°æ®è¿›è¡Œæ‰©å……ï¼Œå°±ä¼šåœ¨å †ä¸Šåˆ†é…ã€‚ åœ¨ interface ç±»å‹ä¸Šè°ƒç”¨æ–¹æ³•ã€‚ åœ¨ interface ç±»å‹ä¸Šè°ƒç”¨æ–¹æ³•éƒ½æ˜¯åŠ¨æ€è°ƒåº¦çš„ â€”â€” æ–¹æ³•çš„çœŸæ­£å®ç°åªèƒ½åœ¨è¿è¡Œæ—¶çŸ¥é“ã€‚æƒ³åƒä¸€ä¸ª io.Reader ç±»å‹çš„å˜é‡ r , è°ƒç”¨ r.Read(b) ä¼šä½¿å¾— r çš„å€¼å’Œåˆ‡ç‰‡b çš„èƒŒåå­˜å‚¨éƒ½é€ƒé€¸æ‰ï¼Œæ‰€ä»¥ä¼šåœ¨å †ä¸Šåˆ†é…ã€‚ ","date":"2020-08-15","objectID":"/2020/golang-deep-learning-8-stack-heap-and-escape-analysis/:3:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 8-å †æ ˆä¸é€ƒé€¸åˆ†æ","uri":"/2020/golang-deep-learning-8-stack-heap-and-escape-analysis/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"å‚è€ƒ [1] Goå †æ ˆçš„ç†è§£ [2] é˜®ä¸€å³°ï¼Œæ ˆçš„ä¸‰ç§å«ä¹‰ [3] å®˜æ–¹å…³äºå˜é‡åˆ†é…åœ¨å †è¿˜æ˜¯æ ˆä¸Šçš„è¯´æ˜ [4] Youngï¼ŒCSDNï¼ŒGo çš„å˜é‡åˆ°åº•åœ¨å †è¿˜æ˜¯æ ˆä¸­åˆ†é… [5] èƒ–è™ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼Œç®€å•èŠèŠå†…å­˜é€ƒé€¸ ","date":"2020-08-15","objectID":"/2020/golang-deep-learning-8-stack-heap-and-escape-analysis/:4:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 8-å †æ ˆä¸é€ƒé€¸åˆ†æ","uri":"/2020/golang-deep-learning-8-stack-heap-and-escape-analysis/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"ä¸€ç›´éƒ½æ¯”è¾ƒçº ç»“è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥æœäº†ä¸€ä¸‹ç­”æ¡ˆï¼Œè®°å½•åœ¨è¿™é‡Œã€‚ å˜é‡çš„å£°æ˜æœ‰ä¸¤ç§æƒ…å†µï¼š éœ€è¦å»ºç«‹å­˜å‚¨ç©ºé—´ï¼Œè¿™ç§ç§°ä¸ºå®šä¹‰æ€§å£°æ˜ï¼ˆdefining declarationï¼‰ï¼Œç®€ç§°å®šä¹‰ ä¸éœ€è¦å»ºç«‹å­˜å‚¨ç©ºé—´ï¼Œè¿™ç§ç§°ä¸ºå¼•ç”¨æ€§å£°æ˜ï¼ˆreferncing declarationï¼‰ æ‰€ä»¥å¹¿ä¹‰çš„è®²ï¼Œå£°æ˜åŒ…å«å®šä¹‰ï¼Œå®šä¹‰æ˜¯å£°æ˜çš„ä¸€ä¸ªç‰¹ä¾‹ã€‚ åœ¨ Go ä¸­ï¼ŒåŸºæœ¬å˜é‡ç±»å‹åœ¨å£°æ˜æ—¶éƒ½ä¼šåˆ†é…å­˜å‚¨ç©ºé—´å¹¶åˆ†é…é»˜è®¤å€¼ï¼Œå› æ­¤éƒ½å±äºå®šä¹‰æ€§å£°æ˜ var ( a int b float32 c bool ) ä½†æ˜¯ï¼Œåƒåˆ‡ç‰‡ã€æ˜ å°„ã€é€šé“ç­‰ï¼Œå£°æ˜æ—¶ä¸ä¼šåˆ†é…å­˜å‚¨ç©ºé—´ï¼Œè¦åˆ†é…ç©ºé—´è¿˜å¿…é¡»ä½¿ç”¨ make å†…ç½®å‡½æ•°ï¼Œå› æ­¤å®ƒä»¬æ˜¯å¼•ç”¨æ€§å£°æ˜ var a []int a = make([]int,3) åœ¨ Go çš„å®˜æ–¹æ–‡æ¡£ä¸­ï¼Œä½¿ç”¨çš„ä¹Ÿéƒ½æ˜¯ declaration è¿™ä¸ªè¯ï¼Œç»Ÿä¸€ç”¨ã€Œå£°æ˜ã€æ¥æè¿° ","date":"2020-08-15","objectID":"/2020/golang-supplement-the-difference-between-definition-and-declaration/:0:0","tags":["Goè¯­æ³•"],"title":"GolangæŸ¥æ¼è¡¥ç¼º-å®šä¹‰ä¸å£°æ˜çš„åŒºåˆ«","uri":"/2020/golang-supplement-the-difference-between-definition-and-declaration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"è°ƒåº¦å™¨å’Œåƒåœ¾å›æ”¶éƒ½å±äº runtime çš„ä¸€éƒ¨åˆ†ï¼Œæœ¬æ–‡æˆ‘ä»¬ä»‹ç» Go ä¸­ runtime çš„å«ä¹‰ï¼Œç„¶åå†æ¥åˆ†æ Go çš„è°ƒåº¦å™¨å’Œåƒåœ¾å›æ”¶ç­–ç•¥ã€‚ ","date":"2020-07-30","objectID":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/:0:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 7-è°ƒåº¦å™¨ä¸åƒåœ¾å›æ”¶","uri":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. runtime runtimeï¼Œç›´è¯‘ä¸ºè¿è¡Œæ—¶ï¼Œä¹‹å‰åªå¬è¯´è¿‡è¿™ä¸ªæ¦‚å¿µï¼Œä½†è¦è§£é‡Š runtime ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Œè¿˜æ˜¯è¯´ä¸å‡ºå£ã€‚æˆ‘ä» Go å®˜æ–¹æ–‡æ¡£çš„é—®ç­”é‡Œæ‰¾åˆ°äº†ä¸‹é¢è¿™æ®µè¯ï¼Œå¯ä»¥ä½œä¸ºä¸€ä¸ªå¾ˆå¥½çš„å¼€å§‹ã€‚ Go does have an extensive library, called the runtime, that is part of every Go program. The runtime library implements garbage collection, concurrency, stack management, and other critical features of the Go language. Although it is more central to the language, Goâ€™s runtime is analogous to libc, the C library. It is important to understand, however, that Goâ€™s runtime does not include a virtual machine, such as is provided by the Java runtime. Go programs are compiled ahead of time to native machine code (or JavaScript or WebAssembly, for some variant implementations). Thus, although the term is often used to describe the virtual environment in which a program runs, in Go the word â€œruntimeâ€ is just the name given to the library providing critical language services. Go çš„è¿è¡Œæ—¶æ˜¯æ¯ä¸ª Go ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œè´Ÿè´£å®æ–½åƒåœ¾å›æ”¶ã€å¹¶å‘ã€æ ˆç®¡ç†ä»¥åŠå…¶å®ƒ Go çš„ä¸€äº›æ ¸å¿ƒç‰¹æ€§ã€‚ä½†æ˜¯ï¼Œå°½ç®¡è¿™äº›éƒ½æ˜¯ä¸€ä¸ªè¯­è¨€çš„æ ¸å¿ƒï¼Œruntime åœ¨ Go ä¸­å®é™…ä¸Šæ˜¯ä¸€ä¸ªåº“ï¼ˆæ ‡å‡†åº“çš„ä¸€ä¸ªï¼‰ã€‚ç†è§£è¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œå› ä¸ºåœ¨å…¶å®ƒä¸€äº›è¯­è¨€ä¸­ï¼Œæ¯”å¦‚ Javaï¼Œruntime å®é™…ä¸ŠåŒ…å«ä¸€ä¸ªè™šæ‹Ÿæœºçš„æ¦‚å¿µï¼Œæ˜¯ç¨‹åºè¿è¡Œçš„ç¯å¢ƒï¼Œä½†åœ¨ Go ä¸­ runtime å°±ä»…ä»…æ˜¯ä¸€ä¸ªåŒ…å«ä¸€äº›å…³é”®ç‰¹æ€§çš„åº“ã€‚ è¿™é‡Œå·²ç»è¯´çš„æ¯”è¾ƒæ¸…æ¥šäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ runtime åº“åŒ…å«å“ªäº›ä¸œè¥¿ï¼Œå®é™…ä¸Šï¼Œruntime åº“ä¸‹é¢è¿˜æœ‰å‡ ä¸ªå­åº“ runtime/cgoï¼šç”¨æ¥æ”¯æŒ C è¯­è¨€å‡½æ•°çš„è°ƒç”¨ runtime/debugï¼šè¿›è¡Œé—®é¢˜æ’æŸ¥ runtime/msan runtime/pprofï¼šè¿›è¡Œæ€§èƒ½åˆ†æ runtime/raceï¼šå®ç°äº†æ•°æ®é™æ€æ£€æµ‹é€»è¾‘ runtime/traceï¼šæ‰§è¡Œè·Ÿè¸ªå™¨ï¼Œæ•è·å„ç§æ‰§è¡Œæ—¶çš„äº‹ä»¶ï¼Œæ¯”å¦‚ goroutine çš„åˆ›å»º/é˜»å¡/è§£é™¤é˜»å¡ã€ç³»ç»Ÿè°ƒç”¨çš„è¿›å…¥/é€€å‡º/é˜»å¡ã€åƒåœ¾å›æ”¶ç›¸å…³çš„äº‹ä»¶ã€å †å¤§å°çš„æ”¹å˜ã€å¤„ç†å™¨çš„å¯åŠ¨å’Œåœæ­¢ç­‰ï¼Œå¹¶å°†å®ƒä»¬å†™å…¥ io.writer ä¸­ éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œè°ƒåº¦å™¨ã€åƒåœ¾å›æ”¶ã€å„ç§æ•°æ®ç±»å‹çš„å®šä¹‰å’Œæ“ä½œ(æ¯”å¦‚åˆ‡ç‰‡ã€æ¥å£ç­‰)éƒ½ä½äº runtime åº“ï¼Œè€Œä¸æ˜¯è¿™å‡ ä¸ªå­åº“ï¼Œåœ¨ç”µè„‘ä¸­çš„ä½ç½®ä¸º $GOROOT/src/runtime Go çš„å¯æ‰§è¡Œæ–‡ä»¶ä¸€èˆ¬æ¯”ç›¸åº”çš„æºç æ–‡ä»¶å¤§å¾ˆå¤šï¼Œè¿™æ˜¯å› ä¸º runtime æ½œå…¥äº†æ¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œå› æ­¤ï¼ŒGo è¿è¡Œä¸ä¾èµ–äºå…¶å®ƒä»»ä½•æ–‡ä»¶ã€‚ ","date":"2020-07-30","objectID":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/:1:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 7-è°ƒåº¦å™¨ä¸åƒåœ¾å›æ”¶","uri":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. è°ƒåº¦å™¨ è¿™éƒ¨åˆ†å…³äºè°ƒåº¦å™¨çš„ä»‹ç»ï¼Œä¸»è¦ç¿»è¯‘è‡ª The Go scheduler è¿™ç¯‡æ–‡ç« ï¼Œå†™çš„éå¸¸å®¹æ˜“ç†è§£ã€‚ åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œè°ƒåº¦ä¸»è¦æ˜¯å¯¹ CPU æ—¶é—´ç‰‡çš„åˆ†é…ç­–ç•¥ï¼Œä¸ºäº†å……åˆ†åˆ©ç”¨ CPUï¼Œå°†æ—¶é—´åˆ’åˆ†ä¸ºä¸€ç³»åˆ—çš„æ—¶é—´ç‰‡ï¼Œç„¶åéµå¾ªæŸç§æœ€ä¼˜çš„ç­–ç•¥ï¼ˆæ€»æ‰§è¡Œæ—¶é—´æœ€çŸ­æˆ–å…¶å®ƒï¼‰å°†è¿›ç¨‹åˆ†é…åˆ°æŸä¸ªæ—¶é—´ç‰‡æ‰§è¡Œçš„è¿‡ç¨‹ã€‚Go ä¸­çš„è°ƒåº¦åšçš„ä¹Ÿæ˜¯ç±»ä¼¼çš„äº‹ï¼Œä¹Ÿå°±æ˜¯å¦‚ä½•åˆ†é… Goroutine çš„æ‰§è¡Œï¼Œåšè¿™ä»¶äº‹çš„å·¥å…·å°±æ˜¯è°ƒåº¦å™¨ï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œè°ƒåº¦å™¨å’Œ Go çš„å¹¶å‘æ˜¯æ¯æ¯ç›¸å…³çš„ã€‚ ","date":"2020-07-30","objectID":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/:2:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 7-è°ƒåº¦å™¨ä¸åƒåœ¾å›æ”¶","uri":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 è®¾è®¡ç†å¿µ æˆ‘ä»¬é¦–å…ˆæ¥ç†è§£ä¸ºä»€ä¹ˆ Go éœ€è¦ä¸€ä¸ªè‡ªå·±çš„è°ƒåº¦å™¨ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„è°ƒåº¦å™¨ã€‚é¦–å…ˆï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œçº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ä¹Ÿéœ€è¦ä¸€å®šçš„èµ„æºï¼Œå…¶ä¸­å¾ˆå¤šå¼€é”€å¯¹ Go çš„è¿è¡Œæ¥è¯´æ˜¯ä¸å¿…è¦çš„ï¼Œè€Œä¸”çº¿ç¨‹æ•°é‡è¶Šå¤šï¼Œè¿™éƒ¨åˆ†å¼€é”€è¶Šå¤§ã€‚å¦å¤–ä¸€ä¸ªé‡è¦çš„åŸå› æ˜¯äº¤ç»™æ“ä½œç³»ç»Ÿè°ƒåº¦æ— æ³•åŸºäº Go å½“å‰çš„æƒ…å†µåšå‡ºæœ€ä¼˜çš„è°ƒåº¦å†³ç­–ï¼Œæ¯”å¦‚ Go è¿›è¡Œåƒåœ¾å›æ”¶çš„æ—¶å€™ï¼Œéœ€è¦æš‚åœæ­£åœ¨è¿è¡Œçš„ Goroutine å’Œçº¿ç¨‹ï¼Œå¹¶ä½¿å†…å­˜ä¿æŒåœ¨ä¸€ä¸ªä¸€è‡´çš„çŠ¶æ€ï¼Œå¦‚æœäº¤ç»™æ“ä½œç³»ç»Ÿçš„è°ƒåº¦å™¨ï¼Œå°±å¤±å»äº†å¯¹ä¸€è‡´æ€§çŠ¶æ€çš„æŠŠæ¡ï¼Œå¹¶ä¸”éœ€è¦ç­‰å¾…æ‰€æœ‰ç›¸å…³çº¿ç¨‹åœæ­¢å·¥ä½œï¼Œæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹è¶Šå¤šï¼Œè¾¾åˆ°è¿™ä¸ªç›®çš„è¶Šéš¾ã€‚å¦‚æœ Go ä½¿ç”¨è‡ªå·±çš„è°ƒåº¦å™¨ï¼Œå°±çŸ¥é“ä»€ä¹ˆæ—¶å€™å†…å­˜çŠ¶æ€æ˜¯ä¸€è‡´çš„ï¼ˆåªé’ˆå¯¹ Go ç¨‹åºåˆ†é…çš„å†…å­˜ï¼‰ï¼Œå®ƒä¼šåœ¨è¿™äº›å·²çŸ¥çš„å†…å­˜ä¸€è‡´æ€§çš„æ—¶åˆ»å¼€å§‹åƒåœ¾å›æ”¶ï¼Œå¹¶ä¸”æ­¤æ—¶åªéœ€è¦ç­‰å¾…å½“å‰æ­£åœ¨ CPU æ ¸ä¸Šæ‰§è¡Œçš„é‚£ä¸ªçº¿ç¨‹ï¼Œè€Œä¸æ˜¯ç­‰å¾…æ‰€æœ‰çš„çº¿ç¨‹ã€‚ æœ‰ä¸‰ç§å¸¸è§çš„çº¿ç¨‹æ¨¡å‹ï¼Œç¬¬ä¸€ç§æ˜¯ N:1ï¼Œä¹Ÿå°±æ˜¯å¤šä¸ªç”¨æˆ·ç©ºé—´çº¿ç¨‹è¿è¡Œåœ¨ä¸€ä¸ª OS çº¿ç¨‹ä¸Šï¼Œå…¶ä¼˜ç‚¹æ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢å¿«é€Ÿï¼Œç¼ºç‚¹æ˜¯ä¸èƒ½å……åˆ†åˆ©ç”¨å¤šæ ¸ç³»ç»Ÿçš„ä¼˜ç‚¹ï¼›ç¬¬äºŒç§æ˜¯ 1:1ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç”¨æˆ·ç©ºé—´çº¿ç¨‹å¯¹åº”ä¸€ä¸ª OS çº¿ç¨‹ï¼Œå…¶ä¼˜ç‚¹æ˜¯å……åˆ†åˆ©ç”¨äº†ç³»ç»Ÿçš„å¤šä¸ªæ ¸ï¼Œç¼ºç‚¹æ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€æœ‰ç‚¹å¤§ã€‚ Go é‡‡ç”¨çš„æ˜¯ä¸€ç§æŠ˜è¡·çš„åŠæ³•ï¼Œå³ M:Nï¼Œä¹Ÿå°±æ˜¯å°†ä»»æ„æ•°é‡çš„ Goroutine å¯¹åº”åˆ°ä»»æ„æ•°é‡çš„ OS çº¿ç¨‹ï¼ŒOS çº¿ç¨‹çš„æ•°é‡é€šå¸¸å–å†³äº CPU æ ¸çš„æ•°ç›®ï¼Œè¿™ç§æ–¹å¼ä¿æŒäº†è¾ƒä½çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ï¼Œå¹¶ä¸”å……åˆ†åˆ©ç”¨äº†å¤šæ ¸ç³»ç»Ÿçš„ä¼˜ç‚¹ï¼Œå®ƒä¸»è¦çš„ç¼ºç‚¹æ˜¯å¢åŠ äº†è°ƒåº¦å™¨çš„å¤æ‚æ€§ã€‚ Go çš„è°ƒåº¦å™¨å®šä¹‰åœ¨ runtime åŒ…ä¸­ï¼Œå…·ä½“çš„æ–‡ä»¶æ˜¯ src/runtime/proc.goï¼Œæœ€ä¸»è¦çš„æ¦‚å¿µæœ‰ä¸‰ä¸ªï¼šPï¼ŒMï¼ŒGã€‚å…¶å®šä¹‰å¦‚ä¸‹ // Goroutine scheduler // The scheduler's job is to distribute ready-to-run goroutines over worker threads. // // The main concepts are: // G - goroutine. // M - worker thread, or machine. // P - processor, a resource that is required to execute Go code. // M must have an associated P to execute Go code, however it can be // blocked or in a syscall w/o an associated P. // // Design doc at https://golang.org/s/go11sched. ç”¨å›¾å½¢æè¿°æ›´ç›´è§‚ä¸€ç‚¹ M æ˜¯ OS çº¿ç¨‹ï¼Œç”±æ“ä½œç³»ç»Ÿç®¡ç†ï¼Œæ˜¯å®é™…çš„æ‰§è¡Œè€…ï¼ŒM æ˜¯ Machine çš„é¦–å­—æ¯å¤§å†™ã€‚ G æ˜¯ Goroutineï¼Œå®ƒåŒ…æ‹¬å †æ ˆï¼ŒæŒ‡ä»¤æŒ‡é’ˆå’Œå…¶ä»–å¯¹è°ƒåº¦ Goroutine é‡è¦çš„ä¿¡æ¯ã€‚ P æ˜¯è°ƒåº¦çš„ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥çœ‹ä½œ Go è‡ªå·±çš„è°ƒåº¦å™¨ï¼Œè´Ÿè´£å°† Goroutine è°ƒåº¦åˆ°å…·ä½“çš„ OS çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œä»–æ˜¯å®ç° M:N æ¨¡å‹çš„å…³é”®ï¼ŒP æ˜¯ Processor çš„é¦–å­—æ¯å¤§å†™ã€‚ ","date":"2020-07-30","objectID":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/:2:1","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 7-è°ƒåº¦å™¨ä¸åƒåœ¾å›æ”¶","uri":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 è°ƒåº¦ç­–ç•¥ æˆ‘ä»¬åŸºäºä¸Šé¢çš„ä¸‰ä¸ªæ¦‚å¿µæ¥æè¿° Go çš„è°ƒåº¦ç­–ç•¥ã€‚ ä¸Šå›¾ä¸­æœ‰ä¸¤ä¸ª Mï¼Œæ¯ä¸ªçº¿ç¨‹ M éƒ½æŒæœ‰ä¸€ä¸ªè°ƒåº¦å™¨ Pï¼Œå¹¶ä¸”è¿è¡Œç€ä¸€ä¸ª Gã€‚è°ƒåº¦å™¨çš„æ•°ç›®å¯ä»¥é€šè¿‡è®¾ç½® GOMAXPROCS ç¯å¢ƒå˜é‡æˆ–è€…è°ƒç”¨ runtime.GOMAXPROCS å‡½æ•°æ¥è®¾å®šï¼Œé€šå¸¸åœ¨è®¾å®šå¥½åï¼Œç¨‹åºè¿è¡ŒæœŸé—´è¯¥å€¼ä¸ä¼šæ”¹å˜ã€‚äº‹å®ä¸Šï¼Œè¯¥å€¼çš„è®¾å®šæ˜¯å……åˆ†åˆ©ç”¨å¤šæ ¸çš„å…³é”®ï¼Œæ¯”å¦‚ï¼Œå¦‚æœæœ‰ä¸€ä¸ª 4 æ ¸çš„è®¡ç®—æœºï¼Œæˆ‘ä»¬é€šå¸¸å°† GOMAXPROCS è®¾å®šä¸º 4ï¼Œè¿™æ ·æ“ä½œç³»ç»Ÿä¸­ä¼šåŒæ—¶æœ‰ 4 ä¸ªçº¿ç¨‹è¿è¡Œ Goroutineã€‚ ç°è‰²çš„ G æ„å‘³ç€ Goroutine æ²¡æœ‰åœ¨è¿è¡Œï¼Œè€Œæ˜¯å¤„äºç­‰å¾…è¢«è°ƒåº¦çš„çŠ¶æ€ï¼Œè¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªé˜Ÿåˆ—æ¥å­˜æ”¾å®ƒä»¬ï¼Œç§°ä¸ºè¿è¡Œé˜Ÿåˆ—(runqueue)ã€‚æ¯å½“ä½¿ç”¨ go å…³é”®å­—å¯åŠ¨ä¸€ä¸ª Goroutine æ—¶ï¼Œå®ƒå°±è¢«åŠ å…¥è¿è¡Œé˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œå½“ P åˆ°è¾¾æŸä¸ªè°ƒåº¦çš„æ—¶åˆ»ï¼Œå°±ä»è¿è¡Œé˜Ÿåˆ—é¦–éƒ¨å–å‡ºä¸€ä¸ª Goroutine ï¼Œè®¾ç½®å¥½å †æ ˆå’ŒæŒ‡ä»¤æŒ‡é’ˆï¼Œç„¶ååˆ†é…ç»™å…³è”çš„ M è¿è¡Œã€‚ä¸ºäº†å‡å°‘äº‰ç”¨ï¼Œæ¯ä¸ª P éƒ½æœ‰è‡ªå·±çš„è¿è¡Œé˜Ÿåˆ—ã€‚ æ³¨ï¼šæ—©æœŸçš„æ—¶å€™æ‰€æœ‰ P å…¬ç”¨ä¸€ä¸ªè¿è¡Œé˜Ÿåˆ—ï¼Œä½†è¿™ç§æƒ…å†µä¸‹è°ƒåº¦æ—¶éœ€è¦åŠ è§£é”ï¼Œçº¿ç¨‹ç»å¸¸è¢«é˜»å¡ã€‚ è¿è¡Œé˜Ÿåˆ—ä¸ç©ºï¼ŒP æœ‰ç”¨æ¥è°ƒåº¦çš„ Goroutineï¼Œé‚£ä¹ˆå°±ä¸ä¼šå‘ç”Ÿæ„å¤–ï¼Œè°ƒåº¦ä¼šå¤„äºä¸€ä¸ªç¨³å®šçš„çŠ¶æ€ã€‚ä½†å®é™…ç¯å¢ƒä¸‹æ˜¯ä¼šäº§ç”Ÿæ„å¤–çš„ï¼Œæˆ‘ä»¬ä»‹ç»å¦‚ä¸‹ï¼š çº¿ç¨‹å‡ºäºæŸäº›åŸå› éœ€è¦é˜»å¡ã€‚è¿™æ—¶å€™ P æ— æ³•å†å°† Goroutine äº¤ç»™è‡ªå·±çš„ M è¿è¡Œï¼Œç„¶åå°±ä¼šå°† Goroutine ç§»äº¤ç»™å…¶å®ƒçš„ M è¿è¡Œã€‚ å¦‚ä¸Šå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° M0 ç”±äºç³»ç»Ÿè°ƒç”¨ï¼ˆsyscallï¼‰å‘ç”Ÿäº†é˜»å¡ï¼Œä¸ä¹‹ç›¸å…³çš„ P ï¼ˆå®é™…ä¸Šæ˜¯ä¸‹æ–‡ï¼‰å°±è¢«ç§»äº¤ç»™äº† M1ï¼ˆè¿™é‡Œæˆ‘ä»¬å¯ä»¥æ›´å¥½çš„ç†è§£ä¸ºä»€ä¹ˆ P çš„æœ¬è´¨æ˜¯ä¸Šä¸‹æ–‡ï¼Œåªæ˜¯å¯ä»¥çœ‹ä½œè°ƒåº¦å™¨ï¼‰ã€‚è°ƒåº¦ç¨‹åºä¼šç¡®ä¿æœ‰è¶³å¤Ÿçš„ M æ¥è¿è¡Œ Pï¼Œä¸Šé¢çš„ M1 å¯èƒ½ä»…ä¸ºäº†å¤„ç†ç§»äº¤çš„ P å’Œå¯¹åº”çš„ Goroutineåˆ›å»ºï¼Œä¹Ÿå¯èƒ½æ¥è‡ªçº¿ç¨‹æ± ã€‚M0 å°†ä¿ç•™æ­£åœ¨æ‰§è¡Œçš„ Goroutineï¼Œå› ä¸ºå®è´¨ä¸Šå®ƒä»ç„¶åœ¨æ‰§è¡Œï¼Œåªæ˜¯åœ¨ OS ä¸­è¢«é˜»å¡ã€‚ å½“ syscall è¿”å›æ—¶ï¼ŒM0 å¿…é¡»å°è¯•è·å–ä¸€ä¸ª P ç”¨æ¥æ‰§è¡Œæœªæ‰§è¡Œå®Œçš„ G0ï¼Œä¸€èˆ¬æƒ…å†µæ˜¯ä»å…¶å®ƒçº¿ç¨‹çªƒå–ä¸€ä¸ª Pï¼Œå¦‚æœæ— æ³•çªƒå–åˆ°ï¼Œå°±ä¼šæŠŠ G0 æ”¾åˆ°å…¨å±€çš„è¿è¡Œé˜Ÿåˆ—ä¸­ï¼Œç„¶åæŠŠè‡ªå·±æ”¾åˆ°çº¿ç¨‹æ± è¿›å…¥ç¡çœ çŠ¶æ€ã€‚ å…¨å±€çš„è¿è¡Œé˜Ÿåˆ—æ˜¯ P ä»è‡ªå·±çš„è¿è¡Œé˜Ÿåˆ—æ— æ³•è·å–åˆ° G æ—¶è¯»å–çš„åœ°æ–¹ï¼ŒP ä¼šå®šæœŸæ£€æµ‹å…¨å±€è¿è¡Œé˜Ÿåˆ—ï¼Œé˜²æ­¢å…¨å±€è¿è¡Œé˜Ÿåˆ—ä¸­çš„ Goroutine å§‹ç»ˆå¾—ä¸åˆ°æ‰§è¡Œã€‚ è¿™ç§å¤„ç†è¿‡ç¨‹è¯´æ˜äº†ä¸ºä»€ä¹ˆå³ä½¿ GOMAXPROCS=1ï¼ŒGo ç¨‹åºè¿è¡Œä¹Ÿä¼šæ¶‰åŠåˆ°å¤šä¸ªçº¿ç¨‹ï¼ŒG0 ä¼šåœç•™åœ¨syscall çº¿ç¨‹ä¸Šã€‚ è¿è¡Œé˜Ÿåˆ—ä¸­çš„ Goroutine è¢«ç”¨å°½äº†ã€‚å¦‚æœæ¯ä¸ª P çš„è¿è¡Œé˜Ÿåˆ—ä¸Š Goroutine çš„æ•°é‡ä¸å¹³è¡¡ï¼Œå°±å¯èƒ½å‘ç”Ÿè¿™ç§æƒ…å†µ å‰é¢å·²ç»æåˆ°ï¼ŒP æœ¬èº«çš„è¿è¡Œé˜Ÿåˆ—ç©ºäº†çš„æ—¶å€™ï¼Œä¼šä»å…¨å±€è¿è¡Œé˜Ÿåˆ—è·å– Goroutineï¼Œé‚£ä¹ˆï¼Œå¦‚æœå…¨å±€è¿è¡Œé˜Ÿåˆ—ä¹Ÿä¸ºç©ºå‘¢ã€‚P å°±ä¼šä»å…¶å®ƒ P é‚£é‡Œçªƒå– Goroutineï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¼šçªƒå–å¤§çº¦ä¸€åŠçš„è¿è¡Œé˜Ÿåˆ—ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä¸¤ä¸ª P ä¸€ç›´æœ‰ Goroutine å¯è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯ä¿æŒå¹³è¡¡ï¼Œä»è€Œä¿è¯æ‰€æœ‰çš„çº¿ç¨‹ä¸å¤„äºç©ºé—²çŠ¶æ€ã€‚ä¸Šå›¾ä¸­ç©ºé—² P ä»å…¶å®ƒ P çªƒå–äº†ä¸¤ä¸ª Goroutineï¼Œä¸€ä¸ªç›´æ¥å¼€å§‹æ‰§è¡Œï¼Œå‰©ä¸‹çš„æ”¾å…¥è¿è¡Œé˜Ÿåˆ—ï¼Œæ­¤æ—¶ä¸¤ä¸ª P çš„è¿è¡Œé˜Ÿåˆ—å¤§å°ç›¸åŒã€‚ æ‰€ä»¥ï¼Œåœ¨æ“ä½œç³»ç»Ÿå±‚é¢ï¼ŒGo é‡‡ç”¨çš„æ˜¯æŠ¢å å¼è°ƒåº¦ï¼Œå¦‚æœ M é™·å…¥äº†é˜»å¡ï¼Œé‚£ä¹ˆä¼šå¯¼è‡´å½“å‰åœ¨å®ƒä¸Šé¢çš„ Goroutine é•¿æ—¶é—´å ç”¨ Mï¼Œè¿™æ—¶å€™å°±ä¼šå‘ç”ŸæŠ¢å ï¼Œ P ä¼šå¯»æ‰¾å…¶å®ƒçš„ Mï¼Œç„¶åæŠŠ G äº¤ç»™æ–°çš„ M è°ƒåº¦ã€‚ä½†æ˜¯åœ¨è¯­è¨€å±‚é¢ï¼Œåæ¥çš„ Goroutine æ°¸è¿œå‡å¦‚è¿è¡Œé˜Ÿåˆ—çš„æœ«å°¾ï¼Œä¸ä¼šæŠ¢å  Pã€‚ éæŠ¢å å¼è°ƒåº¦æ˜¯è¿›ç¨‹/çº¿ç¨‹äº¤ç»™ CPU åï¼Œä¼šä¸€ç›´æ‰§è¡Œå®Œæ¯•ï¼Œä¸ä¼šè¢«ä¸­æ–­ï¼› æŠ¢å å¼è°ƒåº¦æ˜¯ CPU æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹/çº¿ç¨‹ä¼šè¢«å…·æœ‰æ›´é«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹/çº¿ç¨‹æŠ¢å æ‰ï¼ˆå¯ä»¥é˜²æ­¢å•ä¸€è¿›ç¨‹é•¿æ—¶é—´ç‹¬å  CPUï¼‰ã€‚ å…¶å®ƒå‚è€ƒï¼šè¯´è¯´Golangçš„runtime ","date":"2020-07-30","objectID":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/:2:2","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 7-è°ƒåº¦å™¨ä¸åƒåœ¾å›æ”¶","uri":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. åƒåœ¾å›æ”¶ åƒåœ¾å›æ”¶ï¼ˆGarbage Collectionï¼ŒGCï¼‰ï¼Œæ˜¯ä¸€ç§å­˜å‚¨ç®¡ç†æœºåˆ¶ã€‚æˆ‘ä»¬ç¼–å†™çš„ç¨‹åºä¸­ï¼Œå˜é‡ã€å‡½æ•°å‚æ•°ç­‰åœ¨å†…å­˜é€šå¸¸å­˜æ”¾åœ¨ä¸¤ä¸ªä¸åŒçš„åŒºåŸŸï¼šæ ˆå’Œå †ã€‚æ ˆçš„åˆ†é…ç”±æ“ä½œç³»ç»Ÿç®¡ç†ï¼Œè€Œå †çš„åˆ†é…ç”±ç¨‹åºå‘˜ç®¡ç†ï¼Œåœ¨ C å’Œä¸€äº›è¯­è¨€ä¸­ï¼Œç¨‹åºå‘˜ä½¿ç”¨ malloc ç”³è¯·ç©ºé—´åï¼Œæœ€åè¿˜éœ€è¦è‡ªå·±ä½¿ç”¨ free é‡Šæ”¾ç©ºé—´ï¼Œç¼–è¯‘å™¨ä¸ä¼šè¾…åŠ©å®Œæˆè¿™ä¸ªè¿‡ç¨‹ï¼Œå¦‚æœå¿˜è®°é‡Šæ”¾ï¼Œå°±å¯èƒ½é€ æˆä¸å¯é¢„çŸ¥çš„åæœï¼ˆå†…å­˜æ³„æ¼ç­‰ï¼‰ã€‚è€Œåœ¨ Go å’Œå¦ä¸€äº›ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œä¸»åŠ¨æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå®ƒä¼šåœ¨åå°æŒç»­çš„è¿è¡Œï¼Œç›‘æ§å„ä¸ªå˜é‡å’Œå‚æ•°çš„çŠ¶æ€ï¼Œè¯†åˆ«é‚£äº›ä¸å†ä½¿ç”¨çš„å¯¹è±¡å¹¶é‡Šæ”¾æ‰å®ƒä»¬çš„å†…å­˜ç©ºé—´ï¼Œè¿™ç§æœºåˆ¶ï¼ˆæˆ–è€…è¯´è¿™ä¸ªåå°è¿›ç¨‹ï¼‰å«åšåƒåœ¾å›æ”¶ã€‚ ","date":"2020-07-30","objectID":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/:3:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 7-è°ƒåº¦å™¨ä¸åƒåœ¾å›æ”¶","uri":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.1 å¸¸è§çš„GCç®—æ³• æœ‰å¾ˆå¤šç”¨äºåƒåœ¾å›æ”¶çš„ç®—æ³•ã€‚ ç¬¬ä¸€ä¸ªå«åšå¼•ç”¨è®¡æ•°ï¼Œæ–¹æ³•æ˜¯ä¸ºæ¯ä¸ªå¯¹è±¡æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å½“æœ‰å¼•ç”¨æŒ‡å‘è¯¥å¯¹è±¡ï¼Œè®¡æ•°å™¨+1ï¼Œé‡Šæ”¾æ—¶è®¡æ•°å™¨-1ï¼Œå½“ GC æ£€æµ‹åˆ°è®¡æ•°å™¨ä¸º 0 æ—¶ï¼Œè¯´æ˜è¯¥å¯¹è±¡ä¸å†è¢«ä½¿ç”¨ï¼Œå°±å›æ”¶ä¸ºå®ƒåˆ†é…çš„å†…å­˜ã€‚å…¶ç¼ºç‚¹æ˜¯æ— æ³•æ£€æµ‹åˆ°å¾ªç¯å¼•ç”¨ï¼Œå› ä¸ºå¾ªç¯å¼•ç”¨çš„å¼•ç”¨è®¡æ•°æ°¸è¿œä¸å¯èƒ½ä¸º 0ã€‚ ç¬¬äºŒä¸ªå«åšæ ¹æœç´¢ç®—æ³•ï¼ŒJava å’Œ C# ä½¿ç”¨äº†è¿™ç§åŠæ³•ã€‚åŸç†æ˜¯é€šè¿‡ä¸€ç³»åˆ—ç§°ä¸º GC Root çš„å¯¹è±¡ä½œä¸ºèµ·ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å‘ä¸‹æœç´¢ï¼Œæ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾ï¼ˆReference Chainï¼‰ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡åˆ° GC Root æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼Œé‚£ä¹ˆå°±è¯´æ˜è¯¥å¯¹è±¡çš„å†…å­˜å¯ä»¥è¢«å›æ”¶ã€‚Java ä¸­å¯ä»¥ä½œä¸º GC Root çš„å¯¹è±¡åŒ…æ‹¬è™šæ‹Ÿæœºæ ˆä¸­çš„å¼•ç”¨å¯¹è±¡ã€ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ã€å¸¸é‡å¼•ç”¨çš„å¯¹è±¡å’Œæœ¬åœ°æ–¹æ³•æ ˆä¸­çš„å¼•ç”¨å¯¹è±¡ã€‚ ç¬¬ä¸‰ç§å«åšæ ‡è®°-æ¸…é™¤ç®—æ³•ã€‚å®ƒå°†åƒåœ¾å›æ”¶åˆ’åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œåœ¨æ ‡è®°é˜¶æ®µæ ‡è®°æ‰€æœ‰å¯å›æ”¶çš„å¯¹è±¡ï¼Œç„¶ååœ¨å›æ”¶é˜¶æ®µå›æ”¶è¢«æ ‡è®°å¯¹è±¡å ç”¨çš„ç©ºé—´ã€‚å…¶ç¼ºç‚¹ä¸»è¦æœ‰ä¸¤ä¸ªï¼Œç¬¬ä¸€ä¸ªæ˜¯æ ‡è®°æ—¶éœ€è¦æš‚åœæ•´ä¸ªç¨‹åºçš„è¿è¡Œï¼Œç¬¬äºŒä¸ªæ˜¯ä¼šäº§ç”Ÿå¤§é‡çš„å†…å­˜ç¢ç‰‡ï¼Œå¦‚ä¸‹å›¾ï¼Œç¢ç‰‡æ¯”è¾ƒå¤šçš„è¯åç»­å¯èƒ½æ²¡æœ‰è¶³å¤Ÿçš„è¿ç»­å†…å­˜åˆ†é…ç»™éœ€æ±‚è¾ƒå¤šçš„å¯¹è±¡ã€‚ ç¬¬å››ç§æ˜¯å¤åˆ¶ç®—æ³•ã€‚å¤åˆ¶ç®—æ³•æ˜¯æ ‡è®°-æ¸…é™¤ç®—æ³•çš„æ”¹è¿›ï¼Œå®ƒå°†å†…å­˜åˆ†ä¸ºä¸¤ä¸ªç›¸ç­‰çš„åŒºåŸŸï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€ä¸ªåŒºåŸŸï¼Œè¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œä¼šæŠŠå½“å‰å­˜æ´»çš„æ‰€æœ‰å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€ä¸ªç©ºé—´ï¼Œç„¶åå †å½“å‰ç©ºé—´è¿›è¡Œå›æ”¶ã€‚å¦‚ä¸‹å›¾ï¼Œè¿™ç§ç®—æ³•è§£å†³äº†å†…å­˜ç¢ç‰‡çš„é—®é¢˜ï¼Œä»£ä»·æ˜¯å¯ä½¿ç”¨çš„å†…å­˜ä¸ºåŸç†çš„ä¸€åŠï¼Œå¹¶ä¸”ç”±äºé¢å¤–çš„å¤åˆ¶æ“ä½œï¼Œæ•ˆç‡ä¼šæœ‰ä¸€å®šçš„å½±å“ã€‚ ç¬¬äº”ç§æ˜¯æ ‡è®°-å‹ç¼©ç®—æ³•ã€‚æ ‡è®°-å‹ç¼©ç®—æ³•ä¸å¤åˆ¶ç®—æ³•æ€è·¯ç›¸ä¼¼ï¼Œéƒ½æ˜¯å°†å†…å­˜åˆ†ä¸¤å—ï¼Œä¸åŒåœ¨äºï¼Œæ ‡è®°å®Œå¯å›æ”¶çš„å¯¹è±¡åï¼Œæ ‡è®°-å‹ç¼©ç®—æ³•ä¼šå°†å­˜æ´»çš„å¯¹è±¡å‹ç¼©åˆ°å†…å­˜çš„ä¸€ç«¯ï¼Œè®©å®ƒä»¬ç´§å‡‘çš„æ’åˆ—åœ¨ä¸€èµ·ï¼Œç„¶åå¯¹è¾¹ç•Œä»¥å¤–çš„ç©ºé—´è¿›è¡Œå›æ”¶ï¼Œå›æ”¶åï¼Œå·²ç”¨å’Œæœªç”¨çš„å†…å­˜å„è‡ªåœ¨ä¸€è¾¹ã€‚å¦‚ä¸‹å›¾ï¼Œæ ‡è®°å‹ç¼©ç®—æ³•è§£å†³äº†å†…å­˜ç¢ç‰‡é—®é¢˜å’Œå›æ”¶æ•ˆç‡ä½çš„é—®é¢˜ã€‚ ç¬¬å…­ç§æ˜¯åˆ†ä»£æ”¶é›†ã€‚åˆ†ä»£æ”¶é›†æ˜¯ä¸€ç§æ€è·¯ï¼Œç ”ç©¶å‘ç°ï¼Œç¨‹åºä¸­å¤§éƒ¨åˆ†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸéƒ½å¾ˆçŸ­ï¼Œæ‰€ä»¥æ ¹æ®å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„é•¿çŸ­ï¼Œä½¿ç”¨ä¸åŒçš„åƒåœ¾å›æ”¶ç®—æ³•ã€‚ç”Ÿå‘½å‘¨æœŸæ¯”è¾ƒé•¿çš„å«åšè€å¹´ä»£ï¼Œé€šå¸¸ä½¿ç”¨æ ‡è®°-å‹ç¼©ç®—æ³•ï¼Œç”Ÿå‘½å‘¨æœŸæ¯”è¾ƒçŸ­çš„å«åšæ–°ç”Ÿä»£ï¼Œé€šå¸¸ä½¿ç”¨å¤åˆ¶ç®—æ³•ã€‚ æœ¬èŠ‚ä¸»è¦å‚è€ƒï¼šç®€ä¹¦ï¼Œé¡¾æ—æµ·ï¼Œåƒåœ¾å›æ”¶ç®—æ³•æœ‰å“ªäº› ","date":"2020-07-30","objectID":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/:3:1","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 7-è°ƒåº¦å™¨ä¸åƒåœ¾å›æ”¶","uri":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.2 Goçš„åƒåœ¾å›æ”¶ Go çš„åƒåœ¾å›æ”¶ç»å†äº†ä¸€ä¸ªæ¯”è¾ƒé•¿çš„æ¼”å˜è¿‡ç¨‹ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ The Journey of Goâ€™s Garbage Collector è¿™ç¯‡æ–‡ç« ã€‚ ç›®å‰ Go ä½¿ç”¨çš„æ˜¯ä¸‰è‰²æ ‡è®°æ³•ã€‚ä¸‰è‰²æ ‡è®°æ³•æ˜¯æ ‡è®°-å›æ”¶ç®—æ³•çš„ä¸€ç§æ”¹è¿›ï¼Œå®ƒå°†æ‰€æœ‰çš„å¯¹è±¡ç”¨ç™½è‰²ã€ç°è‰²ã€é»‘è‰²ä¸‰ç§é¢œè‰²è¡¨ç¤ºï¼ŒåŸºæœ¬æ­¥éª¤å¦‚ä¸‹ å¼€å§‹æ—¶å°†æ‰€æœ‰å¯¹è±¡æ ‡è®°ä¸ºç™½è‰²ï¼› GC ä»æ ¹ç»“ç‚¹å¼€å§‹æ‰«æï¼Œä¸‹å›¾ä¸­ï¼ŒA å’Œ F æ˜¯æ ¹ç»“ç‚¹ï¼Œæ‰€ä»¥å°†å®ƒä»¬æ ‡è®°ä¸ºç°è‰²ï¼ˆæ³¨æ„è¿™ä¸€æ­¥æ ‡è®°ä¸ºç°è‰²çš„æ˜¯æ ¹ç»“ç‚¹é›†åˆçš„æ‰€æœ‰å¯¹è±¡ï¼‰ éå†ç°è‰²èŠ‚ç‚¹ï¼Œå°†ç°è‰²èŠ‚ç‚¹æ‰€å¼•ç”¨çš„èŠ‚ç‚¹ä¹Ÿæ ‡è®°ä¸ºç°è‰²ï¼Œè¿™é‡Œ A å¼•ç”¨äº† Bã€Cã€Dï¼ŒF æ²¡æœ‰å¼•ç”¨ï¼Œç„¶åå°†åˆ†æè¿‡çš„ç°è‰²èŠ‚ç‚¹æ ‡è®°ä¸ºé»‘è‰²ï¼Œå¦‚ä¸‹å›¾ å¾ªç¯éå†ç°è‰²èŠ‚ç‚¹ï¼Œç›´åˆ°ç°è‰²èŠ‚ç‚¹çš„ä¸ªæ•°ä¸º 0ï¼Œä¸‹å›¾ä¸­ï¼ŒBã€Cã€Déƒ½æ²¡æœ‰å¼•ç”¨çš„ç™½è‰²èŠ‚ç‚¹ï¼Œæ‰€ä»¥è¿™ä¸€è½®éƒ½æ ‡è®°ä¸ºäº†é»‘è‰² æ­¤æ—¶å¯¹ç™½è‰²èŠ‚ç‚¹å¯¹åº”çš„å†…å­˜ç©ºé—´è¿›è¡Œåƒåœ¾å›æ”¶ æœ€åï¼ŒGC å°†é»‘è‰²èŠ‚ç‚¹å†æ¬¡é‡ç½®ä¸ºç™½è‰²ï¼Œä¾›ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶ä½¿ç”¨ã€‚ é™¤äº†ä¸‰è‰²æ ‡è®°çš„ä¸»è¿‡ç¨‹å¤–ï¼Œè¿˜éœ€è¦å†™å±éšœï¼ˆWrite Barrierï¼‰çš„é…åˆã€‚ç”±äºä¸‰è‰²æ ‡è®°æ˜¯å¯å¹¶å‘æ‰§è¡Œçš„ï¼Œè¿è¡Œè¿‡ç¨‹ä¸­å°±å¯èƒ½å‡ºç°æ–°åˆ†é…çš„å¯¹è±¡ï¼Œå¯¹äºè¿™äº›å¯¹è±¡å¦‚ä½•å¤„ç†å°±éœ€è¦å†™å±éšœå‚ä¸ã€‚å†™å±éšœç±»ä¼¼äºå†™é”ï¼Œä¸»è¦ç”¨äºä¿è¯å¹¶å‘çš„ä¸€è‡´æ€§ã€‚å†™å±éšœåœ¨æ ‡è®°å¼€å§‹æ—¶æ‰“å¼€ï¼Œåœ¨æ ‡è®°ç»“æŸåå…³é—­ã€‚ï¼ˆéœ€è¦è¿›ä¸€æ­¥ç†è§£ï¼‰ å¦å¤–ä¸€ä¸ªæ¦‚å¿µæ˜¯ STWï¼ˆStop the worldï¼‰ï¼Œè¿™æ˜¯æ ‡è®°é˜¶æ®µäº§ç”Ÿçš„ä¸€ç§è¡Œä¸ºï¼Œæ„æ€æ˜¯åœæ­¢æ‰€æœ‰çš„ Goroutineã€‚ ","date":"2020-07-30","objectID":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/:3:2","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 7-è°ƒåº¦å™¨ä¸åƒåœ¾å›æ”¶","uri":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.3 å…¶å®ƒ æœ‰ GC ä¸æ„å‘³ç€é«˜æ•æ— å¿§ï¼Œä¹Ÿå¯èƒ½å‘ç”Ÿå†…å­˜æ³„æ¼ï¼Œæ‰€ä»¥è¦å…»æˆä¸€äº›è‰¯å¥½çš„ä¹ æƒ¯ï¼Œæ¯”å¦‚ä¸ä½¿ç”¨çš„æŒ‡é’ˆç½®ä¸º Nilã€‚ runtimeåŒ…æœ‰ä¸¤ä¸ªå…³äºåƒåœ¾å›æ”¶çš„ API runtime.GCï¼šæ‰‹åŠ¨è§¦å‘ GC runtime.ReadMemStatsï¼šè¯»å–å†…å­˜ç›¸å…³çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…å«éƒ¨åˆ† GC ç›¸å…³çš„ç»Ÿè®¡ä¿¡æ¯ è‡ªåŠ¨åƒåœ¾å›æ”¶è§¦å‘çš„æ¡ä»¶æœ‰ä¸¤ä¸ªï¼š è¶…è¿‡å†…å­˜å¤§å°é˜ˆå€¼ è¾¾åˆ°å®šæ—¶æ—¶é—´ï¼ˆé»˜è®¤2minè§¦å‘ä¸€æ¬¡ï¼‰ å¦‚æœæƒ³çŸ¥é“å½“å‰çš„å†…å­˜çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨ // fmt.Printf(\"%d\\n\", runtime.MemStats.Alloc/1024) // æ­¤å¤„ä»£ç åœ¨ Go 1.5.1ä¸‹ä¸å†æœ‰æ•ˆï¼Œæ›´æ­£ä¸º var m runtime.MemStats runtime.ReadMemStats(\u0026m) fmt.Printf(\"%d Kb\\n\", m.Alloc / 1024) ä¸Šé¢çš„ç¨‹åºä¼šç»™å‡ºå·²åˆ†é…å†…å­˜çš„æ€»é‡ï¼Œå•ä½æ˜¯ Kbã€‚è¿›ä¸€æ­¥çš„æµ‹é‡å‚è€ƒ package runtime åƒåœ¾å›æ”¶å‚è€ƒï¼š [1] ç®€ä¹¦ï¼ŒGoåƒåœ¾å›æ”¶ä¹‹ä¸‰è‰²æ ‡è®°ç®—æ³• [2] åšå®¢å›­ï¼Œææ‡‚Goåƒåœ¾å›æ”¶ [3] çŸ¥ä¹ä¸“æ ï¼Œå¼ ä¸‰æ¯›ï¼ŒGoåƒåœ¾å›æ”¶ç³»åˆ— ","date":"2020-07-30","objectID":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/:3:3","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 7-è°ƒåº¦å™¨ä¸åƒåœ¾å›æ”¶","uri":"/2020/golang-deep-learning-7-scheduler-and-garbage-collection/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"pprof ç”¨æ¥åš Go ç¨‹åºçš„æ€§èƒ½ç›‘æ§ï¼Œè®©æˆ‘ä»¬çŸ¥é“åœ¨ä»€ä¹ˆåœ°æ–¹è€—è´¹äº†å¤šå°‘ CPUã€memoryã€‚ pprof å…³æ³¨çš„æ–¹é¢æœ‰ï¼š CPU profileï¼šæŠ¥å‘Šç¨‹åºçš„ CPU ä½¿ç”¨æƒ…å†µï¼ŒæŒ‰ç…§ä¸€å®šé¢‘ç‡å»é‡‡é›†åº”ç”¨ç¨‹åºåœ¨ CPU å’Œå¯„å­˜å™¨ä¸Šé¢çš„æ•°æ® Memory Profileï¼ˆHeap Profileï¼‰ï¼šæŠ¥å‘Šç¨‹åºçš„å†…å­˜ä½¿ç”¨æƒ…å†µ Block Profilingï¼šæŠ¥å‘Š goroutines ä¸åœ¨è¿è¡ŒçŠ¶æ€çš„æƒ…å†µï¼Œå¯ä»¥ç”¨æ¥åˆ†æå’ŒæŸ¥æ‰¾æ­»é”ç­‰æ€§èƒ½ç“¶é¢ˆ Goroutine Profilingï¼šæŠ¥å‘Š goroutines çš„ä½¿ç”¨æƒ…å†µï¼Œæœ‰å“ªäº› goroutineï¼Œå®ƒä»¬çš„è°ƒç”¨å…³ç³»æ˜¯æ€æ ·çš„ ","date":"2020-07-27","objectID":"/2020/golang-deep-learning-6-performance-analysis-pprof/:0:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 6-ä½¿ç”¨pprofè¿›è¡Œæ€§èƒ½åˆ†æ","uri":"/2020/golang-deep-learning-6-performance-analysis-pprof/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. å¼•å…¥ pprof å¯ä»¥ä»ä»¥ä¸‹ä¸¤ä¸ªåŒ…ä¸­å¼•å…¥ï¼š import \"net/http/pprof\" import \"runtime/pprof\" å…¶ä¸­ net/http/pprof åº•å±‚ä½¿ç”¨ runtime/pprof åŒ…ï¼Œåªæ˜¯è¿›è¡Œäº†ä¸€ä¸‹å°è£…ï¼Œå¹¶åœ¨ http ç«¯å£ä¸Šæš´éœ²å‡ºæ¥ã€‚ å¦‚æœæˆ‘ä»¬çš„æœåŠ¡æ˜¯ä¸€ç›´è¿è¡Œçš„ï¼Œå¦‚ web åº”ç”¨ï¼Œé€šè¿‡ç®€å•çš„å¯¼å…¥ import _ \"net/http/pprof\"ï¼Œå°±å¯ä»¥åœ¨è¿è¡Œ web åº”ç”¨ååœ¨æµè§ˆå™¨ http://localhost:port/debug/pprof ç›´æ¥çœ‹åˆ°å½“å‰ web æœåŠ¡çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬ CPU å ç”¨æƒ…å†µå’Œå†…å­˜ä½¿ç”¨æƒ…å†µç­‰ã€‚ å¦‚æœæˆ‘ä»¬çš„ç¨‹åºä¸æ˜¯ web åº”ç”¨ï¼Œè€Œæ˜¯ä¸€ä¸ªæœåŠ¡è¿›ç¨‹ï¼Œé‚£ä¹ˆå¯ä»¥å¯¼å…¥ net/http/pprof åŒ…ï¼Œç„¶åä¸»åŠ¨å¼€å¯ä¸€ä¸ª Goroutine åœ¨ç«¯å£è¿›è¡Œç›‘å¬ go func() { log.Println(http.ListenAndServe(\"localhost:6060\", nil)) }() å¦‚æœæˆ‘ä»¬çš„ç¨‹åºåªæ˜¯ç®€å•çš„ Go ç¨‹åºï¼Œé‚£ä¹ˆåªèƒ½ä½¿ç”¨ runtime/pprof åŒ…ï¼Œå…·ä½“åšæ³•æ˜¯åœ¨ä»£ç ä¸­åŠ å…¥ä¸‹é¢è¿™æ®µç¨‹åºï¼Œç„¶ååœ¨è¿è¡Œæ—¶ï¼ˆgo run æˆ– go buildç­‰å‘½ä»¤ï¼‰åŠ å…¥ â€“cpuprofile å‚æ•°ï¼Œæ¯”å¦‚ go run demo.go --cpuprofile=demo.prof var cpuprofile = flag.String(\"cpuprofile\", \"\", \"write cpu profile to file\") func main() { flag.Parse() if *cpuprofile != \"\" { f, err := os.Create(*cpuprofile) if err != nil { log.Fatal(err) } pprof.StartCPUProfile(f) defer pprof.StopCPUProfile() } ... å‘½ä»¤æ‰§è¡Œå®Œåå½“å‰ç›®å½•ä¼šç”Ÿæˆ demo.prof æ–‡ä»¶ï¼Œå…¶ä¸­è®°å½•äº† CPU è¿è¡Œçš„ä¿¡æ¯ï¼Œä¸‹ä¸€æ­¥å°±å¯ä»¥åˆ©ç”¨è¯¥æ–‡ä»¶æŸ¥çœ‹ç›¸å…³çš„ä¿¡æ¯ï¼Œä½¿ç”¨ go tool pprof å‘½ä»¤æ¥æ‰§è¡Œï¼Œå¦‚æœè¦è¿›è¡Œå¯è§†åŒ–ï¼Œéœ€è¦å®‰è£… graphviz win10 ä¸‹å¯ä»¥ä½¿ç”¨ chocolatye æˆ– winget å®‰è£…ï¼Œå¦‚ä¸‹ \u003e choco install graphviz # æˆ– \u003e winget install graphviz ","date":"2020-07-27","objectID":"/2020/golang-deep-learning-6-performance-analysis-pprof/:1:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 6-ä½¿ç”¨pprofè¿›è¡Œæ€§èƒ½åˆ†æ","uri":"/2020/golang-deep-learning-6-performance-analysis-pprof/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. åˆ†ææ™®é€šç¨‹åº ä¸»è¦å‚è€ƒçš„æ–‡ç« æ˜¯ Go Post ä¸­çš„ Profiling Go Programs æµ‹è¯•ä»£ç æ¥è‡ªäº https://github.com/rsc/benchgraffiti/tree/master/havlak æˆ‘ä»¬ä½¿ç”¨ go mod å»ºç«‹äº†ä¸€ä¸ªæµ‹è¯•é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨æµ‹è¯•ä»£ç ä¸­çš„ havlak1.go æ–‡ä»¶ï¼Œå°†è¯¥æ–‡ä»¶å¤åˆ¶åˆ°æµ‹è¯•é¡¹ç›®æ ¹ç›®å½•ã€‚ç”±äºå…¶ä¸­å·²ç»å¼•å…¥äº† runtime/pprof åŒ…å¹¶åŒ…å«äº†å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬ä¸éœ€è¦åšä¿®æ”¹ï¼Œæ‰§è¡Œæ‰§è¡Œ var cpuprofile = flag.String(\"cpuprofile\", \"\", \"write cpu profile to file\") func main() { flag.Parse() if *cpuprofile != \"\" { f, err := os.Create(*cpuprofile) if err != nil { log.Fatal(err) } pprof.StartCPUProfile(f) defer pprof.StopCPUProfile() } ... æ‰§è¡Œæ—¶åŠ å…¥ â€“cpuprofile=havlak1.prof å‚æ•° $ go build havlak1.go $ ./havlak1 --cpuprofile=havlak1.prof # of loops: 76000 (including 1 artificial root node) $ ls go.mod havlak1.exe havlak1.go havlak1.prof ç„¶åè¿è¡Œ go tool pprof å‘½ä»¤ä¸ profile äº¤äº’ $ go tool pprof havlak1.exe havlak1.prof File: havlak1.exe Type: cpu Time: Jul 25, 2020 at 7:23pm (CST) Duration: 21.52s, Total samples = 34.77s (161.56%) Entering interactive mode (type \"help\" for commands, \"o\" for options) (pprof) æœ€ä¸»è¦çš„å‘½ä»¤æ˜¯ topN ï¼Œç”¨æ¥è¾“å‡ºæœ€è€— CPU çš„å‰Nä¸ªè°ƒç”¨ (pprof) top10 Showing nodes accounting for 21340ms, 61.37% of 34770ms total Dropped 168 nodes (cum \u003c= 173.85ms) Showing top 10 nodes out of 89 flat flat% sum% cum cum% 5340ms 15.36% 15.36% 12320ms 35.43% runtime.scanobject 3190ms 9.17% 24.53% 3650ms 10.50% runtime.mapaccess1_fast64 2650ms 7.62% 32.15% 16670ms 47.94% main.FindLoops 2240ms 6.44% 38.60% 3320ms 9.55% runtime.findObject 1800ms 5.18% 43.77% 2920ms 8.40% runtime.greyobject 1490ms 4.29% 48.06% 6540ms 18.81% runtime.mallocgc 1480ms 4.26% 52.32% 4230ms 12.17% main.DFS 1230ms 3.54% 55.85% 3510ms 10.09% runtime.mapassign_fast64ptr 1000ms 2.88% 58.73% 1450ms 4.17% runtime.heapBitsSetType 920ms 2.65% 61.37% 1050ms 3.02% runtime.spanOf (inline) (pprof) flatã€flat% è¡¨ç¤ºå‡½æ•°åœ¨ CPUä¸Šè¿è¡Œçš„æ—¶é—´åŠç™¾åˆ†æ¯” sum% è¡¨ç¤ºåˆ—è¡¨ä¸­è‡ªå·±åŒ…æ‹¬å‰é¢çš„å‡½æ•°CPUä½¿ç”¨æ¯”ä¾‹çš„ç´¯ç§¯ï¼Œæ¯”å¦‚ç¬¬ä¸‰è¡Œ main.FindLoops æ˜¾ç¤ºçš„ 32.15% å…¶å®å°±ç­‰äºå‰é¢ä¸‰ä¸ªè°ƒç”¨çš„æ¯”ä¾‹ä¹‹å’Œ 15.36% + 9.17% + 7.62% = 32.15% cumã€cum% è¡¨ç¤ºè¯¥å‡½æ•°åŠå…¶å­å‡½æ•°è¿è¡Œæ‰€å çš„æ—¶é—´æ€»å’ŒåŠæ¯”ä¾‹æ€»å’Œï¼Œåº”è¯¥å¤§äºç­‰äºè‡ªå·±æ‰§è¡Œæ‰€å çš„æ—¶é—´å’Œæ¯”ä¾‹ï¼Œä¹Ÿå°±æ˜¯æœ€å‰é¢ä¸¤åˆ— æ·»åŠ  -cum å‚æ•°å¯ä»¥æŒ‰ç…§ cum æ¥æ’åº (pprof) top5 -cum Showing nodes accounting for 2.67s, 7.68% of 34.77s total Dropped 168 nodes (cum \u003c= 0.17s) Showing top 5 nodes out of 89 flat flat% sum% cum cum% 0 0% 0% 16.79s 48.29% main.main 0 0% 0% 16.79s 48.29% runtime.main 0 0% 0% 16.67s 47.94% main.FindHavlakLoops (inline) 2.65s 7.62% 7.62% 16.67s 47.94% main.FindLoops 0.02s 0.058% 7.68% 15.16s 43.60% runtime.systemstack (pprof) å®é™…ä¸Š main.FindLoops å’Œ main.main çš„æ€»å’Œåº”å½“ä¸º 100%ï¼Œä½†æ˜¯ pprof ä¸ä¼šç»Ÿè®¡æ‰€æœ‰çš„è°ƒç”¨ï¼Œé€’å½’è°ƒç”¨å±‚æ¬¡è¿‡æ·±çš„ä¸€äº›æ‰§è¡Œä¼šè¢«å¿½ç•¥ã€‚ å¦å¤–ï¼Œä½¿ç”¨ web å‘½ä»¤å¯ä»¥ç”Ÿæˆè°ƒç”¨å…³ç³»å›¾ï¼Œæ˜¯ä¸€ä¸ª svg æ–‡ä»¶ï¼Œå¯è§†åŒ–çš„æ–¹å¼å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„ç†è§£ï¼Œè¯¥å‘½ä»¤éœ€è¦ graphviz å·¥å…·çš„æ”¯æŒï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå‰é¢è¦å®‰è£…å®ƒ (pprof) web æ‰§è¡Œè¯¥å‘½ä»¤åå›¾ç‰‡ä¼šè‡ªåŠ¨æ‰“å¼€ å›¾ç‰‡ä¸­æ¯ä¸ªæ–¹æ¡†éƒ½ä»£è¡¨ä¸€ä¸ªå‡½æ•°ï¼Œæ–¹æ¡†çš„å¤§å°æ ¹æ® CPU å ç”¨æ¯”ä¾‹ç¡®å®šï¼Œç®­å¤´è¡¨ç¤ºè°ƒç”¨å…³ç³»ï¼Œä»ä¸Šåˆ°ä¸‹è°ƒç”¨å±‚æ¬¡é€æ¸åŠ æ·±ï¼Œè¡¨ç¤ºè°ƒç”¨çš„çº¿æ¡ä¸Šå‡ºç°çš„æ•°å­—è¡¨ç¤ºè°ƒç”¨æ¬¡æ•°ï¼Œé€’å½’è°ƒç”¨è‡ªèº«ä¼šæœ‰ä¸€ä¸ªè‡ªå·±æŒ‡å‘è‡ªå·±çš„ç®­å¤´ã€‚ ä»å›¾ä¸­çœ‹åˆ° mapaccess å ç”¨æ¯”ä¾‹è¾ƒå¤§ï¼Œæˆ‘ä»¬å¯ä»¥åªæ˜¾ç¤ºä¸å®ƒç›¸å…³çš„è°ƒç”¨ï¼Œä»è€Œä½¿å›¾ç‰‡é€»è¾‘æ›´æ¸…æ™°ã€‚å¯ä»¥çœ‹åˆ° mapaccess1 ä¸»è¦ç”± main.FindLoops å’Œ main.DFS è°ƒç”¨ã€‚ æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡æŒ‡å®šå‡½æ•°è¿›å…¥æŸä¸ªå‡½æ•°çš„ç»†èŠ‚ï¼ŒDFSé€»è¾‘æ¯”è¾ƒç®€å•ï¼Œä»¥å®ƒä¸ºä¾‹ (pprof) web DFS ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤ (pprof) list DFS Total: 34.77s ROUTINE ======================== main.DFS in F:\\Go-web\\havlak1.go 1.48s 8.38s (flat, cum) 24.10% of Total . . 233: return false . . 234:} . . 235: . . 236:// DFS - Depth-First-Search and node numbering. . . 237:// 30ms 30ms 238:func DFS(currentNode *BasicBlock, nodes []*UnionFindNode, number map[*BasicBlock]int, last []int, current int) int { 20ms 240ms 239: nodes[current].Init(currentNode, current) 20ms 340ms 240: number[currentNode] = current . . 241: . . 242: lastid := current 1.02s 1.02s 243: for _, target := range currentNode.OutEdges { 190ms 1.73s 244: if number[target] == unvisited { 80ms 4.23s 245: lastid = DFS(target, nodes, number, last, lastid+1) . . 246: } . . 247: } 80ms 750ms 248: last[number[currentNode]] = lastid 40ms 40ms 249: return lastid . . 250:} . . 251: . . 252:// FindLoops . . 253:// . . 254:// Find loops and build loop forest using Havlak's algorithm, which (pprof) å‰ä¸¤åˆ—åˆ†åˆ«æ˜¯ flat å’Œ cumï¼Œä¹Ÿå°±æ˜¯è¯¥è¡Œæ‰§è¡Œå ç”¨çš„æ—¶é—´å’Œè¯¥è¡ŒåŠè¯¥è¡Œè°ƒç”¨çš„å‡½æ•°æ‰§è¡Œå ç”¨çš„æ€»æ—¶é—´ï¼Œç¬¬ä¸‰åˆ—æ˜¯æºç è¡Œæ•°ã€‚æ‰€ä»¥æˆ‘ä»¬çœ‹åˆ°ç¬¬ 245 è¡Œç”±äºå‡ºç°äº† DFS è¿™ä¸ªé€’å½’å‡½æ•°ï¼Œæ€»å ç”¨æ—¶é—´ä¸º 4.23sï¼Œæ˜¯æœ€å¤šçš„ã€‚é™¤äº†è¯¥è¡Œä¹‹å¤–ï¼Œå ç”¨æœ€å¤šçš„å°±æ˜¯ç¬¬239ã€240ã€248ä¸‰è¡Œï¼Œä¸»è¦åŸå› æ˜¯æ˜ å°„çš„ä½¿ç”¨å ç”¨äº†å¤§é‡æ—¶é—´ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä½¿ç”¨ä¸­åº”å°½å¯èƒ½ä½¿ç”¨æ•°ç»„å’Œåˆ‡ç‰‡ï¼Œè€Œå‡å°‘ä½¿ç”¨æ˜ å°„ã€‚ ","date":"2020-07-27","objectID":"/2020/golang-deep-learning-6-performance-analysis-pprof/:2:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 6-ä½¿ç”¨pprofè¿›è¡Œæ€§èƒ½åˆ†æ","uri":"/2020/golang-deep-learning-6-performance-analysis-pprof/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. æ—¶é—´ä¸å­˜å‚¨ä¼˜åŒ– å°† DFS å‡½æ•°å‚æ•°ä¸­çš„ number ç”±æ˜ å°„æ›´æ”¹ä¸ºåˆ‡ç‰‡ï¼Œå¯ä»¥å°†è¿è¡Œæ—¶é—´å‡å°‘ä¸¤å€ï¼Œæˆ‘ä»¬ä½¿ç”¨æµ‹è¯•æ–‡ä»¶åˆ—è¡¨ä¸­çš„ havlak2.goï¼Œæ‰§è¡ŒåŒæ ·çš„æµ‹è¯•è¿‡ç¨‹å¯ä»¥éªŒè¯è¿™ä¸€ç‚¹ï¼ŒåŸå…ˆçš„ DFS cum æ˜¯ 4230msï¼Œç°åœ¨å·²ç»åªæœ‰ 830msã€‚ $ go build havlak2.go $ ./havlak2 --cpuprofile=havlak2.prof # of loops: 76000 (including 1 artificial root node) $ go tool pprof havlak2.exe havlak2.prof File: havlak2.exe Type: cpu Time: Jul 25, 2020 at 8:51pm (CST) Duration: 12.36s, Total samples = 22.91s (185.34%) Entering interactive mode (type \"help\" for commands, \"o\" for options) (pprof) top10 Showing nodes accounting for 14360ms, 62.68% of 22910ms total Dropped 132 nodes (cum \u003c= 114.55ms) Showing top 10 nodes out of 85 flat flat% sum% cum cum% 4130ms 18.03% 18.03% 9810ms 42.82% runtime.scanobject 1850ms 8.08% 26.10% 2570ms 11.22% runtime.findObject 1800ms 7.86% 33.96% 11070ms 48.32% main.FindLoops 1530ms 6.68% 40.64% 2510ms 10.96% runtime.greyobject 1450ms 6.33% 46.97% 5940ms 25.93% runtime.mallocgc 950ms 4.15% 51.11% 1290ms 5.63% runtime.heapBitsSetType 680ms 2.97% 54.08% 830ms 3.62% main.DFS 670ms 2.92% 57.01% 670ms 2.92% runtime.memclrNoHeapPointers 670ms 2.92% 59.93% 670ms 2.92% runtime.nextFreeFast 630ms 2.75% 62.68% 630ms 2.75% runtime.arenaIndex (partial-inline) é™„ï¼š diff between havlak1 and havlak2 ç°åœ¨ï¼ŒDFS ä¸å†æ˜¯æ—¶é—´ç“¶é¢ˆï¼Œå–è€Œä»£ä¹‹çš„æ˜¯å†…å­˜åˆ†é…ä¸åƒåœ¾å›æ”¶ï¼Œä¸Šé¢çš„ç»“æœä¸­ runtime.mallocgc å äº†ä¸€å¤§éƒ¨åˆ†ã€‚ä¸ºäº†æ‰¾å‡ºä¸ºä»€ä¹ˆåƒåœ¾å›æ”¶æ—¶é—´å ç”¨è¿™ä¹ˆå¤šï¼Œæˆ‘ä»¬æ¥åˆ†æå†…å­˜å ç”¨ï¼Œè¿™æ—¶å€™ä½¿ç”¨ memprofile ï¼Œä¸å†æ˜¯ cpuprofileã€‚é¦–å…ˆåœ¨ä¸»å‡½æ•°ä¸­æ›¿æ¢å¦‚ä¸‹éƒ¨åˆ† var memprofile = flag.String(\"memprofile\", \"\", \"write memory profile to this file\") ... FindHavlakLoops(cfgraph, lsgraph) if *memprofile != \"\" { f, err := os.Create(*memprofile) if err != nil { log.Fatal(err) } pprof.WriteHeapProfile(f) f.Close() return } ç„¶åä½¿ç”¨ â€“memprofile æ ‡å¿—ç¼–è¯‘æºç ï¼Œæ­¤æ—¶ä½¿ç”¨æµ‹è¯•æ–‡ä»¶åˆ—è¡¨ä¸­çš„ havlak3 é™„ï¼šdiff from havlak2 $ go build havlak3.go $ ./havlak3 --memprofile=havlak3.mprof $ go tool pprof havlak3.exe havlak3.mprof $ go tool pprof havlak3.exe havlak3.mprof File: havlak3.exe Type: inuse_space Time: Jul 25, 2020 at 9:07pm (CST) Entering interactive mode (type \"help\" for commands, \"o\" for options) (pprof) top5 Showing nodes accounting for 53.39MB, 100% of 53.39MB total Showing top 5 nodes out of 13 flat flat% sum% cum cum% 33.10MB 62.00% 62.00% 33.10MB 62.00% main.FindLoops 11.50MB 21.54% 83.54% 11.50MB 21.54% main.NewBasicBlock (inline) 4.50MB 8.43% 91.96% 4.50MB 8.43% main.(*BasicBlock).AddInEdge 2.29MB 4.29% 96.25% 13.79MB 25.83% main.(*CFG).CreateNode 2MB 3.75% 100% 2MB 3.75% main.(*BasicBlock).AddOutEdge (pprof) flat å’Œ cum å·²ç»ä»æ—¶é—´å ç”¨å˜æˆäº†å­˜å‚¨å ç”¨ï¼Œå¯ä»¥çœ‹åˆ° main.FindLoops å ç”¨æœ€å¤šï¼Œè¾¾åˆ°äº† 62.00%ï¼Œä½¿ç”¨ list å‘½ä»¤æŸ¥çœ‹å…·ä½“æƒ…å†µ (pprof) list FindLoops Total: 53.39MB ROUTINE ======================== main.FindLoops in F:\\Go-web\\havlak3.go 33.10MB 33.10MB (flat, cum) 62.00% of Total . . 261: return . . 262: } . . 263: . . 264: size := cfgraph.NumNodes() . . 265: 1.97MB 1.97MB 266: nonBackPreds := make([]map[int]bool, size) 5.77MB 5.77MB 267: backPreds := make([][]int, size) . . 268: 1.97MB 1.97MB 269: number := make([]int, size) 1.97MB 1.97MB 270: header := make([]int, size, size) 1.97MB 1.97MB 271: types := make([]int, size, size) 1.97MB 1.97MB 272: last := make([]int, size, size) 1.97MB 1.97MB 273: nodes := make([]*UnionFindNode, size, size) . . 274: . . 275: for i := 0; i \u003c size; i++ { 11MB 11MB 276: nodes[i] = new(UnionFindNode) . . 277: } . . 278: . . 279: // Step a: . . 280: // - initialize all nodes as unvisited. . . 281: // - depth-first traversal and numbering. . . 282: // - unreached BB's are marked as dead. . . 283: // . . 284: for i, bb := range cfgraph.Blocks { . . 285: number[bb.Name] = unvisited 4.50MB 4.50MB 286: nonBackPreds[i] = make(map[int]bool) . . 287: } . . 288: . . 289: DFS(cfgraph.Start, nodes, number, last, 0) . . 290: . . 291: // Step b: (pprof) ç“¶é¢ˆä¾ç„¶åœ¨äº UnionFindNode ç»“æ„ä½“çš„åˆå§‹åŒ–å’Œæ˜ å°„ã€‚ å¦å¤–ï¼Œå¦‚æœæˆ‘ä»¬æ‰§è¡Œ go tool pprof åŠ å…¥ --inuse_objects ï¼Œçœ‹åˆ°çš„ä¸æ˜¯å†…å­˜ä½¿ç”¨è€Œæ˜¯è°ƒç”¨è®¡æ•° $ go tool pprof --inuse_objects havlak3.exe havlak3.mprof File: havlak3.exe Type: inuse_objects Time: Jul 25, 2020 at 9:07pm (CST) Entering interactive mode (type \"help\" for commands, \"o\" for options) (pprof) list FindLoops Total: 1171490 ROUTINE ======================== main.FindLoops","date":"2020-07-27","objectID":"/2020/golang-deep-learning-6-performance-analysis-pprof/:3:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 6-ä½¿ç”¨pprofè¿›è¡Œæ€§èƒ½åˆ†æ","uri":"/2020/golang-deep-learning-6-performance-analysis-pprof/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. åˆ†æç½‘ç»œç¨‹åº å°±åƒæˆ‘ä»¬ä¸€å¼€å§‹è¯´çš„ï¼Œåˆ†æä¸€ä¸ªç½‘ç»œç¨‹åºæ›´åŠ çš„ç®€å•ï¼Œåªéœ€è¦å¯¼å…¥ net/http/pprof åŒ…å³å¯ï¼Œä¸éœ€è¦åœ¨ç¨‹åºä¸­ä½¿ç”¨ï¼Œåªéœ€è¦æ·»åŠ è¿™ä¸€æ¡å¯¼å…¥è¯­å¥ã€‚ import _ \"net/http/pprof\" å¯¼å…¥è¯¥åŒ…ä¼šæ·»åŠ ä¸€äº› /debug/pprof/ URL ä¸‹é¢çš„ä¸€äº›å¤„ç†å™¨å‡½æ•°ï¼Œä¹‹åç®€å•çš„è¿è¡Œ go tool pprof ç„¶åæ·»åŠ æœåŠ¡å™¨ URLå°±ä¼šå®æ—¶çš„æ£€æŸ¥é…ç½®æ–‡ä»¶ã€‚ ä»¥æˆ‘ä»¬ä¹‹å‰å†™çš„ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ä¸‹è½½åº”ç”¨ä¸ºä¾‹ï¼Œç«¯å£ä½¿ç”¨ 8090ï¼Œæ·»åŠ å¯¼å…¥è¯­å¥åï¼Œæ‰“å¼€æµè§ˆå™¨ http://localhost:8090/debug/pprof/ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ æˆ–è€…åœ¨å‘½ä»¤è¡Œä½¿ç”¨ go tool pprof å‘½ä»¤ go tool pprof http://localhost:8090/debug/pprof/profile # 30-second CPU profile go tool pprof http://localhost:8090/debug/pprof/heap # heap profile go tool pprof http://localhost:8090/debug/pprof/block # goroutine blocking profile è¿›å…¥ pprof å‘½ä»¤è¡Œç•Œé¢åå°±å’Œå‰é¢çš„ä½¿ç”¨æ²¡æœ‰åŒºåˆ«äº†ï¼Œè¿™å‡ ä¸ªæ–‡ä»¶ç®€å•ä»‹ç»å¦‚ä¸‹ /debug/pprof/profileï¼šè®¿é—®è¿™ä¸ªé“¾æ¥ä¼šè‡ªåŠ¨è¿›è¡Œ CPU profilingï¼ŒæŒç»­ 30sï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ä¾›ä¸‹è½½ /debug/pprof/heapï¼š Memory Profiling çš„è·¯å¾„ï¼Œè®¿é—®è¿™ä¸ªé“¾æ¥ä¼šå¾—åˆ°ä¸€ä¸ªå†…å­˜ Profiling ç»“æœçš„æ–‡ä»¶ /debug/pprof/blockï¼šblock Profiling çš„è·¯å¾„ æœ€åï¼Œä¸Šé¢çš„å¯¼å…¥å½¢å¼æ˜¯åŸºäºæˆ‘ä»¬ä½¿ç”¨é»˜è®¤çš„ http.DefaultServeMux çš„æƒ…å†µï¼Œå¦‚æœä½¿ç”¨äº†å…¶å®ƒçš„åŒ…ï¼Œæ¯”å¦‚ Muxï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ è·¯ç”±è§„åˆ™ r.HandleFunc(\"/debug/pprof/\", pprof.Index) r.HandleFunc(\"/debug/pprof/cmdline\", pprof.Cmdline) r.HandleFunc(\"/debug/pprof/profile\", pprof.Profile) r.HandleFunc(\"/debug/pprof/symbol\", pprof.Symbol) r.HandleFunc(\"/debug/pprof/trace\", pprof.Trace) ä¹‹åçš„ä½¿ç”¨å°±æ²¡æœ‰åŒºåˆ«äº†ã€‚ ","date":"2020-07-27","objectID":"/2020/golang-deep-learning-6-performance-analysis-pprof/:4:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 6-ä½¿ç”¨pprofè¿›è¡Œæ€§èƒ½åˆ†æ","uri":"/2020/golang-deep-learning-6-performance-analysis-pprof/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"åœ¨C/C++ä¸­ï¼Œä½¿ç”¨ GDB è°ƒè¯•ç¨‹åºï¼Œä½†åœ¨Goä¸­ï¼Œçœ‹è¿‡ç½‘ä¸Šçš„ä¸€äº›æ–‡ç« åï¼Œå‘ç° dlv æ˜¯ä¸ªæ›´å¥½çš„é€‰æ‹©ï¼Œæœ¬æ–‡è¿›è¡Œä»‹ç»ã€‚ å®é™…ä¸Šï¼Œdelve æ‰æ˜¯å…¨ç§°ï¼Œdlv åªæ˜¯å¯åŠ¨å‘½ä»¤ï¼Œå¦‚æœä½¿ç”¨ VScodeï¼Œé»˜è®¤ä½¿ç”¨çš„è°ƒè¯•å™¨å°±æ˜¯åŸºäº delve çš„ã€‚ ","date":"2020-07-26","objectID":"/2020/golang-deep-learning-5-debug-with-dlv/:0:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 5-ä½¿ç”¨dlvè°ƒè¯•ç¨‹åº","uri":"/2020/golang-deep-learning-5-debug-with-dlv/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. åŸºæœ¬å‘½ä»¤ ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£… go get github.com/go-delve/delve/cmd/dlv å®‰è£…åæ‰§è¡Œ dlv å‘½ä»¤æŸ¥çœ‹åŸºæœ¬ä¿¡æ¯ $ dlv Delve is a source level debugger for Go programs. Delve enables you to interact with your program by controlling the execution of the process, evaluating variables, and providing information of thread / goroutine state, CPU register state and more. The goal of this tool is to provide a simple yet powerful interface for debugging Go programs. Pass flags to the program you are debugging using `--`, for example: `dlv exec ./hello -- server --config conf/config.toml` Usage: dlv [command] Available Commands: attach Attach to running process and begin debugging. connect Connect to a headless debug server. core Examine a core dump. debug Compile and begin debugging main package in current directory, or the package specified. exec Execute a precompiled binary, and begin a debug session. help Help about any command run Deprecated command. Use 'debug' instead. test Compile test binary and begin debugging program. trace Compile and begin tracing program. version Prints version. Flags: --accept-multiclient Allows a headless server to accept multiple client connections. --api-version int Selects API version when headless. (default 1) --backend string Backend selection (see 'dlv help backend'). (default \"default\") --build-flags string Build flags, to be passed to the compiler. --check-go-version Checks that the version of Go in use is compatible with Delve. (default true) --headless Run debug server only, in headless mode. --init string Init file, executed by the terminal client. -l, --listen string Debugging server listen address. (default \"127.0.0.1:0\") --log Enable debugging server logging. --log-dest string Writes logs to the specified file or file descriptor (see 'dlv help log'). --log-output string Comma separated list of components that should produce debug output (see 'dlv help log') --only-same-user Only connections from the same user that started this instance of Delve are allowed to connect. (default true) --wd string Working directory for running the program. (default \".\") Additional help topics: dlv backend Help about the --backend flag. dlv log Help about logging flags. Use \"dlv [command] --help\" for more information about a command. è¿›å…¥è°ƒè¯•æ¨¡å¼æœ‰ä»¥ä¸‹å‡ ç§åŠæ³• dlv attach pidï¼šå¯¹æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ç›´æ¥è¿›è¡Œè°ƒè¯•ï¼ˆpid ä¸ºè¿›ç¨‹idï¼‰ï¼› dlv debugï¼šç¼–è¯‘æºæ–‡ä»¶å¹¶å¼€å§‹è°ƒè¯•ï¼Œè¿™é‡Œåº”å’Œ main å‡½æ•°ä½äºåŒä¸€ç›®å½•ï¼Œæˆ–è€…æŒ‡å®šå®Œæ•´çš„ main å‡½æ•°è·¯å¾„ dlv exec filenameï¼šä»äºŒè¿›åˆ¶æ–‡ä»¶å¯åŠ¨è°ƒè¯• æˆ‘ä»¬ä»¥ä¸‹é¢çš„ç¨‹åºä¸ºä¾‹è¿›è¡Œè¯´æ˜ï¼Œä½¿ç”¨ dlv debug è¿›å…¥è°ƒè¯• package main import \"fmt\" func main() { a := 10 fmt.Println(a) } è¿›å…¥è°ƒè¯•ï¼Œä½¿ç”¨ help å¯ä»¥æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤ $ dlv debug main.go Type 'help' for list of commands. (dlv) help The following commands are available: args ------------------------ Print function arguments. break (alias: b) ------------ Sets a breakpoint. breakpoints (alias: bp) ----- Print out info for active breakpoints. call ------------------------ Resumes process, injecting a function call (EXPERIMENTAL!!!) clear ----------------------- Deletes breakpoint. clearall -------------------- Deletes multiple breakpoints. condition (alias: cond) ----- Set breakpoint condition. config ---------------------- Changes configuration parameters. continue (alias: c) --------- Run until breakpoint or program termination. deferred -------------------- Executes command in the context of a deferred call. disassemble (alias: disass) - Disassembler. down ------------------------ Move the current frame down. edit (alias: ed) ------------ Open where you are in $DELVE_EDITOR or $EDITOR exit (alias: quit | q) ------ Exit the debugger. frame ----------------------- Set the current frame, or execute command on a different frame. funcs ----------------------- Print list of functions. goroutine (alias: gr) ------- Shows or changes current goroutine goroutines (alias: grs) ----- List program goroutines. help (alias: h) ------------- Prints the help message. libraries ------------------- List loaded dynamic libraries list (alias: ls | l) -------- Show source code. locals ---------------------- Print local variables. next (alias","date":"2020-07-26","objectID":"/2020/golang-deep-learning-5-debug-with-dlv/:1:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 5-ä½¿ç”¨dlvè°ƒè¯•ç¨‹åº","uri":"/2020/golang-deep-learning-5-debug-with-dlv/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. å‘½ä»¤ä½¿ç”¨ ä¸‹é¢é€šè¿‡å®è·µè¯´æ˜è¿™äº›ç®€å•å‘½ä»¤çš„ä½¿ç”¨ ","date":"2020-07-26","objectID":"/2020/golang-deep-learning-5-debug-with-dlv/:2:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 5-ä½¿ç”¨dlvè°ƒè¯•ç¨‹åº","uri":"/2020/golang-deep-learning-5-debug-with-dlv/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 æ–­ç‚¹è®¾ç½® (dlv) b main.go:6 Breakpoint 1 set at 0x4bd2f8 for main.main() F:/Gotest/main.go:6 ","date":"2020-07-26","objectID":"/2020/golang-deep-learning-5-debug-with-dlv/:2:1","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 5-ä½¿ç”¨dlvè°ƒè¯•ç¨‹åº","uri":"/2020/golang-deep-learning-5-debug-with-dlv/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 æ‰“å°æ–­ç‚¹ä¿¡æ¯ (dlv) bp Breakpoint runtime-fatal-throw at 0x4377e0 for runtime.fatalthrow() c:/go/src/runtime/panic.go:1162 (0) Breakpoint unrecovered-panic at 0x437860 for runtime.fatalpanic() c:/go/src/runtime/panic.go:1189 (0) print runtime.curg._panic.arg Breakpoint 1 at 0x4bd2f8 for main.main() F:/Gotest/main.go:6 (0) ","date":"2020-07-26","objectID":"/2020/golang-deep-learning-5-debug-with-dlv/:2:2","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 5-ä½¿ç”¨dlvè°ƒè¯•ç¨‹åº","uri":"/2020/golang-deep-learning-5-debug-with-dlv/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 è¿è¡Œç›´åˆ°æ–­ç‚¹å¤„ (dlv) c \u003e main.main() F:/Gotest/main.go:6 (hits goroutine(1):1 total:1) (PC: 0x4bd2f8) 1: package main 2: 3: import \"fmt\" 4: 5: func main() { =\u003e 6: a := 10 7: fmt.Println(a) 8: } ","date":"2020-07-26","objectID":"/2020/golang-deep-learning-5-debug-with-dlv/:2:3","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 5-ä½¿ç”¨dlvè°ƒè¯•ç¨‹åº","uri":"/2020/golang-deep-learning-5-debug-with-dlv/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.4 ä¸‹ä¸€æ­¥ (dlv) n \u003e main.main() F:/Gotest/main.go:7 (PC: 0x4bd301) 2: 3: import \"fmt\" 4: 5: func main() { 6: a := 10 =\u003e 7: fmt.Println(a) 8: } ","date":"2020-07-26","objectID":"/2020/golang-deep-learning-5-debug-with-dlv/:2:4","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 5-ä½¿ç”¨dlvè°ƒè¯•ç¨‹åº","uri":"/2020/golang-deep-learning-5-debug-with-dlv/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.5 æŸ¥çœ‹å±€éƒ¨å˜é‡ (dlv) locals a = 10 ","date":"2020-07-26","objectID":"/2020/golang-deep-learning-5-debug-with-dlv/:2:5","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 5-ä½¿ç”¨dlvè°ƒè¯•ç¨‹åº","uri":"/2020/golang-deep-learning-5-debug-with-dlv/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.6 æŸ¥çœ‹å½“å‰è°ƒç”¨æ ˆ (dlv) bt 0 0x00000000004bd301 in main.main at F:/Gotest/main.go:7 1 0x0000000000439cfa in runtime.main at c:/go/src/runtime/proc.go:203 2 0x00000000004643d1 in runtime.goexit at c:/go/src/runtime/asm_amd64.s:1373 ","date":"2020-07-26","objectID":"/2020/golang-deep-learning-5-debug-with-dlv/:2:6","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 5-ä½¿ç”¨dlvè°ƒè¯•ç¨‹åº","uri":"/2020/golang-deep-learning-5-debug-with-dlv/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.7 æ‰“å°æºä»£ç  (dlv) list \u003e main.main() F:/Gotest/main.go:7 (PC: 0x4bd301) 2: 3: import \"fmt\" 4: 5: func main() { 6: a := 10 =\u003e 7: fmt.Println(a) 8: } ","date":"2020-07-26","objectID":"/2020/golang-deep-learning-5-debug-with-dlv/:2:7","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 5-ä½¿ç”¨dlvè°ƒè¯•ç¨‹åº","uri":"/2020/golang-deep-learning-5-debug-with-dlv/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.8 è¿è¡Œåˆ°æ–­ç‚¹å¤„æ‰§è¡ŒæŸä¸ªå‘½ä»¤ 1 æ˜¯æ–­ç‚¹IDï¼Œp a ä»£è¡¨æŒ‡å®šåˆ°æ–­ç‚¹å¤„æ‰“å°å˜é‡ a çš„å€¼ (dlv) on 1 p a (dlv) c 10 Process 6540 has exited with status 0 ","date":"2020-07-26","objectID":"/2020/golang-deep-learning-5-debug-with-dlv/:2:8","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 5-ä½¿ç”¨dlvè°ƒè¯•ç¨‹åº","uri":"/2020/golang-deep-learning-5-debug-with-dlv/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. Goroutine è°ƒè¯• Go çš„ä¼˜åŠ¿åœ¨åç¨‹ï¼Œdlv ç›¸æ¯” GDB çš„ä¼˜ç‚¹ä¹Ÿåœ¨äºå¯¹åç¨‹è°ƒè¯•çš„æ”¯æŒï¼Œæˆ‘ä»¬ä»¥ä¸‹é¢çš„ç¨‹åºä¸ºä¾‹ï¼Œç»™å‡ºç¤ºä¾‹ package main import ( \"fmt\" \"time\" ) func main() { a := 10 go printA(a) time.Sleep(1e9) } func printA(a int) { fmt.Println(a) } è®¾ç½®æ–­ç‚¹å¹¶å¯åŠ¨è¿è¡Œ \u003e b main.go:12 Breakpoint 1 set at 0x4bd5be for main.main() F:/Gotest/main.go:12 (dlv) c \u003e main.main() F:/Gotest/main.go:12 (hits goroutine(1):1 total:1) (PC: 0x4bd5be) 7: 8: func main() { 9: a := 10 10: go printA(a) 11: =\u003e 12: time.Sleep(1e9) 13: } 14: 15: func printA(a int) { 16: fmt.Println(a) 17: } æŸ¥çœ‹å½“å‰å¯åŠ¨çš„åç¨‹ï¼Œå…¶ä¸­ Goroutine 1 æ˜¯ä¸»åç¨‹ï¼ŒGoroutine 6 æ˜¯è‡ªè¡Œå¯åŠ¨çš„å­åç¨‹ (dlv) goroutines * Goroutine 1 - User: F:/Gotest/main.go:12 main.main (0x4bd5be) (thread 11412) Goroutine 2 - User: c:/go/src/runtime/proc.go:305 runtime.gopark (0x43a092) Goroutine 3 - User: c:/go/src/runtime/proc.go:305 runtime.gopark (0x43a092) Goroutine 4 - User: c:/go/src/runtime/proc.go:305 runtime.gopark (0x43a092) Goroutine 5 - User: c:/go/src/runtime/proc.go:305 runtime.gopark (0x43a092) Goroutine 6 - User: F:/Gotest/main.go:15 main.printA (0x4bd5e0) [6 goroutines] æ‰“å°ä¸»åç¨‹å½“å‰çš„å˜é‡ (dlv) locals a = 10 å¦‚æœè¦æŸ¥çœ‹å­åç¨‹çš„æƒ…å†µï¼Œéœ€è¦å…ˆåˆ‡æ¢åˆ°å­åç¨‹ (dlv) goroutine 6 Switched from 1 to 6 (thread 11412) (dlv) bt 0 0x00000000004bd5e0 in main.printA at F:/Gotest/main.go:15 1 0x0000000000464621 in runtime.goexit at c:/go/src/runtime/asm_amd64.s:1373 (dlv) args a = 10 ","date":"2020-07-26","objectID":"/2020/golang-deep-learning-5-debug-with-dlv/:3:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 5-ä½¿ç”¨dlvè°ƒè¯•ç¨‹åº","uri":"/2020/golang-deep-learning-5-debug-with-dlv/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. åè®° å†™åˆ°è¿™é‡Œå¥½åƒæ²¡å‘ç°ç›´æ¥ä½¿ç”¨ dlv æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼ŒVScode åœ¨ delve åŸºç¡€ä¸Šå®Œæˆçš„è°ƒè¯•åŠŸèƒ½æ›´æ–¹ä¾¿ï¼Œæ¯”è‡ªå·±ä½¿ç”¨å‘½ä»¤é€æ­¥æ‰§è¡Œå¥½å¤šäº†ã€‚ ","date":"2020-07-26","objectID":"/2020/golang-deep-learning-5-debug-with-dlv/:4:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 5-ä½¿ç”¨dlvè°ƒè¯•ç¨‹åº","uri":"/2020/golang-deep-learning-5-debug-with-dlv/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æœ¬æ–‡å…³å¿ƒ map çš„åº•å±‚å®ç°ã€map çš„æ‰©å®¹æœºåˆ¶å’Œ map éå†çš„éšæœºæ€§ã€‚ å…ˆè§£ç­”é—®é¢˜ map æ˜¯å®ç°æ˜¯å“ˆå¸Œè¡¨+é“¾åœ°å€æ³•è§£å†³å†²çªï¼› map æ‰©å®¹æ¯æ¬¡å¢åŠ ä¸€å€çš„ç©ºé—´ï¼› map éå†å…·æœ‰éšæœºæ€§ï¼Œä¸è¦ä¸»è§‚åœ°è®¤ä¸ºéå†çš„é¡ºåºå°±æ˜¯æ’å…¥çš„é¡ºåºã€‚ å®é™…ä¸Šï¼Œé™¤äº†åŸºæœ¬çš„ç»“æ„å®šä¹‰ï¼Œmap çš„åˆå§‹åŒ–ã€è®¿é—®ã€åˆ é™¤ã€æ‰©å®¹ã€éå†ç­‰æ“ä½œå¹¶æ²¡æœ‰å®Œå…¨ç†è§£ï¼Œç•™å¾…ä¹‹åå†è¯´ï¼Œå…ˆå å‘ã€‚ ","date":"2020-07-25","objectID":"/2020/golang-deep-learning-4-map/:0:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 4-map","uri":"/2020/golang-deep-learning-4-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. å®ç° Go ä¸­æ˜ å°„ï¼ˆmapï¼‰çš„åº•å±‚å®ç°æ˜¯å“ˆå¸Œè¡¨ï¼Œä½äº src/runtime/map.go ä¸­ï¼Œæ•°æ®è¢«æ”¾åˆ°ä¸€ä¸ª buckets æ•°ç»„é‡Œï¼Œæ¯ä¸ª bucket åŒ…å«æœ€å¤š 8 ä¸ªé”®å€¼å¯¹ã€‚key çš„å“ˆå¸Œå€¼ä½ 8 ä½ç”¨äºé€‰æ‹© bucketï¼Œé«˜ 8 ä½ç”¨äºåŒºåˆ† bucket ä¸­å­˜æ”¾çš„å¤šä¸ªé”®å€¼ã€‚å¦‚æœè¶…è¿‡ 8 ä¸ªé”®è¢«æ”¾åˆ°åŒä¸€ä¸ª bucketï¼Œä½¿ç”¨ä¸€ä¸ªé¢å¤–çš„ bucket æ¥å­˜å‚¨ã€‚ æ ¸å¿ƒçš„ç»“æ„ä½“ä¸»è¦æ˜¯ hmap å’Œ bmapï¼Œå‰è€…å°±æ˜¯è¿™ä¸ª bucket æ•°ç»„ï¼Œåè€…å°±æ˜¯å•ä¸ª bucket çš„ç»“æ„ã€‚ // mapçš„åŸºç¡€æ•°æ®ç»“æ„ type hmap struct { count int // mapå­˜å‚¨çš„å…ƒç´ å¯¹è®¡æ•°ï¼Œlen()å‡½æ•°è¿”å›æ­¤å€¼ï¼Œæ‰€ä»¥mapçš„len()æ—¶é—´å¤æ‚åº¦æ˜¯O(1) flags uint8 B uint8 // bucketsæ•°ç»„çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯æ¡¶çš„æ•°é‡ä¸º2^Bä¸ª noverflow uint16 // æº¢å‡ºçš„æ¡¶çš„æ•°é‡çš„è¿‘ä¼¼å€¼ hash0 uint32 // hashç§å­ buckets unsafe.Pointer // æŒ‡å‘2^Bä¸ªæ¡¶ç»„æˆçš„æ•°ç»„çš„æŒ‡é’ˆï¼Œæ•°æ®å­˜åœ¨è¿™é‡Œ oldbuckets unsafe.Pointer // æŒ‡å‘æ‰©å®¹å‰çš„æ—§bucketsæ•°ç»„ï¼Œåªåœ¨mapå¢é•¿æ—¶æœ‰æ•ˆ nevacuate uintptr // è®¡æ•°å™¨ï¼Œæ ‡ç¤ºæ‰©å®¹åæ¬è¿çš„è¿›åº¦ extra *mapextra // ä¿å­˜æº¢å‡ºæ¡¶çš„æŒ‡é’ˆæ•°ç»„å’Œæœªä½¿ç”¨çš„æº¢å‡ºæ¡¶æ•°ç»„çš„é¦–åœ°å€ } type mapextra struct { overflow *[]*bmap // overflow contains overflow buckets for hmap.buckets. oldoverflow *[]*bmap // oldoverflow contains overflow buckets for hmap.oldbuckets. // nextOverflow holds a pointer to a free overflow bucket. nextOverflow *bmap } // æ¡¶çš„å®ç°ç»“æ„, hmapçš„bucketsæŒ‡é’ˆæŒ‡å‘è¯¥ç»“æ„ type bmap struct { // tophashå­˜å‚¨æ¡¶å†…æ¯ä¸ªkeyçš„hashå€¼çš„é«˜å­—èŠ‚ // tophash[0] \u003c minTopHashè¡¨ç¤ºæ¡¶çš„ç–æ•£çŠ¶æ€ // å½“å‰ç‰ˆæœ¬bucketCntçš„å€¼æ˜¯8ï¼Œä¸€ä¸ªæ¡¶æœ€å¤šå­˜å‚¨8ä¸ªkey-valueå¯¹ tophash [bucketCnt]uint8 // ä¸‹é¢ç´§è·Ÿå­˜æ”¾çš„é”®å€¼å¯¹ï¼Œå­˜æ”¾çš„æ ¼å¼æ˜¯æ‰€æœ‰çš„ keyï¼Œç„¶åæ˜¯æ‰€æœ‰çš„ valueï¼Œ // ä¹‹æ‰€ä»¥ä¸æ˜¯ä¸€ä¸ª key è·Ÿéšä¸€ä¸ª valueï¼Œæ˜¯ä¸ºäº†æ¶ˆé™¤å¡«å……æ‰€éœ€è¦çš„é—´éš™ï¼Œå› ä¸º // key ä¸ value çš„ç±»å‹ä¸ä¸€è‡´ï¼Œå ç”¨çš„å†…å­˜å¤§å°ä¸ä¸€è‡´ // æœ€åæ˜¯ä¸€ä¸ªæº¢å‡ºæŒ‡é’ˆ } hmap æ˜¯å“ˆå¸Œè¡¨çš„åŸºç¡€ç»“æ„ï¼Œhmap.buckets å®é™…æŒ‡å‘ buckets æ•°ç»„ï¼Œhmap.oldbuckets å’Œ hmap.nevacuate ç”¨äºæ‰©å®¹ï¼Œä¹‹åä»‹ç»ï¼Œhmap.extra ä¿å­˜æº¢å‡ºæ¡¶çš„åœ°å€çš„æ•°ç»„ä»¥åŠæœªä½¿ç”¨çš„æº¢å‡ºæ¡¶æ•°ç»„çš„é¦–åœ°å€ã€‚ bmap æ˜¯å•ä¸ªæ¡¶çš„ç»“æ„ï¼Œæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 8 çš„æ•°ç»„ï¼Œæ•°ç»„æ¯ä¸ªå…ƒç´ çš„å€¼æ˜¯ key çš„å“ˆå¸Œå€¼çš„é«˜ 8 ä½ï¼Œæ•°ç»„ä¹‹åæ˜¯ 8 ä¸ª keyï¼Œç„¶å 8 ä¸ª valueï¼Œæœ€åä¸€ä¸ªæº¢å‡ºæŒ‡é’ˆï¼Œæº¢å‡ºæŒ‡é’ˆæŒ‡å‘é¢å¤–çš„æ¡¶é“¾è¡¨ï¼Œç”¨äºå­˜å‚¨æº¢å‡ºçš„æ•°æ®ã€‚ç”¨å›¾æè¿°å¦‚ä¸‹ ","date":"2020-07-25","objectID":"/2020/golang-deep-learning-4-map/:1:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 4-map","uri":"/2020/golang-deep-learning-4-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. è®¿é—® ä¸»è¦æ˜¯ map.go æ–‡ä»¶ä¸­çš„å‡ ä¸ª mapaccess å‡½æ•°ï¼ŒåŸºæœ¬é€»è¾‘ä¸º æ‰¾ä¸åˆ° keyï¼Œå°±è¿”å›è¯¥ç±»å‹çš„é›¶å€¼ã€‚ ","date":"2020-07-25","objectID":"/2020/golang-deep-learning-4-map/:2:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 4-map","uri":"/2020/golang-deep-learning-4-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. åˆ†é… åˆ†é…çš„æ„æ€æ˜¯å‘ map ä¸­æ·»åŠ æ–°å€¼ï¼Œä¸»è¦æ˜¯ mapassign å‡½æ•°ï¼ŒåŸºæœ¬é€»è¾‘ä¸æŸ¥æ‰¾ç›¸ä¼¼ï¼Œä½†å¤šäº†å†™ä¿æŠ¤å’Œæ‰©å®¹çš„å†…å®¹ ","date":"2020-07-25","objectID":"/2020/golang-deep-learning-4-map/:3:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 4-map","uri":"/2020/golang-deep-learning-4-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. åˆ é™¤ åˆ é™¤ä¸»è¦æ˜¯ mapdelete å‡½æ•°ï¼Œé€»è¾‘å¦‚ä¸‹ï¼Œåˆ é™¤æ“ä½œçš„å®è´¨æ˜¯å°†å€¼ç½®ç©ºï¼Œå¹¶æ²¡æœ‰å‡å°‘å†…å­˜ ","date":"2020-07-25","objectID":"/2020/golang-deep-learning-4-map/:4:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 4-map","uri":"/2020/golang-deep-learning-4-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"5. éå† Go ä¸­ map éå†çš„ä¸€ä¸ªçªå‡ºç‰¹å¾å°±æ˜¯å…ƒç´ é¡ºåºçš„éšæœºåŒ–ï¼Œå³æ¯æ¬¡éå†å¾—åˆ°çš„å…ƒç´ çš„é¡ºåºä¸ä¸€å®šç›¸åŒï¼Œå’Œå…ƒç´ çš„æ’å…¥é¡ºåºæ— å…³ã€‚ Go ä¸­éå†çš„åŸºæœ¬é€»è¾‘æ˜¯å…ˆè°ƒç”¨ mapiterinit åˆå§‹åŒ– hiter ç»“æ„ä½“ï¼Œç„¶ååˆ©ç”¨ è¯¥ç»“æ„ä½“è¿›è¡Œéå†ã€‚ ","date":"2020-07-25","objectID":"/2020/golang-deep-learning-4-map/:5:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 4-map","uri":"/2020/golang-deep-learning-4-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"6. æ‰©å®¹ é¦–å…ˆï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹çš„é€»è¾‘æ˜¯ func (h *hmap) growing() bool { return h.oldbuckets != nil } ä½•æ—¶h.oldbucketsä¸ä¸ºnilå‘¢ï¼Ÿåœ¨åˆ†é…assigné€»è¾‘ä¸­ï¼Œå½“æ²¡æœ‰ä½ç½®ç»™keyä½¿ç”¨ï¼Œè€Œä¸”æ»¡è¶³æµ‹è¯•æ¡ä»¶(è£…è½½å› å­\u003e6.5æˆ–æœ‰å¤ªå¤šæº¢å‡ºé€š)æ—¶ï¼Œä¼šè§¦å‘hashGrowé€»è¾‘ï¼š func hashGrow(t *maptype, h *hmap) { //åˆ¤æ–­æ˜¯å¦éœ€è¦sameSizeGrowï¼Œå¦åˆ™\"çœŸ\"æ‰© bigger := uint8(1) if !overLoadFactor(h.count+1, h.B) { bigger = 0 h.flags |= sameSizeGrow } // å°†bucketså¤åˆ¶ç»™oldbuckets oldbuckets := h.buckets newbuckets, nextOverflow := makeBucketArray(t, h.B+bigger, nil) flags := h.flags \u0026^ (iterator | oldIterator) if h.flags\u0026iterator != 0 { flags |= oldIterator } // æ›´æ–° hmap ç»“æ„ h.B += bigger h.flags = flags h.oldbuckets = oldbuckets h.buckets = newbuckets h.nevacuate = 0 h.noverflow = 0 // è®¾ç½®æº¢å‡ºæ¡¶ if h.extra != nil \u0026\u0026 h.extra.overflow != nil { // Promote current overflow buckets to the old generation. if h.extra.oldoverflow != nil { throw(\"oldoverflow is not nil\") } h.extra.oldoverflow = h.extra.overflow h.extra.overflow = nil } if nextOverflow != nil { if h.extra == nil { h.extra = new(mapextra) } h.extra.nextOverflow = nextOverflow } // the actual copying of the hash table data is done incrementally // by growWork() and evacuate(). } è¿™é‡Œéœ€è¦æ˜ç™½ï¼Œmap æ‰©å®¹æ—¶æ¯æ¬¡å¢å¤§ä¸€å€ï¼Œæ–¹æ³•æ˜¯åˆ†é…ä¸€ä¸ªæ–°çš„ Bucket æ•°ç»„ï¼Œç„¶åå°†å°±æ•°ç»„å¤åˆ¶è¿‡å»ã€‚ ","date":"2020-07-25","objectID":"/2020/golang-deep-learning-4-map/:6:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 4-map","uri":"/2020/golang-deep-learning-4-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"å‚è€ƒ [1] ç®€ä¹¦ï¼ŒLoveè¯­é¬¼ï¼ŒGolang mapçš„åº•å±‚å®ç° ","date":"2020-07-25","objectID":"/2020/golang-deep-learning-4-map/:7:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 4-map","uri":"/2020/golang-deep-learning-4-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æœ¬ç¯‡ç†è§£åˆ‡ç‰‡çš„åº•å±‚å®ç°å’Œæ‰©å®¹æ–¹å¼ã€‚ ","date":"2020-07-24","objectID":"/2020/golang-deep-learning-3-slice/:0:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 3-åˆ‡ç‰‡","uri":"/2020/golang-deep-learning-3-slice/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. å®ç° åˆ‡ç‰‡çš„å®šä¹‰ä½äº src/runtime/slice.goï¼Œå¦‚ä¸‹ type slice struct { array unsafe.Pointer // ç”¨æ¥å­˜å‚¨å®é™…æ•°æ®çš„æ•°ç»„æŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€å—è¿ç»­çš„å†…å­˜ len int // åˆ‡ç‰‡ä¸­å…ƒç´ çš„æ•°é‡ cap int // arrayæ•°ç»„çš„é•¿åº¦ } æ‰€ä»¥å¯è§åˆ‡ç‰‡å’Œå­—ç¬¦ä¸²å¾ˆç›¸ä¼¼ï¼Œå®è´¨éƒ½æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œåªä¸è¿‡é™¤äº†é•¿åº¦ len è¿˜æœ‰ä¸€ä¸ªå®¹é‡å­—æ®µ capã€‚ä¸€ä¸ªç®€å•çš„å›¾è§£å¦‚ä¸‹ å›¾ä¸­çš„ x å’Œ y éƒ½æ˜¯ä»æ•°ç»„ [5]int{2,3,5,7,11} ä¸Šè·å–çš„åˆ‡ç‰‡ï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘è¯¥æ•°ç»„çš„ä¸åŒä½ç½®ã€‚ ä¸Šç¯‡ä»‹ç»å­—ç¬¦ä¸²çš„æ—¶å€™æåˆ°å­—ç¬¦ä¸²è™½ç„¶åº•å±‚æ˜¯æŒ‡é’ˆï¼Œä½†ä¸å…è®¸ç­‰äº nilï¼Œå®ƒçš„ç©ºå€¼æ˜¯ç©ºå­—ç¬¦ä¸² \"\"ã€‚ä½†åˆ‡ç‰‡æ˜¯å¯ä»¥ç­‰äº nil çš„ï¼Œåªè¦å…¶åº•å±‚æŒ‡é’ˆç­‰äº nilï¼Œä¸€èˆ¬æƒ…å†µæ˜¯åˆ‡ç‰‡å£°æ˜è€Œæœªåˆå§‹åŒ–çš„æ—¶å€™å‡ºç°è¯¥æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™å› ä¸ºæ²¡æœ‰æŒ‡å‘ä»»ä½•å†…å­˜åŒºåŸŸï¼Œåˆ‡ç‰‡çš„é•¿åº¦å’Œå®¹é‡ä¿¡æ¯éƒ½æ˜¯æ— æ•ˆçš„ï¼Œä¸è¿‡è¿˜æ˜¯å¯ä»¥è·å–åˆ°ã€‚ æ³¨ï¼šå› ä¸ºåˆ‡ç‰‡ç­‰äº nil ä¸€èˆ¬æ„å‘³ç€æ²¡æœ‰åˆå§‹åŒ–ï¼Œä¹Ÿå°±æ²¡æœ‰ä½¿ç”¨çš„ä»·å€¼ï¼Œæ‰€ä»¥å¾ˆå°‘å°†åˆ‡ç‰‡ç›´æ¥å’Œ nil ä½œæ¯”è¾ƒï¼Œä½¿ç”¨æ›´å¤šçš„è¿˜æ˜¯åˆ¤æ–­åˆ‡ç‰‡çš„é•¿åº¦æ˜¯å¦ä¸º0ï¼ˆlen(s) == 0ï¼‰ func main() { var s []int fmt.Println(s, len(s), cap(s)) fmt.Println(s == nil) } // Output [] 0 0 true åˆ‡ç‰‡ä¸€æ—¦åˆå§‹åŒ–ï¼Œåº•å±‚æŒ‡é’ˆå°±æŒ‡å‘äº†ä¸€ä¸ªç¡®å®šçš„å†…å­˜åŒºåŸŸï¼Œä½†æŒ‡å‘çš„å†…å­˜åŒºåŸŸå¤§å°å¯ä»¥ä¸º0ï¼Œä¹Ÿå°±æ˜¯åˆ‡ç‰‡ä¸­æ²¡æœ‰ä»»ä½•å…ƒç´ ï¼Œæ­¤æ—¶åˆ‡ç‰‡çš„é•¿åº¦ä¹Ÿæ˜¯ 0ï¼Œä½†å’Œæœªåˆå§‹åŒ–æ—¶å¾—åˆ°çš„é•¿åº¦ç»ä¸æ˜¯ä¸€ä¸ªå«ä¹‰ã€‚ func main() { var s []int s = []int{} fmt.Println(s, len(s), cap(s)) fmt.Println(s == nil) } // Output [] 0 0 false ","date":"2020-07-24","objectID":"/2020/golang-deep-learning-3-slice/:1:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 3-åˆ‡ç‰‡","uri":"/2020/golang-deep-learning-3-slice/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. æ‰©å®¹ åˆ‡ç‰‡çš„é•¿åº¦æ˜¯å½“å‰æ‰€åŒ…å«çš„å…ƒç´ ä¸ªæ•°ï¼Œå®¹é‡æ˜¯å¯å®¹çº³çš„æœ€å¤§å…ƒç´ ä¸ªæ•°ã€‚è¿™é‡Œçš„å«ä¹‰æ˜¯ï¼Œåˆå§‹åŒ–æ—¶æŒ‡å®šçš„å®¹é‡å°±ä»£è¡¨åœ¨å†…å­˜å·²ç»é¢„åˆ†é…äº†ä¸å®¹é‡ç›¸ç­‰çš„ç©ºé—´ï¼Œå…¶åè®¿é—®ã€æ·»åŠ ã€åˆ é™¤åˆ‡ç‰‡çš„å…ƒç´ éƒ½å’Œæ•°ç»„ç›¸ä¼¼ï¼Œåªæ“ä½œæŒ‡é’ˆï¼Œä¸ä¼šé€ æˆå†…å­˜é‡æ–°åˆ†é…ã€‚ func main() { s := make([]int, 0, 3) fmt.Printf(\"%p \", s) fmt.Println(s, len(s), cap(s)) s = append(s, 1) fmt.Printf(\"%p \", s) fmt.Println(s, len(s), cap(s)) } // Output 0xc000124180 [] 0 3 0xc000124180 [1] 1 3 ä½†æ˜¯ï¼Œå¦‚æœè¿½åŠ çš„å…ƒç´ æ•°é‡è¶…è¿‡äº†å®¹é‡ï¼Œé‚£ä¹ˆä¼šå¯¼è‡´å†…å­˜çš„é‡æ–°åˆ†é…ã€‚ func main() { s := make([]int, 0, 3) fmt.Printf(\"%p \", s) fmt.Println(s, len(s), cap(s)) s = append(s, 1, 2, 3, 4) fmt.Printf(\"%p \", s) fmt.Println(s, len(s), cap(s)) } // Output 0xc000124180 [] 0 3 0xc000146030 [1 2 3 4] 4 6 å†…å­˜çš„é‡æ–°åˆ†é…å°±æ˜¯åˆ‡ç‰‡çš„æ‰©å®¹ï¼Œå…¶é€»è¾‘æ˜¯ï¼Œä¸ºåˆ‡ç‰‡åˆ†é…ä¸€å—æ›´å¤§çš„å†…å­˜ï¼Œç„¶åå°†æ—§åˆ‡ç‰‡çš„å…ƒç´ å¤åˆ¶åˆ°æ–°åˆ‡ç‰‡ä¸­ã€‚ ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„æƒ…å†µå¦‚ä¸‹ï¼Œå°†åˆ‡ç‰‡ s èµ‹å€¼ç»™ä¸€ä¸ªæ–°çš„åˆ‡ç‰‡ lï¼Œç„¶åå¯¹åŸåˆ‡ç‰‡ s è¿›è¡Œæ‰©å®¹å’Œä¿®æ”¹ï¼Œä¸ä¼šå½±å“åˆ°åˆ‡ç‰‡ l func main() { s := make([]int, 3, 3) fmt.Printf(\"%p %v\\n\", s, s) l := s[:] s = append(s, 1) s[0] = 1 fmt.Printf(\"%p %v\\n\", s, s) fmt.Printf(\"%p %v\", l, l) } // Output 0xc000124180 [0 0 0] 0xc000146030 [1 0 0 1] 0xc000124180 [0 0 0] æœ€åä¸€ä¸ªå€¼å¾—æ³¨æ„çš„é—®é¢˜æ˜¯åˆ‡ç‰‡æ¯æ¬¡æ‰©å®¹ä¼šæ‰©å¤§å¤šå°‘ï¼Œè¿™ä¸ªé€»è¾‘ä½äº src/runtime/slice.go æ–‡ä»¶ä¸­çš„ growslice å‡½æ•°ä¸­ï¼Œå…¶ä¸­ old.len æ˜¯æ—§é•¿åº¦ï¼Œold.cap æ˜¯æ—§å®¹é‡ï¼Œnewcap æ˜¯æ–°å®¹é‡ï¼Œcap æ˜¯éœ€è¦çš„å®¹é‡ï¼Œ // ...çœç•¥ newcap := old.cap doublecap := newcap + newcap if cap \u003e doublecap { newcap = cap } else { if old.len \u003c 1024 { newcap = doublecap } else { // Check 0 \u003c newcap to detect overflow // and prevent an infinite loop. for 0 \u003c newcap \u0026\u0026 newcap \u003c cap { newcap += newcap / 4 } // Set newcap to the requested cap when // the newcap calculation overflowed. if newcap \u003c= 0 { newcap = cap } } } // ...çœç•¥ ç®€å•æè¿°å°±æ˜¯ï¼š å¦‚æœéœ€è¦çš„å®¹é‡è¶…è¿‡åŸåˆ‡ç‰‡å®¹é‡çš„ä¸¤å€ï¼Œç›´æ¥ä½¿ç”¨éœ€è¦çš„å®¹é‡ä½œä¸ºæ–°å®¹é‡ï¼› å¦‚æœåŸåˆ‡ç‰‡çš„é•¿åº¦å°äº 1024ï¼Œæ–°åˆ‡ç‰‡çš„å®¹é‡ç¿»å€ï¼› å¦‚æœåŸåˆ‡ç‰‡çš„é•¿åº¦å¤§äº1024ï¼Œåˆ™æ¯æ¬¡å¢åŠ 25%ï¼Œç›´åˆ°æ–°å®¹é‡è¶…è¿‡æ‰€éœ€è¦çš„å®¹é‡ï¼› ç¬¬äºŒæ¡çš„ç¿»å€å€’æ˜¯å¯ä»¥ç¡®è®¤ï¼Œä½†ç¬¬ä¸€æ¡å’Œç¬¬ä¸‰æ¡ç»éªŒè¯å´ä¸å¤ªç¬¦åˆ func main() { // 1. éœ€è¦çš„å®¹é‡è¶…è¿‡åŸåˆ‡ç‰‡å®¹é‡çš„ä¸¤å€ï¼Œæ–°å®¹é‡åº”ä¸ºéœ€è¦çš„å®¹é‡5 s1 := make([]int, 2) fmt.Printf(\"%p %v\\n\", s1, cap(s1)) s1 = append(s1, 3, 4, 5) fmt.Printf(\"%p %v\\n\", s1, cap(s1)) // 2. åŸåˆ‡ç‰‡é•¿åº¦å°äº1024ï¼Œæ–°å®¹é‡åº”å½“ç¿»å€ä¸º4 s2 := make([]int, 2) fmt.Printf(\"%p %v\\n\", s2, cap(s2)) s2 = append(s2, 3) fmt.Printf(\"%p %v\\n\", s2, cap(s2)) // 3. åŸåˆ‡ç‰‡é•¿åº¦å¤§äº1024ï¼Œæ–°å®¹é‡é€’å¢25%1æ¬¡ï¼Œåº”å½“ä¸º1500 s3 := make([]int, 1200) fmt.Printf(\"%p %v\\n\", s3, cap(s3)) s3 = append(s3, 3) fmt.Printf(\"%p %v\", s3, cap(s3)) } // Output 0xc0000120b0 2 0xc00000a390 6 0xc0000120f0 2 0xc0000104c0 4 0xc000100000 1200 0xc00010c000 1536 è¿™æ˜¯å› ä¸ºæ‰©å®¹çš„é‚£ä¸€æ®µæ ¸å¿ƒæºç åé¢è¿˜æœ‰ä¸€æ®µæ–°å®¹é‡çš„å¤„ç†è¿‡ç¨‹ï¼Œå¦‚ä¸‹ var overflow bool var lenmem, newlenmem, capmem uintptr // Specialize for common values of et.size. // For 1 we don't need any division/multiplication. // For sys.PtrSize, compiler will optimize division/multiplication into a shift by a constant. // For powers of 2, use a variable shift. switch { case et.size == 1: lenmem = uintptr(old.len) newlenmem = uintptr(cap) capmem = roundupsize(uintptr(newcap)) overflow = uintptr(newcap) \u003e maxAlloc newcap = int(capmem) case et.size == sys.PtrSize: lenmem = uintptr(old.len) * sys.PtrSize newlenmem = uintptr(cap) * sys.PtrSize capmem = roundupsize(uintptr(newcap) * sys.PtrSize) overflow = uintptr(newcap) \u003e maxAlloc/sys.PtrSize newcap = int(capmem / sys.PtrSize) case isPowerOfTwo(et.size): var shift uintptr if sys.PtrSize == 8 { // Mask shift for better code generation. shift = uintptr(sys.Ctz64(uint64(et.size))) \u0026 63 } else { shift = uintptr(sys.Ctz32(uint32(et.size))) \u0026 31 } lenmem = uintptr(old.len) \u003c\u003c shift newlenmem = uintptr(cap) \u003c\u003c shift capmem = roundupsize(uintptr(newcap) \u003c\u003c shift) overflow = uintptr(newcap) \u003e (maxAlloc \u003e\u003e shift) newcap = int(capmem \u003e\u003e shift) default: lenmem = uintptr(old.len) * et.size newlenmem = uintptr(cap) * et.size capmem, overflow = math.MulUintptr(et.size, uintptr(newcap)) capmem = roundupsize(capmem) newcap = int(capmem / et.size) } å…¶ä¸­ et æ˜¯åˆ‡ç‰‡ä¸­çš„å…ƒç´ ç±»å‹ï¼Œsys.PtrSize æ˜¯ä¸€ä¸ªæŒ‡é’ˆçš„å¤§å°ï¼Œ64ä½ç³»ç»Ÿä¸­ä¸º8ï¼Œä¸»è¦è°ƒç”¨çš„å¤„ç†å‡½æ•° roundupsize æ¥è‡ª src/runtime/msize.go æ–‡ä»¶ï¼Œå¦‚ä¸‹ // Returns size of the memory block that mallocgc will allocate if you ask for the size. func roundupsize(size uintptr) uintptr { // _MaxSmallSize = 32768 if size \u003c _MaxSmallSize { // smallSizeMax = 1024 if size \u003c= smallSizeMax-8 { return uintptr(class_to_size[size_to_class8[divRoundUp(size, smallSizeDiv)]]) } else { return uintptr(class_to_size[size_to_class128[divRoundUp(size-smallSizeMax, largeSiz","date":"2020-07-24","objectID":"/2020/golang-deep-learning-3-slice/:2:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 3-åˆ‡ç‰‡","uri":"/2020/golang-deep-learning-3-slice/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"Go ä¸­å­—ç¬¦ä¸²è™½ç„¶ä½œä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œä½†æœ¬è´¨ä¾ç„¶æ˜¯å­—ç¬¦æ•°ç»„ï¼Œæœ¬ç¯‡æ–‡ç« ç†è§£ Go åº•å±‚ string ç±»å‹æ˜¯å¦‚ä½•å®ç°çš„ï¼Œä»¥åŠæ¢è®¨å®ƒä¸ []byte ä¹‹é—´çš„å…³ç³»ã€‚ ","date":"2020-07-24","objectID":"/2020/golang-deep-learning-2-string/:0:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 2-string","uri":"/2020/golang-deep-learning-2-string/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. string æ ‡å‡†åº“ builtin å£°æ˜äº† Go æ‰€æœ‰çš„é¢„å®šä¹‰æ ‡è¯†ç¬¦ï¼Œå…¶ä¸­å¯¹ string çš„æè¿°å¦‚ä¸‹ string is the set of all strings of 8-bit bytes, conventionally but not necessarily representing UTF-8-encoded text. A string may be empty, but not nil. Values of string type are immutable. æ„æ€æ˜¯å­—ç¬¦ä¸²æ˜¯å­—èŠ‚çš„ä¸€ä¸ªåºåˆ—ï¼Œçº¦å®šä½†ä¸å¿…é¡»æ˜¯ UTF-8 ç¼–ç çš„æ–‡æœ¬ã€‚å­—ç¬¦ä¸²å¯ä»¥ä¸ºç©ºä½†ä¸èƒ½æ˜¯nilï¼Œå…¶å€¼ä¸å¯å˜ã€‚Go ä¸­å­—ç¬¦ä¸²çš„æºç å®šä¹‰åœ¨ src/runtime/string.go ä¸­ï¼Œå¦‚ä¸‹ type stringStruct struct { str unsafe.Pointer len int } æ‰€ä»¥ Go ä¸­å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œå…¶ä¸­åŒ…å«ä¸¤ä¸ªå­—æ®µï¼Œç¬¬ä¸€ä¸ªå­—æ®µ str æ˜¯ä¸ªæŒ‡é’ˆï¼Œç¬¬äºŒä¸ªå­—æ®µ len æ˜¯å­—ç¬¦ä¸²é•¿åº¦ã€‚str æŒ‡é’ˆè™½ç„¶æ˜¯ unsafe.Pointer ç±»å‹ï¼Œä½†å®ƒæœ€åå…¶å®æŒ‡å‘äº†ä¸€ä¸ª byte ç±»å‹çš„æ•°ç»„ï¼Œå¦‚ä¸‹ //go:nosplit func gostringnocopy(str *byte) string { ss := stringStruct{str: unsafe.Pointer(str), len: findnull(str)} s := *(*string)(unsafe.Pointer(\u0026ss)) return s } æ‰€ä»¥æˆ‘ä»¬ç†è§£äº†å­—ç¬¦ä¸²çš„èµ‹å€¼å…¶å®æ˜¯æŒ‡é’ˆçš„å¤åˆ¶ï¼ŒåŒæ—¶æˆ‘ä»¬è¿˜æ³¨æ„åˆ°å­—ç¬¦ä¸²é•¿åº¦å…¶å®è°ƒç”¨äº† findnull å‡½æ•° func findnullw(s *uint16) int { if s == nil { return 0 } p := (*[maxAlloc/2/2 - 1]uint16)(unsafe.Pointer(s)) l := 0 for p[l] != 0 { l++ } return l } åœ¨ findnull çš„å®ç°ä¸­ï¼ŒmaxAlloc æ˜¯å…è®¸ç”¨æˆ·åˆ†é…çš„æœ€å¤§è™šæ‹Ÿå†…å­˜ç©ºé—´ã€‚åœ¨ 64 ä½ï¼Œç†è®ºä¸Šå¯åˆ†é…æœ€å¤§ 1 \u003c\u003c heapAddrBits å­—èŠ‚ã€‚åœ¨ 32 ä½ï¼Œæœ€å¤§å¯åˆ†é…å°äº 1 \u003c\u003c 32 å­—èŠ‚ã€‚æ‰€ä»¥ï¼Œæ±‚é•¿åº¦çš„é€»è¾‘æ˜¯ï¼šå¦‚æœæŒ‡é’ˆæ‚¬ç©ºï¼Œé‚£ä¹ˆå­—ç¬¦ä¸²é•¿åº¦ä¸º0ï¼Œå¦åˆ™å°†æŒ‡é’ˆè½¬æ¢ä¸ºä¸€ä¸ªå­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆï¼Œç„¶ååˆ¤æ–­è¿™ä¸ªå­—ç¬¦æ•°ç»„çš„æ¯ä¸ªå€¼æ˜¯å¦å­˜åœ¨ï¼Œç¬¬ä¸€ä¸ªä¸º0çš„å€¼å¯¹åº”çš„ç´¢å¼•å°±æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚ å­—ç¬¦ä¸²çš„å€¼ä¸å¯æ”¹å˜è¿™ä¸ªç‰¹æ€§æ˜¯é€šè¿‡ç¦æ­¢è®¿é—® str æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜çš„å€¼å®ç°çš„ï¼Œä½† str æŒ‡é’ˆæœ¬èº«çš„å€¼æ˜¯å¯ä»¥æ”¹å˜çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæŒ‡å‘çš„å†…å­˜åŒºåŸŸå¯ä»¥æ”¹å˜ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²å¯ä»¥é‡å¤èµ‹å€¼ s := \"hello\" // str æŒ‡é’ˆæŒ‡å‘\"hello\"çš„å†…å­˜ s = \"world\" // str æŒ‡é’ˆæŒ‡å‘\"world\"çš„å†…å­˜ å­—ç¬¦ä¸²åŒæ—¶ä¹Ÿæ”¯æŒåˆ‡ç‰‡æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸º str çš„é‡æ–°èµ‹å€¼å’Œ len çš„é‡æ–°è®¡ç®—ï¼Œæ¯”å¦‚ä¸‹é¢çš„è¯­å¥ä¸­ï¼Œhello å’Œ world å…¶å®éƒ½æŒ‡å‘ s æ‰€æŒ‡å‘çš„å†…å­˜åŒºåŸŸï¼Œåªæ˜¯æŒ‡é’ˆçš„ä½ç½®ä¸ä¸€æ ·ã€‚ s := \"hello, world\" hello := s[:5] world := s[7:] æœ€åï¼Œè™½ç„¶å­—ç¬¦ä¸²åº•å±‚æŒ‡å‘ä¸€ä¸ª byte æ•°ç»„ï¼Œå•ç‹¬è®¿é—®å…¶å…ƒç´ å¾—åˆ°çš„ç±»å‹ä¹Ÿæ˜¯ byteï¼Œä½†ä½¿ç”¨ for range è¯­æ³•éå†æ—¶ï¼Œå•ä¸ªå€¼çš„ç±»å‹å´æ˜¯ runeã€‚ func main() { s := \"hello\" fmt.Printf(\"%T \", s[1]) for _, v := range s { fmt.Printf(\"%T\", v) break } } // Output uint8 int32 è¿™é‡Œä¸»è¦æ˜¯å› ä¸º Go ä¸“é—¨åšäº†ä¸€ä¸ªè§£ç æ“ä½œï¼Œå¦‚ä¸‹ï¼Œæ³¨æ„è¿™é‡Œçš„ä»£ç ä¸æ˜¯çœŸçš„åº•å±‚å®ç°ï¼Œåªæ˜¯ç”¨æ¥è¯´æ˜é€»è¾‘çš„ func forOnString(s string, forBody func(i int, r rune)) { for i := 0; len(s) \u003e 0; { r,size := utf8.DecodeRuneInString(s) forBody(i,r) s = s[size:] i += size } } ","date":"2020-07-24","objectID":"/2020/golang-deep-learning-2-string/:1:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 2-string","uri":"/2020/golang-deep-learning-2-string/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. è½¬æ¢ ç”±ä»¥ä¸Šå¯çŸ¥å­—ç¬¦ä¸²å•ä¸ªå­—ç¬¦å¯èƒ½æ˜¯ byte æˆ– runeï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä½¿ç”¨å­—ç¬¦ä¸²æ—¶ç»å¸¸åšçš„å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚å®ƒä»¬éšå«è€…å†…å­˜çš„é‡æ–°åˆ†é…ï¼Œä»£ä»·å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥è¿™é‡Œç ”ç©¶ä¸€ä¸‹ã€‚ ","date":"2020-07-24","objectID":"/2020/golang-deep-learning-2-string/:2:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 2-string","uri":"/2020/golang-deep-learning-2-string/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 string-\u003e[]byte string è½¬æ¢ []byteï¼Œæºç å®ç°å¦‚ä¸‹ func stringtoslicebyte(buf *tmpBuf, s string) []byte { var b []byte if buf != nil \u0026\u0026 len(s) \u003c= len(buf) { *buf = tmpBuf{} b = buf[:len(s)] } else { b = rawbyteslice(len(s)) } copy(b, s) return b } // rawbyteslice allocates a new byte slice. The byte slice is not zeroed. func rawbyteslice(size int) (b []byte) { cap := roundupsize(uintptr(size)) p := mallocgc(cap, nil, false) if cap != uintptr(size) { memclrNoHeapPointers(add(p, uintptr(size)), cap-uintptr(size)) } *(*slice)(unsafe.Pointer(\u0026b)) = slice{p, size, int(cap)} return } æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å®åšäº†ä¸€æ¬¡å†…å­˜çš„é‡æ–°åˆ†é…ï¼Œå¾—åˆ°äº†æ–°çš„å­—ç¬¦æ•°ç»„ bï¼Œç„¶åå°† s å¤åˆ¶ç»™ bã€‚è‡³äº copy å‡½æ•°å¯ä»¥ç›´æ¥æŠŠ string å¤åˆ¶ç»™ []byteï¼Œæ˜¯å› ä¸º go æºç å•ç‹¬å®ç°äº†ä¸€ä¸ªslicestringcopyå‡½æ•°æ¥å®ç°ï¼Œå…·ä½“å¯ä»¥çœ‹src/runtime/slice.goã€‚ ","date":"2020-07-24","objectID":"/2020/golang-deep-learning-2-string/:2:1","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 2-string","uri":"/2020/golang-deep-learning-2-string/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 []byte-\u003estring []byte è½¬æ¢ stringï¼Œæºç å¦‚ä¸‹ func slicebytetostring(buf *tmpBuf, ptr *byte, n int) (str string) { if n == 0 { // Turns out to be a relatively common case. // Consider that you want to parse out data between parens in \"foo()bar\", // you find the indices and convert the subslice to string. return \"\" } if raceenabled { racereadrangepc(unsafe.Pointer(ptr), uintptr(n), getcallerpc(), funcPC(slicebytetostring)) } if msanenabled { msanread(unsafe.Pointer(ptr), uintptr(n)) } if n == 1 { p := unsafe.Pointer(\u0026staticuint64s[*ptr]) if sys.BigEndian { p = add(p, 7) } stringStructOf(\u0026str).str = p stringStructOf(\u0026str).len = 1 return } var p unsafe.Pointer if buf != nil \u0026\u0026 n \u003c= len(buf) { p = unsafe.Pointer(buf) } else { p = mallocgc(uintptr(n), nil, false) } stringStructOf(\u0026str).str = p stringStructOf(\u0026str).len = n memmove(p, unsafe.Pointer(ptr), uintptr(n)) return } func stringStructOf(sp *string) *stringStruct { return (*stringStruct)(unsafe.Pointer(sp)) } è¯¥è½¬æ¢çš„æ€è·¯æ˜¯æ–°åˆ†é… sï¼Œç„¶åå°† b å¤åˆ¶ç»™å®ƒï¼Œæ‰€ä»¥ä¾ç„¶æœ‰å†…å­˜çš„é‡æ–°åˆ†é…ã€‚ ","date":"2020-07-24","objectID":"/2020/golang-deep-learning-2-string/:2:2","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 2-string","uri":"/2020/golang-deep-learning-2-string/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 string-\u003e[]rune æºç å¦‚ä¸‹ï¼Œç”±äº byte å’Œ rune ç±»å‹çš„å·®å¼‚ï¼Œæ¯”å¦‚è¿›è¡Œå†…å­˜çš„é‡æ–°åˆ†é…ã€‚ func stringtoslicerune(buf *[tmpStringBufSize]rune, s string) []rune { // two passes. // unlike slicerunetostring, no race because strings are immutable. n := 0 for range s { n++ } var a []rune if buf != nil \u0026\u0026 n \u003c= len(buf) { *buf = [tmpStringBufSize]rune{} a = buf[:n] } else { a = rawruneslice(n) } n = 0 for _, r := range s { a[n] = r n++ } return a } // rawruneslice allocates a new rune slice. The rune slice is not zeroed. func rawruneslice(size int) (b []rune) { if uintptr(size) \u003e maxAlloc/4 { throw(\"out of memory\") } mem := roundupsize(uintptr(size) * 4) p := mallocgc(mem, nil, false) if mem != uintptr(size)*4 { memclrNoHeapPointers(add(p, uintptr(size)*4), mem-uintptr(size)*4) } *(*slice)(unsafe.Pointer(\u0026b)) = slice{p, size, int(mem / 4)} return } ","date":"2020-07-24","objectID":"/2020/golang-deep-learning-2-string/:2:3","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 2-string","uri":"/2020/golang-deep-learning-2-string/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.4 []rune-\u003estring æºç å¦‚ä¸‹ï¼Œå†…å­˜åˆ†é…æ²¡å¾—è·‘ã€‚ func slicerunetostring(buf *tmpBuf, a []rune) string { if raceenabled \u0026\u0026 len(a) \u003e 0 { racereadrangepc(unsafe.Pointer(\u0026a[0]), uintptr(len(a))*unsafe.Sizeof(a[0]), getcallerpc(), funcPC(slicerunetostring)) } if msanenabled \u0026\u0026 len(a) \u003e 0 { msanread(unsafe.Pointer(\u0026a[0]), uintptr(len(a))*unsafe.Sizeof(a[0])) } var dum [4]byte size1 := 0 for _, r := range a { size1 += encoderune(dum[:], r) } s, b := rawstringtmp(buf, size1+3) size2 := 0 for _, r := range a { // check for race if size2 \u003e= size1 { break } size2 += encoderune(b[size2:], r) } return s[:size2] } func rawstringtmp(buf *tmpBuf, l int) (s string, b []byte) { if buf != nil \u0026\u0026 l \u003c= len(buf) { b = buf[:l] s = slicebytetostringtmp(\u0026b[0], len(b)) } else { s, b = rawstring(l) } return } func rawstring(size int) (s string, b []byte) { p := mallocgc(uintptr(size), nil, false) stringStructOf(\u0026s).str = p stringStructOf(\u0026s).len = size *(*slice)(unsafe.Pointer(\u0026b)) = slice{p, size, size} return } ","date":"2020-07-24","objectID":"/2020/golang-deep-learning-2-string/:2:4","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 2-string","uri":"/2020/golang-deep-learning-2-string/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. æ€»ç»“ string å’Œ []byteï¼Œstring å’Œ []rune çš„è½¬æ¢éƒ½ä¼šè¿›è¡Œå†…å­˜çš„é‡æ–°åˆ†é…ï¼Œæœ‰ä¸€å®šä»£ä»·ï¼› ç›´æ¥è®¿é—® string ä¸­çš„æˆå‘˜ï¼Œç±»å‹ä¸º byteï¼Œä½¿ç”¨ for range ç»“æ„ï¼Œç±»å‹ä¸º runeï¼› éœ€è¦ä¿®æ”¹ string ä¸­çš„æˆå‘˜æ—¶ï¼Œéœ€è¦è½¬æ¢ []byteï¼› ","date":"2020-07-24","objectID":"/2020/golang-deep-learning-2-string/:3:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 2-string","uri":"/2020/golang-deep-learning-2-string/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æœ¬ç¯‡ä»‹ç» Go ä¸­çš„æŒ‡é’ˆã€uintptr å’Œ unsafe.Pointer ä¸‰ä¸ªæ¦‚å¿µã€‚ ","date":"2020-07-23","objectID":"/2020/golang-deep-learning-1-uintptr-and-unsafe.pointer/:0:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 1-uintptr å’Œ Unsafe.Pointer","uri":"/2020/golang-deep-learning-1-uintptr-and-unsafe.pointer/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. æŒ‡é’ˆ Go ä¸­æŒ‡é’ˆçš„æ¦‚å¿µä¸ C ç›¸åŒï¼Œåªæ˜¯æŒ‡é’ˆæœ¬èº«ä¸èƒ½è¿›è¡Œè¿ç®—ã€‚ ä»»ä½•ä¸€ä¸ªå˜é‡åœ¨è¿è¡Œæ—¶éƒ½æœ‰ä¸€ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€ä»£è¡¨å®ƒåœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼Œåœ¨å˜é‡åå‰ä½¿ç”¨å–åœ°å€ç¬¦ \u0026 å¯ä»¥è·å–è¯¥å˜é‡çš„å†…å­˜åœ°å€ï¼Œæ¯”å¦‚ ptr := \u0026v å…¶ä¸­ v æ˜¯ä¸€ä¸ªå˜é‡ï¼Œptr ç”¨æ¥ä¿å­˜å®ƒçš„å†…å­˜åœ°å€ï¼Œptr å°±æ˜¯æŒ‡é’ˆã€‚å½“ç„¶ï¼Œå‡†ç¡®çš„æ¥è¯´ï¼Œptr æ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œä½œä¸ºå˜é‡ï¼Œä»ç„¶æ˜¯ç”¨æ¥ä¿å­˜æ•°æ®ï¼Œåªä¸è¿‡è¿™é‡Œå®ƒç‰¹åˆ«ç”¨æ¥ä¿å­˜ä¸€ä¸ªå†…å­˜åœ°å€è€Œå·²ã€‚ ä¸€ä¸ªæŒ‡é’ˆå˜é‡éœ€è¦ä½¿ç”¨ * æ¥å£°æ˜ï¼Œå¦‚ä¸‹ var ptr *int * ä»£è¡¨ ptr ä¿å­˜ä¸€ä¸ªåœ°å€ï¼Œè€Œ int ä»£è¡¨è¿™ä¸ªåœ°å€æŒ‡å‘çš„å†…å­˜æ‰€ä¿å­˜çš„æ•°æ®æ˜¯ int ç±»å‹ã€‚è¿™é‡Œè¦æ³¨æ„ï¼Œ*int å’Œ *string æ˜¯ä¸åŒçš„æŒ‡é’ˆç±»å‹ï¼Œä¸èƒ½ç›¸äº’èµ‹å€¼ï¼Œå¦‚ä¸‹ä¾‹ï¼ŒæŒ‡é’ˆçš„ç±»å‹ä¸å®ƒæ‰€æŒ‡å‘çš„å†…å­˜åœ°å€ä¿å­˜çš„æ•°æ®ç±»å‹æœ‰å…³ã€‚ func main() { var a *int b := \"hello\" a = \u0026b } // Output .\\main.go:6:4: cannot use \u0026b (type *string) as type *int in assignment æŒ‡é’ˆåœ¨å£°æ˜ä½†æœªèµ‹å€¼æ—¶å…¶å€¼ä¸º nilï¼Œä¸æŒ‡å‘ä»»ä½•å†…å­˜ func main() { var a *int fmt.Println(a) } // Output \u003cnil\u003e å°†ä¸€ä¸ªå˜é‡çš„åœ°å€èµ‹å€¼ç»™æŒ‡é’ˆåï¼Œè¿›è¡Œä½¿ç”¨è¦åˆ©ç”¨ * ç¬¦å·ï¼Œå¦åˆ™å…¶å€¼å°±æ˜¯æ‰€ä¿å­˜çš„å†…å­˜åœ°å€ func main() { var a *int b := 10 a = \u0026b fmt.Println(a, *a) } // Output 0xc000012098 10 ","date":"2020-07-23","objectID":"/2020/golang-deep-learning-1-uintptr-and-unsafe.pointer/:1:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 1-uintptr å’Œ Unsafe.Pointer","uri":"/2020/golang-deep-learning-1-uintptr-and-unsafe.pointer/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. unsafe.Pointer æˆ‘ä»¬å·²ç»çŸ¥é“ä¸åŒçš„æŒ‡é’ˆç±»å‹é—´ä¸èƒ½ç›¸äº’èµ‹å€¼ï¼Œå¦å¤–ï¼Œå®ƒä»¬ä¹Ÿä¸èƒ½è¿›è¡Œç±»å‹è½¬æ¢ func main() { var a *int b := 10 a = \u0026b c := (*float64)(a) } // Output .\\main.go:7:17: cannot convert a (type *int) to type *float64 unsafe.Pointer æ˜¯ç‰¹åˆ«å®šä¹‰çš„ä¸€ç§æŒ‡é’ˆç±»å‹ï¼Œå®ƒå¯ä»¥åŒ…å«ä»»æ„ç±»å‹å˜é‡çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¯´æ— è®º intã€float64 è¿˜æ˜¯å…¶å®ƒç±»å‹çš„å˜é‡ï¼Œå†…å­˜åœ°å€éƒ½å¯ä»¥äº¤ç»™å®ƒä¿å­˜ã€‚ package main import ( \"fmt\" \"unsafe\" ) func main() { b := 10 var a *int = \u0026b c := unsafe.Pointer(a) fmt.Println(c) } // Output 0xc000012098 ä»ä¸Šé¢çš„ç¨‹åºæ³¨æ„åˆ°ä¸¤ç‚¹ unsafe.Pointer æ¥è‡ª unsafe åŒ…ï¼Œä¸æ˜¯å†…ç½®ç±»å‹ï¼› unsafe.Pointer ä¸€èˆ¬ä½œä¸ºæŒ‡é’ˆç±»å‹è½¬æ¢çš„æ¡¥æ¢ä½¿ç”¨ unsafe.Pointer æœ¬è´¨æ˜¯ä¸€ä¸ª *intï¼Œåœ¨ unsafe åŒ…ä¸­å®šä¹‰å¦‚ä¸‹ type ArbitraryType int type Pointer *ArbitraryType unsafe.Pointer çš„ä½¿ç”¨è¯´æ˜å¦‚ä¸‹ ä»»æ„ç±»å‹çš„æŒ‡é’ˆå¯ä»¥è½¬æ¢ä¸ºä¸€ä¸ªPointerç±»å‹å€¼ ä¸€ä¸ªPointerç±»å‹å€¼å¯ä»¥è½¬æ¢ä¸ºä»»æ„ç±»å‹çš„æŒ‡é’ˆ ä¸€ä¸ªuintptrç±»å‹å€¼å¯ä»¥è½¬æ¢ä¸ºä¸€ä¸ªPointerç±»å‹å€¼ ä¸€ä¸ªPointerç±»å‹å€¼å¯ä»¥è½¬æ¢ä¸ºä¸€ä¸ªuintptrç±»å‹å€¼ ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ unsafe.Pointer ä½œä¸ºæ¡¥æ¢è¿›è¡Œç±»å‹è½¬æ¢çš„ä¾‹å­ func main() { b := 10 var a *int = \u0026b c := (*float64)(unsafe.Pointer(a)) } ","date":"2020-07-23","objectID":"/2020/golang-deep-learning-1-uintptr-and-unsafe.pointer/:2:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 1-uintptr å’Œ Unsafe.Pointer","uri":"/2020/golang-deep-learning-1-uintptr-and-unsafe.pointer/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. uintptr uintptr ç¡®ç¡®å®å®æ˜¯ Go çš„åŸºæœ¬ç±»å‹ï¼Œå±äºæ•´å‹çš„ä¸€ç§ï¼Œè¢«è®¾è®¡ä¸ºè¶³å¤Ÿå®¹çº³ä¸€ä¸ªæŒ‡é’ˆã€‚åœ¨ Go ä¸­æŒ‡é’ˆæ˜¯ä¸å…è®¸è¿›è¡Œè¿ç®—çš„ï¼Œä½† uintptr å¯ä»¥ï¼Œæ‰€ä»¥å®ƒçš„æ„ä¹‰åœ¨äºå°†å…¶å®ƒç±»å‹çš„æŒ‡é’ˆè½¬æ¢æˆå®ƒè¿›è¡Œè¿ç®—ï¼Œç„¶åå†è½¬æ¢å›åŸæœ¬çš„ç±»å‹ã€‚ type User struct { Name string Age int } func main() { u := new(User) name :=(*string)(unsafe.Pointer(u)) *name = \"test\" age := (*int)(unsafe.Pointer(uintptr(unsafe.Pointer(u)) + unsafe.Offsetof(u.Age))) *age = 18 fmt.Println(u) } æ€è·¯: å¦‚æœæƒ³å¯¹ Name å’Œ Age è¿›è¡Œèµ‹å€¼ï¼Œé‚£é¦–å…ˆåº”è¯¥å…ˆæ‹¿åˆ°ç›¸åº”çš„åœ°å€ï¼Œç„¶åå¯¹åœ°å€å†…å®¹ä¿®æ”¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ†åˆ«å®šä¹‰ä¸€ä¸ª string å’Œ int åˆ†åˆ«æŒ‡å‘ Name å’Œ Ageçš„åœ°å€ å¯¹äº u è¿™ä¸ªç»“æ„ä½“ï¼Œu çš„é¦–åœ°å€å°±æ˜¯ Name çš„åœ°å€ï¼Œä½†æ˜¯ u æ˜¯ç»“æ„ä½“æŒ‡é’ˆï¼Œæ‰€ä»¥åªéœ€è¦å°†uè½¬æ¢æˆ *string å³å¯ å¯¹äº Ageï¼Œæˆ‘ä»¬å·²ç»æ‹¿åˆ°äº†Nameçš„åœ°å€ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œåç§»å³å¯ï¼Œä¹Ÿå°±æ˜¯ unsafe.Offsetof(u.Age) çš„åç§»é‡ï¼Œ ä½†æ˜¯ Pointerä¸èƒ½è¿›è¡ŒæŒ‡é’ˆè¿ç®—ï¼Œéšæ„éœ€è¦å°† Pointer è½¬æ¢æˆ uintptr ","date":"2020-07-23","objectID":"/2020/golang-deep-learning-1-uintptr-and-unsafe.pointer/:3:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 1-uintptr å’Œ Unsafe.Pointer","uri":"/2020/golang-deep-learning-1-uintptr-and-unsafe.pointer/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. è¯´æ˜ è¿™é‡Œæœ‰ä¸¤ç‚¹è¦è¯´æ˜ã€‚ ç¬¬ä¸€ï¼Œç†è§£ unsafe.Pointer å’Œ uintptr æ˜¯å› ä¸º Go æºç ä¸­å¾ˆå¤šå®ç°éƒ½ä½¿ç”¨äº†è¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œæ¯”å¦‚æ¥å£ç±»å‹çš„å®šä¹‰ type iface struct { tab *itab data unsafe.Pointer } type itab struct { inter *interfacetype _type *_type hash uint32 _ [4]byte fun [1]uintptr } ç¬¬äºŒï¼Œä½¿ç”¨ unsafe.Pointer å’Œ uintptr è¦éå¸¸æ³¨æ„ï¼Œå› ä¸ºå®ƒä»¬ç»•è¿‡äº†ç±»å‹ç³»ç»Ÿç›´æ¥æ“ä½œå†…å­˜åœ°å€ã€‚ ","date":"2020-07-23","objectID":"/2020/golang-deep-learning-1-uintptr-and-unsafe.pointer/:4:0","tags":["Goè¯­æ³•"],"title":"Golangæ·±å…¥å­¦ä¹ 1-uintptr å’Œ Unsafe.Pointer","uri":"/2020/golang-deep-learning-1-uintptr-and-unsafe.pointer/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"éƒ¨ç½² Go åº”ç”¨ç›¸å¯¹ç®€å•ï¼Œå› ä¸ºæ‰€æœ‰åº”ç”¨ä»£ç éƒ½è¢«æ‰“åŒ…æˆä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶äº†ï¼ˆè§†å›¾æ¨¡æ¿ã€é™æ€èµ„æºå’Œé…ç½®æ–‡ä»¶ç­‰é Go ä»£ç é™¤å¤–ï¼‰ï¼Œå¹¶ä¸”ä¸éœ€è¦ä¾èµ–å…¶ä»–åº“ï¼Œä¸éœ€è¦é¢å¤–çš„è¿è¡Œæ—¶ç¯å¢ƒï¼ˆæ¯”å¦‚ Java éœ€è¦å†å®‰è£… JVMï¼‰ï¼Œä¹Ÿä¸éœ€è¦éƒ¨ç½²é¢å¤–çš„ HTTP æœåŠ¡å™¨ã€‚ å¯¹äºåœ¨çº¿è®ºå›é¡¹ç›®ï¼ŒåŒ…å«äº†é™æ€èµ„æºæ–‡ä»¶ï¼ˆCSSã€JavaScriptã€å›¾ç‰‡ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†åœ¨ Go Web åº”ç”¨ä¹‹å‰å‰ç½®ä¸€ä¸ª Nginx æœåŠ¡å™¨å¤„ç†é™æ€èµ„æºè¯·æ±‚ï¼Œç„¶åé€šè¿‡åå‘ä»£ç†å¤„ç†åŠ¨æ€èµ„æºè¯·æ±‚ï¼ˆæŒ‡å‘ Go å¤„ç†å™¨æ–¹æ³•çš„è¯·æ±‚ï¼‰ï¼Œå¯¹äºé‚£äº›ä¸åŒ…å«é™æ€èµ„æºå’Œè§†å›¾æ¨¡æ¿çš„çº¯ API é¡¹ç›®ï¼Œé€šå¸¸åªéœ€è¦æ‰“åŒ…ä¸€ä»½äºŒè¿›åˆ¶æ–‡ä»¶éƒ¨ç½²åˆ°æœåŠ¡å™¨å³å¯ï¼Œæ›´åŠ ä¾¿æ·ã€‚ æ³¨ï¼šå…¶å® Go åº”ç”¨éƒ¨ç½²çš„æœ€ä½³å®è·µæ˜¯åŸºäº Dockerï¼Œåç»­æˆ‘ä»¬åœ¨éƒ¨ç½²ä¸“é¢˜ä¸­å†ä»‹ç»å¦‚ä½•åŸºäº Docker å°†åº”ç”¨å¿«é€Ÿéƒ¨ç½²åˆ°è¿œç¨‹äº‘æœåŠ¡å™¨ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/:0:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›9-éƒ¨ç½²Go Webåº”ç”¨","uri":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. æ„å»ºåº”ç”¨ é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°é¡¹ç›®æ ¹ç›®å½•ä¸‹é€šè¿‡å¦‚ä¸‹å‘½ä»¤å°†åº”ç”¨ä»£ç æ‰“åŒ…æˆäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼š GOOS=linux GOARCH=amd64 go build æ³¨æ„è¿™é‡ŒæŒ‡å®šäº† GOOS å’Œ GOARCH é€‰é¡¹è¿›è¡Œäº¤å‰ç¼–è¯‘ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯åœ¨ Win10 ç³»ç»Ÿï¼ˆamd64ï¼‰ä¸­æ‰“åŒ…ï¼Œå¹¶ä¸”ç›®æ ‡äºŒè¿›åˆ¶æ–‡ä»¶éœ€è¦åœ¨ Linux æœåŠ¡å™¨ï¼ˆlinuxï¼‰æ‰§è¡Œã€‚è¯¥å‘½ä»¤æ‰§è¡ŒæˆåŠŸåä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆå’Œé¡¹ç›®åç§°ç›¸åŒçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š ç„¶åæˆ‘ä»¬å¯ä»¥å°†ä»£ç æäº¤åˆ° Github æˆ–è€…å…¶ä»–ä»£ç ä»“åº“ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/:1:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›9-éƒ¨ç½²Go Webåº”ç”¨","uri":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. éƒ¨ç½²åº”ç”¨ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/:2:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›9-éƒ¨ç½²Go Webåº”ç”¨","uri":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 éƒ¨ç½²ä»£ç  å†ç™»å½•æœåŠ¡å™¨åˆ°éƒ¨ç½²ç›®å½•ä¸‹æ‹‰å–ä»£ç ï¼š git clone https://github.com/nonfu/chitchat åˆæ¬¡æ‹‰å–ä½¿ç”¨ git cloneï¼Œåç»­åœ¨ chitchat ç›®å½•ä¸‹è¿è¡Œ git pull å³å¯ã€‚ ç„¶åæˆ‘ä»¬è¿›å…¥ chitchat ç›®å½•ï¼Œé…ç½® config.json è¿›è¡ŒæœåŠ¡ç«¯æ•°æ®åº“é…ç½®ï¼ˆæ­£å¼é¡¹ç›®ä¸è¦å°† config.json æäº¤åˆ°ä»£ç ä»“åº“ï¼Œä»¥å…å®‰å…¨é£é™©å’Œåç»­æ‹‰å–ä»£ç è¦†ç›–ï¼‰ï¼Œç¡®ä¿ logs ç›®å½•å¯¹ Web ç”¨æˆ·å…·æœ‰å†™æƒé™ï¼ˆæ¯”å¦‚é…ç½®æƒé™ä¸º 777ï¼Œæˆ–è€…æ‰€å±ç”¨æˆ·ä¸ Web ç”¨æˆ·ç»„ä¸€è‡´ï¼‰ã€‚ æ³¨ï¼šå½“ç„¶æˆ‘ä»¬è¿™é‡Œéƒ¨ç½²ä»£ç çš„æ–¹å¼æ¯”è¾ƒåŸå§‹ï¼Œå¯¹äºå¤šäººåä½œçš„å¤§å‹é¡¹ç›®ï¼Œå¯ä»¥å€ŸåŠ©æŒç»­é›†æˆå·¥å…·ï¼ˆæ¯”å¦‚ Jenkinsï¼‰è¿›è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œå¹¶ä¸”ç”±äºé¡¹ç›®æ¯”è¾ƒç®€å•ï¼Œå°±ä¸å†æ¼”ç¤ºå•å…ƒæµ‹è¯•ã€CI/CD ç­‰å…¶ä»– DevOps å·¥å…·çš„ä½¿ç”¨äº†ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/:2:1","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›9-éƒ¨ç½²Go Webåº”ç”¨","uri":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 æ•°æ®åº“åˆå§‹åŒ– åœ¨æœåŠ¡ç«¯ MySqL æ•°æ®åº“ä¸­åˆ›å»º chitchat æ•°æ®åº“ï¼Œå¹¶åˆå§‹åŒ–å¯¹åº”æ•°æ®è¡¨ã€‚å¦‚æœä¸äº†è§£å¦‚ä½•å®‰è£…å’Œåˆ›å»ºæ•°æ®åº“ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ•™ç¨‹ï¼šå°†åšå®¢åº”ç”¨è‡ªåŠ¨éƒ¨ç½²åˆ°çº¿ä¸ŠæœåŠ¡å™¨å®Œæ•´æµç¨‹è¯¦è§£ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/:2:2","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›9-éƒ¨ç½²Go Webåº”ç”¨","uri":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 è®¿é—®åº”ç”¨ å®Œæˆä»¥ä¸Šå·¥ä½œåï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ chitchat é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ chitchat äºŒè¿›åˆ¶æ–‡ä»¶å¯åŠ¨åº”ç”¨äº†ï¼š ç„¶åæˆ‘ä»¬åœ¨æœ¬åœ° hosts æ–‡ä»¶ä¸­è‡ªå®šä¹‰ä¸€ä¸ªæµ‹è¯•åŸŸåä¸æœåŠ¡å™¨ IP çš„æ˜ å°„ï¼š your-server-ip-address chitchat.test å°†ä¸Šè¿° your-server-ip-address æ›¿æ¢æˆè‡ªå·±çš„è¿œç¨‹æœåŠ¡å™¨ IP åœ°å€ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­é€šè¿‡ http://chitchat.test:8080 è®¿é—®åº”ç”¨äº†ï¼š ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/:2:3","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›9-éƒ¨ç½²Go Webåº”ç”¨","uri":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. é€šè¿‡ Nginx åšåå‘ä»£ç† è™½ç„¶ä¸Šè¿°æ–¹å¼å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯å¦‚æœè¦é«˜æ•ˆå¤„ç†é™æ€èµ„æºæ–‡ä»¶å¹¶å¯¹å…¶åšç¼“å­˜ï¼Œå¯ä»¥å€ŸåŠ© Nginx ä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨æ¥å®Œæˆï¼Œæˆ‘ä»¬åœ¨ Nginx è™šæ‹Ÿä¸»æœºé…ç½®ç›®å½• /etc/nginx/sites-available ä¸­æ–°å¢ä¸€ä¸ªé…ç½®æ–‡ä»¶ chitchat.confï¼ˆä»¥ Ubuntu æœåŠ¡å™¨ä¸ºä¾‹ï¼‰ï¼š server { listen 80; server_name chitchat.test www.chitchat.test; # é™æ€èµ„æºäº¤ç”± Nginx ç®¡ç†ï¼Œå¹¶ç¼“å­˜ä¸€å¤© location /static { root /var/www/chitchat/public; expires 1d; add_header Cache-Control public; access_log off; try_files $uri @goweb; } location / { try_files /_not_exists_ @goweb; } # åŠ¨æ€è¯·æ±‚é»˜è®¤é€šè¿‡ Go Web æœåŠ¡å™¨å¤„ç† location @goweb { proxy_set_header Host $http_host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Scheme $scheme; proxy_redirect off; proxy_pass http://127.0.0.1:8080; } error_log /var/log/nginx/chitchat_error.log; access_log /var/log/nginx/chitchat_access.log; } ç„¶åå†å¯ç”¨è¯¥é…ç½®æ–‡ä»¶ï¼š ln -s /etc/nginx/sites-available/chitchat /etc/nginx/sites-enabled/chitchat é‡å¯ Nginx æœåŠ¡ï¼š service nginx restart ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ chitchat/config.json ä¸­çš„ App é…ç½®é¡¹å¯åŠ¨ IP åœ°å€æ”¹ä¸º 127.0.0.1ï¼š \"App\": { \"Address\": \"127.0.0.1:8080\", \"Static\": \"public\", \"Log\": \"logs\", \"Locale\": \"locales\", \"Language\": \"zh\" }, å¹¶å†æ¬¡é‡å¯è¿™ä¸ª Go åº”ç”¨ï¼Œè¿™æ ·å°±åªèƒ½é€šè¿‡ Nginx è®¿é—®åº”ç”¨ï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—® http://chitchat.testï¼š è€Œå½“ä½ è¯•å›¾å†é€šè¿‡ http://chitchat.test:8080 è®¿é—®åº”ç”¨ï¼Œåˆ™ä¼šæŠ¥é”™ï¼š æˆ‘ä»¬å¯ä»¥æµ‹è¯•ä¸‹æ³¨å†Œç™»å½•åŠŸèƒ½ä»¥åŠåˆ›å»ºæ–°ç¾¤ç»„åŠŸèƒ½ï¼š ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/:3:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›9-éƒ¨ç½²Go Webåº”ç”¨","uri":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. é€šè¿‡ Supervisor ç»´æŠ¤åº”ç”¨å®ˆæŠ¤è¿›ç¨‹ çœ‹èµ·æ¥ä¸€åˆ‡éƒ½ OK äº†ï¼Œä½†æ˜¯ç›®å‰è¿™ç§æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·é€€å‡ºå Go Web åº”ç”¨è¿›ç¨‹ä¼šå…³é—­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œè€Œä¸”å¦‚æœ Go Web åº”ç”¨è¿›ç¨‹å› ä¸ºå…¶ä»–å¼‚å¸¸æŒ‚æ‰ï¼Œä¹Ÿæ— æ³•è‡ªåŠ¨é‡å¯ï¼Œæ¯æ¬¡éœ€è¦æˆ‘ä»¬ç™»å½•åˆ°æœåŠ¡å™¨è¿›è¡Œå¯åŠ¨æ“ä½œï¼Œè¿™å¾ˆä¸æ–¹ä¾¿ï¼Œä¹Ÿå½±å“åœ¨çº¿åº”ç”¨çš„ç¨³å®šæ€§ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©ç¬¬ä¸‰æ–¹è¿›ç¨‹ç›‘æ§å·¥å…·å¸®æˆ‘ä»¬å®ç° Go Web åº”ç”¨è¿›ç¨‹ä»¥åå°å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œã€‚å¸¸è§çš„è¿›ç¨‹ç›‘æ§å·¥å…·æœ‰ Supervisorã€Upstartã€systemd ç­‰ï¼Œç”±äºæˆ‘çš„æœåŠ¡å™¨ä¹‹å‰éƒ¨ç½²è¿‡ Supervisorï¼Œæ‰€ä»¥æˆ‘å°±å€ŸåŠ©å®ƒæ¥ç®¡ç† Go Web åº”ç”¨è¿›ç¨‹ã€‚ æ³¨ï¼šå¯¹ Supervisor å®‰è£…é…ç½®ä¸äº†è§£çš„åŒå­¦ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ•™ç¨‹ â€”â€” é˜Ÿåˆ—ç³»ç»Ÿè§£å†³æ–¹æ¡ˆï¼šHorizonã€‚ é¦–å…ˆåˆ›å»ºå¯¹åº”çš„ Supervisor é…ç½®æ–‡ä»¶ /etc/supervisor/conf.d/chitchat.confï¼Œè¿™é‡Œéœ€è¦è®¾ç½®è¿›ç¨‹å¯åŠ¨ç›®å½•åŠå‘½ä»¤ã€è¿›ç¨‹æ„å¤–æŒ‚æ‰åæ˜¯å¦è‡ªåŠ¨é‡å¯ã€ä»¥åŠæ—¥å¿—æ–‡ä»¶è·¯å¾„ç­‰ï¼š [program:chitchat] process_name=%(program_name)s directory=/var/www/chitchat command=/var/www/chitchat/chitchat autostart=true autorestart=true user=root redirect_stderr=true stdout_logfile=/var/www/chitchat/logs/chitchat.log æ³¨æ„ï¼šæˆ‘ä»¬éœ€è¦è¿›å…¥ chitchat æ‰€åœ¨ç›®å½•æ‰§è¡Œå¯åŠ¨å‘½ä»¤ï¼Œå¦åˆ™ä¼šæ‰¾ä¸åˆ°é…ç½®æ–‡ä»¶å’Œå…¶ä»–èµ„æºè·¯å¾„ï¼Œæ‰€ä»¥éœ€è¦é…ç½® directory é€‰é¡¹ã€‚ ç„¶åå…³é—­ä¹‹å‰é€šè¿‡æ‰‹åŠ¨è¿è¡Œ chitchat å¯åŠ¨çš„ Go Web æœåŠ¡å™¨ï¼Œå†è¿è¡Œå¦‚ä¸‹æŒ‡ä»¤é€šè¿‡ Supervisor å¯åŠ¨å¹¶ç»´æŠ¤ Go Web åº”ç”¨è¿›ç¨‹ï¼š supervisorctl reread supervisorctl update supervisorctl start chitchat ä½ å¯ä»¥é€šè¿‡ ps -ef | grep chitchat æŸ¥çœ‹è¿›ç¨‹æ˜¯å¦å¯åŠ¨æˆåŠŸï¼š å¯åŠ¨æˆåŠŸåï¼Œå°±å¯ä»¥åœ¨æµè§ˆå™¨é€šè¿‡ http://chitchat.test è®¿é—®éƒ¨ç½²åœ¨è¿œç¨‹æœåŠ¡å™¨çš„åœ¨çº¿è®ºå›äº†ï¼š å¹¶ä¸”æ— è®ºæ˜¯å¦é€€å‡ºè¿œç¨‹æœåŠ¡å™¨è¿˜æ˜¯å…³é—­ Go Web åº”ç”¨è¿›ç¨‹ï¼Œéƒ½ä¸ä¼šå½±å“åœ¨çº¿è®ºå›çš„è®¿é—®ï¼Œå› ä¸ºå®ƒæ˜¯ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œçš„ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å…³é—­åè‡ªåŠ¨é‡å¯ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/:4:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›9-éƒ¨ç½²Go Webåº”ç”¨","uri":"/2020/development-of-online-forum-based-on-golang-9-deploy-go-web-application/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"ç”±äºä¹‹å‰æ‰€æœ‰é¡µé¢å’Œæ¶ˆæ¯æ–‡æœ¬éƒ½æ˜¯è‹±æ–‡çš„ï¼Œè€Œæˆ‘ä»¬å¼€å‘çš„åº”ç”¨åŸºæœ¬éƒ½æ˜¯é¢å‘ä¸­æ–‡ç”¨æˆ·çš„ï¼Œæ‰€ä»¥éœ€è¦å¯¹é¡¹ç›®è¿›è¡Œæœ¬åœ°åŒ–ï¼Œå› æ­¤æœ¬ç¯‡ä»‹ç»å¦‚ä½•åœ¨ Go Web åº”ç”¨ä¸­è¿›è¡Œå›½é™…åŒ–å’Œæœ¬åœ°åŒ–ç¼–ç¨‹ï¼Œç”±äºé¡¹ç›®æ¯”è¾ƒç®€å•ï¼Œåªä»‹ç»æ¶ˆæ¯æç¤ºã€è§†å›¾æ¨¡æ¿å’Œæ—¥æœŸæ ¼å¼çš„æœ¬åœ°åŒ–ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:0:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. æ¶ˆæ¯æœ¬åœ°åŒ– ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:1:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.1 å®‰è£… go-i18n æ‰©å±•åŒ… é¦–å…ˆæ¥çœ‹æ¶ˆæ¯æç¤ºæ–‡æœ¬ï¼Œæ¶ˆæ¯æç¤ºæ–‡æœ¬é€šå¸¸åŒ…æ‹¬è¡¨å•éªŒè¯æ¶ˆæ¯ã€åº”ç”¨å¼‚å¸¸æ¶ˆæ¯ã€æ¥å£å“åº”æ¶ˆæ¯ç­‰åç«¯æ¥å£è¿”å›çš„æ¶ˆæ¯å­—ç¬¦ä¸²ç‰‡æ®µï¼Œå…³äºè¿™ä¸€å—çš„æœ¬åœ°åŒ–ï¼Œå¯ä»¥å€ŸåŠ© Go å®˜æ–¹è‡ªå¸¦çš„ golang.org/x/text æ‰©å±•åŒ…å®ç°ï¼Œè¿™ä¸ªæ‰©å±•åŒ…æ‰©å±•æ€§å¥½ï¼Œä½†æ˜¯ä¸Šæ‰‹èµ·æ¥æœ‰ç‚¹å¤æ‚ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ä¸€æ¬¾æ›´å®¹æ˜“ä¸Šæ‰‹çš„ç¬¬ä¸‰æ–¹æ‰©å±•åŒ… â€”â€” go-i18nã€‚ åœ¨ä½¿ç”¨è¿™ä¸ªæ‰©å±•åŒ…ä¹‹å‰ï¼Œå…ˆåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œå¦‚ä¸‹å‘½ä»¤ä¸‹è½½ç›¸å…³çš„æ‰©å±•åŒ…ï¼š go get -u github.com/nicksnyder/go-i18n/v2/i18n go get -u github.com/nicksnyder/go-i18n/v2/goi18n ä¸‹è½½å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œ goi18n -help ç¡®ä¿ goi18n å‘½ä»¤å¯æ‰§è¡Œ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:1:1","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.2 é€šè¿‡ go-i18n è‡ªåŠ¨ç”Ÿæˆç¿»è¯‘æ–‡ä»¶ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥ç¼–å†™æ¶ˆæ¯æ–‡æœ¬æ¨¡æ¿ç”¨äºç”Ÿæˆç¿»è¯‘æ–‡ä»¶ã€‚åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œåªæœ‰ä¸€ä¸ªæ¶ˆæ¯æç¤ºæ–‡æœ¬ï¼Œé‚£å°±æ˜¯è®¿é—®çš„ç¾¤ç»„ä¸å­˜åœ¨æ—¶è¿”å›çš„ Cannot read threadï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º messages.goï¼Œå¹¶åŸºäº go-i18n æä¾›çš„ç±»å‹ç¼–å†™æ¶ˆæ¯æ¨¡æ¿å¦‚ä¸‹ï¼š package main import \"github.com/nicksnyder/go-i18n/v2/i18n\" var messages = []i18n.Message{ { ID: \"thread_not_found\", Description: \"Thread not exists in db\", Other: \"Cannot read thread\", }, } å…¶ä¸­ ID æ˜¯æ¶ˆæ¯æ–‡æœ¬çš„å”¯ä¸€æ ‡è¯†ï¼ŒOther åˆ™æ˜¯å¯¹åº”çš„ç¿»è¯‘å­—ç¬¦ä¸²ï¼ˆé»˜è®¤æ˜¯è‹±æ–‡ï¼‰ï¼Œç„¶ååŸºäº goi18n å‘½ä»¤è‡ªåŠ¨ç”Ÿæˆç¿»è¯‘æ–‡ä»¶åˆ° locales ç›®å½•ï¼ˆæ‰§è¡Œå‰å…ˆåˆ›å»º locales ç›®å½•ï¼‰ï¼š mkdir locales goi18n extract -outdir=locales -format=json messages.go è¿™æ ·ï¼Œå°±ä¼šåœ¨ locales ç›®å½•ä¸‹ç”Ÿæˆå¯ä»¥è¢« go-i18n åŒ…è¯†åˆ«å¹¶è§£æçš„ JSON æ ¼å¼ç¿»è¯‘æ–‡ä»¶ active.en.jsonï¼š ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:1:2","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.3 ç¼–å†™ä¸­æ–‡ç‰ˆæœ¬ç¿»è¯‘æ–‡ä»¶ ç„¶åï¼Œè¦è¿›è¡Œæœ¬åœ°åŒ–ç¼–ç¨‹ï¼Œå¯ä»¥åœ¨åŒçº§ç›®å½•ä¸‹åˆ›å»ºå¹¶ç¼–è¾‘ active.zh.json ç”¨äºå­˜æ”¾æ¶ˆæ¯æ–‡æœ¬çš„ä¸­æ–‡ç¿»è¯‘ï¼š ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:1:3","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.4 æœ¬åœ°åŒ–é…ç½®åˆå§‹åŒ– å›åˆ°åœ¨åœ¨çº¿è®ºå›é¡¹ç›®ï¼Œæ‰“å¼€é…ç½®æ–‡ä»¶ config.jsonï¼Œæ–°å¢æœ¬åœ°åŒ–ç›®å½•å’Œè¯­è¨€é…ç½®ï¼š { \"App\": { ... \"Locale\": \"locales\", \"Language\": \"zh\" }, ... } ç„¶ååœ¨ config/config.go ä¸­æ–°å¢ä¸ä¹‹æ˜ å°„çš„ç»“æ„ä½“å­—æ®µï¼Œä»¥åŠå¯¹åº”çš„åˆå§‹åŒ–è®¾ç½®ï¼š package config import ( \"encoding/json\" \"github.com/nicksnyder/go-i18n/v2/i18n\" \"golang.org/x/text/language\" \"log\" \"os\" \"sync\" ) type App struct { ... Locale string Language string } ... type Configuration struct { App App Db Database LocaleBundle *i18n.Bundle } var config *Configuration var once sync.Once // é€šè¿‡å•ä¾‹æ¨¡å¼åˆå§‹åŒ–å…¨å±€é…ç½® func LoadConfig() *Configuration { once.Do(func() { file, err := os.Open(\"config.json\") if err != nil { log.Fatalln(\"Cannot open config file\", err) } decoder := json.NewDecoder(file) config = \u0026Configuration{} err = decoder.Decode(config) if err != nil { log.Fatalln(\"Cannot get configuration from file\", err) } // æœ¬åœ°åŒ–åˆå§‹è®¾ç½® bundle := i18n.NewBundle(language.English) bundle.RegisterUnmarshalFunc(\"json\", json.Unmarshal) bundle.MustLoadMessageFile(config.App.Locale + \"/active.en.json\") bundle.MustLoadMessageFile(config.App.Locale + \"/active.\" + config.App.Language + \".json\") config.LocaleBundle = bundle }) return config } æ³¨æ„æˆ‘ä»¬åœ¨ App ç»“æ„ä½“ä¸­æ–°å¢äº†ä¸€ä¸ª *i18n.Bundle ç±»å‹çš„ LocaleBundle å­—æ®µï¼Œç”¨äºå­˜æ”¾å…¨å±€æœ¬åœ°åŒ– Bundle å®ä¾‹ï¼Œå¹¶ä¸”åœ¨ LoadConfig() æ–¹æ³•ä¸­ä»¥å•ä¾‹æ¨¡å¼åˆå§‹åŒ–è¯¥å®ä¾‹ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:1:4","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.5 åœ¨å¤„ç†å™¨æ–¹æ³•ä¸­è¿”å›æœ¬åœ°åŒ–æ¶ˆæ¯ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ‰“å¼€ handlers/helper.goï¼Œåœ¨ init æ–¹æ³•ä¸­åˆå§‹åŒ– Localizer ä»¥ä¾¿è¢«æ‰€æœ‰å¤„ç†å™¨æ–¹æ³•ä½¿ç”¨ï¼š package handlers import ( ... \"github.com/nicksnyder/go-i18n/v2/i18n\" . \"github.com/xueyuanjun/chitchat/config\" ) var logger *log.Logger var config *Configuration var localizer *i18n.Localizer func init() { // è·å–å…¨å±€é…ç½®å®ä¾‹ config = LoadConfig() // è·å–æœ¬åœ°åŒ–å®ä¾‹ localizer = i18n.NewLocalizer(config.LocaleBundle, config.App.Language) ... } ... æœ€ååœ¨ handlers/thread.go å’Œ handlers/post.go ä¸­è°ƒç”¨ errorMessage è¾…åŠ©å‡½æ•°çš„åœ°æ–¹è°ƒç”¨ Localizer æä¾›çš„æ–¹æ³•å¯¹æ¶ˆæ¯æ–‡æœ¬è¿›è¡Œç¿»è¯‘å¹¶è¿”å›ç»™ç”¨æˆ·ï¼š if err != nil { msg := localizer.MustLocalize(\u0026i18n.LocalizeConfig{ MessageID: \"thread_not_found\", }) errorMessage(writer, request, msg) } else { ... } ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:1:5","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.6 æµ‹è¯•æ¶ˆæ¯æœ¬åœ°åŒ– é‡æ–°å¯åŠ¨åº”ç”¨ï¼Œå¦‚æœè¯•å›¾è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„ç¾¤ç»„é¡µé¢ï¼Œå°±ä¼šè¿”å›å¦‚ä¸‹ä¸­æ–‡æç¤ºä¿¡æ¯ï¼š è¯´æ˜æˆ‘ä»¬çš„æœ¬åœ°åŒ–ç¿»è¯‘ç”Ÿæ•ˆäº†ï¼Œå½“ç„¶è¿™é‡Œåªæ˜¯ä½¿ç”¨äº† go-i18n æä¾›çš„æœ€åŸºæœ¬çš„åŠŸèƒ½ï¼Œæƒ³è¦äº†è§£æ›´å¤šä½¿ç”¨ç¤ºä¾‹ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹é“¾æ¥ï¼š å®˜æ–¹æ–‡æ¡£ å€ŸåŠ© go-i18n æ›´ç®€å•åœ°å®ç°å…¨çƒåŒ– ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:1:6","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. è§†å›¾æœ¬åœ°åŒ– æ‰€è°“è§†å›¾æœ¬åœ°åŒ–æŒ‡çš„æ˜¯é™æ€ HTML è§†å›¾æ¨¡æ¿çš„æœ¬åœ°åŒ–ï¼Œè¿™é‡Œå°±ä¸å†é€‚åˆä½¿ç”¨æ¶ˆæ¯æ–‡æœ¬ç¿»è¯‘çš„æ–¹å¼å®ç°äº†ï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ä¸ºæ¯ä¸ªè¯­è¨€åˆ›å»ºç‹¬ç«‹çš„è§†å›¾æ¨¡æ¿è¿›è¡Œæœ¬åœ°åŒ–ï¼Œç„¶ååœ¨åº”ç”¨ä»£ç ä¸­é€šè¿‡è¯»å–å…¨å±€é…ç½®ã€ç”¨æˆ·æ‰‹åŠ¨é€‰æ‹©ã€å®¢æˆ·ç«¯å‚æ•°ï¼ˆæ¯”å¦‚ HTML è¯·æ±‚å¤´ä¸­çš„ Accept-Language å­—æ®µï¼‰ã€æˆ–è€…åŸŸåä¿¡æ¯æ¥åˆ¤æ–­åŠ è½½é‚£ç§æœ¬åœ°åŒ–è§†å›¾æ¨¡æ¿ï¼Œä¸ºäº†ç®€åŒ–æ¼”ç¤ºæµç¨‹ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å…¨å±€é…ç½®çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸Šé¢é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„ Language å­—æ®µã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:2:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 åˆ›å»ºæœ¬åœ°åŒ–è§†å›¾æ¨¡æ¿ é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ views ç›®å½•ä¸‹æ–°å¢ en å’Œ zh ä¸¤ä¸ªå­ç›®å½•ï¼Œåˆ†åˆ«ç”¨äºå­˜æ”¾è‹±æ–‡è§†å›¾æ¨¡æ¿å’Œä¸­æ–‡è§†å›¾æ¨¡æ¿ï¼Œç„¶åå°†åŸæœ‰è§†å›¾æ–‡ä»¶ç§»åŠ¨åˆ° en ç›®å½•ä¸‹ï¼Œå¹¶ä¸”åœ¨ zh ç›®å½•ä¸‹åˆ›å»ºæ¯ä¸ªè§†å›¾æ¨¡æ¿çš„ä¸­æ–‡ç‰ˆæœ¬ï¼Œä»¥é¦–é¡µ index.html ä¸ºä¾‹ï¼Œå¯¹åº”çš„ä¸­æ–‡ç‰ˆæœ¬å¦‚ä¸‹ï¼š å…¶ä»–ä¸­æ–‡è§†å›¾æ¨¡æ¿ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œå°†å…¶ä¸­çš„è‹±æ–‡æ–‡æœ¬ç»Ÿä¸€ç¿»è¯‘æˆä¸­æ–‡å³å¯ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:2:1","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 é€šè¿‡é…ç½®åŠ è½½æœ¬åœ°åŒ–è§†å›¾ æ‰“å¼€ handlers/helper.goï¼Œåœ¨ generateHTML æ–¹æ³•ä¸­é€šè¿‡è¯»å–å…¨å±€é…ç½®åŠ è½½å¯¹åº”çš„æœ¬åœ°åŒ–è§†å›¾æ¨¡æ¿ï¼š func generateHTML(writer http.ResponseWriter, data interface{}, filenames ...string) { var files []string for _, file := range filenames { files = append(files, fmt.Sprintf(\"views/%s/%s.html\", config.App.Language, file)) } templates := template.Must(template.ParseFiles(files...)) templates.ExecuteTemplate(writer, \"layout\", data) } éå¸¸ç®€å•ï¼Œä¸å†èµ˜è¿°ã€‚ æ³¨ï¼šåŒæ—¶ç§»é™¤ parseTemplateFiles æ–¹æ³•ï¼Œå¹¶å°†è°ƒç”¨è¯¥æ–¹æ³•çš„åœ°æ–¹è°ƒæ•´ä¸ºè°ƒç”¨ generateHTML ä»¥é¿å…ç»´æŠ¤ä¸¤ä¸ªåœ°æ–¹ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:2:2","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 æµ‹è¯•è§†å›¾æœ¬åœ°åŒ– é‡å¯åº”ç”¨ï¼Œè®¿é—®é¦–é¡µï¼Œå³å¯çœ‹åˆ°é¡µé¢è§†å›¾å·²ç»éƒ½æ˜¯ä¸­æ–‡æ˜¾ç¤ºäº†ï¼š ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:2:3","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. æ—¥æœŸæ—¶é—´æœ¬åœ°åŒ– çœ‹èµ·æ¥éƒ½å·²ç» OK äº†ï¼Œä¸è¿‡è¿˜æœ‰ä¸ªå°é—®é¢˜ï¼Œé‚£å°±æ˜¯æ—¥æœŸæ—¶é—´æ˜¾ç¤ºè¿˜æ˜¯è‹±æ–‡é£æ ¼çš„ï¼Œå¯¹åº”çš„å®ç°ä»£ç åœ¨ models/thread.go ä¸­ï¼š func (thread *Thread) CreatedAtDate() string { return thread.CreatedAt.Format(\"Jan 2, 2006 at 3:04pm\") } æˆ‘ä»¬å½“ç„¶å¯ä»¥ç›´æ¥ä¿®æ”¹è¿™é‡Œæ¥å®ç°ç±»ä¼¼ 2006-01-02 15:04:05 çš„æ—¥æœŸæ—¶é—´æ ¼å¼ï¼ˆè¯¥æ—¶é—´èŠ‚ç‚¹æ˜¯ Go è¯­è¨€å…ƒå¹´ï¼‰ï¼Œä¸è¿‡ï¼Œå­¦é™¢å›è¿™é‡Œæ¢ä¸€ç§å¤æ‚ä¸€ç‚¹çš„å®ç°ï¼Œä»¥ä¾¿é¡ºæ‰‹ä»‹ç»ä¸‹å¦‚ä½•åœ¨ Go è§†å›¾æ¨¡æ¿ä¸­é€šè¿‡ç®¡é“æ¨¡å¼è°ƒç”¨è‡ªå®šä¹‰å‡½æ•°ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:3:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.1 å°†è‡ªå®šä¹‰å‡½æ•°åº”ç”¨åˆ°è§†å›¾æ¨¡æ¿ æ‰“å¼€ handlers/helper.goï¼Œæ–°å¢ä¸€ä¸ªæ ¼å¼åŒ–æ—¥æœŸæ—¶é—´çš„å‡½æ•° formatDateï¼Œç„¶ååœ¨ generateHTML æ–¹æ³•ä¸­å°†è¿™ä¸ªå‡½æ•°é€šè¿‡ template.FuncMap ç»„è£…åå†é€šè¿‡ Funcs æ–¹æ³•åº”ç”¨åˆ°è§†å›¾æ¨¡æ¿ä¸­ï¼Œè¿™æ ·ï¼Œå°±å¯ä»¥åœ¨æ‰€æœ‰è§†å›¾æ¨¡æ¿ä¸­é€šè¿‡ fdate åˆ«åæ¥è°ƒç”¨ formatDate å‡½æ•°äº†ï¼š // ç”Ÿæˆ HTML æ¨¡æ¿ func generateHTML(writer http.ResponseWriter, data interface{}, filenames ...string) { var files []string for _, file := range filenames { files = append(files, fmt.Sprintf(\"views/%s/%s.html\", config.App.Language, file)) } funcMap := template.FuncMap{\"fdate\": formatDate} t := template.New(\"layout\").Funcs(funcMap) templates := template.Must(t.ParseFiles(files...)) templates.ExecuteTemplate(writer, \"layout\", data) } ... // æ—¥æœŸæ ¼å¼åŒ–è¾…åŠ©å‡½æ•° func formatDate(t time.Time) string { datetime := \"2006-01-02 15:04:05\" return t.Format(datetime) } ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:3:1","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.2 è°ƒç”¨è‡ªå®šä¹‰å‡½æ•°æ ¼å¼åŒ–æœ¬åœ°æ—¥æœŸæ—¶é—´ ç„¶åæˆ‘ä»¬åœ¨æ‰€æœ‰è§†å›¾æ–‡ä»¶ä¸­å°†ç¾¤ç»„åˆ›å»ºæ—¥æœŸæ¸²æŸ“è°ƒæ•´ä¸ºå¦‚ä¸‹æ–¹å¼ï¼Œå³é€šè¿‡ç®¡é“è¿æ¥ç¬¦çš„æ–¹å¼å°† .CreatedAt å˜é‡ä½œä¸ºå‚æ•°ä¼ å…¥ fdate å¹¶è¾“å‡ºè¿”å›å€¼ï¼š {{ .CreatedAt | fdate }} æ³¨æ„è¿™é‡Œä¸€å®šè¦ä½¿ç”¨ .CreatedAtï¼Œè¿™ä¸ªå˜é‡æ‰æ˜¯ time.Time ç±»å‹ï¼Œè€Œ .CreatedAtDate æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚ å†æ¬¡é‡æ–°å¯åŠ¨åº”ç”¨ï¼Œè®¿é—®é¦–é¡µå’Œç¾¤ç»„è¯¦æƒ…é¡µå°±å¯ä»¥çœ‹åˆ°æ ¼å¼åŒ–åçš„æœ¬åœ°æ—¥æœŸæ—¶é—´æ ¼å¼äº†ï¼š ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/:3:2","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›8-æ¶ˆæ¯ã€è§†å›¾å’Œæ—¥æœŸæ—¶é—´æœ¬åœ°åŒ–","uri":"/2020/development-of-online-forum-based-on-golang-8-message-view-and-date-time-localizationsingleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æœ¬æ–‡ä»‹ç»å¦‚ä½•å°†æ•æ„Ÿä¿¡æ¯æˆ–å¯å˜ä¿¡æ¯é€šè¿‡é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®ï¼Œç„¶ååœ¨åº”ç”¨ä¸­è¯»å–è¿™äº›é…ç½®æ–‡ä»¶æ¥è·å–é…ç½®ä¿¡æ¯ã€‚ å°†æ•æ„Ÿä¿¡æ¯é€šè¿‡é…ç½®æ–‡ä»¶è¯»å–æ˜¯ä¸ºäº†é¿å…éšç€ä»£ç æäº¤åˆ°å…¬å¼€åº“é€ æˆæ•æ„Ÿä¿¡æ¯çš„æ³„éœ²ï¼Œç»™çº¿ä¸Šç¯å¢ƒå¸¦æ¥å®‰å…¨éšæ‚£ï¼Œè¿™äº›æ•æ„Ÿä¿¡æ¯åŒ…æ‹¬æ•°æ®åº“è¿æ¥ä¿¡æ¯ã€ç¬¬ä¸‰æ–¹ SDK ï¼ˆæ¯”å¦‚å¾®ä¿¡ã€æ”¯ä»˜å®ã€Githubï¼‰çš„å¯†é’¥ç­‰ã€‚ å°†å¯å˜ä¿¡æ¯é€šè¿‡é…ç½®æ–‡ä»¶è¯»å–æ˜¯ä¸ºäº†é¿å…ç¡¬ç¼–ç ï¼Œå°†ç»å¸¸å˜åŠ¨çš„ä¿¡æ¯é€šè¿‡é…ç½®æ–‡ä»¶é…ç½®å¯ä»¥æå¤§çš„æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§ï¼Œè¿™äº›å¯å˜ä¿¡æ¯é€šå¸¸åŒ…æ‹¬åº”ç”¨æœåŠ¡å™¨ç›‘å¬çš„åœ°å€å’Œç«¯å£ã€ç›®å½•è·¯å¾„è®¾ç½®ã€å½“å‰è¿è¡Œç¯å¢ƒã€è¶…æ—¶æ—¶é—´ç­‰ã€‚ ä½¿ç”¨å…¬å¼€åº“æ—¶ï¼Œå¦‚ githubï¼Œé…ç½®æ–‡ä»¶éœ€è¦å†™å…¥ .gitignore æ–‡ä»¶ä»è€Œé¿å…æäº¤åˆ°çº¿ä¸Šã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-7-get-global-configuration-through-singleton-mode/:0:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›7-é€šè¿‡å•ä¾‹æ¨¡å¼è·å–å…¨å±€é…ç½®","uri":"/2020/development-of-online-forum-based-on-golang-7-get-global-configuration-through-singleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. å®šä¹‰å…¨å±€é…ç½®æ–‡ä»¶ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸ºåœ¨çº¿è®ºå›é¡¹ç›®è®¾ç½®é…ç½®æ–‡ä»¶ config.jsonï¼Œå°†ä¸€äº›æ•æ„Ÿä¿¡æ¯å’Œå¯å˜ä¿¡æ¯æäº¤åˆ° JSON é…ç½®æ–‡ä»¶ä¸­ { \"App\": { \"Address\": \"0.0.0.0:8080\", \"Static\": \"public\", \"Log\": \"logs\" }, \"Db\": { \"Driver\": \"mysql\", \"Address\": \"localhost:3306\", \"Database\": \"chitchat\", \"User\": \"root\", \"Password\": \"root\" } } åº”ç”¨ç›¸å…³çš„å¯å˜ä¿¡æ¯é…ç½®åˆ° app é…ç½®é¡¹ï¼Œæ•°æ®åº“ç›¸å…³çš„æ•æ„Ÿä¿¡æ¯é…ç½®åˆ° Db é…ç½®é¡¹ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-7-get-global-configuration-through-singleton-mode/:1:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›7-é€šè¿‡å•ä¾‹æ¨¡å¼è·å–å…¨å±€é…ç½®","uri":"/2020/development-of-online-forum-based-on-golang-7-get-global-configuration-through-singleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. é€šè¿‡å•ä¾‹æ¨¡å¼åˆå§‹åŒ–å…¨å±€é…ç½® åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»º config ç›®å½•ï¼Œç„¶ååœ¨è¯¥ç›®å½•ä¸‹æ–°å¢ config.go ç”¨æ¥å­˜æ”¾é…ç½®åˆå§‹åŒ–ä»£ç  package config import ( \"encoding/json\" \"log\" \"os\" \"sync\" ) type App struct { Address string Static string Log string } type Database struct { Driver string Address string Database string User string Password string } type Configuration struct { App App Db Database } var config *Configuration var once sync.Once // é€šè¿‡å•ä¾‹æ¨¡å¼åˆå§‹åŒ–å…¨å±€é…ç½® func LoadConfig() *Configuration { once.Do(func() { file, err := os.Open(\"config.json\") if err != nil { log.Fatalln(\"Cannot open config file\", err) } decoder := json.NewDecoder(file) config = \u0026Configuration{} err = decoder.Decode(config) if err != nil { log.Fatalln(\"Cannot get configuration from file\", err) } }) return config } å®šä¹‰ Configuration ç»“æ„ä½“ä»¥ä¾¿å’Œå…¨å±€é…ç½®æ–‡ä»¶ config.json å­—æ®µè¿›è¡Œæ˜ å°„ï¼Œæ³¨æ„è¿™é‡Œçš„é¦–å­—æ¯éƒ½éœ€è¦å¤§å†™ å®šä¹‰ä¸€ä¸ª LoadConfig æ–¹æ³•ä»¥å•ä¾‹æ¨¡å¼è¿”å›å…¨å±€é…ç½®å®ä¾‹çš„æŒ‡é’ˆï¼Œè¿™é‡Œä½¿ç”¨å•ä¾‹çš„åŸå› æ˜¯å› ä¸ºåº”ç”¨ä»£ç ä¸­å¯èƒ½å¤šå¤„éƒ½è¦è·å–é…ç½®å€¼ï¼Œé‡å¤åŠ è½½é…ç½®æ–‡ä»¶è¿›è¡Œ JSON è§£ç å­˜åœ¨æ€§èƒ½æŸè€—ï¼ˆå½“ç„¶ï¼Œå®šä¹‰ init æ–¹æ³•æœ¬èº«å°±å¯ä»¥æ”¯æŒå…¨å±€è¿è¡Œä¸€æ¬¡ï¼Œè¿™é‡Œä¸»è¦æ¼”ç¤ºä¸‹å•ä¾‹æ¨¡å¼å¦‚ä½•å®ç°ï¼‰ã€‚åœ¨ Go è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©å¹¶å‘ç¼–ç¨‹ä¸­çš„ sync.Once ç±»å‹æ¥å®ç°å•ä¾‹æ¨¡å¼ï¼Œä¿è¯å¹¶å‘å®‰å…¨ï¼Œåœ¨ once.Do ä¸­å®šä¹‰çš„åŒ¿åå‡½æ•°å…¨å±€åªä¼šæ‰§è¡Œä¸€æ¬¡ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-7-get-global-configuration-through-singleton-mode/:2:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›7-é€šè¿‡å•ä¾‹æ¨¡å¼è·å–å…¨å±€é…ç½®","uri":"/2020/development-of-online-forum-based-on-golang-7-get-global-configuration-through-singleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. é¡¹ç›®ä»£ç é‡æ„ æœ€åï¼Œæˆ‘ä»¬å°†é¡¹ç›®ä»£ç ä¸­ç›¸åº”ä½ç½®çš„ç¡¬ç¼–ç è°ƒæ•´ä¸ºé€šè¿‡ä¸Šé¢æ–¹æ³•è¿”å›çš„å…¨å±€é…ç½®å®ä¾‹è·å–é…ç½®å€¼ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-7-get-global-configuration-through-singleton-mode/:3:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›7-é€šè¿‡å•ä¾‹æ¨¡å¼è·å–å…¨å±€é…ç½®","uri":"/2020/development-of-online-forum-based-on-golang-7-get-global-configuration-through-singleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.1 Web æœåŠ¡å™¨å¯åŠ¨å‚æ•° é¦–å…ˆéœ€è¦åœ¨ main.go çš„å…¥å£ä½ç½®åˆå§‹åŒ–å…¨å±€é…ç½® package main import ( . \"github.com/xueyuanjun/chitchat/config\" . \"github.com/xueyuanjun/chitchat/routes\" \"log\" \"net/http\" ) func main() { startWebServer() } // é€šè¿‡æŒ‡å®šç«¯å£å¯åŠ¨ Web æœåŠ¡å™¨ func startWebServer() { // åœ¨å…¥å£ä½ç½®åˆå§‹åŒ–å…¨å±€é…ç½® config := LoadConfig() r := NewRouter() // é€šè¿‡ router.go ä¸­å®šä¹‰çš„è·¯ç”±å™¨æ¥åˆ†å‘è¯·æ±‚ // å¤„ç†é™æ€èµ„æºæ–‡ä»¶ assets := http.FileServer(http.Dir(config.App.Static)) r.PathPrefix(\"/static/\").Handler(http.StripPrefix(\"/static/\", assets)) http.Handle(\"/\", r) log.Println(\"Starting HTTP service at \" + config.App.Address) err := http.ListenAndServe(config.App.Address, nil) if err != nil { log.Println(\"An error occured starting HTTP listener at \" + config.App.Address) log.Println(\"Error: \" + err.Error()) } } æˆ‘ä»¬åœ¨ startWebServer æ–¹æ³•çš„å…¥å£ä½ç½®åˆå§‹åŒ–å…¨å±€é…ç½®ï¼Œå¹¶ä¸”å…¨å±€é…ç½®å®ä¾‹åªåœ¨è¿™é‡Œè¿›è¡Œä¸€æ¬¡åˆå§‹åŒ–ï¼Œåç»­ä¸ä¼šå†æ‰§è¡ŒåŠ è½½é…ç½®æ–‡ä»¶å’Œ JSON è§£ç æ“ä½œï¼Œè€Œæ˜¯ç›´æ¥è¿”å›å¯¹åº”çš„ config å®ä¾‹ï¼š config := LoadConfig() ç„¶åå°† Web æœåŠ¡å™¨çš„å¯åŠ¨å‚æ•°å’Œé™æ€èµ„æºç›®å½•éƒ½è°ƒæ•´ä¸ºé€šè¿‡é…ç½®å€¼è·å–ï¼Œè¿™æ ·æˆ‘ä»¬åç»­åªéœ€è¦æ›´æ”¹é…ç½®æ–‡ä»¶å³å¯å¯¹å…¶è¿›è¡Œè°ƒæ•´ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä»£ç ï¼Œé™ä½äº†ä»£ç ç»´æŠ¤æˆæœ¬ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-7-get-global-configuration-through-singleton-mode/:3:1","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›7-é€šè¿‡å•ä¾‹æ¨¡å¼è·å–å…¨å±€é…ç½®","uri":"/2020/development-of-online-forum-based-on-golang-7-get-global-configuration-through-singleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.2 æ•°æ®åº“è¿æ¥é…ç½® æ¥ä¸‹æ¥ï¼Œæ‰“å¼€ models/db.goï¼Œå°†æ•°æ®åº“è¿æ¥ä¿¡æ¯è°ƒæ•´ä¸ºé€šè¿‡é…ç½®æ–‡ä»¶è¯»å–ï¼š package models import ( \"crypto/rand\" \"crypto/sha1\" \"database/sql\" \"fmt\" _ \"github.com/go-sql-driver/mysql\" . \"github.com/xueyuanjun/chitchat/config\" \"log\" ) var Db *sql.DB func init() { var err error config := LoadConfig() // åŠ è½½å…¨å±€é…ç½®å®ä¾‹ driver := config.Db.Driver source := fmt.Sprintf(\"%s:%s@(%s)/%s?charset=utf8\u0026parseTime=true\", config.Db.User, config.Db.Password, config.Db.Address, config.Db.Database) Db, err = sql.Open(driver, source) if err != nil { log.Fatal(err) } return } è™½ç„¶ï¼Œåœ¨è¿™é‡Œé¡µè°ƒç”¨äº† LoadConfig()ï¼Œä½†æ˜¯ç”±äºæ˜¯å•ä¾‹æ¨¡å¼ï¼Œæ‰€ä»¥ä¼šç›´æ¥è¿”å› config å®ä¾‹ï¼Œä¸ä¼šå†è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œç„¶åæˆ‘ä»¬è·å–é…ç½®å€¼å¡«å……å¯¹åº”çš„ sql.Open è¿æ¥é…ç½®ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-7-get-global-configuration-through-singleton-mode/:3:2","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›7-é€šè¿‡å•ä¾‹æ¨¡å¼è·å–å…¨å±€é…ç½®","uri":"/2020/development-of-online-forum-based-on-golang-7-get-global-configuration-through-singleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. æ•´ä½“æµ‹è¯• è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†é€šè¿‡é…ç½®æ–‡ä»¶è¯»å–åº”ç”¨é…ç½®çš„ä»£ç é‡æ„ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºé¡¹ç›®ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡åœ¨æµè§ˆå™¨è®¿é—®è¿™ä¸ªåœ¨çº¿è®ºå›é¡¹ç›®éªŒè¯é‡æ„ååº”ç”¨æ˜¯å¦å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œé‡æ–°å¯åŠ¨ Web æœåŠ¡å™¨ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š $ go run main.go 2020/06/07 16:54:55 Starting HTTP server at 0.0.0.0:8080 è¡¨ç¤ºå¯åŠ¨æœåŠ¡å™¨æ—¶è¯»å–é…ç½®ä¿¡æ¯æ­£å¸¸ï¼Œç„¶åè®¿é—®åº”ç”¨é¦–é¡µï¼š æˆåŠŸï¼Œå¯¹ç”¨æˆ·æ¥è¯´ï¼Œæ²¡æœ‰ä»»ä½•æ„ŸçŸ¥åå°çš„å˜åŠ¨ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-7-get-global-configuration-through-singleton-mode/:4:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›7-é€šè¿‡å•ä¾‹æ¨¡å¼è·å–å…¨å±€é…ç½®","uri":"/2020/development-of-online-forum-based-on-golang-7-get-global-configuration-through-singleton-mode/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†åœ¨çº¿è®ºå›é¡¹ç›®åŸºæœ¬åŠŸèƒ½çš„å¼€å‘ï¼Œå¯¹ Go è¯­è¨€ Web ç¼–ç¨‹ä¸­å¦‚ä½•å®ç° MVC æ¶æ„æ¨¡å¼ä»¥åŠ CRUDï¼ˆæ•°æ®åº“å¢åˆ æ”¹æŸ¥ï¼‰åŸºæœ¬æ“ä½œæœ‰äº†åˆæ­¥çš„è®¤è¯†ã€‚ä¸è¿‡ç°åœ¨æ‰€æœ‰çš„æ—¥å¿—å’Œé”™è¯¯å¤„ç†éƒ½æ˜¯æ‚ç³…åœ¨ä¸šåŠ¡ä»£ç ä¸­ï¼Œæœ¬ç¯‡ä»‹ç»å¦‚ä½•å¯¹å®ƒä»¬ç»Ÿä¸€è¿›è¡Œå¤„ç†ï¼Œä½¿å¾—ä¸šåŠ¡ä»£ç å’Œæ—¥å¿—åŠé”™è¯¯å¤„ç†é€»è¾‘åˆ†ç¦»ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/:0:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›6-æ—¥å¿—ä¸é”™è¯¯å¤„ç†","uri":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. æ—¥å¿—å¤„ç† ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/:1:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›6-æ—¥å¿—ä¸é”™è¯¯å¤„ç†","uri":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.1 åˆå§‹åŒ–æ—¥å¿—å¤„ç†å™¨ é¦–å…ˆæ¥çœ‹æ—¥å¿—å¤„ç†ï¼Œåœ¨ handlers/helper.go ä¸­ï¼Œæ–°å¢å¦‚ä¸‹æ—¥å¿—å¤„ç†å™¨åˆå§‹åŒ–ä»£ç ï¼š import ( \"log\" \"os\" ) var logger *log.Logger func init() { file, err := os.OpenFile(\"logs/chitchat.log\", os.O_CREATE|os.O_WRONLY|os.O_APPEND, 0666) if err != nil { log.Fatalln(\"Failed to open log file\", err) } logger = log.New(file, \"INFO \", log.Ldate|log.Ltime|log.Lshortfile) } è¿™é‡Œæˆ‘ä»¬å€ŸåŠ© Go å®˜æ–¹æä¾›çš„ log åŒ…è¿›è¡Œæ—¥å¿—å¤„ç†ï¼Œé¦–å…ˆå£°æ˜ä¸€ä¸ª *log.Logger ç±»å‹çš„ logger å˜é‡ä½œä¸ºæ—¥å¿—å¤„ç†å™¨ï¼Œä»¥ä¾¿å¯ä»¥å…¨å±€ä½¿ç”¨ã€‚é»˜è®¤çš„æ—¥å¿—æ–‡ä»¶ä½äº logs/chitchat.logï¼Œæˆ‘ä»¬é€šè¿‡ os.OpenFile æ‰“å¼€è¿™ä¸ªæ—¥å¿—æ–‡ä»¶å¥æŸ„ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™è‡ªåŠ¨åˆ›å»ºã€‚ç„¶åæˆ‘ä»¬é€šè¿‡ log.New åˆå§‹åŒ–æ—¥å¿—å¤„ç†å™¨å¹¶èµ‹å€¼ç»™ loggerï¼Œè¯¥æ–¹æ³•éœ€è¦ä¼ å…¥æ—¥å¿—æ–‡ä»¶ã€é»˜è®¤æ—¥å¿—çº§åˆ«ã€ä»¥åŠæ—¥å¿—æ ¼å¼ï¼Œå…³äºè¯¥æ–¹æ³•çš„ç»†èŠ‚ï¼Œæˆ‘ä»¬åé¢åœ¨æ—¥å¿—ç« èŠ‚ä¼šè¯¦ç»†ä»‹ç»ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/:1:1","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›6-æ—¥å¿—ä¸é”™è¯¯å¤„ç†","uri":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.2 å®šä¹‰æ—¥å¿—å‡½æ•° ç„¶åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ logger è¿™ä¸ªæ—¥å¿—å¤„ç†å™¨æ¥è®°å½•æ—¥å¿—äº†ï¼Œåœ¨ helper.go ä¸­æ–°å¢å¦‚ä¸‹å‡ ä¸ªæ—¥å¿—å‡½æ•°ï¼š func info(args ...interface{}) { logger.SetPrefix(\"INFO \") logger.Println(args...) } // ä¸ºä»€ä¹ˆä¸å‘½åä¸º errorï¼Ÿé¿å…å’Œ error ç±»å‹é‡å func danger(args ...interface{}) { logger.SetPrefix(\"ERROR \") logger.Println(args...) } func warning(args ...interface{}) { logger.SetPrefix(\"WARNING \") logger.Println(args...) } éå¸¸ç®€å•ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸‰ä¸ªæ—¥å¿—å‡½æ•°æ¥è®°å½•ä¸‰ä¸ªæ—¥å¿—çº§åˆ«ï¼Œåˆ†åˆ«æ˜¯ INFOï¼ˆæ™®é€šï¼‰ã€ERRORï¼ˆé”™è¯¯ï¼‰ã€WARNINGï¼ˆè­¦å‘Šï¼‰ï¼Œç„¶åé€šè¿‡è°ƒç”¨ logger.Println ä¼ å…¥å‚æ•°è®°å½•æ—¥å¿—ä¿¡æ¯åˆ°æ—¥å¿—æ–‡ä»¶å³å¯ï¼Œè¿™é‡Œçš„å‚æ•°ç±»å‹æ˜¯ ...interface{}ï¼Œè¡¨ç¤ºå¯ä»¥ä¼ å…¥å‚æ•°æ”¯æŒä»»æ„ç±»å‹ã€ä»»æ„ä¸ªæ•°ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/:1:2","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›6-æ—¥å¿—ä¸é”™è¯¯å¤„ç†","uri":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.3 é‡æ„ä¸šåŠ¡ä»£ç  æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ°ä¸šåŠ¡å¤„ç†å™¨ä¸­ï¼Œå°†åŸæ¥çš„æ—¥å¿—æ‰“å°ä»£ç éƒ½é‡æ„ä¸ºè°ƒç”¨å¯¹åº”çš„æ—¥å¿—å‡½æ•°ï¼Œä»¥ handlers/auth.go ä¸ºä¾‹ï¼Œä¿®æ”¹æ—¥å¿—å¤„ç†ä»£ç å¦‚ä¸‹ï¼š // src/github.com/xueyuanjun/chitchat/handlers/auth.go // æ³¨å†Œæ–°ç”¨æˆ· func SignupAccount(writer http.ResponseWriter, request *http.Request) { err := request.ParseForm() if err != nil { danger(err, \"Cannot parse form\") } user := models.User{ Name: request.PostFormValue(\"name\"), Email: request.PostFormValue(\"email\"), Password: request.PostFormValue(\"password\"), } if err := user.Create(); err != nil { danger(err, \"Cannot create user\") } http.Redirect(writer, request, \"/login\", 302) } // ç”¨æˆ·è®¤è¯ func Authenticate(writer http.ResponseWriter, request *http.Request) { err := request.ParseForm() user, err := models.UserByEmail(request.PostFormValue(\"email\")) if err != nil { danger(err, \"Cannot find user\") } if user.Password == models.Encrypt(request.PostFormValue(\"password\")) { session, err := user.CreateSession() if err != nil { danger(err, \"Cannot create session\") } cookie := http.Cookie{ Name: \"_cookie\", Value: session.Uuid, HttpOnly: true, } http.SetCookie(writer, \u0026cookie) http.Redirect(writer, request, \"/\", 302) } else { http.Redirect(writer, request, \"/login\", 302) } } // ç”¨æˆ·é€€å‡º func Logout(writer http.ResponseWriter, request *http.Request) { cookie, err := request.Cookie(\"_cookie\") if err != http.ErrNoCookie { warning(err, \"Failed to get cookie\") session := models.Session{Uuid: cookie.Value} session.DeleteByUUID() } http.Redirect(writer, request, \"/\", 302) } å…¶ä»–å¤„ç†å™¨æ–¹æ³•å‚ç…§è¿™ä¸ªç¤ºä¾‹è¿›è¡Œè°ƒæ•´å³å¯ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/:1:3","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›6-æ—¥å¿—ä¸é”™è¯¯å¤„ç†","uri":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. é”™è¯¯å¤„ç† Go è¯­è¨€å¹¶æ²¡æœ‰åƒ PHPã€Java é‚£æ ·æä¾›å¼‚å¸¸è¿™ç§ç±»å‹ï¼Œåªæœ‰ error å’Œ panicï¼Œå¯¹äº Go Web åº”ç”¨ä¸­çš„é”™è¯¯å¤„ç†ï¼Œä¸å½±å“ç¨‹åºç»§ç»­å¾€åæ‰§è¡Œçš„ï¼Œå¯ä»¥é€šè¿‡æ—¥å¿—æ–¹å¼è®°å½•ä¸‹æ¥ï¼Œå¦‚æœæŸäº›é”™è¯¯å¯¼è‡´ç¨‹åºæ— æ³•å¾€åæ‰§è¡Œï¼Œæ¯”å¦‚æµè§ˆç¾¤ç»„è¯¦æƒ…é¡µï¼Œå¯¹åº”ç¾¤ç»„ä¸å­˜åœ¨ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±åº”è¯¥ç›´æ¥è¿”å› 404 å“åº”æˆ–è€…å°†ç”¨æˆ·é‡å®šå‘åˆ° 404 é¡µé¢ï¼Œè€Œä¸èƒ½ç»§ç»­å¾€åæ‰§è¡Œï¼Œå¯¹äºè¿™ç§é”™è¯¯ï¼Œåªèƒ½é€šè¿‡å•ç‹¬çš„å¤„ç†é€»è¾‘è¿›è¡Œå¤„ç†ï¼Œè¿™ç§é”™è¯¯ç±»ä¼¼äº Laravel ä¸­çš„ä¸­æ–­å¼‚å¸¸å¤„ç†ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/:2:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›6-æ—¥å¿—ä¸é”™è¯¯å¤„ç†","uri":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 é‡å®šå‘åˆ°é”™è¯¯é¡µé¢ åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡é‡å®šå‘åˆ°é”™è¯¯é¡µé¢çš„æ–¹å¼å¤„ç†è¿™ç§ç±»å‹çš„é”™è¯¯ï¼Œåœ¨ handlers/helper.go ä¸­æ–°å¢ error_message å‡½æ•°ï¼š // å¼‚å¸¸å¤„ç†ç»Ÿä¸€é‡å®šå‘åˆ°é”™è¯¯é¡µé¢ func error_message(writer http.ResponseWriter, request *http.Request, msg string) { url := []string{\"/err?msg=\", msg} http.Redirect(writer, request, strings.Join(url, \"\"), 302) } è°ƒç”¨è¯¥æ–¹æ³•ä¼šå°†ç”¨æˆ·é‡å®šå‘åˆ°é”™è¯¯å¤„ç†é¡µé¢ï¼ˆç”± err è·¯ç”±å¯¹åº”å¤„ç†å™¨æ–¹æ³•æ¸²æŸ“ï¼‰ï¼Œå“åº”çŠ¶æ€ç ä¸º 302ï¼Œå¹¶ä¸”å¸¦ä¸Šé”™è¯¯æ¶ˆæ¯ msgï¼Œä»¥ä¾¿å®¢æˆ·ç«¯æ„ŸçŸ¥é”™è¯¯åŸå› ã€‚ ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/:2:1","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›6-æ—¥å¿—ä¸é”™è¯¯å¤„ç†","uri":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 ç¼–å†™é”™è¯¯é¡µé¢ç›¸å…³ä»£ç  ä¸ºæ­¤ï¼Œæˆ‘ä»¬è¿˜è¦ç¼–å†™ç”¨äºå¤„ç†åº”ç”¨å‡ºé”™çš„è·¯ç”±ã€å¤„ç†å™¨å’Œè§†å›¾å®ç°ã€‚ å¤„ç†å™¨æ–¹æ³• é¦–å…ˆåœ¨ handlers/index.go ä¸­ç¼–å†™å…¨å±€çš„ã€æ¸²æŸ“é”™è¯¯é¡µé¢çš„å¤„ç†å™¨æ–¹æ³•ï¼š func Err(writer http.ResponseWriter, request *http.Request) { vals := request.URL.Query() _, err := session(writer, request) if err != nil { generateHTML(writer, vals.Get(\"msg\"), \"layout\", \"navbar\", \"error\") } else { generateHTML(writer, vals.Get(\"msg\"), \"layout\", \"auth.navbar\", \"error\") } } æˆ‘ä»¬å¯ä»¥é€šè¿‡ vals.Get æ–¹æ³•ä»æŸ¥è¯¢å­—ç¬¦ä¸²è·å– msg å‚æ•°ï¼Œå¹¶å°†å…¶æ¸²æŸ“åˆ°é”™è¯¯è§†å›¾ error.html ä¸­ã€‚ é”™è¯¯è§†å›¾ ç„¶ååœ¨ views ç›®å½•ä¸‹æ–°å¢ error.html ç”¨æ¥å®šä¹‰é”™è¯¯è§†å›¾ï¼š {{ define \"content\" }} \u003cp class=\"lead\"\u003e{{ . }}\u003c/p\u003e {{ end }} éå¸¸ç®€å•ï¼Œåªæ˜¯é€šè¿‡ {{ . }} è·å– msg å˜é‡çš„å€¼å¹¶æ¸²æŸ“å‡ºæ¥ã€‚ æ³¨å†Œè·¯ç”± æœ€ååœ¨ routes/routes.go ä¸­æ³¨å†Œé”™è¯¯è·¯ç”±ï¼š { \"error\", \"GET\", \"/err\", handlers.Err, }, ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/:2:2","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›6-æ—¥å¿—ä¸é”™è¯¯å¤„ç†","uri":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 é‡æ„ä¸šåŠ¡ä»£ç  åœ¨å¿…è¦çš„åœ°æ–¹è°ƒç”¨é”™è¯¯å¤„ç†å‡½æ•° error_message å°†ç”¨æˆ·é‡å®šå‘åˆ°é”™è¯¯é¡µé¢ï¼Œæ¯”å¦‚åœ¨ handlers/thread.go ä¸­ï¼Œåœ¨æµè§ˆç¾¤ç»„è¯¦æƒ…é¡µæ—¶ï¼Œå¦‚æœæŒ‡å®š ID å¯¹åº”ç¾¤ç»„ä¸å­˜åœ¨ï¼Œåˆ™å°†ç”¨æˆ·é‡å®šå‘åˆ°é”™è¯¯é¡µé¢ï¼š // é€šè¿‡ ID æ¸²æŸ“æŒ‡å®šç¾¤ç»„é¡µé¢ func ReadThread(writer http.ResponseWriter, request *http.Request) { vals := request.URL.Query() uuid := vals.Get(\"id\") thread, err := models.ThreadByUUID(uuid) if err != nil { error_message(writer, request, \"Cannot read thread\") } else { ... } } åˆæ¯”å¦‚ handlers/post.go ä¸­ï¼Œåœ¨åˆ›å»ºæ–°ä¸»é¢˜æ—¶ï¼Œå¦‚æœè·å–ä¸åˆ°ä¸»é¢˜å½’å±çš„ç¾¤ç»„ï¼Œåˆ™å°†ç”¨æˆ·é‡å®šå‘åˆ°é”™è¯¯é¡µé¢ï¼š // åœ¨æŒ‡å®šç¾¤ç»„ä¸‹åˆ›å»ºæ–°ä¸»é¢˜ func PostThread(writer http.ResponseWriter, request *http.Request) { sess, err := session(writer, request) if err != nil { http.Redirect(writer, request, \"/login\", 302) } else { ... thread, err := models.ThreadByUUID(uuid) if err != nil { error_message(writer, request, \"Cannot read thread\") } ... } } ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/:2:3","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›6-æ—¥å¿—ä¸é”™è¯¯å¤„ç†","uri":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. æ•´ä½“æµ‹è¯• è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†æ—¥å¿—å’Œé”™è¯¯ç»Ÿä¸€å¤„ç†çš„ä»£ç é‡æ„ï¼Œæ¥ä¸‹æ¥ï¼Œå¯ä»¥è¿›è¡Œç®€å•çš„æµ‹è¯•ï¼Œé‡å¯ HTTP æœåŠ¡å™¨ï¼Œè®¿é—®åº”ç”¨é¦–é¡µï¼Œæ­¤æ—¶ä¼šå¼•å…¥ helper.goï¼Œæ‰§è¡Œ init æ–¹æ³•ï¼Œåˆ›å»ºæ—¥å¿—æ–‡ä»¶ï¼Œæˆ‘ä»¬è¯•å›¾ä½¿ç”¨é”™è¯¯çš„ç”¨æˆ·åå¯†ç ç™»å½•ï¼š æµ‹è¯•å°±å¯ä»¥åœ¨ logs/chitchat.log ä¸­çœ‹åˆ°é”™è¯¯æ—¥å¿—äº†ï¼š ERROR 2020/04/07 14:55:39 helper.go:71: sql: no rows in result set Cannot find user æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„ç¾¤ç»„ http://localhost:8080/thread/read?id=100ï¼Œé¡µé¢å°±ä¼šé‡å®šå‘åˆ°é”™è¯¯é¡µé¢ï¼š ","date":"2020-06-07","objectID":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/:3:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›6-æ—¥å¿—ä¸é”™è¯¯å¤„ç†","uri":"/2020/development-of-online-forum-based-on-golang-6-log-and-error/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æ—¥å¿—æ˜¯ä¸€ä¸ªç³»ç»Ÿå¿…ä¸å¯å°‘çš„éƒ¨åˆ†ï¼Œæœ¬ç¯‡ä»‹ç»Golangä¸­çš„æ—¥å¿—ç³»ç»Ÿã€‚ ","date":"2020-06-07","objectID":"/2020/golang-log-system/:0:0","tags":["Goå®æˆ˜"],"title":"Golangæ—¥å¿—ç³»ç»Ÿ","uri":"/2020/golang-log-system/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. å†…ç½®logåŒ… å®˜æ–¹æä¾›çš„ log åŒ…å®ç°äº†ç®€å•çš„æ—¥å¿—æœåŠ¡ã€‚è¯¥åŒ…å®šä¹‰äº†ä¸€ä¸ª Logger ç±»å‹ï¼Œæä¾›äº†ä¸€äº›æ ¼å¼åŒ–è¾“å‡ºæ–¹æ³•ï¼Œä¸ºäº†æ›´å®¹æ˜“åœ°ä½¿ç”¨ï¼Œå¯¹è¯¥ç±»å‹æä¾›äº†ä¸€ä¸ªæ ‡å‡† Logger å®ç°ï¼Œè¯¥ Logger ä¼šæ‰“å°æ¯æ¡æ—¥å¿—ä¿¡æ¯çš„æ—¥æœŸã€æ—¶é—´ã€é»˜è®¤è¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯ï¼ŒFatalç³»åˆ—å‡½æ•°ä¼šåœ¨å†™å…¥æ—¥å¿—ä¿¡æ¯åè°ƒç”¨ os.Exit(1)ã€‚Panicç³»åˆ—å‡½æ•°ä¼šåœ¨å†™å…¥æ—¥å¿—ä¿¡æ¯åpanicã€‚ ","date":"2020-06-07","objectID":"/2020/golang-log-system/:1:0","tags":["Goå®æˆ˜"],"title":"Golangæ—¥å¿—ç³»ç»Ÿ","uri":"/2020/golang-log-system/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.1 å†…ç½®å®ç° ä¸€ä¸ªå†…ç½®å®ç°ä½¿ç”¨çš„ç®€å•ä¾‹å­å¦‚ä¸‹ // This sample program demonstrates how to use the base log package. package main import ( \"log\" ) func init() { log.SetPrefix(\"TRACE: \") log.SetFlags(log.Ldate | log.Lmicroseconds | log.Llongfile) } func main() { // Println writes to the standard logger. log.Println(\"message\") // Fatalln is Println() followed by a call to os.Exit(1). log.Fatalln(\"fatal message\") // Panicln is Println() followed by a call to panic(). log.Panicln(\"panic message\") } ------------------------------- TRACE: 2019/04/09 14:24:32.868375 D:/go/TestFile/src/main/TestLog.go:15: message TRACE: 2019/04/09 14:24:32.962329 D:/go/TestFile/src/main/TestLog.go:18: fatal message Process finished with exit code 1 åŸå‹å‡½æ•°çš„è¯´æ˜å¦‚ä¸‹ func Flags() int // Flagsè¿”å›æ ‡å‡†loggerçš„è¾“å‡ºé€‰é¡¹ func SetFlags(flag int) // SetFlagsè®¾ç½®æ ‡å‡†loggerçš„è¾“å‡ºé€‰é¡¹ func Prefix() string // Prefixè¿”å›æ ‡å‡†loggerçš„è¾“å‡ºå‰ç¼€ func SetPrefix(prefix string) // SetPrefixè®¾ç½®æ ‡å‡†loggerçš„è¾“å‡ºå‰ç¼€ func SetOutput(w io.Writer) // SetOutputè®¾ç½®æ ‡å‡†loggerçš„è¾“å‡ºç›®çš„åœ°ï¼Œé»˜è®¤æ˜¯æ ‡å‡†é”™è¯¯è¾“å‡º // Printfè°ƒç”¨Outputå°†ç”Ÿæˆçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²è¾“å‡ºåˆ°æ ‡å‡†loggerï¼Œå‚æ•°ç”¨å’Œfmt.Printfç›¸åŒçš„æ–¹æ³•å¤„ç†ã€‚ func Printf(format string, v ...interface{}) // Printè°ƒç”¨Outputå°†ç”Ÿæˆçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²è¾“å‡ºåˆ°æ ‡å‡†loggerï¼Œå‚æ•°ç”¨å’Œfmt.Printç›¸åŒçš„æ–¹æ³•å¤„ç†ã€‚ func Print(v ...interface{}) // Printlnè°ƒç”¨Outputå°†ç”Ÿæˆçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²è¾“å‡ºåˆ°æ ‡å‡†loggerï¼Œå‚æ•°ç”¨å’Œfmt.Printlnç›¸åŒçš„æ–¹æ³•å¤„ç†ã€‚ func Println(v ...interface{}) func Fatalf(format string, v ...interface{}) // Fatalfç­‰ä»·äº{Printf(v...); os.Exit(1)} func Fatal(v ...interface{}) // Fatalç­‰ä»·äº{Print(v...); os.Exit(1)} func Fatalln(v ...interface{}) // Fatallnç­‰ä»·äº{Println(v...); os.Exit(1)} func Panicf(format string, v ...interface{}) // Panicfç­‰ä»·äº{Printf(v...); panic(...)} func Panic(v ...interface{}) // Panicç­‰ä»·äº{Print(v...); panic(...)} func Panicln(v ...interface{}) // Paniclnç­‰ä»·äº{Println(v...); panic(...)} SetPrefix è®¾ç½®è¾“å‡ºå‰ç¼€ï¼ŒSetfFlags è®¾ç½®è¾“å‡ºé€‰é¡¹ï¼Œä¸ºäº†ç†è§£è¾“å‡ºå‰ç¼€ä¸é€‰é¡¹ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªæ ‡å‡†è¾“å‡º TRACE: 2019/04/09 14:24:32.868375 D:/go/TestFile/src/main/TestLog.go:15: message å…¶ä¸­ï¼ŒTRACE å°±æ˜¯è¾“å‡ºå‰ç¼€ï¼Œå¯ä»¥é€šè¿‡ SetPrefix è®¾ç½®ï¼Œé€šè¿‡ Prefix è¾“å‡ºï¼Œç”¨æ¥åœ¨æ™®é€šçš„ç¨‹åºè¾“å‡ºä¸­åˆ†å¸ƒå‡ºæ—¥å¿—ã€‚åé¢å†’å·å‰çš„ä¿¡æ¯å°±æ˜¯è¾“å‡ºé€‰é¡¹ï¼Œé€šè¿‡ SetFlags è®¾ç½®ï¼Œé€šè¿‡ Flags è¾“å‡ºã€‚è¾“å‡ºé€‰é¡¹çš„ç»“æ„å®šä¹‰å¦‚ä¸‹ const ( // å­—ä½å…±åŒæ§åˆ¶è¾“å‡ºæ—¥å¿—ä¿¡æ¯çš„ç»†èŠ‚ã€‚ä¸èƒ½æ§åˆ¶è¾“å‡ºçš„é¡ºåºå’Œæ ¼å¼ã€‚ // åœ¨æ‰€æœ‰é¡¹ç›®åä¼šæœ‰ä¸€ä¸ªå†’å·ï¼š2009/01/23 01:23:23.123123 /a/b/c/d.go:23: message Ldate = 1 \u003c\u003c iota // æ—¥æœŸï¼š2009/01/23 Ltime // æ—¶é—´ï¼š01:23:23 Lmicroseconds // å¾®ç§’åˆ†è¾¨ç‡ï¼š01:23:23.123123ï¼ˆç”¨äºå¢å¼ºLtimeä½ï¼‰ Llongfile // æ–‡ä»¶å…¨è·¯å¾„å+è¡Œå·ï¼š /a/b/c/d.go:23 Lshortfile // æ–‡ä»¶æ— è·¯å¾„å+è¡Œå·ï¼šd.go:23ï¼ˆä¼šè¦†ç›–æ‰Llongfileï¼‰ LstdFlags = Ldate | Ltime // æ ‡å‡†loggerçš„åˆå§‹å€¼ ) log åŒ…æœ‰ä¸€ä¸ªå¾ˆæ–¹ä¾¿çš„åœ°æ–¹å°±æ˜¯ï¼Œè¿™äº›æ—¥å¿—è®°å½•å™¨æ˜¯å¤š goroutine å®‰å…¨çš„ã€‚è¿™æ„å‘³ç€åœ¨å¤šä¸ªgoroutine å¯ä»¥åŒæ—¶è°ƒç”¨æ¥è‡ªåŒä¸€ä¸ªæ—¥å¿—è®°å½•å™¨çš„è¿™äº›å‡½æ•°ï¼Œè€Œä¸ä¼šæœ‰å½¼æ­¤é—´çš„å†™å†²çªã€‚æ ‡å‡†æ—¥å¿—è®°å½•å™¨å…·æœ‰è¿™ä¸€æ€§è´¨ï¼Œç”¨æˆ·å®šåˆ¶çš„æ—¥å¿—è®°å½•å™¨ä¹Ÿåº”è¯¥æ»¡è¶³è¿™ä¸€æ€§è´¨ã€‚ ","date":"2020-06-07","objectID":"/2020/golang-log-system/:1:1","tags":["Goå®æˆ˜"],"title":"Golangæ—¥å¿—ç³»ç»Ÿ","uri":"/2020/golang-log-system/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.2 åŸºäºLoggerè‡ªå®šä¹‰ å®˜æ–¹çš„é¢„ç½®å®ç°æ˜¯åŸºäºLoggerç±»å‹çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åŸºäºLoggerç±»å‹è‡ªå·±è¿›è¡Œå®ç° Loggerç±»å‹è¡¨ç¤ºä¸€ä¸ªæ´»åŠ¨çŠ¶æ€çš„è®°å½•æ—¥å¿—çš„å¯¹è±¡ï¼Œå®ƒä¼šç”Ÿæˆä¸€è¡Œè¡Œçš„è¾“å‡ºå†™å…¥ä¸€ä¸ªio.Writeræ¥å£ã€‚æ¯ä¸€æ¡æ—¥å¿—æ“ä½œä¼šè°ƒç”¨ä¸€æ¬¡io.Writeræ¥å£çš„Writeæ–¹æ³•ã€‚Loggerç±»å‹çš„å¯¹è±¡å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹å®‰å…¨çš„åŒæ—¶ä½¿ç”¨ï¼Œå®ƒä¼šä¿è¯å¯¹io.Writeræ¥å£çš„é¡ºåºè®¿é—®ã€‚ type Logger struct { // contains filtered or unexported fields } Loggerç±»å‹çš„æ–¹æ³•å°±æ˜¯å®˜æ–¹å®ç°çš„é‚£äº›å‡½æ•° func (l *Logger) Fatal(v ...interface{}) func (l *Logger) Fatalf(format string, v ...interface{}) func (l *Logger) Fatalln(v ...interface{}) func (l *Logger) Flags() int func (l *Logger) Output(calldepth int, s string) error func (l *Logger) Panic(v ...interface{}) func (l *Logger) Panicf(format string, v ...interface{}) func (l *Logger) Panicln(v ...interface{}) func (l *Logger) Prefix() string func (l *Logger) Print(v ...interface{}) func (l *Logger) Printf(format string, v ...interface{}) func (l *Logger) Println(v ...interface{}) func (l *Logger) SetFlags(flag int) func (l *Logger) SetPrefix(prefix string) æœ‰åŒºåˆ«çš„æ˜¯ï¼Œè¿˜æœ‰ä¸€ä¸ª New å‡½æ•°ç”¨æ¥åˆ›å»ºä¸€ä¸ª Loggerï¼Œå…¶ä¸­çš„å‚æ•° out ç”¨äºè®¾ç½®æ—¥å¿—ä¿¡æ¯å†™å…¥çš„ç›®çš„åœ°ï¼Œprefix è®¾ç½®å‰ç¼€ï¼Œflag è®¾ç½®é€‰é¡¹ã€‚ func New(out io.Writer, prefix string, flag int) *Logger ä¸€ä¸ªç®€å•çš„ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ var buf bytes.Buffer logger := log.New(\u0026buf, \"logger: \", log.Lshortfile) logger.Print(\"Hello, log file!\") fmt.Print(\u0026buf) // Output logger: example_test.go:16: Hello, log file! ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åŒºåˆ†ä¸åŒçš„æ—¥å¿—çº§åˆ«ï¼šInfoã€Warning å’Œ Errorï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå‚è€ƒå®ç° // è¿™ä¸ªç¤ºä¾‹ç¨‹åºå±•ç¤ºå¦‚ä½•åˆ›å»ºå®šåˆ¶çš„æ—¥å¿—è®°å½•å™¨ package main import ( \"io\" \"io/ioutil\" \"log\" \"os\" ) var ( Trace *log.Logger // è®°å½•æ‰€æœ‰æ—¥å¿— Info *log.Logger // é‡è¦çš„ä¿¡æ¯ Warning *log.Logger // éœ€è¦æ³¨æ„çš„ä¿¡æ¯ Error *log.Logger // éå¸¸ä¸¥é‡çš„é—®é¢˜ ) func init() { file, err := os.OpenFile(\"errors.txt\", os.O_CREATE|os.O_WRONLY|os.O_APPEND, 0666) if err != nil { log.Fatalln(\"Failed to open error log file:\", err) } Trace = log.New(ioutil.Discard, \"TRACE: \", log.Ldate|log.Ltime|log.Lshortfile) Info = log.New(os.Stdout, \"INFO: \", log.Ldate|log.Ltime|log.Lshortfile) Warning = log.New(os.Stdout, \"WARNING: \", log.Ldate|log.Ltime|log.Lshortfile) Error = log.New(io.MultiWriter(file, os.Stderr), \"ERROR: \", log.Ldate|log.Ltime|log.Lshortfile) } func main() { Trace.Println(\"I have something standard to say\") Info.Println(\"Special Information\") Warning.Println(\"There is something you need to know about\") Error.Println(\"Something has failed\") } ------------------------------------ INFO: 2019/04/09 14:37:11 TestCustomLog.go:44: Special Information ERROR: 2019/04/09 14:37:11 TestCustomLog.go:46: Something has failed WARNING: 2019/04/09 14:37:11 TestCustomLog.go:45: There is something you need to know about è¿™é‡Œå†™å…¥çš„ç›®çš„åœ°ä¸º ioutil.Discardï¼Œè¿™æ˜¯ä¸€ä¸ª io.Writer æ¥å£ï¼Œè°ƒç”¨å®ƒçš„ Write æ–¹æ³•å°†ä¸åšä»»ä½•äº‹æƒ…å¹¶ä¸”å§‹ç»ˆæˆåŠŸè¿”å›ã€‚ OpenFileå‡ ä¸ªé€‰é¡¹è¯´æ˜å¦‚ä¸‹ O_CREATE // å¦‚æœä¸å­˜åœ¨å°†åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ O_WRONLY // åªå†™æ¨¡å¼æ‰“å¼€æ–‡ä»¶ O_APPEND // å†™æ“ä½œæ—¶å°†æ•°æ®é™„åŠ åˆ°æ–‡ä»¶å°¾éƒ¨ ","date":"2020-06-07","objectID":"/2020/golang-log-system/:1:2","tags":["Goå®æˆ˜"],"title":"Golangæ—¥å¿—ç³»ç»Ÿ","uri":"/2020/golang-log-system/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. ç¬¬ä¸‰æ–¹logåº“ æ¯”è¾ƒæµè¡Œä¸”è¿‘æœŸè¿˜åœ¨æ›´æ–°çš„æ—¥å¿—åº“æœ‰ logrusã€zapã€oklogã€zerolog å¯ä»¥è€ƒè™‘é€‰æ‹© JSON æ ¼å¼çš„æ—¥å¿—ï¼Œå‚è€ƒ æœ€ä½³æ—¥å¿—å®è·µï¼ˆv2.0ï¼‰ ä¸€æ–‡ å…³äºæ€§èƒ½å¯ä»¥å‚è€ƒ Goé›¶æ¶ˆè€—debug logæŠ€å·§ï¼Œä½¿ç”¨å®˜æ–¹æ¨¡å—åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å­˜åœ¨æ€§èƒ½ç“¶é¢ˆ ","date":"2020-06-07","objectID":"/2020/golang-log-system/:2:0","tags":["Goå®æˆ˜"],"title":"Golangæ—¥å¿—ç³»ç»Ÿ","uri":"/2020/golang-log-system/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.å‚è€ƒ [1] åˆè‚¥æ‡’çš®ï¼Œç®€ä¹¦ï¼ŒGolang logæ—¥å¿—ï¼Œ2019.04.09 [2] Goè¯­è¨€æ ‡å‡†åº“æ–‡æ¡£ ","date":"2020-06-07","objectID":"/2020/golang-log-system/:3:0","tags":["Goå®æˆ˜"],"title":"Golangæ—¥å¿—ç³»ç»Ÿ","uri":"/2020/golang-log-system/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"ä¸Šç¯‡æ–‡ç« åŸºäº Cookie + Session å®ç°äº†ç®€å•çš„ç”¨æˆ·è®¤è¯åŠŸèƒ½ï¼Œç”¨æˆ·è®¤è¯ä¹‹åï¼Œå°±å¯ä»¥åˆ›å»ºç¾¤ç»„å’Œä¸»é¢˜äº†ï¼Œæœ¬ç¯‡ä»‹ç»å¦‚ä½•åˆ›å»ºç¾¤ç»„å’Œä¸»é¢˜ï¼Œå¹¶å°†å…¶æ¸²æŸ“åˆ°å‰ç«¯é¡µé¢ã€‚ ","date":"2020-06-05","objectID":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/:0:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›5-åˆ›å»ºç¾¤ç»„å’Œä¸»é¢˜åŠŸèƒ½å®ç°","uri":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. ç¾¤ç»„çš„åˆ›å»ºå’Œæµè§ˆ ","date":"2020-06-05","objectID":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/:1:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›5-åˆ›å»ºç¾¤ç»„å’Œä¸»é¢˜åŠŸèƒ½å®ç°","uri":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.1 å¤„ç†å™¨æ–¹æ³• åœ¨ handlers ç›®å½•ä¸‹æ–°å¢ thread.go ç¼–å†™ç¾¤ç»„åˆ›å»ºä¸è·å–æ–¹æ³•ï¼š package handlers import ( \"fmt\" \"github.com/xueyuanjun/chitchat/models\" \"net/http\" ) // GET /threads/new // åˆ›å»ºç¾¤ç»„é¡µé¢ func NewThread(writer http.ResponseWriter, request *http.Request) { _, err := session(writer, request) if err != nil { http.Redirect(writer, request, \"/login\", 302) } else { generateHTML(writer, nil, \"layout\", \"auth.navbar\", \"new.thread\") } } // POST /thread/create // æ‰§è¡Œç¾¤ç»„åˆ›å»ºé€»è¾‘ func CreateThread(writer http.ResponseWriter, request *http.Request) { sess, err := session(writer, request) if err != nil { http.Redirect(writer, request, \"/login\", 302) } else { err = request.ParseForm() if err != nil { fmt.Println(\"Cannot parse form\") } user, err := sess.User() if err != nil { fmt.Println(\"Cannot get user from session\") } topic := request.PostFormValue(\"topic\") if _, err := user.CreateThread(topic); err != nil { fmt.Println(\"Cannot create thread\") } http.Redirect(writer, request, \"/\", 302) } } // GET /thread/read // é€šè¿‡ ID æ¸²æŸ“æŒ‡å®šç¾¤ç»„é¡µé¢ func ReadThread(writer http.ResponseWriter, request *http.Request) { vals := request.URL.Query() uuid := vals.Get(\"id\") thread, err := models.ThreadByUUID(uuid) if err != nil { fmt.Println(\"Cannot read thread\") } else { _, err := session(writer, request) if err != nil { generateHTML(writer, \u0026thread, \"layout\", \"navbar\", \"thread\") } else { generateHTML(writer, \u0026thread, \"layout\", \"auth.navbar\", \"auth.thread\") } } } å…¶ä¸­å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ç”¨äºæ¸²æŸ“ç¾¤ç»„åˆ›å»ºè¡¨å•é¡µé¢ã€å¤„ç†æäº¤è¡¨å•æ‰§è¡Œç¾¤ç»„åˆ›å»ºé€»è¾‘ã€ä»¥åŠæ ¹æ®æŒ‡å®š ID æ¸²æŸ“å¯¹åº”ç¾¤ç»„é¡µé¢ã€‚å‰ä¸¤ä¸ªæ–¹æ³•éœ€è¦è®¤è¯åæ‰èƒ½è®¿é—®ï¼Œå¦åˆ™å°†ç”¨æˆ·é‡å®šå‘åˆ°ç™»å½•é¡µï¼Œç¾¤ç»„è¯¦æƒ…é¡µä¸éœ€è¦è®¤è¯å³å¯è®¿é—®ï¼Œä¸è¿‡ä¼šæ ¹æ®æ˜¯å¦è®¤è¯è¿”å›ä¸åŒçš„è§†å›¾æ¨¡æ¿ã€‚ åœ¨è¿™é‡Œï¼Œä»ç„¶é€šè¿‡è¾…åŠ©å‡½æ•° session åˆ¤æ–­ç”¨æˆ·æ˜¯å¦è®¤è¯ï¼Œå…¶ä»–çš„ä¸šåŠ¡é€»è¾‘ä¹Ÿéƒ½éå¸¸ç®€å•ï¼Œæ— éæ˜¯è·å–è¡¨å•è¾“å…¥ã€æŸ¥è¯¢æ•°æ®åº“ã€å†™å…¥æ•°æ®åº“ã€è¿”å›å“åº”è§†å›¾ç­‰æ“ä½œï¼Œåé¢æˆ‘ä»¬ä¼šåœ¨ä»‹ç»å¤„ç† HTTP è¯·æ±‚æ—¶è¯¦ç»†è§£é‡Šå…¶ä¸­çš„ç»†èŠ‚ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸‹å…¨è²Œå³å¯ã€‚ ","date":"2020-06-05","objectID":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/:1:1","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›5-åˆ›å»ºç¾¤ç»„å’Œä¸»é¢˜åŠŸèƒ½å®ç°","uri":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.2 è§†å›¾æ¨¡æ¿ ç„¶åæˆ‘ä»¬éœ€è¦åˆ›å»ºå‡ ä¸ªæ–°çš„è§†å›¾æ¨¡æ¿ï¼Œåœ¨ views ç›®å½•ä¸‹ new.thread.html æ¥ç¼–å†™åˆ›å»ºç¾¤ç»„è¡¨å•ï¼š {{ define \"content\" }} \u003cform role=\"form\" action=\"/thread/create\" method=\"post\"\u003e \u003cdiv class=\"lead\"\u003eStart a new thread with the following topic\u003c/div\u003e \u003cdiv class=\"form-group\"\u003e \u003ctextarea class=\"form-control\" name=\"topic\" id=\"topic\" placeholder=\"Thread topic here\" rows=\"4\"\u003e\u003c/textarea\u003e \u003cbr/\u003e \u003cbr/\u003e \u003cbutton class=\"btn btn-lg btn-primary pull-right\" type=\"submit\"\u003eStart this thread\u003c/button\u003e \u003c/div\u003e \u003c/form\u003e {{ end }} ç„¶ååˆ›å»º thread.html ç¼–å†™æœªè®¤è¯æƒ…å†µä¸‹æ¸²æŸ“çš„ç¾¤ç»„è¯¦æƒ…é¡µè§†å›¾ï¼ˆå…¶ä¸­è¿˜åŒ…å«äº†å¯¹ç¾¤ç»„ä¸»é¢˜çš„éå†å’Œæ¸²æŸ“ï¼‰ï¼š {{ define \"content\" }} \u003cdiv class=\"panel panel-default\"\u003e \u003cdiv class=\"panel-heading\"\u003e \u003cspan class=\"lead\"\u003e \u003ci class=\"fa fa-comment-o\"\u003e\u003c/i\u003e {{ .Topic }}\u003c/span\u003e \u003cdiv class=\"pull-right\"\u003e Started by {{ .User.Name }} - {{ .CreatedAtDate }} \u003c/div\u003e \u003c/div\u003e {{ range .Posts }} \u003cdiv class=\"panel-body\"\u003e \u003cspan class=\"lead\"\u003e \u003ci class=\"fa fa-comment\"\u003e\u003c/i\u003e {{ .Body }}\u003c/span\u003e \u003cdiv class=\"pull-right\"\u003e {{ .User.Name }} - {{ .CreatedAtDate }} \u003c/div\u003e \u003c/div\u003e {{ end }} \u003c/div\u003e {{ end }} ä»¥åŠ auth.thread.html ç¼–å†™è®¤è¯åçš„ç¾¤ç»„è¯¦æƒ…é¡µè§†å›¾ï¼ˆåœ¨æœªè®¤è¯è§†å›¾æ¨¡æ¿çš„åŸºç¡€ä¸Šæ–°å¢äº†æäº¤ä¸»é¢˜çš„è¡¨å•åŒºå—ï¼‰ï¼š {{ define \"content\" }} \u003cdiv class=\"panel panel-default\"\u003e \u003cdiv class=\"panel-heading\"\u003e \u003cspan class=\"lead\"\u003e \u003ci class=\"fa fa-comment-o\"\u003e\u003c/i\u003e {{ .Topic }}\u003c/span\u003e \u003cdiv class=\"pull-right\"\u003e Started by {{ .User.Name }} - {{ .CreatedAtDate }} \u003c/div\u003e \u003c/div\u003e {{ range .Posts }} \u003cdiv class=\"panel-body\"\u003e \u003cspan class=\"lead\"\u003e \u003ci class=\"fa fa-comment\"\u003e\u003c/i\u003e {{ .Body }}\u003c/span\u003e \u003cdiv class=\"pull-right\"\u003e {{ .User.Name }} - {{ .CreatedAtDate }} \u003c/div\u003e \u003c/div\u003e {{ end }} \u003c/div\u003e \u003cdiv class=\"panel panel-info\"\u003e \u003cdiv class=\"panel-body\"\u003e \u003cform role=\"form\" action=\"/thread/post\" method=\"post\"\u003e \u003cdiv class=\"form-group\"\u003e \u003ctextarea class=\"form-control\" name=\"body\" id=\"body\" placeholder=\"Write your reply here\" rows=\"3\"\u003e\u003c/textarea\u003e \u003cinput type=\"hidden\" name=\"uuid\" value=\"{{ .Uuid }}\"\u003e \u003cbr/\u003e \u003cbutton class=\"btn btn-primary pull-right\" type=\"submit\"\u003eReply\u003c/button\u003e \u003c/div\u003e \u003c/form\u003e \u003c/div\u003e \u003c/div\u003e {{ end }} ","date":"2020-06-05","objectID":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/:1:2","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›5-åˆ›å»ºç¾¤ç»„å’Œä¸»é¢˜åŠŸèƒ½å®ç°","uri":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.3 æ³¨å†Œè·¯ç”± æœ€ååœ¨ routes/routes.go ä¸­æ³¨å†Œç¾¤ç»„ç›¸å…³è·¯ç”±ï¼š var webRoutes = WebRoutes{ ... // å…¶ä»–è·¯ç”± { \"newThread\", \"GET\", \"/thread/new\", handlers.NewThread, }, { \"createThread\", \"POST\", \"/thread/create\", handlers.CreateThread, }, { \"readThread\", \"GET\", \"/thread/read\", handlers.ReadThread, }, } ","date":"2020-06-05","objectID":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/:1:3","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›5-åˆ›å»ºç¾¤ç»„å’Œä¸»é¢˜åŠŸèƒ½å®ç°","uri":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.4 æµ‹è¯•ç¾¤ç»„åˆ›å»ºå’Œæµè§ˆ è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†åœ¨çº¿è®ºå›é¡¹ç›®ç¾¤ç»„åˆ›å»ºå’Œæµè§ˆçš„æ‰€æœ‰ç›¸å…³è·¯ç”±ã€å¤„ç†å™¨ã€è§†å›¾ç¼–ç ï¼Œé‡æ–°å¯åŠ¨ HTTP æœåŠ¡å™¨ï¼Œå°±å¯ä»¥åœ¨é¦–é¡µç‚¹å‡»ã€ŒStart a threadã€é“¾æ¥åˆ›å»ºæ–°çš„ç¾¤ç»„äº†ï¼š å¦‚æœæ²¡æœ‰ç™»å½•ï¼Œä¼šå…ˆè·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Œç™»å½•ä¹‹åå†æ¬¡ç‚¹å‡»è¯¥é“¾æ¥å°±å¯ä»¥è¿›å…¥ç¾¤ç»„åˆ›å»ºé¡µé¢ï¼š æˆ‘ä»¬åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥ç¾¤ç»„ä¸»é¢˜ã€ŒGolangã€å¹¶ç‚¹å‡»å³ä¸‹è§’æäº¤æŒ‰é’®ï¼Œå°±å¯ä»¥æˆåŠŸåˆ›å»ºä¸€ä¸ªæ–°çš„ç¾¤ç»„å¹¶åœ¨é¦–é¡µçœ‹åˆ°äº†ï¼š ï¼ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ç‚¹å‡»è¯¥ç¾¤ç»„çš„ã€ŒRead moreã€é“¾æ¥è¿›å…¥ç¾¤ç»„è¯¦æƒ…é¡µï¼š ç›®å‰è¿˜æ²¡æœ‰ä»»ä½•ä¸»é¢˜ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥ç¼–å†™åˆ›å»ºä¸»é¢˜çš„åç«¯å¤„ç†å™¨æ–¹æ³•å’Œè·¯ç”±å®ç°ã€‚ ","date":"2020-06-05","objectID":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/:1:4","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›5-åˆ›å»ºç¾¤ç»„å’Œä¸»é¢˜åŠŸèƒ½å®ç°","uri":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. åˆ›å»ºæ–°ä¸»é¢˜ ","date":"2020-06-05","objectID":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/:2:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›5-åˆ›å»ºç¾¤ç»„å’Œä¸»é¢˜åŠŸèƒ½å®ç°","uri":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 å¤„ç†å™¨æ–¹æ³• æˆ‘ä»¬åœ¨ handlers ç›®å½•ä¸‹æ–°å¢ post.go æ¥å­˜æ”¾ä¸»é¢˜ç›¸å…³å¤„ç†å™¨æ–¹æ³•ï¼š package handlers import ( \"fmt\" \"github.com/xueyuanjun/chitchat/models\" \"net/http\" ) // POST /thread/post // åœ¨æŒ‡å®šç¾¤ç»„ä¸‹åˆ›å»ºæ–°ä¸»é¢˜ func PostThread(writer http.ResponseWriter, request *http.Request) { sess, err := session(writer, request) if err != nil { http.Redirect(writer, request, \"/login\", 302) } else { err = request.ParseForm() if err != nil { fmt.Println(\"Cannot parse form\") } user, err := sess.User() if err != nil { fmt.Println(\"Cannot get user from session\") } body := request.PostFormValue(\"body\") uuid := request.PostFormValue(\"uuid\") thread, err := models.ThreadByUUID(uuid) if err != nil { fmt.Println(\"Cannot read thread\") } if _, err := user.CreatePost(thread, body); err != nil { fmt.Println(\"Cannot create post\") } url := fmt.Sprint(\"/thread/read?id=\", uuid) http.Redirect(writer, request, url, 302) } } æˆ‘ä»¬åªå®šä¹‰äº†ä¸€ä¸ªåˆ›å»ºä¸»é¢˜çš„å¤„ç†å™¨æ–¹æ³•ï¼Œåœ¨è¯¥å¤„ç†å™¨æ–¹æ³•ä¸­ï¼Œä»ç„¶ä¼šéªŒè¯ç”¨æˆ·æ˜¯å¦å·²è®¤è¯ï¼Œåªæœ‰è®¤è¯ç”¨æˆ·æ‰èƒ½åˆ›å»ºä¸»é¢˜ï¼Œæˆ‘ä»¬æœ€åä¼šè°ƒç”¨ user.CreatePost æ–¹æ³•æ ¹æ®ç¾¤ç»„ IDã€ç”¨æˆ· ID å’Œä¸»é¢˜å†…å®¹åˆ›å»ºæ–°çš„ä¸»é¢˜è®°å½•ï¼Œä¿å­˜æˆåŠŸåï¼Œä¼šè¿”å›åˆ›å»ºè¯¥ä¸»é¢˜çš„ç¾¤ç»„è¯¦æƒ…é¡µï¼Œå¹¶å°†ä¸è¯¥ç¾¤ç»„å…³è”çš„æ‰€æœ‰ä¸»é¢˜æ¸²æŸ“å‡ºæ¥ã€‚å…³äºæ•°æ®åº“å’Œè§†å›¾æ¨¡æ¿å¼•æ“çš„è¯­æ³•ç»†èŠ‚ï¼Œåé¢æˆ‘ä»¬ä¼šåœ¨å¯¹åº”çš„ç‹¬ç«‹æ•™ç¨‹ä¸­è¯¦ç»†ä»‹ç»ã€‚ ","date":"2020-06-05","objectID":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/:2:1","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›5-åˆ›å»ºç¾¤ç»„å’Œä¸»é¢˜åŠŸèƒ½å®ç°","uri":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 æ³¨å†Œè·¯ç”± ç”±äºä¸»é¢˜æ²¡æœ‰ç‹¬ç«‹çš„è§†å›¾æ¨¡æ¿ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨è·¯ç”±æ–‡ä»¶ä¸­æ³¨å†Œåˆ›å»ºä¸»é¢˜å¯¹åº”çš„è·¯ç”±å°±å¯ä»¥äº†ï¼š { \"postThread\", \"POST\", \"/thread/post\", handlers.PostThread, }, ","date":"2020-06-05","objectID":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/:2:2","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›5-åˆ›å»ºç¾¤ç»„å’Œä¸»é¢˜åŠŸèƒ½å®ç°","uri":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 æµ‹è¯•ä¸»é¢˜åˆ›å»º å†æ¬¡é‡å¯ HTTP æœåŠ¡å™¨ï¼Œå°±å¯ä»¥åœ¨ä¹‹å‰çš„ç¾¤ç»„è¯¦æƒ…é¡µåˆ›å»ºæ–°ä¸»é¢˜äº†ï¼š ç‚¹å‡»ã€ŒREPLYã€æŒ‰é’®æäº¤ï¼Œé¡µé¢ä¼šåˆ·æ–°å¹¶æ¸²æŸ“ä¸»é¢˜å†…å®¹ï¼š å›åˆ°è®ºå›é¦–é¡µï¼Œä½ å¯ä»¥çœ‹åˆ°æ¯ä¸ªç¾¤ç»„ä¸‹çš„ä¸»é¢˜æ•°ç›®ï¼š ","date":"2020-06-05","objectID":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/:2:3","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›5-åˆ›å»ºç¾¤ç»„å’Œä¸»é¢˜åŠŸèƒ½å®ç°","uri":"/2020/development-of-online-forum-based-on-golang-5-create-thread-and-post/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"ä¸Šç¯‡æ¼”ç¤ºäº†é¦–é¡µè·¯ç”±ã€å¤„ç†å™¨ã€è§†å›¾æ¨¡æ¿çš„å®ç°ï¼Œæ¥ç€å°±è¦å®ç°ç¾¤ç»„ã€ä¸»é¢˜çš„å¢åˆ æŸ¥æ”¹ï¼Œä¸è¿‡ï¼Œéœ€è¦åœ¨è®¤è¯åæ‰èƒ½æ‰§è¡Œè¿™äº›æ“ä½œï¼Œæ‰€ä»¥æœ¬ç¯‡ä»‹ç»å¦‚ä½•å®ç°ç”¨æˆ·è®¤è¯ç›¸å…³åŠŸèƒ½ã€‚ ","date":"2020-06-04","objectID":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/:0:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›4-é€šè¿‡Cookieå’ŒSessionå®ç°ç”¨æˆ·è®¤è¯","uri":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. å…¨å±€è¾…åŠ©å‡½æ•° æˆ‘ä»¬å…ˆåœ¨ handlers ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª helper.go æ–‡ä»¶ï¼Œç”¨äºå®šä¹‰ä¸€äº›å…¨å±€è¾…åŠ©å‡½æ•°ï¼ˆä¸»è¦ç”¨åœ¨å¤„ç†å™¨ä¸­ï¼‰ï¼š package handlers import ( \"errors\" \"fmt\" \"github.com/xueyuanjun/chitchat/models\" \"html/template\" \"net/http\" ) // é€šè¿‡ Cookie åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å·²ç™»å½• func session(writer http.ResponseWriter, request *http.Request) (sess models.Session, err error) { cookie, err := request.Cookie(\"_cookie\") if err == nil { sess = models.Session{Uuid: cookie.Value} if ok, _ := sess.Check(); !ok { err = errors.New(\"Invalid session\") } } return } // è§£æ HTML æ¨¡æ¿ï¼ˆåº”å¯¹éœ€è¦ä¼ å…¥å¤šä¸ªæ¨¡æ¿æ–‡ä»¶çš„æƒ…å†µï¼Œé¿å…é‡å¤ç¼–å†™æ¨¡æ¿ä»£ç ï¼‰ func parseTemplateFiles(filenames ...string) (t *template.Template) { var files []string t = template.New(\"layout\") for _, file := range filenames { files = append(files, fmt.Sprintf(\"views/%s.html\", file)) } t = template.Must(t.ParseFiles(files...)) return } // ç”Ÿæˆå“åº” HTML func generateHTML(writer http.ResponseWriter, data interface{}, filenames ...string) { var files []string for _, file := range filenames { files = append(files, fmt.Sprintf(\"views/%s.html\", file)) } templates := template.Must(template.ParseFiles(files...)) templates.ExecuteTemplate(writer, \"layout\", data) } // è¿”å›ç‰ˆæœ¬å· func Version() string { return \"0.1\" } ç›®å‰æä¾›äº†ç‰ˆæœ¬ä¿¡æ¯ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•ï¼ŒHTML æ¨¡æ¿çš„è§£æä¸ç”Ÿæˆç­‰é€»è¾‘ï¼Œæˆ‘ä»¬å°† HTML æ¨¡æ¿è§£æä¸ç”Ÿæˆé€»è¾‘æå–å‡ºæ¥ï¼Œä¸»è¦æ˜¯ä¸ºäº†é¿å…é‡å¤ç¼–å†™ç±»ä¼¼çš„æ¨¡æ¿ä»£ç ï¼Œæ¯”å¦‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°† handlers/index.go ä¸­çš„ Index æ–¹æ³•æ”¹å†™å¦‚ä¸‹ï¼š func Index(w http.ResponseWriter, r *http.Request) { threads, err := models.Threads(); if err == nil { generateHTML(w, threads, \"layout\", \"navbar\", \"index\") } } æ˜¯ä¸æ˜¯çœ‹èµ·æ¥ç®€å•å¤šäº†ï¼Œæ›´é‡è¦çš„æ˜¯æé«˜äº†ä»£ç çš„å¤ç”¨æ€§ã€‚ åœ¨ session å‡½æ•°ä¸­ï¼Œé€šè¿‡ä»è¯·æ±‚ä¸­è·å–æŒ‡å®š Cookie å­—æ®µé‡Œé¢å­˜æ”¾çš„ Session IDï¼Œç„¶åä» Session å­˜å‚¨å™¨ï¼ˆè¿™é‡Œå­˜å‚¨é©±åŠ¨æ˜¯æ•°æ®åº“ï¼‰æŸ¥è¯¢å¯¹åº” Session æ˜¯å¦å­˜åœ¨æ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å·²è®¤è¯ï¼Œå¦‚æœå·²è®¤è¯åˆ™è¿”å›çš„ sess ä¸ä¸ºç©ºã€‚ ","date":"2020-06-04","objectID":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/:1:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›4-é€šè¿‡Cookieå’ŒSessionå®ç°ç”¨æˆ·è®¤è¯","uri":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. ç”¨æˆ·è®¤è¯ç›¸å…³å¤„ç†å™¨ ","date":"2020-06-04","objectID":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/:2:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›4-é€šè¿‡Cookieå’ŒSessionå®ç°ç”¨æˆ·è®¤è¯","uri":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 ç¼–å†™å¤„ç†å™¨ä»£ç  æ¥ä¸‹æ¥ï¼Œåœ¨ handlers ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª auth.go æ¥å­˜æ”¾ç”¨æˆ·è®¤è¯ç›¸å…³å¤„ç†å™¨ï¼š package handlers import ( \"fmt\" \"github.com/xueyuanjun/chitchat/models\" \"net/http\" ) // GET /login // ç™»å½•é¡µé¢ func Login(writer http.ResponseWriter, request *http.Request) { t := parseTemplateFiles(\"auth.layout\", \"navbar\", \"login\") t.Execute(writer, nil) } // GET /signup // æ³¨å†Œé¡µé¢ func Signup(writer http.ResponseWriter, request *http.Request) { generateHTML(writer, nil, \"auth.layout\", \"navbar\", \"signup\") } // POST /signup // æ³¨å†Œæ–°ç”¨æˆ· func SignupAccount(writer http.ResponseWriter, request *http.Request) { err := request.ParseForm() if err != nil { fmt.Println(\"Cannot parse form\") } user := models.User{ Name: request.PostFormValue(\"name\"), Email: request.PostFormValue(\"email\"), Password: request.PostFormValue(\"password\"), } if err := user.Create(); err != nil { fmt.Println(\"Cannot create user\") } http.Redirect(writer, request, \"/login\", 302) } // POST /authenticate // é€šè¿‡é‚®ç®±å’Œå¯†ç å­—æ®µå¯¹ç”¨æˆ·è¿›è¡Œè®¤è¯ func Authenticate(writer http.ResponseWriter, request *http.Request) { err := request.ParseForm() user, err := models.UserByEmail(request.PostFormValue(\"email\")) if err != nil { fmt.Println(\"Cannot find user\") } if user.Password == models.Encrypt(request.PostFormValue(\"password\")) { session, err := user.CreateSession() if err != nil { fmt.Println(\"Cannot create session\") } cookie := http.Cookie{ Name: \"_cookie\", Value: session.Uuid, HttpOnly: true, } http.SetCookie(writer, \u0026cookie) http.Redirect(writer, request, \"/\", 302) } else { http.Redirect(writer, request, \"/login\", 302) } } // GET /logout // ç”¨æˆ·é€€å‡º func Logout(writer http.ResponseWriter, request *http.Request) { cookie, err := request.Cookie(\"_cookie\") if err != http.ErrNoCookie { fmt.Println(\"Failed to get cookie\") session := models.Session{Uuid: cookie.Value} session.DeleteByUUID() } http.Redirect(writer, request, \"/\", 302) } ä¸Šè¿°ä»£ç ä¸­å®šä¹‰äº†ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€é€€å‡ºç›¸å…³ä¸šåŠ¡é€»è¾‘ï¼Œéå¸¸ç®€å•ï¼Œå’Œ Laravel è®¤è¯è„šæ‰‹æ¶ç”Ÿæˆçš„é»˜è®¤è®¤è¯ç›¸å…³æ§åˆ¶å™¨éå¸¸ç›¸ä¼¼ã€‚ ","date":"2020-06-04","objectID":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/:2:1","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›4-é€šè¿‡Cookieå’ŒSessionå®ç°ç”¨æˆ·è®¤è¯","uri":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 ç”¨æˆ·æ³¨å†Œ ç”¨æˆ·æ³¨å†Œé€»è¾‘æ¯”è¾ƒç®€å•ï¼Œæ— éæ˜¯å¡«å†™æ³¨å†Œè¡¨å•ï¼ˆSignup å¤„ç†å™¨æ–¹æ³•ï¼‰ï¼Œæäº¤æ³¨å†ŒæŒ‰é’®å°†ç”¨æˆ·ä¿¡æ¯ä¿å­˜åˆ°æ•°æ®åº“ï¼ˆSignupAccount å¤„ç†å™¨æ–¹æ³•ï¼‰ã€‚ ","date":"2020-06-04","objectID":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/:2:2","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›4-é€šè¿‡Cookieå’ŒSessionå®ç°ç”¨æˆ·è®¤è¯","uri":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 ç”¨æˆ·ç™»å½• æ¥ä¸‹æ¥ï¼ŒæœåŠ¡ç«¯ä¼šå°†ç”¨æˆ·é‡å®šå‘åˆ°ç™»å½•é¡µé¢ï¼ˆLogin å¤„ç†å™¨æ–¹æ³•ï¼‰ï¼Œç”¨æˆ·å¡«å†™ç™»å½•è¡¨å•åï¼Œå°±å¯ä»¥é€šè¿‡ Authenticate å¤„ç†å™¨æ–¹æ³•æ‰§è¡Œè®¤è¯æ“ä½œã€‚ ç”¨æˆ·è®¤è¯æ˜¯åŸºäº Cookie + Session å®ç°çš„ï¼ŒSession çš„æ•°æ®ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š type Session struct { Id int Uuid string Email string UserId int CreatedAt time.Time } é€šè¿‡ Uuid å­—æ®µå¯ä»¥å”¯ä¸€æ ‡è¯†è¿™ä¸ª Sessionï¼Œå› æ­¤å¯ä»¥çœ‹ä½œæ˜¯å¯¹å¤–å¯è§çš„å…¨å±€ Session IDï¼Œåœ¨å®¢æˆ·ç«¯ Cookie å­˜å‚¨çš„ Session ID ä¹Ÿæ˜¯è¿™ä¸ª Uuidã€‚å½“ç”¨æˆ·è®¤è¯æˆåŠŸä¹‹åï¼Œå°±ä¼šåˆ›å»º Sessionï¼Œæœ‰äº† Session ä¹‹åï¼Œå°±å¯ä»¥åˆ›å»º Cookie å¹¶å†™åˆ°å“åº”ä¸­ï¼š cookie := http.Cookie{ Name: \"_cookie\", Value: session.Uuid, HttpOnly: true, } http.SetCookie(writer, \u0026cookie) è¿™æ ·ï¼Œä¸‹æ¬¡ç”¨æˆ·è®¿é—®åœ¨çº¿è®ºå›é¡µé¢å°±ä¼šåœ¨è¯·æ±‚å¤´ä¸­å¸¦ä¸ŠåŒ…å« Session ID çš„ Cookieï¼ŒæœåŠ¡ç«¯é€šè¿‡è§£æè¿™ä¸ª Uuid å¹¶æŸ¥è¯¢ Session å­˜å‚¨å™¨ï¼ˆè¿™é‡Œå­˜å‚¨é©±åŠ¨æ˜¯æ•°æ®åº“ï¼‰åˆ¤æ–­è¯¥ç”¨æˆ· Session æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ç”¨æˆ·è®¤è¯é€šè¿‡ï¼Œä¹Ÿå°±æ˜¯å‰é¢è¾…åŠ©å‡½æ•° session æ‰€åšçš„äº‹æƒ…ã€‚ ","date":"2020-06-04","objectID":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/:2:3","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›4-é€šè¿‡Cookieå’ŒSessionå®ç°ç”¨æˆ·è®¤è¯","uri":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 ç”¨æˆ·é€€å‡º ä¸Šè¿° Cookie æœªè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ‰€ä»¥ç”Ÿå‘½å‘¨æœŸå’Œ Session ä¸€è‡´ï¼Œå½“æµè§ˆå™¨å…³é—­æ—¶ï¼ŒCookie å°±è‡ªåŠ¨åˆ é™¤ï¼Œä¸‹æ¬¡æ‰“å¼€æµè§ˆå™¨éœ€è¦é‡æ–°è®¤è¯ã€‚ æœ€åç”¨æˆ·é€€å‡ºå¤„ç†å™¨æ–¹æ³• Logout æ–¹æ³•åˆ™æ˜¯æ–¹ä¾¿ç”¨æˆ·ä¸»åŠ¨é€€å‡ºï¼Œå½“ç”¨æˆ·ç‚¹å‡»é€€å‡ºæŒ‰é’®ï¼Œå¯ä»¥æ‰§è¡Œè¯¥å¤„ç†å™¨æ–¹æ³•é”€æ¯å½“å‰ç”¨æˆ· Session å’Œè®¤è¯ Cookieï¼Œå¹¶å°†ç”¨æˆ·é‡å®šå‘åˆ°é¦–é¡µã€‚ ","date":"2020-06-04","objectID":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/:2:4","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›4-é€šè¿‡Cookieå’ŒSessionå®ç°ç”¨æˆ·è®¤è¯","uri":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. ç”¨æˆ·è®¤è¯ç›¸å…³è§†å›¾æ¨¡æ¿ å®šä¹‰å¥½è®¤è¯å¤„ç†å™¨åï¼Œæˆ‘ä»¬æ¥ç¼–å†™ä¸è®¤è¯ç›¸å…³çš„è§†å›¾æ¨¡æ¿ï¼Œä¸»è¦æ˜¯ç™»å½•é¡µé¢å’Œæ³¨å†Œé¡µé¢ï¼Œåœ¨ views ç›®å½•ä¸‹æ–°å¢ login.html ç¼–å†™ç™»å½•é¡µé¢ï¼š {{ define \"content\" }} \u003cform class=\"form-signin center\" role=\"form\" action=\"/authenticate\" method=\"post\"\u003e \u003ch2 class=\"form-signin-heading\"\u003e \u003ci class=\"fa fa-comments-o\"\u003e ChitChat \u003c/i\u003e \u003c/h2\u003e \u003cinput type=\"email\" name=\"email\" class=\"form-control\" placeholder=\"Email address\" required autofocus\u003e \u003cinput type=\"password\" name=\"password\" class=\"form-control\" placeholder=\"Password\" required\u003e \u003cbr/\u003e \u003cbutton class=\"btn btn-lg btn-primary btn-block\" type=\"submit\"\u003eSign in\u003c/button\u003e \u003cbr/\u003e \u003ca class=\"lead pull-right\" href=\"/signup\"\u003eSign up\u003c/a\u003e \u003c/form\u003e {{ end }} ç„¶ååˆ›å»º signup.html ç¼–å†™æ³¨å†Œé¡µé¢ï¼š {{ define \"content\" }} \u003cform class=\"form-signin\" role=\"form\" action=\"/signup_account\" method=\"post\"\u003e \u003ch2 class=\"form-signin-heading\"\u003e \u003ci class=\"fa fa-comments-o\"\u003e ChitChat \u003c/i\u003e \u003c/h2\u003e \u003cdiv class=\"lead\"\u003eSign up for an account below\u003c/div\u003e \u003cinput id=\"name\" type=\"text\" name=\"name\" class=\"form-control\" placeholder=\"Name\" required autofocus\u003e \u003cinput type=\"email\" name=\"email\" class=\"form-control\" placeholder=\"Email address\" required\u003e \u003cinput type=\"password\" name=\"password\" class=\"form-control\" placeholder=\"Password\" required\u003e \u003cbutton class=\"btn btn-lg btn-primary btn-block\" type=\"submit\"\u003eSign up\u003c/button\u003e \u003c/form\u003e {{ end }} æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜ä¸ºç™»å½•å’Œæ³¨å†Œé¡µé¢å®šä¹‰äº†å•ç‹¬çš„å¸ƒå±€æ¨¡æ¿ auth.layout.htmlï¼š {{ define \"layout\" }} \u003c!DOCTYPE html\u003e \u003chtml lang=\"en\"\u003e \u003chead\u003e \u003cmeta charset=\"utf-8\"\u003e \u003cmeta http-equiv=\"X-UA-Compatible\" content=\"IE=9\"\u003e \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1\"\u003e \u003ctitle\u003eChitChat\u003c/title\u003e \u003clink href=\"/static/css/bootstrap.min.css\" rel=\"stylesheet\"\u003e \u003clink href=\"/static/css/font-awesome.min.css\" rel=\"stylesheet\"\u003e \u003clink href=\"/static/css/login.css\" rel=\"stylesheet\"\u003e \u003c/head\u003e \u003cbody\u003e \u003cdiv class=\"container\"\u003e {{ template \"content\" . }} \u003c/div\u003e \u003c!-- /container --\u003e \u003cscript src=\"/static/js/jquery-2.1.1.min.js\"\u003e\u003c/script\u003e \u003cscript src=\"/static/js/bootstrap.min.js\"\u003e\u003c/script\u003e \u003c/body\u003e \u003c/html\u003e {{ end }} ä»¥ä¸Šè§†å›¾æ¨¡æ¿å·²ç»åœ¨è®¤è¯å¤„ç†å™¨æ–¹æ³•ä¸­å¼•ç”¨ã€‚ ","date":"2020-06-04","objectID":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/:3:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›4-é€šè¿‡Cookieå’ŒSessionå®ç°ç”¨æˆ·è®¤è¯","uri":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. æ³¨å†Œç”¨æˆ·è®¤è¯è·¯ç”± æœ€åï¼Œæˆ‘ä»¬éœ€è¦åœ¨ routes/routes.go ä¸­æ³¨å†Œç”¨æˆ·è®¤è¯ç›¸å…³è·¯ç”±ï¼š // å®šä¹‰æ‰€æœ‰ Web è·¯ç”± var webRoutes = WebRoutes{ ... // å…¶ä»–è·¯ç”± { \"signup\", \"GET\", \"/signup\", handlers.Signup, }, { \"signupAccount\", \"POST\", \"/signup_account\", handlers.SignupAccount, }, { \"login\", \"GET\", \"/login\", handlers.Login, }, { \"auth\", \"POST\", \"/authenticate\", handlers.Authenticate, }, { \"logout\", \"GET\", \"/logout\", handlers.Logout, }, } ","date":"2020-06-04","objectID":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/:4:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›4-é€šè¿‡Cookieå’ŒSessionå®ç°ç”¨æˆ·è®¤è¯","uri":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"5. æµ‹è¯•ç”¨æˆ·è®¤è¯åŠŸèƒ½ è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥é‡å¯åº”ç”¨å¹¶è®¿é—®ç”¨æˆ·æ³¨å†Œé¡µé¢ http://localhost:8080/signup è¿›è¡Œæ³¨å†Œäº†ï¼š æ³¨å†ŒæˆåŠŸåï¼Œé¡µé¢ä¼šè·³è½¬åˆ°ç™»å½•é¡µé¢ http://localhost:8080/loginï¼š è¾“å…¥åˆšæ‰å¡«å†™çš„æ³¨å†Œé‚®ç®±å’Œå¯†ç ï¼Œç‚¹å‡»ã€ŒSIGN INã€æŒ‰é’®ç™»å½•æˆåŠŸåï¼Œé¡µé¢è·³è½¬åˆ°é¦–é¡µã€‚ æˆ‘ä»¬è¿˜æ²¡æœ‰å¯¹é¦–é¡µåšé¢å¤–çš„è®¤è¯åˆ¤æ–­å’Œå¤„ç†ï¼Œæ‰€ä»¥æ­¤æ—¶æ˜¾ç¤ºçš„é¡µé¢æ•ˆæœå’Œä¹‹å‰ä¸€æ ·ï¼Œä¸ºäº†åŒºåˆ«ç”¨æˆ·è®¤è¯ä¸æœªè®¤è¯çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºè®¤è¯çŠ¶æ€æ¸²æŸ“ä¸åŒçš„å¯¼èˆªæ¨¡æ¿ï¼Œå¯¹äºè®¤è¯ç”¨æˆ·ï¼Œæ¸²æŸ“ auth.navbar æ¨¡æ¿ï¼Œå¯¹äºæœªè®¤è¯ç”¨æˆ·ï¼Œè¿˜æ˜¯ä¿æŒå’Œä¹‹å‰ä¸€æ ·ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ views ç›®å½•ä¸‹æ–°å¢ auth.navbar.html è§†å›¾ï¼š {{ define \"navbar\" }} \u003cdiv class=\"navbar navbar-default navbar-static-top\" role=\"navigation\"\u003e \u003cdiv class=\"container\"\u003e \u003cdiv class=\"navbar-header\"\u003e \u003cbutton type=\"button\" class=\"navbar-toggle collapsed\" data-toggle=\"collapse\" data-target=\".navbar-collapse\"\u003e \u003cspan class=\"sr-only\"\u003eToggle navigation\u003c/span\u003e \u003cspan class=\"icon-bar\"\u003e\u003c/span\u003e \u003cspan class=\"icon-bar\"\u003e\u003c/span\u003e \u003cspan class=\"icon-bar\"\u003e\u003c/span\u003e \u003c/button\u003e \u003ca class=\"navbar-brand\" href=\"/\"\u003e \u003ci class=\"fa fa-comments-o\"\u003e\u003c/i\u003e ChitChat \u003c/a\u003e \u003c/div\u003e \u003cdiv class=\"navbar-collapse collapse\"\u003e \u003cul class=\"nav navbar-nav\"\u003e \u003cli\u003e\u003ca href=\"/\"\u003eHome\u003c/a\u003e\u003c/li\u003e \u003c/ul\u003e \u003cul class=\"nav navbar-nav navbar-right\"\u003e \u003cli\u003e\u003ca href=\"/logout\"\u003eLogout\u003c/a\u003e\u003c/li\u003e \u003c/ul\u003e \u003c/div\u003e \u003c/div\u003e \u003c/div\u003e {{ end }} åŒæ—¶è¿˜è¦ä¿®æ”¹ handlers.Index å¤„ç†å™¨æ–¹æ³•å®ç°ï¼š func Index(writer http.ResponseWriter, request *http.Request) { threads, err := models.Threads(); if err == nil { _, err := session(writer, request) if err != nil { generateHTML(writer, threads, \"layout\", \"navbar\", \"index\") } else { generateHTML(writer, threads, \"layout\", \"auth.navbar\", \"index\") } } } å†æ¬¡é‡å¯åº”ç”¨ï¼Œåˆ·æ–°é¦–é¡µï¼Œå¯¼èˆªæ¡çš„å±•ç¤ºæ•ˆæœå°±ä¸ä¸€æ ·äº†ï¼š æ­¤æ—¶æ˜¾ç¤ºçš„æ˜¯ã€ŒLogoutã€é“¾æ¥ï¼Œç‚¹å‡»å³å¯é€€å‡ºåº”ç”¨ï¼š ","date":"2020-06-04","objectID":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/:5:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›4-é€šè¿‡Cookieå’ŒSessionå®ç°ç”¨æˆ·è®¤è¯","uri":"/2020/development-of-online-forum-based-on-golang-4-user-authentication/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"å…³äº Cookie çš„ä½¿ç”¨æ˜¯ Web ç¼–ç¨‹ä¸­çš„é‡è¦ä¸€éƒ¨åˆ†ï¼Œæœ¬ç¯‡ä»‹ç» Cookie çš„åŸºæœ¬çŸ¥è¯†å’Œ Golang ä¸­ä½¿ç”¨çš„æ–¹æ³•ã€‚ ","date":"2020-06-01","objectID":"/2020/golang-set-and-use-cookie/:0:0","tags":["Goå®æˆ˜"],"title":"Golangè®¾ç½®ä¸ä½¿ç”¨cookie","uri":"/2020/golang-set-and-use-cookie/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. ä½¿ç”¨Cookieæ¥ç®¡ç†çŠ¶æ€ HTTP æ˜¯æ— çŠ¶æ€åè®®ï¼Œä¸è®°å½•ä¹‹å‰å‘ç”Ÿè¿‡çš„è¯·æ±‚å’Œå“åº”ï¼Œä¹Ÿå› æ­¤æ— æ³•æ ¹æ®å†å²çŠ¶æ€ä¿¡æ¯å¤„ç†å½“å‰è¯·æ±‚ã€‚ä½†å‡è®¾æˆ‘ä»¬æ­£åœ¨æµè§ˆæ·˜å®ï¼Œç„¶ååœ¨é¦–é¡µè¿›è¡Œäº†ç™»å½•ï¼Œç‚¹å‡»å¹¶è·³è½¬åˆ°å•†å“é¡µé¢æ—¶ï¼Œå› ä¸º HTTP çš„æ— çŠ¶æ€ç‰¹æ€§ï¼Œå°±éœ€è¦é‡æ–°è¿›è¡Œç™»å½•ï¼Œè¿™å¸¦æ¥äº†è¯¸å¤šä¸ä¾¿ã€‚ ä¸å¯å¦è®¤ï¼Œæ— çŠ¶æ€åè®®æœ‰å®ƒçš„ä¼˜ç‚¹ï¼Œç”±äºä¸å¿…ä¿å­˜çŠ¶æ€ï¼Œå‡å°‘äº†æœåŠ¡å™¨çš„ CPU åŠå†…å­˜èµ„æºæ¶ˆè€—ï¼ŒåŒæ—¶ä¹Ÿå› ä¸ºåè®®è¶³å¤Ÿç®€å•ï¼Œæ‰å¯ä»¥ç”¨åˆ°å„ç§åœºæ™¯ä¸­ã€‚é‚£ä¹ˆå¦‚ä½•è§£å†³é€›æ·˜å®è¿™ç§éœ€è¦è®°å½•å†å²ä¿¡æ¯çš„åœºæ™¯å‘¢ï¼Œè¿™é‡Œå°±ç”¨åˆ° Cookie æŠ€æœ¯ã€‚ Cookie æŠ€æœ¯é€šè¿‡åœ¨ HTTP è¯·æ±‚å’Œå“åº”æŠ¥æ–‡ä¸­å†™å…¥ Cookie ä¿¡æ¯æ¥æ§åˆ¶å®¢æˆ·ç«¯çš„çŠ¶æ€ã€‚é¦–å…ˆï¼ŒæœåŠ¡ç«¯åœ¨å‘é€çš„å“åº”æŠ¥æ–‡å†…æ·»åŠ ä¸€ä¸ªå«åš Set-Cookie çš„é¦–éƒ¨å­—æ®µä¿¡æ¯ï¼Œå®¢æˆ·ç«¯æ¥æ”¶åˆ°åä¼šä¿å­˜ Cookieã€‚å½“ä¸‹æ¬¡å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œå°±ä¼šè‡ªåŠ¨åœ¨è¯·æ±‚æŠ¥æ–‡ä¸­åŠ å…¥ä¿å­˜çš„ Cookie å€¼ã€‚æœåŠ¡å™¨å‘ç°å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„ Cookie åï¼Œä¼šæ£€æŸ¥ç©¶ç«Ÿæ˜¯å“ªä¸ªå®¢æˆ·ç«¯å‘æ¥çš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå¯¹æ¯”æœåŠ¡å™¨ä¸Šçš„æ•°æ®ï¼Œå¾—åˆ°ä¹‹å‰çš„çŠ¶æ€ä¿¡æ¯ã€‚è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆå›¾æºä¸ºã€Šå›¾è§£HTTPã€‹ï¼‰ æ‰€ä»¥ Cookie çš„å®è´¨æ˜¯ HTTP è¯·æ±‚ä¸å“åº”æŠ¥æ–‡ä¸­çš„ä¸€ä¸ªé¦–éƒ¨å­—æ®µä¿¡æ¯ï¼Œä¸‹é¢ç»™å‡ºä¸€äº›æŠ¥æ–‡ç¤ºä¾‹ï¼š è¯·æ±‚æŠ¥æ–‡ï¼ˆæ²¡æœ‰ Cookie ä¿¡æ¯æ—¶çš„çŠ¶æ€ï¼‰ GET /reader/ HTTP/1.1 Host: hackr.jp *é¦–éƒ¨å­—æ®µå†…æ²¡æœ‰Cookieçš„ç›¸å…³ä¿¡æ¯ å“åº”æŠ¥æ–‡ï¼ˆæœåŠ¡å™¨ç«¯ç”Ÿæˆ Cookie ä¿¡æ¯ï¼‰ HTTP/1.1 200 OK Date: Thu, 12 Jul 2012 07:12:20 GMT Server: Apache ï¼œSet-Cookie: sid=1342077140226724; path=/; expires=Wed,10-Oct-12 07:12:20 GMTï¼ Content-Type: text/plain; charset=UTF-8 è¯·æ±‚æŠ¥æ–‡ï¼ˆè‡ªåŠ¨å‘é€ä¿å­˜çš„ Cookie ä¿¡æ¯ï¼‰ GET /image/ HTTP/1.1 Host: hackr.jp Cookie: sid=1342077140226724 ","date":"2020-06-01","objectID":"/2020/golang-set-and-use-cookie/:1:0","tags":["Goå®æˆ˜"],"title":"Golangè®¾ç½®ä¸ä½¿ç”¨cookie","uri":"/2020/golang-set-and-use-cookie/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. å…³äºCookieçš„é¦–éƒ¨å­—æ®µ å…³äº Cookie çš„ç›¸å…³è¯´æ˜æ²¡æœ‰è¢«ç¼–å…¥æ ‡å‡†åŒ– HTTP/1.1 çš„RFC2516ä¸­ï¼Œä¸‹é¢ä»‹ç»çš„æ˜¯ä½¿ç”¨æœ€å¹¿æ³›çš„ Cookie æ ‡å‡†ã€‚ é¦–éƒ¨å­—æ®µå è¯´æ˜ é¦–éƒ¨ç±»å‹ Set-Cookie å¼€å§‹çŠ¶æ€ç®¡ç†æ‰€ä½¿ç”¨çš„Cookieä¿¡æ¯ å“åº”é¦–éƒ¨å­—æ®µ Cookie æœåŠ¡å™¨æ¥æ”¶åˆ°çš„Cookieä¿¡æ¯ è¯·æ±‚é¦–éƒ¨å­—æ®µ ","date":"2020-06-01","objectID":"/2020/golang-set-and-use-cookie/:2:0","tags":["Goå®æˆ˜"],"title":"Golangè®¾ç½®ä¸ä½¿ç”¨cookie","uri":"/2020/golang-set-and-use-cookie/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 Set-Cookie Set-Cookie: status=enable; expires=Tue, 05 Jul 2011 07:26:31 GMT; â‡’ path=/; domain=.hackr.jp; å½“æœåŠ¡å™¨å‡†å¤‡å¼€å§‹ç®¡ç†å®¢æˆ·ç«¯çš„çŠ¶æ€æ—¶ï¼Œä¼šäº‹å…ˆå‘ŠçŸ¥å„ç§ä¿¡æ¯ã€‚ä¸‹é¢çš„è¡¨æ ¼åˆ—ä¸¾äº†Set-Cookie çš„å­—æ®µå€¼ã€‚ å±æ€§ è¯´æ˜ NAME=VALUE èµ‹äºˆCookieçš„åç§°å’Œå…¶å€¼ï¼ˆå¿…é¡»é¡¹ï¼‰ expires=DATE Cookieçš„æœ‰æ•ˆæœŸï¼ˆè‹¥ä¸æ˜ç¡®æŒ‡å®šåˆ™é»˜è®¤ä¸ºæµè§ˆå™¨å…³é—­å‰ä¸ºæ­¢ï¼‰ path=PATH å°†æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ç›®å½•ä½œä¸ºCookieçš„é€‚ç”¨å¯¹è±¡ï¼ˆè‹¥ä¸æŒ‡å®šåˆ™é»˜è®¤ä¸ºæ–‡æ¡£æ‰€åœ¨çš„æ–‡ä»¶ç›®å½•ï¼‰ domain=åŸŸå ä½œä¸ºCookieé€‚ç”¨å¯¹è±¡çš„åŸŸåï¼ˆè‹¥ä¸æŒ‡å®šåˆ™é»˜è®¤ä¸ºåˆ›å»ºCookieçš„æœåŠ¡å™¨åŸŸåï¼‰ Secure ä»…åœ¨HTTPSå®‰å…¨é€šä¿¡æ—¶æ‰ä¼šå‘é€Cookie HttpOnly åŠ ä»¥é™åˆ¶ï¼Œä½¿Cookieä¸èƒ½è¢«JavaScriptè„šæœ¬è®¿é—® expireså±æ€§ï¼šæœ‰ä¸¤ç§æ–¹æ³•æ¥è®¾ç½®è¿‡æœŸæ—¶é—´ï¼šä¸€ç§æ˜¯ç›´æ¥è®¾ç½® Expires å­—æ®µï¼Œä¸€ç§æ˜¯è®¾ç½® MaxAge å­—æ®µã€‚å‰è€…è¡¨ç¤ºåˆ°æœŸçš„å…·ä½“æ—¶é—´ç‚¹ï¼Œåè€…è¡¨ç¤º Cookie çš„æœ‰æ•ˆæ—¶é•¿ï¼ˆå•ä½æ˜¯ç§’ï¼‰ã€‚è¿™å¹¶ä¸æ˜¯ Go è¯­è¨€çš„è®¾è®¡ï¼Œè€Œæ˜¯ä¸åŒæµè§ˆå™¨çš„æ··ä¹±æ ‡å‡†ä½¿ç„¶ï¼Œæ¯”å¦‚è™½ç„¶ HTTP/1.1 æœ‰æ„åºŸå¼ƒ Expiresï¼Œä¸è¿‡ IE 6ã€7ã€8 å´ä¸æ”¯æŒ MaxAge å­—æ®µã€‚é€šå¸¸ï¼Œè€ƒè™‘åˆ°é»˜è®¤æ—¶åŒºé—®é¢˜ï¼Œæœ¬åœ°æ—¶é—´ä¸å¯é ï¼Œæ¨èé€šè¿‡ MaxAge å­—æ®µè®¾ç½® Cookie è¿‡æœŸæ—¶é—´ï¼Œä¸è¿‡å¯¹äº Web åº”ç”¨è€Œè¨€ï¼Œé€šå¸¸ä¸è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè®© Cookie éšç€æµè§ˆå™¨å…³é—­è€Œå¤±æ•ˆå³å¯ã€‚ domainå±æ€§ï¼šdomain å±æ€§æŒ‡å®šçš„åŸŸåå¯åšåˆ°ä¸ç»“å°¾åŒ¹é…ä¸€è‡´ï¼Œæ¯”å¦‚ï¼Œå½“æŒ‡å®š example.com åï¼Œé™¤ example.com æœ¬èº«å¤–ï¼Œwww.example.com æˆ– www2.example.com ç­‰éƒ½å¯ä»¥å‘é€ Cookieï¼Œæ‰€ä»¥ï¼Œé™¤äº†é’ˆå¯¹å…·ä½“æŒ‡å®šçš„å¤šä¸ªåŸŸåå‘é€Cookieä¹‹å¤–ï¼Œä¸æŒ‡å®šdomainå±æ€§æ˜¾å¾—æ›´å®‰å…¨ secureå±æ€§ï¼šæŒ‡å®š secure å±æ€§çš„æ–¹æ³•ä¸º Set-Cookie: name=value; secure HttpOnlyå±æ€§ï¼šæŒ‡å®š HttpOnly å±æ€§çš„æ–¹æ³•ä¸º Set-Cookie: name=value; HttpOnly ","date":"2020-06-01","objectID":"/2020/golang-set-and-use-cookie/:2:1","tags":["Goå®æˆ˜"],"title":"Golangè®¾ç½®ä¸ä½¿ç”¨cookie","uri":"/2020/golang-set-and-use-cookie/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 Cookie Cookie: status=enable åœ¨è¯·æ±‚æŠ¥æ–‡ä¸­æ·»åŠ è¯¥å­—æ®µåï¼Œå°±ç›¸å½“äºå‘Šè¯‰æœåŠ¡å™¨å®¢æˆ·ç«¯æƒ³è¦è·å¾— HTTP çŠ¶æ€ç®¡ç†æ”¯æŒã€‚æ¥æ”¶åˆ°å¤šä¸ªCookieæ—¶ï¼ŒåŒæ ·å¯ä»¥ä»¥å¤šä¸ªCookieå½¢å¼å‘é€ã€‚ ","date":"2020-06-01","objectID":"/2020/golang-set-and-use-cookie/:2:2","tags":["Goå®æˆ˜"],"title":"Golangè®¾ç½®ä¸ä½¿ç”¨cookie","uri":"/2020/golang-set-and-use-cookie/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. Session ç®¡ç† æŸäº› Web é¡µé¢åªæƒ³è®©ç‰¹å®šçš„äººæµè§ˆï¼Œæˆ–è€…å¹²è„†ä»…æœ¬äººå¯è§ï¼Œä¸ºè¾¾åˆ°è¿™ä¸ªç›®æ ‡ï¼Œéœ€è¦æ·»åŠ è®¤è¯åŠŸèƒ½ã€‚HTTP/1.1 å®ç”¨çš„è®¤è¯åŒ…æ‹¬ BASICè®¤è¯ã€DIGESTè®¤è¯ã€SSLå®¢æˆ·ç«¯è®¤è¯ã€FormBaseè®¤è¯ç­‰ï¼Œç”±äºä½¿ç”¨ä¸Šçš„ä¾¿åˆ©æ€§å’Œå®‰å…¨æ€§é—®é¢˜ï¼Œå‰ä¸¤ç§å‡ ä¹ä¸é€‚ç”¨ï¼ŒSSLå®¢æˆ·ç«¯è®¤è¯åˆ™ç”±äºå¯¼å…¥åŠè´¹ç”¨é—®é¢˜æœªå¾—åˆ°æ™®åŠï¼Œç›®å‰å¸¸ç”¨çš„æ˜¯æœ€åä¸€ç§ï¼šåŸºäºè¡¨å•çš„è®¤è¯ã€‚ åŸºäºè¡¨å•çš„è®¤è¯æ–¹æ³•å¹¶ä¸æ˜¯åœ¨HTTPåè®®ä¸­å®šä¹‰çš„ï¼Œè€Œæ˜¯ç”±å®¢æˆ·ç«¯é€šè¿‡è¡¨å•å‘æœåŠ¡å™¨æäº¤ç™»å½•ä¿¡æ¯ï¼Œç„¶åç”±æœåŠ¡å™¨å®‰è£…è‡ªå®šä¹‰çš„å®ç°æ–¹å¼è¿›è¡ŒéªŒè¯ï¼Œä¸åŒçš„åº”ç”¨ä½¿ç”¨çš„éªŒè¯æ–¹å¼å¤šæœ‰ä¸åŒï¼Œä½†å¤šæ•°æƒ…å†µä¸‹ï¼Œæ˜¯åŸºäºç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·IDï¼ˆé€šå¸¸æ˜¯ä»»æ„å­—ç¬¦ä¸²æˆ–é‚®ä»¶åœ°å€ï¼‰å’Œå¯†ç ç­‰ç™»å½•ä¿¡æ¯è¿›è¡Œè®¤è¯ã€‚ é‰´äº HTTP æ˜¯æ— çŠ¶æ€åè®®ï¼Œä¹‹å‰å·²è®¤è¯æˆåŠŸé¢ç”¨æˆ·çŠ¶æ€æ— æ³•ä¿ç•™ï¼Œå› æ­¤ä¸€èˆ¬ä½¿ç”¨ Cookie æ¥ç®¡ç† Session(ä¼šè¯)ã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒåŸºæœ¬çš„æ­¥éª¤ä¸º å®¢æˆ·ç«¯æŠŠç”¨æˆ·IDå’Œå¯†ç ç­‰ç™»å½•ä¿¡æ¯æ”¾å…¥æŠ¥æ–‡çš„å®ä½“éƒ¨åˆ†ï¼Œé€šå¸¸æ˜¯ä»¥POSTæ–¹æ³•æŠŠè¯·æ±‚å‘é€ç»™æœåŠ¡å™¨ã€‚è€Œè¿™æ—¶ï¼Œä¼šä½¿ç”¨HTTPSé€šä¿¡æ¥è¿›è¡ŒHTMLè¡¨å•ç”»é¢çš„æ˜¾ç¤ºå’Œç”¨æˆ·è¾“å…¥æ•°æ®çš„å‘é€ã€‚ æœåŠ¡å™¨ä¼šå‘æ”¾ç”¨ä»¥è¯†åˆ«ç”¨æˆ·çš„Session IDã€‚é€šè¿‡éªŒè¯ä»å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„ç™»å½•ä¿¡æ¯è¿›è¡Œèº«ä»½è®¤è¯ï¼Œç„¶åæŠŠç”¨æˆ·çš„è®¤è¯çŠ¶æ€ä¸Session IDç»‘å®šåè®°å½•åœ¨æœåŠ¡å™¨ç«¯ã€‚å‘å®¢æˆ·ç«¯è¿”å›å“åº”æ—¶ï¼Œä¼šåœ¨é¦–éƒ¨å­—æ®µSet-Cookieå†…å†™å…¥Session IDï¼ˆå¦‚PHPSESSID=028a8câ€¦ï¼‰ã€‚ä½ å¯ä»¥æŠŠSession IDæƒ³è±¡æˆä¸€ç§ç”¨ä»¥åŒºåˆ†ä¸åŒç”¨æˆ·çš„ç­‰ä½å·ã€‚ç„¶è€Œï¼Œå¦‚æœSession IDè¢«ç¬¬ä¸‰æ–¹ç›—èµ°ï¼Œå¯¹æ–¹å°±å¯ä»¥ä¼ªè£…æˆä½ çš„èº«ä»½è¿›è¡Œæ¶æ„æ“ä½œäº†ã€‚å› æ­¤å¿…é¡»é˜²æ­¢Session IDè¢«ç›—ï¼Œæˆ–è¢«çŒœå‡ºã€‚ä¸ºäº†åšåˆ°è¿™ç‚¹ï¼ŒSession IDåº”ä½¿ç”¨éš¾ä»¥æ¨æµ‹çš„å­—ç¬¦ä¸²ï¼Œä¸”æœåŠ¡å™¨ç«¯ä¹Ÿéœ€è¦è¿›è¡Œæœ‰æ•ˆæœŸçš„ç®¡ç†ï¼Œä¿è¯å…¶å®‰å…¨æ€§ã€‚å¦å¤–ï¼Œä¸ºå‡è½»è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰é€ æˆçš„æŸå¤±ï¼Œå»ºè®®äº‹å…ˆåœ¨Cookieå†…åŠ ä¸Šhttponlyå±æ€§ã€‚ å®¢æˆ·ç«¯æ¥æ”¶åˆ°ä»æœåŠ¡å™¨ç«¯å‘æ¥çš„Session IDåï¼Œä¼šå°†å…¶ä½œä¸ºCookieä¿å­˜åœ¨æœ¬åœ°ã€‚ä¸‹æ¬¡å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å‘é€Cookieï¼Œæ‰€ä»¥SessionIDä¹Ÿéšä¹‹å‘é€åˆ°æœåŠ¡å™¨ã€‚æœåŠ¡å™¨ç«¯å¯é€šè¿‡éªŒè¯æ¥æ”¶åˆ°çš„Session IDè¯†åˆ«ç”¨æˆ·å’Œå…¶è®¤è¯çŠ¶æ€ã€‚ éœ€è¦æ³¨æ„ï¼Œä¸Šè¿°ä»‹ç»å¹¶ä¸æ˜¯å”¯ä¸€çš„å®ç°æ–¹å¼ï¼Œå®é™…ä¸Šï¼Œä¸ä»…åŸºäºè¡¨å•è®¤è¯çš„ç™»å½•ä¿¡æ¯åŠè®¤è¯è¿‡ç¨‹æ²¡æœ‰æ ‡å‡†åŒ–ï¼ŒæœåŠ¡ç«¯å¦‚ä½•ä¿æŒå¯†ç ç­‰ç™»å½•ä¿¡æ¯ä¹Ÿæ²¡æœ‰æ ‡å‡†åŒ–ã€‚é€šå¸¸ï¼Œä¸€ç§å®‰å…¨çš„ä¿å­˜æ–¹æ³•æ˜¯ï¼Œå…ˆåˆ©ç”¨ç»™å¯†ç åŠ ç›ï¼ˆsaltï¼‰çš„æ–¹å¼å¢åŠ é¢å¤–ä¿¡æ¯ï¼Œå†ä½¿ç”¨æ•£åˆ—ï¼ˆhashï¼‰å‡½æ•°è®¡ç®—å‡ºæ•£åˆ—å€¼åä¿å­˜ã€‚ä½†æ˜¯æˆ‘ä»¬ä¹Ÿç»å¸¸çœ‹åˆ°ç›´æ¥ä¿å­˜æ˜æ–‡å¯†ç çš„åšæ³•ï¼Œè€Œè¿™æ ·çš„åšæ³•å…·æœ‰å¯¼è‡´å¯†ç æ³„éœ²çš„é£é™©ã€‚ ","date":"2020-06-01","objectID":"/2020/golang-set-and-use-cookie/:3:0","tags":["Goå®æˆ˜"],"title":"Golangè®¾ç½®ä¸ä½¿ç”¨cookie","uri":"/2020/golang-set-and-use-cookie/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. Goä¸­Cookieçš„è®¾ç½®ä¸è¯»å– ","date":"2020-06-01","objectID":"/2020/golang-set-and-use-cookie/:4:0","tags":["Goå®æˆ˜"],"title":"Golangè®¾ç½®ä¸ä½¿ç”¨cookie","uri":"/2020/golang-set-and-use-cookie/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4.1 è®¾ç½®Cookie Goè¯­è¨€ä¸­é€šè¿‡ net/http åŒ…ä¸­çš„ SetCookie æ¥è®¾ç½® Cookieï¼š http.SetCookie(w ResponseWriter, cookie *Cookie) w è¡¨ç¤ºéœ€è¦å†™å…¥çš„ responseï¼Œcookie æ˜¯ä¸€ä¸ª structï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¯¹è±¡æ˜¯æ€æ ·çš„ï¼š type Cookie strã€uct { Name string Value string Path string Domain string Expires time.Time RawExpires string // MaxAge=0 æ„å‘³ç€æ²¡æœ‰æŒ‡å®š Max-Age çš„å€¼ // MaxAge\u003c0 æ„å‘³ç€ç°åœ¨å°±åˆ é™¤ Cookieï¼Œç­‰ä»·äº Max-Age=0 // MaxAge\u003e0 æ„å‘³ç€ Max-Age å±æ€§å­˜åœ¨å¹¶ä»¥ç§’ä¸ºå•ä½å­˜åœ¨ MaxAge int Secure bool HttpOnly bool Raw string Unparsed []string // æœªè§£æçš„ attribute-value å±æ€§ä½å¯¹ } ä¸‹é¢æ¥çœ‹ä¸€ä¸ªå¦‚ä½•è®¾ç½® Cookie çš„ä¾‹å­ï¼š expiration := time.Now() expiration := expiration.AddDate(1, 0, 0) cookie := http.Cookie{ Name: \"username\", Value: \"zuolan\", Expires: expiration } http.SetCookie(writer, \u0026Cookie) ","date":"2020-06-01","objectID":"/2020/golang-set-and-use-cookie/:4:1","tags":["Goå®æˆ˜"],"title":"Golangè®¾ç½®ä¸ä½¿ç”¨cookie","uri":"/2020/golang-set-and-use-cookie/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4.2 è¯»å– Cookie ä¸Šé¢çš„ä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•è®¾ç½® Cookie æ•°æ®ï¼Œè¿™é‡Œæ¼”ç¤ºå¦‚ä½•è¯»å– Cookieï¼š cookie, _ := r.Cookie(\"username\") fmt.Fprint(w, cookie) è¿˜æœ‰å¦å¤–ä¸€ç§è¯»å–æ–¹å¼ï¼š for _, cookie := range r.Cookies() { fmt.Fprint(w, cookie.Name) } å¯ä»¥çœ‹åˆ°é€šè¿‡ request è·å– Cookie éå¸¸æ–¹ä¾¿ã€‚ ","date":"2020-06-01","objectID":"/2020/golang-set-and-use-cookie/:4:2","tags":["Goå®æˆ˜"],"title":"Golangè®¾ç½®ä¸ä½¿ç”¨cookie","uri":"/2020/golang-set-and-use-cookie/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"å‚è€ƒ ä¸Šé‡å®£[æ—¥]ï¼Œå›¾è§£HTTPï¼Œäººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾ï¼Œ2014 å­¦é™¢å›ï¼Œåœ¨ Go è¯­è¨€ä¸­è®¾ç½®ã€è¯»å–å’Œåˆ é™¤ HTTP Cookieï¼Œ2020 ","date":"2020-06-01","objectID":"/2020/golang-set-and-use-cookie/:5:0","tags":["Goå®æˆ˜"],"title":"Golangè®¾ç½®ä¸ä½¿ç”¨cookie","uri":"/2020/golang-set-and-use-cookie/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æ¨¡æ¿å°±æ˜¯åœ¨å†™åŠ¨æ€é¡µé¢æ—¶ä¸å˜çš„éƒ¨åˆ†ï¼ŒæœåŠ¡ç«¯ç¨‹åºæ¸²æŸ“å¯å˜éƒ¨åˆ†ç”ŸæˆåŠ¨æ€ç½‘é¡µï¼ŒGo è¯­è¨€æä¾›äº† html/template åŒ…æ¥æ”¯æŒæ¨¡æ¿æ¸²æŸ“ã€‚ ","date":"2020-05-29","objectID":"/2020/golang-template/:0:0","tags":["Goå®æˆ˜"],"title":"Golangæ¨¡æ¿","uri":"/2020/golang-template/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. åŸºæœ¬è¯­æ³• æ¨¡æ¿çš„åŸºæœ¬è¯­æ³•æ¥è‡ªäº text/template åŒ…ï¼Œä¸å¤§å¤šæ•°è¯­è¨€ä¸€æ ·ï¼Œç”¨ {{ å’Œ }} æ¥åšæ ‡è¯†ï¼Œ{{ }} é‡Œå¯ä»¥æ˜¯è¡¨è¾¾å¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å˜é‡ ","date":"2020-05-29","objectID":"/2020/golang-template/:1:0","tags":["Goå®æˆ˜"],"title":"Golangæ¨¡æ¿","uri":"/2020/golang-template/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.1 å˜é‡ æ¨¡æ¿ä¸­çš„å˜é‡é€šè¿‡{{.}} æ¥è®¿é—®ã€‚Golangæ¸²æŸ“templateçš„æ—¶å€™ï¼Œå¯ä»¥åœ¨æ¨¡æ¿æ–‡ä»¶ä¸­è¯»å–å˜é‡å†…çš„å€¼å¹¶æ¸²æŸ“åˆ°æ¨¡æ¿é‡Œã€‚æœ‰ä¸¤ä¸ªå¸¸ç”¨çš„ä¼ å…¥ç±»å‹ã€‚ä¸€æ˜¯structï¼Œåœ¨æ¨¡æ¿å†…å¯ä»¥è¯»å–è¯¥structçš„å†…å®¹ã€‚äºŒæ˜¯map[string]interface{}ï¼Œåœ¨æ¨¡æ¿å†…å¯ä»¥ä½¿ç”¨keyæ¥è¿›è¡Œæ¸²æŸ“ã€‚ ä»¥ç»“æ„ä½“ä¸ºä¾‹ï¼Œå‡è®¾åˆå§‹åŒ–äº†ä¸€ä¸ªç»“æ„ä½“ User type User struct { UserId int Username string Age uint Sex string } user := User{1, \"Steven\", 35, \"ç”·\"} æ¨¡æ¿è·å–æ•°æ®çš„æ–¹å¼å¦‚ä¸‹ {{.}}{{.Username}}{{.UserId}}{{.Age}}{{.Sex}} é‚£ä¹ˆæ¸²æŸ“åçš„æ¨¡æ¿å†…å®¹å¦‚ä¸‹ {1 Steven 35 ç”·}Steven135ç”· ä¹Ÿå¯ä»¥åœ¨æ¨¡æ¿ä¸­å®šä¹‰å˜é‡ï¼Œåˆå§‹åŒ–åå°±å¯ä»¥è¿›è¡Œè°ƒç”¨ï¼Œå¦‚ä¸‹æ‰€ç¤º {{$MyUserName := \"StevenWang\"}} {{$MyUserName}} ","date":"2020-05-29","objectID":"/2020/golang-template/:1:1","tags":["Goå®æˆ˜"],"title":"Golangæ¨¡æ¿","uri":"/2020/golang-template/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.2 é€»è¾‘åˆ¤æ–­ Golang æ¨¡æ¿æ”¯æŒ if æ¡ä»¶åˆ¤æ–­ï¼Œå½“å‰æ”¯æŒæœ€ç®€å•çš„ bool ç±»å‹å’Œ string ç±»å‹ï¼Œå®šä¹‰æ–¹å¼å¦‚ä¸‹ {{if .confition}} {{end}} å½“.conditionæ˜¯boolç±»å‹æ—¶ï¼Œå€¼ä¸ºtrueè¡¨ç¤ºæ‰§è¡Œã€‚å½“.conditionæ˜¯stringç±»å‹æ—¶ï¼Œå€¼éç©ºè¡¨ç¤ºæ‰§è¡Œã€‚åŠ å…¥ else æ—¶ï¼Œå½¢å¼å¦‚ä¸‹ {{if .confition}} {{else}} {{end}} æ­¤æ¨¡æ¿ä¹Ÿæ”¯æŒifâ€¦else ifåµŒå¥—ï¼Œå®šä¹‰æ–¹å¼å¦‚ä¸‹æ‰€ç¤º {{if .confition}} {{else if .confition}} {{end}} Golangçš„æ¨¡æ¿æä¾›äº†ä¸€äº›å†…ç½®çš„æ¨¡æ¿å‡½æ•°æ¥æ‰§è¡Œé€»è¾‘åˆ¤æ–­ï¼Œä¸‹é¢åˆ—ä¸¾ç›®å‰å¸¸ç”¨çš„ä¸€äº›å†…ç½®æ¨¡æ¿å‡½æ•° å‡½æ•°è¯­æ³• å‡½æ•°ä½œç”¨ {{if not .condition}} {{end}} not é {{if and .condition1 .condition2}} {{end}} and ä¸ {{if or .condition1 .condition2}} {{end}} or æˆ– {{if eq .var1 .var2}} {{end}} eq ç­‰äº {{if ne .var1 .var2}} {{end}} ne ä¸ç­‰äº {{if lt .var1 .var2}} {{end}} lt å°äº {{if le .var1 .var2}}{{end}} le å°äºç­‰äº {{if gt .var1 .var2}}{{end}} gt å¤§äº {{if ge .var1 .var2}}{{end}} ge å¤§äºç­‰äº å‡è®¾åœ¨ Go ç¨‹åºä¸­å®šä¹‰äº†ä¸€ä¸ªmapï¼Œå¦‚ä¸‹ locals := make(map[string]interface{}) locals[\"username1\"] = \"Steven\" locals[\"username2\"] = \"Daniel\" åœ¨æ¨¡æ¿æ–‡ä»¶ä¸­è¿›è¡Œé€»è¾‘åˆ¤æ–­å¦‚ä¸‹ {{if eq .username .user}} OK:è´¦å·åç§°ä¸€è‡´ {{else if ne .username .user}} Err:è´¦å·åç§°ä¸ä¸€è‡´ {{end}} é€»è¾‘åˆ¤æ–­ä¹Ÿå¯ä»¥ä½¿ç”¨ with ä½œä¸ºå…³é”®è¯ {{with .condition}} {{end}} æˆ–è€… {{with .condition}} {{else}} {{end}} ","date":"2020-05-29","objectID":"/2020/golang-template/:1:2","tags":["Goå®æˆ˜"],"title":"Golangæ¨¡æ¿","uri":"/2020/golang-template/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.3 å¾ªç¯éå† Golang çš„æ¨¡æ¿æ”¯æŒ range å¾ªç¯æ¥éå† mapã€sliceä¸­çš„å†…å®¹ï¼Œè¯­æ³•å¦‚ä¸‹ {{range $index, $value := .slice}} {{end}} åœ¨è¿™ä¸ªrangeå¾ªç¯å†…ï¼Œéå†æ•°æ®é€šè¿‡$indexå’Œ $valueæ¥å®ç°ã€‚è¿˜æœ‰ä¸€ç§éå†æ–¹å¼ï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹æ‰€ç¤º {{range .slice}} {{end}} è¿™ç§æ–¹å¼æ— æ³•è®¿é—®åˆ°$indexå’Œ$keyçš„å€¼ï¼Œéœ€è¦é€šè¿‡{{.}}æ¥è®¿é—®å¯¹åº”çš„$valueã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨å¾ªç¯ä½“å†…ï¼Œå¤–éƒ¨å˜é‡éœ€è¦ä½¿ç”¨{{$.}}æ¥è®¿é—®ã€‚ æ¨¡æ¿æ–‡ä»¶çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ {{range $index, $value := .filelist}} \u003cfigure\u003e \u003ca href=\"/html/upload/{{$value}}\"\u003e\u003cimg src=\"/html/upload/{{$value}}\"/\u003e\u003c/a\u003e \u003cfigcaption\u003e {{$value}} \u003cbr/\u003e \u003ca href=\"/delete?id={{$value}}\"\u003e[åˆ é™¤]\u003c/a\u003e {{$.username}}ä¸Šä¼  \u003c/figcaption\u003e \u003c/figure\u003e {{end}} å¾ªç¯ä¹Ÿæœ‰ else è¯­å¥ï¼Œå¦‚æœä½œä¸ºå¾ªç¯æ¡ä»¶çš„æ•°ç»„ã€åˆ‡ç‰‡ã€æ˜ å°„æˆ–é€šé“é•¿åº¦ä¸º0ï¼Œå°±æ‰§è¡Œ else åçš„è¯­å¥ã€‚ {{range .slice}} {{else}} {{end}} ","date":"2020-05-29","objectID":"/2020/golang-template/:1:3","tags":["Goå®æˆ˜"],"title":"Golangæ¨¡æ¿","uri":"/2020/golang-template/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.4 æ¨¡æ¿åµŒå¥— åœ¨ç¼–å†™æ¨¡æ¿çš„æ—¶å€™ï¼Œç»å¸¸éœ€è¦å°†å…¬ç”¨çš„æ¨¡æ¿è¿›è¡Œæ•´åˆï¼Œæ¯”å¦‚æ¯ä¸€ä¸ªé¡µé¢éƒ½æœ‰å¯¼èˆªæ å’Œé¡µè„šï¼Œé€šå¸¸çš„åšæ³•æ˜¯å°†å…¶ç¼–å†™ä¸ºä¸€ä¸ªå•ç‹¬çš„æ¨¡å—ï¼Œè®©æ‰€æœ‰çš„é¡µé¢è¿›è¡Œå¯¼å…¥ï¼Œè¿™æ ·å°±ä¸ç”¨é‡å¤ç¼–å†™äº†ã€‚ ä»»ä½•ç½‘é¡µéƒ½æœ‰ä¸€ä¸ªä¸»æ¨¡æ¿ï¼Œç„¶åå¯ä»¥åœ¨ä¸»æ¨¡æ¿å†…åµŒå…¥å­æ¨¡æ¿æ¥å®ç°æ¨¡å—å…±äº«ã€‚å½“æ¨¡æ¿æƒ³è¦å¼•å…¥å­æ¨¡æ¿æ—¶ï¼Œé€šå¸¸ä½¿ç”¨å¦‚ä¸‹è¯­å¥ {{template \"navbar\"}} è¿™æ ·å°±ä¼šè½½å…¥åä¸º navbar çš„å­æ¨¡ç‰ˆï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ navbar å­æ¨¡ç‰ˆçš„å®ç° {{define \"navbar\"}} {{end}} åœ¨å®šä¹‰ä¸­é—´çš„å†…å®¹æœ€ç»ˆä¼šæ›¿ä»£æºæ–‡ä»¶ä¸­çš„ {{template â€œnavbarâ€}} è¿™ä¸€æ¡è¯­å¥ å¦‚æœæƒ³è¦å­æ¨¡æ¿è·å¾—çˆ¶æ¨¡æ¿çš„å˜é‡ï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹æ³• {{template \"navbar\" .}} ","date":"2020-05-29","objectID":"/2020/golang-template/:1:4","tags":["Goå®æˆ˜"],"title":"Golangæ¨¡æ¿","uri":"/2020/golang-template/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. æ¨¡æ¿å‡½æ•° ä¸Šé¢çš„è¯­æ³•ä¸€èˆ¬æƒ…å†µéƒ½æ˜¯å®šä¹‰åœ¨å‰ç«¯æ–‡ä»¶ä¸­çš„ï¼Œè¦å¯¹æ¨¡æ¿è¿›è¡Œå¤„ç†ï¼Œhtml/template è¿˜æä¾›äº†ä¸€ç³»åˆ—å‡½æ•°ã€‚ ä¸€ä¸ªç®€å•çš„ä¾‹å­å¦‚ä¸‹ import \"text/template\" ... t, err := template.New(\"foo\").Parse(`{{define\"T\"}}Hello, {{.}}!{{end}}`) err = t.ExecuteTemplate(out, \"T\", \"\u003cscript\u003ealert('you have been pwned')\u003c/script\u003e\") æ¶‰åŠåˆ°çš„å‡ ä¸ªå‡½æ•°åˆ†åˆ«æ˜¯ Newï¼ŒParse å’Œ ExecuteTemplateï¼Œè§£é‡Šå¦‚ä¸‹ // åˆ›å»ºä¸€ä¸ªåä¸ºnameçš„æ¨¡æ¿ func New(name string) *Template // Parseæ–¹æ³•å°†å­—ç¬¦ä¸²textè§£æä¸ºæ¨¡æ¿ func (t *Template) Parse(src string) (*Template, error) // å°†è§£æå¥½çš„æ¨¡æ¿åº”ç”¨åˆ°dataä¸Šï¼Œä½¿ç”¨åä¸ºnameçš„tå…³è”çš„æ¨¡æ¿äº§ç”Ÿè¾“å‡ºã€‚ func (t *Template) ExecuteTemplate(wr io.Writer, name string, data interface{}) error æ‰€ä»¥ New å’Œ Parse åˆ›å»ºä¸€ä¸ªæ¨¡æ¿å¹¶å°†å­—ç¬¦ä¸²è§£æåˆ°è¯¥æ¨¡æ¿ï¼Œä½†å®é™…ä½¿ç”¨æ—¶æ¨¡æ¿æ–‡ä»¶é€šå¸¸æ˜¯å•ç‹¬çš„ï¼Œè¿™æ—¶ä¸€èˆ¬ä½¿ç”¨ Must å’Œ ParseFiles å‡½æ•°ã€‚ ParseFilesæ–¹æ³•è§£æfilenamesæŒ‡å®šçš„æ–‡ä»¶é‡Œçš„æ¨¡æ¿å®šä¹‰å¹¶å°†è§£æç»“æœä¸tå…³è”ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œä¼šåœæ­¢è§£æå¹¶è¿”å›nilï¼Œå¦åˆ™è¿”å›(t, nil)ã€‚è‡³å°‘è¦æä¾›ä¸€ä¸ªæ–‡ä»¶ã€‚ func (t *Template) ParseFiles(filenames ...string) (*Template, error) å¯ä»¥çœ‹åˆ° ParseFiles è¿”å› (*Template, error)ï¼ŒMust å‡½æ•°æ­£å¥½ç”¨æ¥å°è£…è¿™ç§è¿”å›å½¢å¼çš„å‡½æ•° func Must(t *Template, err error) *Template å®ƒä¼šåœ¨ err é nil æ—¶ panicï¼Œä¸€èˆ¬ç”¨äºå˜é‡åˆå§‹åŒ– var t = template.Must(template.New(\"name\").Parse(\"html\")) å¦å¤–ï¼ŒExecuteTemplate å°†è¾“å‡ºæŒ‡å®šåˆ°åä¸º name çš„æ¨¡æ¿ä¸Šï¼Œä½†è¿˜æœ‰ä¸€ç§ç®€å•å½¢å¼å¦‚ä¸‹ func (t *Template) Execute(wr io.Writer, data interface{}) error Executeæ–¹æ³•å°†è§£æå¥½çš„æ¨¡æ¿åº”ç”¨åˆ°dataä¸Šï¼Œå¹¶å°†è¾“å‡ºå†™å…¥wrï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯æ²¡æœ‰ç»‘å®šæ¨¡æ¿ã€‚ ","date":"2020-05-29","objectID":"/2020/golang-template/:2:0","tags":["Goå®æˆ˜"],"title":"Golangæ¨¡æ¿","uri":"/2020/golang-template/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æœ¬æ–‡ä»‹ç» gorilla/mux åŒ…çš„ä½¿ç”¨ã€‚ æˆ‘ä»¬å·²çŸ¥ Go æ ‡å‡†åº“ net/http æä¾›çš„é»˜è®¤è·¯ç”±æ˜¯ DefaultServeMuxï¼Œè™½ç„¶ç®€å•æ˜“ä¸Šæ‰‹ï¼Œä½†å­˜åœ¨å¾ˆå¤šä¸è¶³ï¼Œæ¯”å¦‚ ä¸æ”¯æŒå‚æ•°è®¾å®šï¼Œä¾‹å¦‚ /user/:uid è¿™ç§æ³›ç±»å‹åŒ¹é…ï¼› å¯¹ REST é£æ ¼æ¥å£æ”¯æŒä¸å‹å¥½ï¼Œæ— æ³•é™åˆ¶è®¿é—®è·¯ç”±çš„æ–¹æ³•ï¼› å¯¹äºæ‹¥æœ‰å¾ˆå¤šè·¯ç”±è§„åˆ™çš„åº”ç”¨ï¼Œç¼–å†™å¤§é‡è·¯ç”±è§„åˆ™éå¸¸ç¹çã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ gorilla/mux æä¾›çš„æ›´åŠ å¼ºå¤§çš„è·¯ç”±å¤„ç†å™¨ï¼ˆmux ä»£è¡¨ HTTP request multiplexerï¼Œå³ HTTP è¯·æ±‚å¤šè·¯å¤ç”¨å™¨ï¼‰ï¼Œå’Œ http.ServeMux å®ç°åŸç†ä¸€æ ·ï¼Œgorilla/mux æä¾›çš„è·¯ç”±å™¨å®ç°ç±» mux.Router ä¹Ÿä¼šåŒ¹é…ç”¨æˆ·è¯·æ±‚ä¸ç³»ç»Ÿæ³¨å†Œçš„è·¯ç”±è§„åˆ™ï¼Œç„¶åå°†ç”¨æˆ·è¯·æ±‚è½¬å‘è¿‡å»ã€‚ type Router struct { // Configurable Handler to be used when no route matches. NotFoundHandler http.Handler // Configurable Handler to be used when the request method does not match the route. MethodNotAllowedHandler http.Handler // Routes to be matched, in order. routes []*Route // Routes by name for URL building. namedRoutes map[string]*Route // If true, do not clear the request context after handling the request. // Deprecated: No effect, since the context is stored on the request itself. KeepContext bool // Slice of middlewares to be called after a match is found middlewares []middleware // configuration shared with `Route` routeConf } mux.Router ä¸»è¦å…·å¤‡ä»¥ä¸‹ç‰¹æ€§ï¼š å®ç°äº† http.Handler æ¥å£ï¼Œæ‰€ä»¥å’Œ http.ServeMux å®Œå…¨å…¼å®¹ï¼› å¯ä»¥åŸºäº URL ä¸»æœºã€è·¯å¾„ã€å‰ç¼€ã€schemeã€è¯·æ±‚å¤´ã€è¯·æ±‚å‚æ•°ã€è¯·æ±‚æ–¹æ³•è¿›è¡Œè·¯ç”±åŒ¹é…ï¼› URL ä¸»æœºã€è·¯å¾„ã€æŸ¥è¯¢å­—ç¬¦ä¸²æ”¯æŒå¯é€‰çš„æ­£åˆ™åŒ¹é…ï¼› æ”¯æŒæ„å»ºæˆ–åè½¬å·²æ³¨å†Œçš„ URL ä¸»æœºï¼Œä»¥ä¾¿ç»´æŠ¤å¯¹èµ„æºçš„å¼•ç”¨ï¼› æ”¯æŒè·¯ç”±åµŒå¥—ï¼Œä»¥ä¾¿ä¸åŒè·¯ç”±å¯ä»¥å…±äº«é€šç”¨æ¡ä»¶ï¼Œæ¯”å¦‚ä¸»æœºã€è·¯å¾„å‰ç¼€ç­‰ã€‚ ","date":"2020-05-29","objectID":"/2020/golang-use-gorilla/mux-package/:0:0","tags":["Goå®æˆ˜"],"title":"Golangä½¿ç”¨gorillaã€muxåŒ…","uri":"/2020/golang-use-gorilla/mux-package/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. ä½¿ç”¨å…¥é—¨ è¿è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£… $ go get -u github.com/gorilla/mux ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹å¦‚ä¸‹ func main() { r := mux.NewRouter() r.HandleFunc(\"/\", HomeHandler) r.HandleFunc(\"/products\", ProductsHandler) r.HandleFunc(\"/articles\", ArticlesHandler) http.ListenAndServe(\":8080\", r) } main å‡½æ•°ä¸­çš„ç¬¬ä¸€è¡Œæ˜¾å¼åˆå§‹åŒ–äº† mux.Router ä½œä¸ºè·¯ç”±å™¨ï¼Œç„¶ååœ¨è¿™ä¸ªè·¯ç”±å™¨ä¸­æ³¨å†Œè·¯ç”±è§„åˆ™ï¼Œæœ€åå°†è¿™ä¸ªè·¯ç”±å™¨ä¼ å…¥ http.ListenAndServe æ–¹æ³•ï¼Œæ•´ä¸ªè°ƒç”¨è¿‡ç¨‹å’Œä¹‹å‰å¹¶æ— äºŒè‡´ï¼Œå› ä¸ºmux.Router ä¹Ÿå®ç°äº† Handler æ¥å£ã€‚ è·¯å¾„ä¸­å¯ä»¥åŒ…å«å˜é‡ã€‚å˜é‡çš„å®šä¹‰å½¢å¼ä¸º {name} æˆ– {name:pattern}ï¼Œåªèƒ½æ˜¯å°å†™å­—æ¯ï¼Œä¸æ”¯æŒå…¶å®ƒå­—ç¬¦ï¼ŒåŒæ—¶ï¼Œname å¯ä»¥æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­æ‰€ç¤º r := mux.NewRouter() r.HandleFunc(\"/products/{key}\", ProductHandler) r.HandleFunc(\"/articles/{category}/\", ArticlesCategoryHandler) r.HandleFunc(\"/articles/{category}/{id:[0-9]+}\", ArticleHandler) ç›¸åº”åœ°ï¼Œåœ¨é—­åŒ…å¤„ç†å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ mux.Vars() è§£æè·¯ç”±å‚æ•°ï¼š func ArticlesCategoryHandler(w http.ResponseWriter, r *http.Request) { vars := mux.Vars(r) w.WriteHeader(http.StatusOK) fmt.Fprintf(w, \"Category: %v\\n\", vars[\"category\"]) } ","date":"2020-05-29","objectID":"/2020/golang-use-gorilla/mux-package/:1:0","tags":["Goå®æˆ˜"],"title":"Golangä½¿ç”¨gorillaã€muxåŒ…","uri":"/2020/golang-use-gorilla/mux-package/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. è·¯ç”±ä»£ç æ‹†åˆ† æ¯”è¾ƒç®€å•çš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„è·¯ç”±ã€å¤„ç†å™¨éƒ½æ”¾åœ¨åº”ç”¨å…¥å£æ–‡ä»¶ä¸­ï¼Œä¸€èˆ¬æ˜¯ main.goï¼Œä½†å¦‚æœé¡¹ç›®æ¯”è¾ƒå¤§ï¼Œç”šè‡³ä»…ä»…æ˜¯åšå®¢è¿™ç§çº§åˆ«çš„é¡¹ç›®ï¼Œå°±è¦å¤„ç†æ–‡ç« ã€ç”¨æˆ·ã€å›¾ç‰‡ç­‰ä¼—å¤šèµ„æºï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é’ˆå¯¹è¿™ç§æƒ…å†µè¿›è¡Œä¸€å®šçš„ä¼˜åŒ–ã€‚ ä¼˜åŒ–çš„åŠæ³•å°±æ˜¯å°†è·¯ç”±å™¨ä¸æ§åˆ¶å™¨åˆ†ç¦»ï¼Œä¸ºäº†ä½¿ä»£ç ç»“æ„æ›´åŠ æ¸…æ™°æ˜äº†ï¼Œæˆ‘ä»¬æŠŠæœåŠ¡å™¨ã€è·¯ç”±å™¨ã€è·¯ç”±å®šä¹‰ã€å¤„ç†å™¨æ–¹æ³•å…¨éƒ½æ‹†åˆ†å¼€ã€‚ ","date":"2020-05-29","objectID":"/2020/golang-use-gorilla/mux-package/:2:0","tags":["Goå®æˆ˜"],"title":"Golangä½¿ç”¨gorillaã€muxåŒ…","uri":"/2020/golang-use-gorilla/mux-package/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 è·¯ç”±å™¨ æˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»º routes ç›®å½•ç”¨æ¥å­˜æ”¾è·¯ç”±å®šä¹‰åŠå®ç°ã€‚ é¦–å…ˆåœ¨ routes ç›®å½•ä¸‹åˆ›å»º routes.go å­˜æ”¾è·¯ç”±å®šä¹‰ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ package routes import \"net/http\" // å®šä¹‰ä¸€ä¸ª WebRoute ç»“æ„ä½“ç”¨äºå­˜æ”¾å•ä¸ªè·¯ç”± type WebRoute struct { Name string Method string Pattern string HandlerFunc http.HandlerFunc } // å£°æ˜ WebRoutes åˆ‡ç‰‡å­˜æ”¾æ‰€æœ‰ Web è·¯ç”± type WebRoutes []WebRoute // å®šä¹‰æ‰€æœ‰ Web è·¯ç”± var webRoutes = WebRoutes{ } åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª WebRoute ç»“æ„ä½“æ¥è¡¨ç¤ºå•ä¸ªè·¯ç”±ï¼Œå…¶ä¸­åŒ…å«äº†è·¯ç”±åç§°ã€è¯·æ±‚æ–¹æ³•ã€åŒ¹é…å­—ç¬¦ä¸²æ¨¡å¼ã€ä»¥åŠå¯¹åº”çš„å¤„ç†å™¨æ–¹æ³•ï¼Œè·¯ç”±å™¨å¯ä»¥æ ¹æ®è¿™äº›é…ç½®è¯·æ±‚è¯·æ±‚åˆ†å‘ã€‚ ç„¶åå®šä¹‰äº†ä¸€ä¸ª WebRoutes åˆ‡ç‰‡æ¥å­˜æ”¾æ‰€æœ‰ WebRoute ç±»å‹çš„è·¯ç”±ï¼Œæœ€ååˆå§‹åŒ–è¿™ä¸ªåˆ‡ç‰‡ä¸ºç©ºï¼Œè¡¨ç¤ºè¿˜æ²¡æœ‰å®šä¹‰ä»»ä½•è·¯ç”±ã€‚ æ¥ä¸‹æ¥ï¼Œåœ¨ routes ç›®å½•ä¸‹åˆ›å»º router.go ç”¨æ¥ç¼–å†™è·¯ç”±å™¨å®ç° package routes import \"github.com/gorilla/mux\" // è¿”å›ä¸€ä¸ª mux.Router ç±»å‹æŒ‡é’ˆï¼Œä»è€Œå¯ä»¥å½“ä½œå¤„ç†å™¨ä½¿ç”¨ func NewRouter() *mux.Router { // åˆ›å»º mux.Router è·¯ç”±å™¨ç¤ºä¾‹ router := mux.NewRouter().StrictSlash(true) // éå† web.go ä¸­å®šä¹‰çš„æ‰€æœ‰ webRoutes for _, route := range webRoutes { // å°†æ¯ä¸ª web è·¯ç”±åº”ç”¨åˆ°è·¯ç”±å™¨ router.Methods(route.Method). Path(route.Pattern). Name(route.Name). Handler(route.HandlerFunc) } return router } StrictSlash å®šä¹‰æ–œæ å°¾éšè¡Œä¸ºï¼Œæ„æ€æ˜¯ï¼Œä¼ å…¥ true æ—¶ï¼Œå¦‚æœè·¯ç”±è·¯å¾„æ˜¯ /path è¿™ç§å½¢å¼ï¼Œå°†é‡å®šå‘åˆ° /path/ ï¼Œåä¹‹äº¦ç„¶ã€‚ä¼ å…¥ false æ—¶ï¼Œä¸ä¼šé‡å®šå‘ï¼Œè¿™ä¸¤ç§æƒ…å†µä¸ä¼šçœ‹ä½œä¸€ç§ã€‚ Methodsï¼ŒPathï¼ŒNameï¼ŒHandleråˆ†åˆ«ç”¨æ¥é™å®šè¯·æ±‚æ–¹æ³•ã€åŒ¹é…å­—ç¬¦ä¸²æ¨¡å¼ã€è·¯ç”±åå’Œå¤„ç†å™¨æ–¹æ³•ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å°† routes.go ä¸­å®šä¹‰çš„æ‰€æœ‰ Web è·¯ç”±éƒ½åº”ç”¨åˆ°äº†ä½¿ç”¨ mux.NewRouter åˆ›å»ºçš„è·¯ç”±å™¨ï¼Œä»¥ä¾¿å¯ä»¥å¤„ç†ç”¨æˆ·è¯·æ±‚çš„è·¯ç”±åŒ¹é…å’Œåˆ†å‘ã€‚ ","date":"2020-05-29","objectID":"/2020/golang-use-gorilla/mux-package/:2:1","tags":["Goå®æˆ˜"],"title":"Golangä½¿ç”¨gorillaã€muxåŒ…","uri":"/2020/golang-use-gorilla/mux-package/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 æœåŠ¡å™¨ åœ¨å…¥å£æ–‡ä»¶ main.go ä¸­ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•å¯åŠ¨æœåŠ¡å™¨ package main import ( . \"github.com/shuzang/projectname/routes\" \"log\" \"net/http\" ) func main() { startWebServer(\"8080\") } func startWebServer(port string) { r := NewRouter() http.Handle(\"/\", r) log.Println(\"Starting HTTP service at \" + port) err := http.ListenAndServe(\":\"+port, nil) // Goroutine will block here if err != nil { log.Println(\"An error occured starting HTTP listener at port \" + port) log.Println(\"Error: \" + err.Error()) } } æˆ‘ä»¬å°† Web æœåŠ¡å™¨å¯åŠ¨é€»è¾‘å°è£…åˆ° startWebServer æ–¹æ³•ä¸­å®ç°ï¼Œè¯¥æ–¹æ³•éœ€è¦ä¼ å…¥ç«¯å£å‚æ•°ã€‚åœ¨å…·ä½“å®ç°æ—¶ï¼Œæˆ‘ä»¬è°ƒç”¨äº† routes/router.go ä¸­å®šä¹‰çš„ NewRouter æ–¹æ³•ï¼Œå°†å…¶è¿”å›å€¼ä½œä¸ºå¤„ç†å™¨ä¼ å…¥ http.Handle æ–¹æ³•ï¼Œæœ€åè°ƒç”¨ http.ListenAndServe å¯åŠ¨ Web æœåŠ¡å™¨å¹¶ç›‘å¬ä¼ å…¥çš„ç«¯å£å·ã€‚ æœ€ååœ¨ main æ–¹æ³•ä¸­è°ƒç”¨ startWebServer æ–¹æ³•å³å¯ã€‚ ","date":"2020-05-29","objectID":"/2020/golang-use-gorilla/mux-package/:2:2","tags":["Goå®æˆ˜"],"title":"Golangä½¿ç”¨gorillaã€muxåŒ…","uri":"/2020/golang-use-gorilla/mux-package/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 å¤„ç†å™¨ ä¸Šå±‚ä»£ç å†™å®Œåï¼Œç°åœ¨å®šä¹‰å¤„ç†å™¨æ–¹æ³•ã€‚åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»º handlers ç›®å½•å­˜æ”¾å¤„ç†å™¨æ–¹æ³•ï¼Œè¿™é‡Œä¸¾ 2 ä¸ªç¤ºä¾‹ï¼Œåˆ†åˆ«å®šä¹‰åœ¨ common.go å’Œ user.go ä¸¤ä¸ªæ–‡ä»¶ä¸­ï¼Œç”¨æ¥å¤„ç†é€šç”¨è¯·æ±‚å’Œç”¨æˆ·èµ„æºã€‚ é¦–å…ˆåœ¨ common.go ä¸­ç¼–å†™é¦–é¡µè¯·æ±‚å¤„ç†å™¨æ–¹æ³• package handlers import ( \"io\" \"net/http\" ) func Home(w http.ResponseWriter, r *http.Request) { io.WriteString(w, \"Welcome to my site\") } ç„¶ååœ¨ user.go ä¸­å®šä¹‰è·å–æŒ‡å®šç”¨æˆ·å¯¹åº”å¤„ç†å™¨æ–¹æ³• package handlers import ( \"github.com/gorilla/mux\" \"io\" \"net/http\" ) func GetUser(w http.ResponseWriter, r *http.Request) { // Get user from DB by id... params := mux.Vars(r) id := params[\"id\"] io.WriteString(w, \"Return user info with id = \" + id) } è¿™æ—¶è¦è®°å¾—ï¼Œroutes/routes.go ä¸­çš„è·¯ç”±åˆ‡ç‰‡è¿˜æ˜¯ç©ºçš„ï¼Œç”¨å®ç°çš„å¤„ç†å™¨å¡«å……å®ƒ var webRoutes = WebRoutes{ WebRoute{ \"Home\", \"GET\", \"/\", handlers.Home, }, WebRoute{ \"User\", \"GET\", \"/user/{id}\", handlers.GetUser, }, } ","date":"2020-05-29","objectID":"/2020/golang-use-gorilla/mux-package/:2:3","tags":["Goå®æˆ˜"],"title":"Golangä½¿ç”¨gorillaã€muxåŒ…","uri":"/2020/golang-use-gorilla/mux-package/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. è·¯ç”±åŒ¹é…è§„åˆ™ ç¬¬ä¸€éƒ¨åˆ†çš„è·¯ç”±åŒ¹é…è§„åˆ™åªæ˜¯ç®€å•ä»‹ç»ï¼Œå®é™…ä¸Šï¼Œgorilla/mux å®ç°çš„åŒ¹é…è§„åˆ™éå¸¸å¼ºå¤§ã€‚ ","date":"2020-05-29","objectID":"/2020/golang-use-gorilla/mux-package/:3:0","tags":["Goå®æˆ˜"],"title":"Golangä½¿ç”¨gorillaã€muxåŒ…","uri":"/2020/golang-use-gorilla/mux-package/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.1 å¸¸ç”¨åŒ¹é…è§„åˆ™ é™å®šè¯·æ±‚æ–¹æ³• r.HandleFunc(\"/books/{title}\", CreateBook).Methods(\"POST\") r.HandleFunc(\"/books/{title}\", ReadBook).Methods(\"GET\") r.HandleFunc(\"/books/{title}\", UpdateBook).Methods(\"PUT\") r.HandleFunc(\"/books/{title}\", DeleteBook).Methods(\"DELETE\") é™å®šä¸»æœºåæˆ–å­åŸŸå r.HandleFunc(\"/books/{title}\", BookHandler).Host(\"www.mybookstore.com\") é™å®š Scheme r.HandleFunc(\"/secure\", SecureHandler).Schemes(\"https\") r.HandleFunc(\"/insecure\", InsecureHandler).Schemes(\"http\") é™å®šå‰ç¼€å’Œå­è·¯ç”± bookrouter := r.PathPrefix(\"/books\").Subrouter() bookrouter.HandleFunc(\"/\", AllBooks) bookrouter.HandleFunc(\"/{title}\", GetBook) é™å®šè¯·æ±‚å‚æ•° r.HandleFunc(\"/request/header\", func(w http.ResponseWriter, r *http.Request) { header := \"X-Requested-With\" fmt.Fprintf(w, \"åŒ…å«æŒ‡å®šè¯·æ±‚å¤´[%s=%s]\", header, r.Header[header]) }).Headers(\"X-Requested-With\", \"XMLHttpRequest\") ","date":"2020-05-29","objectID":"/2020/golang-use-gorilla/mux-package/:3:1","tags":["Goå®æˆ˜"],"title":"Golangä½¿ç”¨gorillaã€muxåŒ…","uri":"/2020/golang-use-gorilla/mux-package/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.2 è‡ªå®šä¹‰åŒ¹é…è§„åˆ™ gorilla/mux è·¯ç”±æ”¯æŒé€šè¿‡ MatcherFunc æ–¹æ³•è‡ªå®šä¹‰è·¯ç”±åŒ¹é…è§„åˆ™ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­ï¼Œå¯ä»¥è·å–åˆ°è¯·æ±‚å®ä¾‹ requestï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°æ‰€æœ‰çš„ç”¨æˆ·è¯·æ±‚ä¿¡æ¯ï¼Œå¹¶å¯¹å…¶è¿›è¡Œåˆ¤æ–­ï¼Œç¬¦åˆæˆ‘ä»¬é¢„æœŸçš„è¯·æ±‚æ‰èƒ½åŒ¹é…å¹¶è®¿é—®è¯¥æ–¹æ³•åº”ç”¨åˆ°çš„è·¯ç”±ã€‚ æ¯”å¦‚ä¸‹é¢è¿™ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬é™å®šåªæœ‰æ¥è‡ª https://baidu.com åŸŸåçš„è¯·æ±‚æ‰å¯ä»¥åŒ¹é…åˆ° /custom/matcher è·¯ç”± r.HandleFunc(\"/custom/matcher\", func(w http.ResponseWriter, r *http.Request) { fmt.Fprintf(w, \"è¯·æ±‚æ¥è‡ªæŒ‡å®šåŸŸå: %s\", r.Referer()) }).MatcherFunc(func(request *http.Request, match *mux.RouteMatch) bool { return request.Referer() == \"https://baidu.com\" }) ","date":"2020-05-29","objectID":"/2020/golang-use-gorilla/mux-package/:3:2","tags":["Goå®æˆ˜"],"title":"Golangä½¿ç”¨gorillaã€muxåŒ…","uri":"/2020/golang-use-gorilla/mux-package/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.3 è·¯ç”±å‘½å é€šè¿‡ Name æ–¹æ³•åœ¨è·¯ç”±è§„åˆ™ä¸­æŒ‡å®š postRouter := r.PathPrefix(\"/posts\").Subrouter() postRouter.HandleFunc(\"/\", listPosts).Methods(\"GET\").Name(\"posts.index\") postRouter.HandleFunc(\"/create\", createPost).Methods(\"POST\").Name(\"posts.create\") ","date":"2020-05-29","objectID":"/2020/golang-use-gorilla/mux-package/:3:3","tags":["Goå®æˆ˜"],"title":"Golangä½¿ç”¨gorillaã€muxåŒ…","uri":"/2020/golang-use-gorilla/mux-package/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. è·¯ç”±ä¸­é—´ä»¶ ","date":"2020-05-29","objectID":"/2020/golang-use-gorilla/mux-package/:4:0","tags":["Goå®æˆ˜"],"title":"Golangä½¿ç”¨gorillaã€muxåŒ…","uri":"/2020/golang-use-gorilla/mux-package/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"5. å¤„ç†é™æ€èµ„æºå“åº” ä½¿ç”¨é»˜è®¤httpåŒ…å¤„ç†é™æ€èµ„æºçš„æ–¹æ³•å¦‚ä¸‹ fs := http.FileServer(http.Dir(\"assets/\")) http.Handle(\"/static/\", http.StripPrefix(\"/static/\", fs)) ä½¿ç”¨ gorilla/mux æ—¶ï¼Œå¤„ç†æ–¹æ³•å¾ˆç›¸ä¼¼ r := NewRouter() // é€šè¿‡ router.go ä¸­å®šä¹‰çš„è·¯ç”±å™¨æ¥åˆ†å‘è¯·æ±‚ assets := http.FileServer(http.Dir(\"public\")) r.PathPrefix(\"/static/\").Handler(http.StripPrefix(\"/static/\", assets)) http.Handle(\"/\", r) // åº”ç”¨è·¯ç”±å™¨åˆ° HTTP æœåŠ¡å™¨ ... è™½ç„¶ gorilla/mux è·¯ç”±å™¨æä¾›äº†å¯¹é™æ€èµ„æºçš„æ”¯æŒï¼Œä½†æ˜¯é€šå¸¸æˆ‘ä»¬è¿˜æ˜¯ä¼šåŸºäº Nginx æ¥å¤„ç†é™æ€èµ„æºï¼Œç„¶åå°†åŠ¨æ€è¯·æ±‚è½¬å‘ç»™ Go HTTP æœåŠ¡å™¨ï¼Œå› ä¸º Nginx ä½œä¸ºä¸€æ¬¾å¼ºå¤§çš„åå‘ä»£ç†æœåŠ¡å™¨ï¼Œå¹¶å‘å¤„ç†é™æ€èµ„æºçš„èƒ½åŠ›éå¸¸å¼ºæ‚ï¼Œæ²¡å¿…è¦è‡ªå·±å»å¤„ç†è¿™å—é€»è¾‘ã€‚ ","date":"2020-05-29","objectID":"/2020/golang-use-gorilla/mux-package/:5:0","tags":["Goå®æˆ˜"],"title":"Golangä½¿ç”¨gorillaã€muxåŒ…","uri":"/2020/golang-use-gorilla/mux-package/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æœ¬æ–‡ä»‹ç» Golang å¦‚ä½•å®ç° HTTP æœåŠ¡ç«¯åŠå®¢æˆ·ç«¯ã€‚ ","date":"2020-05-29","objectID":"/2020/golang-start-http-server/:0:0","tags":["Goå®æˆ˜"],"title":"Golangå¯åŠ¨HTTPæœåŠ¡å™¨","uri":"/2020/golang-start-http-server/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. HTTPåè®®å®¢æˆ·ç«¯å®ç° Goè¯­è¨€æ ‡å‡†åº“å†…ç½®äº†net/httpåŒ…ï¼Œæ¶µç›–äº†HTTPå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å…·ä½“çš„å®ç°æ–¹å¼ã€‚å†…ç½®çš„net/httpåŒ…æä¾›äº†æœ€ç®€æ´çš„HTTPå®¢æˆ·ç«¯å®ç°æ–¹å¼ï¼Œæ— é¡»å€ŸåŠ©ç¬¬ä¸‰æ–¹ç½‘ç»œé€šä¿¡åº“ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨HTTPä¸­ç”¨å¾—æœ€å¤šçš„GETå’ŒPOSTæ–¹å¼è¯·æ±‚æ•°æ®ã€‚ å®ç°HTTPå®¢æˆ·ç«¯å°±æ˜¯å®¢æˆ·ç«¯é€šè¿‡ç½‘ç»œè®¿é—®å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚ï¼ŒæœåŠ¡ç«¯å‘é€å“åº”ä¿¡æ¯ï¼Œå¹¶å°†ç›¸åº”ä¿¡æ¯è¾“å‡ºåˆ°å®¢æˆ·ç«¯çš„è¿‡ç¨‹ã€‚å®ç°å®¢æˆ·ç«¯æœ‰å¤šç§æ–¹å¼ï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºã€‚ ","date":"2020-05-29","objectID":"/2020/golang-start-http-server/:1:0","tags":["Goå®æˆ˜"],"title":"Golangå¯åŠ¨HTTPæœåŠ¡å™¨","uri":"/2020/golang-start-http-server/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.1 ä½¿ç”¨http.NewRequest()æ–¹æ³• é¦–å…ˆåˆ›å»ºä¸€ä¸ªclientï¼ˆå®¢æˆ·ç«¯ï¼‰å¯¹è±¡ï¼Œå…¶æ¬¡åˆ›å»ºä¸€ä¸ªrequestï¼ˆè¯·æ±‚ï¼‰å¯¹è±¡ï¼Œæœ€åä½¿ç”¨clientå‘é€requestã€‚ package main import ( \"fmt\" \"net/http\" ) func main() { testHttpNewRequest() } func testHttpNewRequest() { //1.åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ client := http.Client{} //2.åˆ›å»ºä¸€ä¸ªè¯·æ±‚ï¼Œè¯·æ±‚æ–¹å¼å¯ä»¥æ˜¯GETæˆ–POST request, err := http.NewRequest(\"GET\", \"http://www.baidu.com\", nil) checkErr(err) //3.å®¢æˆ·ç«¯å‘é€è¯·æ±‚ cookName := \u0026http.Cookie{Name: \"username\", Value: \"Steven\"} //æ·»åŠ cookie request.AddCookie(cookName) response, err := client.Do(request) checkErr(err) //è®¾ç½®è¯·æ±‚å¤´ request.Header.Set(\"Accept-Lanauage\", \"zh-cn\") defer response.Body.Close() //æŸ¥çœ‹è¯·æ±‚å¤´çš„æ•°æ® fmt.Printf(\"Header:%+v\\n\", request.Header) fmt.Printf(\"å“åº”çŠ¶æ€ç : %v\\n\", response.StatusCode) //4.æ“ä½œæ•°æ® if response.StatusCode == 200 { fmt.Println(\"ç½‘ç»œè¯·æ±‚æˆåŠŸ\") checkErr(err) } else { fmt.Println(\"ç½‘ç»œè¯·æ±‚å¤±è´¥\", response.Status) } } //æ£€æŸ¥é”™è¯¯ func checkErr(err error) { defer func() { if ins, ok := recover().(error); ok { fmt.Println(\"ç¨‹åºå‡ºç°å¼‚å¸¸: \", ins.Error()) } }() if err != nil { panic(err) } } è¿è¡Œç»“æœå¦‚ä¸‹ $ go run main.go Header:map[Accept-Lanauage:[zh-cn] Cookie:[username=Steven]] å“åº”çŠ¶æ€ç : 200 ç½‘ç»œè¯·æ±‚æˆåŠŸ ","date":"2020-05-29","objectID":"/2020/golang-start-http-server/:1:1","tags":["Goå®æˆ˜"],"title":"Golangå¯åŠ¨HTTPæœåŠ¡å™¨","uri":"/2020/golang-start-http-server/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.2 è°ƒç”¨client.Get() æ–¹æ³• è¿™ç§æ–¹æ³•æ€»å…±ä¸¤ä¸ªæ­¥éª¤ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªclientï¼ˆå®¢æˆ·ç«¯ï¼‰å¯¹è±¡ï¼Œç„¶åä½¿ç”¨clientè°ƒç”¨Get()æ–¹æ³•ã€‚ package main import ( \"fmt\" \"net/http\" ) func main() { testClientGet() } func testClientGet() { //1.åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ client := http.Client{} //2.é€šè¿‡clientè¯·æ±‚ response, err := client.Get(\"http://www.baidu.com\") checkErr(err) fmt.Printf(\"å“åº”çŠ¶æ€ç : %v\\n\", response.StatusCode) if response.StatusCode == 200 { fmt.Println(\"ç½‘ç»œè¯·æ±‚æˆåŠŸ\") defer response.Body.Close() } } //æ£€æŸ¥é”™è¯¯ func checkErr(err error) { defer func() { if ins, ok := recover().(error); ok { fmt.Println(\"ç¨‹åºå‡ºç°å¼‚å¸¸: \", ins.Error()) } }() if err != nil { panic(err) } } è¿è¡Œç»“æœå¦‚ä¸‹ $ go run main.go å“åº”çŠ¶æ€ç : 200 ç½‘ç»œè¯·æ±‚æˆåŠŸ ","date":"2020-05-29","objectID":"/2020/golang-start-http-server/:1:2","tags":["Goå®æˆ˜"],"title":"Golangå¯åŠ¨HTTPæœåŠ¡å™¨","uri":"/2020/golang-start-http-server/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.3 ä½¿ç”¨client.Post()æˆ–client.PostForm()æ–¹æ³• è¿™ç§æ–¹æ³•ä¹Ÿæ˜¯ä¸¤ä¸ªæ­¥éª¤ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªclientï¼ˆå®¢æˆ·ç«¯ï¼‰å¯¹è±¡ï¼Œç„¶åä½¿ç”¨clientè°ƒç”¨Post()æˆ–PostForm()æ–¹æ³•ã€‚å…¶å®clientçš„Post()æˆ–PostForm()æ–¹æ³•ï¼Œå°±æ˜¯å¯¹http.NewRequest()çš„å°è£…ã€‚ resp, err := http.Post(\"http://example.com/upload\", \"image/jpeg\", \u0026buf) ... resp, err := http.PostForm(\"http://example.com/form\", url.Values{\"key\": {\"Value\"}, \"id\": {\"123\"}}) ","date":"2020-05-29","objectID":"/2020/golang-start-http-server/:1:3","tags":["Goå®æˆ˜"],"title":"Golangå¯åŠ¨HTTPæœåŠ¡å™¨","uri":"/2020/golang-start-http-server/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.4 ä½¿ç”¨http.Get() æ–¹æ³• è¿™ç§æ–¹å¼åªæœ‰ä¸€ä¸ªæ­¥éª¤ï¼Œhttpçš„Get()æ–¹æ³•å°±æ˜¯å¯¹DefaultClient.Get()çš„å°è£…ã€‚ package main import ( \"fmt\" \"net/http\" ) func main() { testHttpGet() } func testHttpGet() { //è·å–æœåŠ¡å™¨æ•°æ® response, err := http.Get(\"http://www.baidu.com\") checkErr(err) fmt.Printf(\"å“åº”çŠ¶æ€ç : %v\\n\", response.StatusCode) if response.StatusCode == 200 { fmt.Println(\"ç½‘ç»œè¯·æ±‚æˆåŠŸ\") defer response.Body.Close() checkErr(err) } else { fmt.Println(\"è¯·æ±‚å¤±è´¥\", response.Status) } } //æ£€æŸ¥é”™è¯¯ func checkErr(err error) { defer func() { if ins, ok := recover().(error); ok { fmt.Println(\"ç¨‹åºå‡ºç°å¼‚å¸¸: \", ins.Error()) } }() if err != nil { panic(err) } } è¿è¡Œç»“æœä¸º $ go run main.go å“åº”çŠ¶æ€ç : 200 ç½‘ç»œè¯·æ±‚æˆåŠŸ ","date":"2020-05-29","objectID":"/2020/golang-start-http-server/:1:4","tags":["Goå®æˆ˜"],"title":"Golangå¯åŠ¨HTTPæœåŠ¡å™¨","uri":"/2020/golang-start-http-server/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.5 ä½¿ç”¨http.Post()æˆ–http.PostForm()æ–¹æ³• httpçš„Post()å‡½æ•°æˆ–PostForm()ï¼Œå°±æ˜¯å¯¹DefaultClient.Post()æˆ–DefaultClient.PostForm()çš„å°è£…ã€‚è¿™ç§æ–¹æ³•ä¹Ÿåªéœ€è¦ä¸€ä¸ªæ­¥éª¤ ","date":"2020-05-29","objectID":"/2020/golang-start-http-server/:1:5","tags":["Goå®æˆ˜"],"title":"Golangå¯åŠ¨HTTPæœåŠ¡å™¨","uri":"/2020/golang-start-http-server/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. HTTPåè®®æœåŠ¡ç«¯å®ç° ä½¿ç”¨Goè¯­è¨€æ ‡å‡†åº“å†…ç½®çš„net/httpåŒ…ï¼Œå°±å¯ä»¥å®ç°ä¸€ä¸ªåŸºæœ¬çš„HTTPæœåŠ¡ç«¯ã€‚ä¸€ä¸ªåŸºæœ¬çš„HTTPæœåŠ¡å™¨ä¸»è¦åº”å®Œæˆå¦‚ä¸‹åŠŸèƒ½ å¤„ç†åŠ¨æ€è¯·æ±‚ï¼šå¤„ç†æµè§ˆç½‘ç«™ï¼Œç™»å½•å¸æˆ·æˆ–å‘å¸ƒå›¾ç‰‡ç­‰ç”¨æˆ·ä¼ å…¥çš„è¯·æ±‚ã€‚ æä¾›é™æ€æ–‡ä»¶ï¼šå°†JavaScriptï¼ŒCSSå’Œå›¾åƒç­‰é™æ€æ–‡ä»¶æä¾›ç»™æµè§ˆå™¨ï¼ŒæœåŠ¡äºç”¨æˆ·ã€‚ æ¥å—è¿æ¥è¯·æ±‚ï¼šHTTPæœåŠ¡å™¨å¿…é¡»ç›‘å¬æŒ‡å®šç«¯å£ä»è€Œæ¥æ”¶æ¥è‡ªç½‘ç»œçš„è¿æ¥è¯·æ±‚ã€‚ ","date":"2020-05-29","objectID":"/2020/golang-start-http-server/:2:0","tags":["Goå®æˆ˜"],"title":"Golangå¯åŠ¨HTTPæœåŠ¡å™¨","uri":"/2020/golang-start-http-server/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 å¤„ç†åŠ¨æ€è¯·æ±‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨http.HandleFuncå‡½æ•°æ³¨å†Œä¸€ä¸ªæ–°çš„ Handler æ¥å¤„ç†åŠ¨æ€è¯·æ±‚ã€‚å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¯·æ±‚è·¯å¾„çš„åŒ¹é…æ¨¡å¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹ï¼Œè¡¨ç¤ºé’ˆå¯¹è¿™ä¸ªè¯·æ±‚è¦æ‰§è¡Œçš„åŠŸèƒ½ã€‚ä¸‹ä¾‹ä¸­é’ˆå¯¹è¯·æ±‚è¿”å›ä¸€ä¸ªæ¬¢è¿è®¿é—®çš„æç¤ºè¯­ã€‚ http.HandleFunc(\"/\", func (w http.ResponseWriter, r *http.Request) { fmt.Fprint(w, \"Welcome to my website!\") }) http.ResponseWriterç±»å‹åŒ…å«äº†æœåŠ¡å™¨ç«¯ç»™å®¢æˆ·ç«¯çš„å“åº”æ•°æ®ã€‚æœåŠ¡å™¨ç«¯å¾€é‡Œé¢å†™å…¥äº†ä»€ä¹ˆå†…å®¹ï¼Œæµè§ˆå™¨çš„ç½‘é¡µæºç å°±æ˜¯ä»€ä¹ˆå†…å®¹ã€‚*http.RequeståŒ…å«äº†å®¢æˆ·ç«¯å‘é€ç»™æœåŠ¡å™¨ç«¯çš„è¯·æ±‚ä¿¡æ¯ï¼ˆè·¯å¾„ã€æµè§ˆå™¨ç±»å‹ç­‰ï¼‰ã€‚ ","date":"2020-05-29","objectID":"/2020/golang-start-http-server/:2:1","tags":["Goå®æˆ˜"],"title":"Golangå¯åŠ¨HTTPæœåŠ¡å™¨","uri":"/2020/golang-start-http-server/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 æä¾›é™æ€æ–‡ä»¶ ä½¿ç”¨http.FileServer() æ–¹æ³•æä¾› Javascriptï¼ŒCSSæˆ–å›¾ç‰‡ç­‰é™æ€æ–‡ä»¶ã€‚å®ƒçš„å‚æ•°æ˜¯æ–‡ä»¶ç³»ç»Ÿæ¥å£ï¼Œå¯ä»¥ä½¿ç”¨http.Dir()æ¥æŒ‡å®šæ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„ã€‚å¦‚æœè¯¥è·¯å¾„ä¸­æœ‰index.htmlæ–‡ä»¶ï¼Œåˆ™ä¼šä¼˜å…ˆæ˜¾ç¤ºhtmlæ–‡ä»¶ï¼Œå¦åˆ™ä¼šæ˜¾ç¤ºæ–‡ä»¶ç›®å½•ã€‚ fs := http.FileServer(http.Dir(\"static/\")) http.FileServer()çš„è¿”å›å€¼æ­£å¥½æ˜¯ Handler ç±»å‹ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥æä¾›æ–‡ä»¶è®¿é—®æœåŠ¡çš„HTTPå¤„ç†å™¨ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬åªéœ€è¦å°†ä¸€ä¸ªURLæŒ‡å‘å®ƒï¼ŒæœŸé—´æˆ‘ä»¬å¯ä»¥ä½¿ç”¨http.StripPrefix() å»é™¤æŸäº›URLå‰ç¼€ï¼Œè¿”å›å€¼åŒæ ·æ˜¯ä¸€ä¸ª Handlerç±»å‹ http.Handle(\"/static/\", http.StripPrefix(\"/static/\", fs)) ","date":"2020-05-29","objectID":"/2020/golang-start-http-server/:2:2","tags":["Goå®æˆ˜"],"title":"Golangå¯åŠ¨HTTPæœåŠ¡å™¨","uri":"/2020/golang-start-http-server/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 æ¥æ”¶è¿æ¥è¯·æ±‚ http.ListenAndServer()å‡½æ•°ç”¨æ¥å¯åŠ¨HTTPæœåŠ¡å™¨ï¼Œå¹¶ä¸”åœ¨æŒ‡å®šçš„ IP åœ°å€å’Œç«¯å£ä¸Šç›‘å¬å®¢æˆ·ç«¯è¯·æ±‚ http.ListenAndServe(\":80\", nil) å‡½æ•°å®ç°å¦‚ä¸‹ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç›‘å¬åœ°å€ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºä¸€ä¸ªHTTPå¤„ç†å™¨ Handlerã€‚å¯ä»¥çœ‹åˆ°ï¼Œåº•å±‚è°ƒç”¨çš„æ˜¯ net/http åŒ…çš„ ListenAndServe æ–¹æ³•ï¼Œé¦–å…ˆä¼šåˆå§‹åŒ–ä¸€ä¸ª Server å¯¹è±¡ï¼Œç„¶åè°ƒç”¨è¯¥ Server å®ä¾‹çš„ ListenAndServe æ–¹æ³•ï¼Œè¿›è€Œè°ƒç”¨ net.Listen(\"tcp\", addr)ï¼Œä¹Ÿå°±æ˜¯åŸºäº TCP åè®®åˆ›å»º Listen Socketï¼Œå¹¶åœ¨ä¼ å…¥çš„IP åœ°å€å’Œç«¯å£å·ä¸Šç›‘å¬è¯·æ±‚ã€‚ func ListenAndServe(addr string, handler Handler) error { server := \u0026Server{Addr: addr, Handler: handler} return server.ListenAndServe() } func (srv *Server) ListenAndServe() error { if srv.shuttingDown() { return ErrServerClosed } addr := srv.Addr if addr == \"\" { addr = \":http\" } ln, err := net.Listen(\"tcp\", addr) if err != nil { return err } return srv.Serve(ln) } æœ€ç»ˆæˆ‘ä»¬çœ‹åˆ°è°ƒç”¨äº† Server å®ä¾‹çš„ Serve(net.Listener) æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•é‡Œé¢èµ·äº†ä¸€ä¸ª for å¾ªç¯ï¼Œåœ¨å¾ªç¯ä½“ä¸­é¦–å…ˆé€šè¿‡ net.Listenerï¼ˆå³ä¸Šä¸€æ­¥ç›‘å¬ç«¯å£ä¸­åˆ›å»ºçš„ Listen Socketï¼‰å®ä¾‹çš„ Accept æ–¹æ³•æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚ï¼Œæ¥æ”¶åˆ°è¯·æ±‚åæ ¹æ®è¯·æ±‚ä¿¡æ¯åˆ›å»ºä¸€ä¸ª conn è¿æ¥å®ä¾‹ï¼Œæœ€åå•ç‹¬å¼€äº†ä¸€ä¸ª goroutineï¼ŒæŠŠè¿™ä¸ªè¯·æ±‚çš„æ•°æ®å½“åšå‚æ•°æ‰”ç»™è¿™ä¸ª conn å»æœåŠ¡ï¼š for { rw, err := l.Accept() if err != nil { ... } connCtx := ctx if cc := srv.ConnContext; cc != nil { connCtx = cc(connCtx, rw) if connCtx == nil { panic(\"ConnContext returned nil\") } } tempDelay = 0 c := srv.newConn(rw) c.setState(c.rwc, StateNew) // before Serve can return go c.serve(connCtx) } ç”¨æˆ·çš„æ¯ä¸€æ¬¡è¯·æ±‚éƒ½æ˜¯åœ¨ä¸€ä¸ªæ–°çš„ goroutine å»æœåŠ¡ï¼Œç›¸äº’ä¸å½±å“ã€‚å®¢æˆ·ç«¯è¯·æ±‚çš„å…·ä½“å¤„ç†é€»è¾‘éƒ½æ˜¯åœ¨ c.serve ä¸­å®Œæˆçš„ã€‚ conn å®ä¾‹çš„ serve æ–¹æ³•é¦–å…ˆä¼šé€šè¿‡ c.readRequest() è§£æè¯·æ±‚ï¼Œç„¶ååœ¨ serverHandler{c.server}.ServeHTTP(w, w.req) çš„ ServeHTTP æ–¹æ³•ä¸­è·å–ç›¸åº”çš„ handlerï¼šhandler := c.server.Handlerï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆšæ‰åœ¨è°ƒç”¨å‡½æ•° ListenAndServe æ—¶å€™çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚ func (sh serverHandler) ServeHTTP(rw ResponseWriter, req *Request) { handler := sh.srv.Handler if handler == nil { handler = DefaultServeMux } if req.RequestURI == \"*\" \u0026\u0026 req.Method == \"OPTIONS\" { handler = globalOptionsHandler{} } handler.ServeHTTP(rw, req) } æˆ‘ä»¬å‘ç°å½“ handler ä¸º nilï¼Œä¹Ÿå°±æ˜¯ ListenAndServe() çš„ç¬¬äºŒä¸ªå‚æ•°ä¸º nil æ—¶ï¼Œä½¿ç”¨äº†é»˜è®¤çš„ http.DefaultServeMuxï¼Œè¿™æ˜¯ ServeMuxçš„é»˜è®¤å®ä¾‹ var DefaultServeMux = \u0026defaultServeMux var defaultServeMux ServeMux ServeMuxçš„æ•°æ®ç»“æ„å¦‚ä¸‹ type ServeMux struct { mu sync.RWMutex. // ç”±äºè¯·æ±‚æ¶‰åŠåˆ°å¹¶å‘å¤„ç†ï¼Œå› æ­¤è¿™é‡Œéœ€è¦ä¸€ä¸ªé”æœºåˆ¶ m map[string]muxEntry // è·¯ç”±è§„åˆ™å­—å…¸ï¼Œå­˜æ”¾ URL è·¯å¾„ä¸å¤„ç†å™¨çš„æ˜ å°„å…³ç³» es []muxEntry // MuxEntry åˆ‡ç‰‡ï¼ˆæŒ‰ç…§æœ€é•¿åˆ°æœ€çŸ­æ’åºï¼‰ hosts bool // è·¯ç”±è§„åˆ™ä¸­æ˜¯å¦åŒ…å« host ä¿¡æ¯ } è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦é‡ç‚¹å…³æ³¨çš„æ˜¯ muxEntry ç»“æ„ï¼š type muxEntry struct { h Handler // å¤„ç†å™¨å…·ä½“å®ç° pattern string // æ¨¡å¼åŒ¹é…å­—ç¬¦ä¸² } æœ€åæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ Handler çš„å®šä¹‰ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¥å£ï¼š type Handler interface { ServeHTTP(ResponseWriter, *Request) // è·¯ç”±å¤„ç†å®ç°æ–¹æ³• } å½“è¯·æ±‚è·¯å¾„ä¸ pattern åŒ¹é…æ—¶ï¼Œå°±ä¼šè°ƒç”¨ Handler çš„ ServeHTTP æ–¹æ³•æ¥å¤„ç†è¯·æ±‚ã€‚ http.HandleFunc(\"/\", sayHelloWorld) å½“æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„å¤„ç†å‡½æ•°æ—¶ï¼Œå¦‚ä¸Šé¢çš„sayHelloWorldï¼Œå¹¶æ²¡æœ‰å®ç° Handler æ¥å£ï¼Œä¹‹æ‰€ä»¥å¯ä»¥æˆåŠŸæ·»åŠ åˆ°è·¯ç”±æ˜ å°„è§„åˆ™ï¼Œæ˜¯å› ä¸ºåœ¨åº•å±‚é€šè¿‡ HandlerFunc() å‡½æ•°å°†å…¶å¼ºåˆ¶è½¬åŒ–ä¸ºäº† HandlerFunc ç±»å‹ï¼Œè€Œ HandlerFunc ç±»å‹å®ç°äº† ServeHTTP æ–¹æ³•ï¼Œè¿™æ ·ï¼ŒsayHelloWorld æ–¹æ³•ä¹Ÿå°±å˜ç›¸å®ç°äº† Handler æ¥å£ func (mux *ServeMux) HandleFunc(pattern string, handler func(ResponseWriter, *Request)) { if handler == nil { panic(\"http: nil handler\") } mux.Handle(pattern, HandlerFunc(handler)) } ... type HandlerFunc func(ResponseWriter, *Request) func (f HandlerFunc) ServeHTTP(w ResponseWriter, r *Request) { f(w, r) } å¯¹äº sayHelloWorld æ–¹æ³•æ¥è¯´ï¼Œå®ƒå·²ç„¶å˜æˆäº† HandlerFunc ç±»å‹çš„å‡½æ•°ç±»å‹ï¼Œå½“æˆ‘ä»¬åœ¨å…¶å®ä¾‹ä¸Šè°ƒç”¨ ServeHTTP æ–¹æ³•æ—¶ï¼Œè°ƒç”¨çš„æ˜¯ sayHelloWorld æ–¹æ³•æœ¬èº«ã€‚ å‰é¢æˆ‘ä»¬æåˆ°ï¼ŒDefaultServeMux æ˜¯ ServeMux çš„é»˜è®¤å®ä¾‹ï¼Œå½“æˆ‘ä»¬åœ¨ HandleFunc ä¸­è°ƒç”¨ mux.Handle æ–¹æ³•æ—¶ï¼Œå®é™…ä¸Šæ˜¯å°†å…¶è·¯ç”±æ˜ å°„è§„åˆ™ä¿å­˜åˆ° DefaultServeMux è·¯ç”±å¤„ç†å™¨çš„æ•°æ®ç»“æ„ä¸­ï¼š func (mux *ServeMux) Handle(pattern string, handler Handler) { mux.mu.Lock() defer mux.mu.Unlock() if pattern == \"\" { panic(\"http: invalid pattern\") } if handler == nil { panic(\"http: nil handler\") } if _, exist := mux.m[pattern]; exist { panic(\"http: multiple registrations for \" + pattern) } if mux.m == nil { mux.m = make(map[string]muxEntry) } e := muxEntry{h: handler, pattern: pattern} mux.m[pattern] = e if pattern[len(pattern)-1] == '/' { mux.es = appendSorted(mux.es, e) } if pattern[0] != '/' { mux.hosts = true } } è¿˜æ˜¯ä»¥ sayHelloWorld ä¸ºä¾‹ï¼Œè¿™é‡Œçš„ pattern å­—ç¬¦ä¸²å¯¹åº”çš„æ˜¯è¯·æ±‚è·¯å¾„ /ï¼Œhandler å¯¹åº”çš„æ˜¯ sayHelloWorld å‡½æ•°ã€‚ ä¿å­˜å¥½è·¯ç”±æ˜ å°„è§„åˆ™ä¹‹åï¼Œå®¢æˆ·ç«¯è¯·æ±‚çš„å¤„ç†å°±é»˜è®¤è°ƒç”¨ServeMux å®ç°çš„ ServeHTTP æ–¹æ³•ï¼š func (mux *ServeMux) ServeHTTP(w ResponseWriter, r *Request) { if r.RequestURI == \"*\" { w.Header().Set(\"Connection\", \"close\") w.WriteHeader(StatusBadRequest) return } h, _ := mux.Handler(r) h.ServeHTTP(w, r) } å¦‚ä¸Šæ‰€ç¤ºï¼Œè·¯ç”±å¤„ç†å™¨æ¥æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œå¦‚æœ URL è·¯å¾„æ˜¯ *ï¼Œåˆ™å…³é—­è¿æ¥ï¼Œå¦åˆ™","date":"2020-05-29","objectID":"/2020/golang-start-http-server/:2:3","tags":["Goå®æˆ˜"],"title":"Golangå¯åŠ¨HTTPæœåŠ¡å™¨","uri":"/2020/golang-start-http-server/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.4 è·å–å®¢æˆ·ç«¯æäº¤çš„æ•°æ® å‰é¢å·²ç»æåˆ°ï¼Œå®¢æˆ·ç«¯æäº¤çš„æ•°æ®å…¨éƒ¨ä½äº *http.Request ä¸­ï¼Œä¸‹é¢çš„ä¾‹å­è™½ç„¶åšäº†å£°æ˜ï¼Œä½†æ²¡æœ‰ä½¿ç”¨ï¼Œæœ¬èŠ‚ä»‹ç»ä¸€ä¸‹å¦‚ä½•ä» *http.request ä¸­æå–æƒ³è¦çš„æ•°æ® http.HandleFunc(\"/\", func (w http.ResponseWriter, r *http.Request) { fmt.Fprint(w, \"Welcome to my website!\") }) Requestçš„éƒ¨åˆ†ç»“æ„å¦‚ä¸‹ type Request struct { ... // MethodæŒ‡å®šHTTPæ–¹æ³•ï¼ˆGETã€POSTã€PUTç­‰ï¼‰ã€‚å¯¹å®¢æˆ·ç«¯ï¼Œ\"\"ä»£è¡¨GETã€‚ Method string // Formæ˜¯è§£æå¥½çš„è¡¨å•æ•°æ®ï¼ŒåŒ…æ‹¬URLå­—æ®µçš„queryå‚æ•°å’ŒPOSTæˆ–PUTçš„è¡¨å•æ•°æ®ã€‚ Form url.Values // PostFormæ˜¯è§£æå¥½çš„POSTæˆ–PUTçš„è¡¨å•æ•°æ®ã€‚ PostForm url.Values ... } ä½¿ç”¨ParseFormè§£æURLä¸­çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå¹¶å°†è§£æç»“æœæ›´æ–°åˆ°r.Formå­—æ®µã€‚å¯¹äºPOSTæˆ–PUTè¯·æ±‚ï¼ŒParseFormè¿˜ä¼šå°†bodyå½“ä½œè¡¨å•è§£æï¼Œå¹¶å°†ç»“æœæ—¢æ›´æ–°åˆ°r.PostFormä¹Ÿæ›´æ–°åˆ°r.Formã€‚è§£æç»“æœä¸­ï¼ŒPOSTæˆ–PUTè¯·æ±‚ä¸»ä½“è¦ä¼˜å…ˆäºURLæŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆåŒåå˜é‡ï¼Œä¸»ä½“çš„å€¼åœ¨æŸ¥è¯¢å­—ç¬¦ä¸²çš„å€¼å‰é¢ï¼‰ã€‚ func (r *Request) ParseForm() error ç„¶åä½¿ç”¨ FormValue è¿”å›ä»¥ key ä¸ºå¥æŸ¥è¯¢ r.Form å¾—åˆ°çš„ç¬¬ä¸€ä¸ªå€¼ func (r *Request) FormValue(key string) string PostFormValueåˆ™è¿”å›keyä¸ºé”®æŸ¥è¯¢r.PostFormå­—æ®µå¾—åˆ°çš„ç¬¬ä¸€ä¸ªå€¼ï¼Œç”¨äºPOSTå’ŒPUT func (r *Request) PostFormValue(key string) string å½“æäº¤çš„è¯·æ±‚æ•°æ®ä¸­æœ‰æ–‡ä»¶æ—¶ï¼Œä½¿ç”¨FormFileï¼Œå¯ä»¥è¿”å›ä»¥keyä¸ºé”®æŸ¥è¯¢r.MultipartFormå­—æ®µå¾—åˆ°ç»“æœä¸­çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶å’Œå®ƒçš„ä¿¡æ¯ã€‚ func (r *Request) FormFile(key string) (multipart.File, *multipart.FileHeader, error) ä¸€ä¸ªç®€å•çš„å®ç°å¦‚ä¸‹ func loginActionHandler(w http.ResponseWriter, r *http.Request) { r.ParseForm() if r.Method == \"GET\" \u0026\u0026 r.ParseForm() == nil { username := r.FormValue(\"username\") pwd := r.FormValue(\"password\") if len(username) \u003c 4 || len(username) \u003e 10 { w.Write([]byte(\"ç”¨æˆ·åä¸ç¬¦åˆè§„èŒƒ\")) } if len(pwd) \u003c 6 || len(pwd) \u003e 16 { w.Write([]byte(\"å¯†ç ä¸ç¬¦åˆè§„èŒƒ\")) } http.Redirect(w, r, \"/list\", http.StatusFound) return } else { w.Write([]byte(\"è¯·æ±‚æ–¹å¼ä¸å¯¹\")) return } w.Write([]byte(\"ç™»å½•å¤±è´¥\")) } ","date":"2020-05-29","objectID":"/2020/golang-start-http-server/:2:4","tags":["Goå®æˆ˜"],"title":"Golangå¯åŠ¨HTTPæœåŠ¡å™¨","uri":"/2020/golang-start-http-server/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"å‰ä¸¤ç¯‡åˆ†åˆ«ä»‹ç»äº†æ•´ä½“è®¾è®¡åŠæ•°æ®è¡¨çš„åˆ›å»ºã€æ¨¡å‹ç±»çš„ç¼–å†™ï¼Œæœ¬ç¯‡äº†è§£å¦‚ä½•åœ¨æœåŠ¡ç«¯å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼Œå¹¶å¯åŠ¨è®ºå›é¦–é¡µã€‚æ–‡ç« è½¬è‡ªå­¦é™¢å›çš„æ•™ç¨‹ï¼Œç•¥æœ‰æ”¹åŠ¨ã€‚ ç”¨æˆ·è¯·æ±‚çš„å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼› æœåŠ¡ç«¯è·¯ç”±å™¨ï¼ˆmultiplexerï¼‰å°†è¯·æ±‚åˆ†å‘ç»™æŒ‡å®šå¤„ç†å™¨ï¼ˆhandlerï¼‰ï¼› å¤„ç†å™¨å¤„ç†è¯·æ±‚ï¼Œå®Œæˆå¯¹åº”çš„ä¸šåŠ¡é€»è¾‘ï¼› å¤„ç†å™¨è°ƒç”¨æ¨¡æ¿å¼•æ“ç”Ÿæˆ HTML å¹¶å°†å“åº”è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æŒ‰ç…§è¿™ä¸ªæµç¨‹æ¥ç¼–å†™æœåŠ¡ç«¯ä»£ç ã€‚ ","date":"2020-05-29","objectID":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/:0:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›3-è®¿é—®è®ºå›é¦–é¡µ","uri":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. è·¯ç”±å™¨å®šä¹‰ è¿™é‡Œæˆ‘ä»¬åŸºäº gorilla/mux æ¥å®ç°è·¯ç”±å™¨ï¼Œæ‰€ä»¥éœ€è¦å®‰è£…å¯¹åº”ä¾èµ–ï¼š $ go get -u github.com/gorilla/mux å°†è·¯ç”±å™¨å®šä¹‰åœ¨ routes ç›®å½•ä¸‹çš„ router.go ä¸­ package routes import \"github.com/gorilla/mux\" // è¿”å›ä¸€ä¸ª mux.Router ç±»å‹æŒ‡é’ˆï¼Œä»è€Œå¯ä»¥å½“ä½œå¤„ç†å™¨ä½¿ç”¨ func NewRouter() *mux.Router { // åˆ›å»º mux.Router è·¯ç”±å™¨ç¤ºä¾‹ router := mux.NewRouter().StrictSlash(true) // éå† web.go ä¸­å®šä¹‰çš„æ‰€æœ‰ webRoutes for _, route := range webRoutes { // å°†æ¯ä¸ª web è·¯ç”±åº”ç”¨åˆ°è·¯ç”±å™¨ router.Methods(route.Method). Path(route.Pattern). Name(route.Name). Handler(route.HandlerFunc) } return router } å°†æ‰€æœ‰è·¯ç”±å®šä¹‰åœ¨åŒä¸€ç›®å½•çš„ routes.go ä¸­ï¼š package routes import \"net/http\" // å®šä¹‰ä¸€ä¸ª WebRoute ç»“æ„ä½“ç”¨äºå­˜æ”¾å•ä¸ªè·¯ç”± type WebRoute struct { Name string Method string Pattern string HandlerFunc http.HandlerFunc } // å£°æ˜ WebRoutes åˆ‡ç‰‡å­˜æ”¾æ‰€æœ‰ Web è·¯ç”± type WebRoutes []WebRoute // å®šä¹‰æ‰€æœ‰ Web è·¯ç”± var webRoutes = WebRoutes{ } ","date":"2020-05-29","objectID":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/:1:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›3-è®¿é—®è®ºå›é¦–é¡µ","uri":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. å¯åŠ¨HTTPæœåŠ¡å™¨ æœ€ååœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ main.go ä¸­å¼•å…¥ä¸Šè¿°è·¯ç”±å™¨æ¥å¯åŠ¨ HTTP æœåŠ¡å™¨ï¼š package main import ( . \"github.com/xueyuanjun/chitchat/routes\" \"log\" \"net/http\" ) func main() { startWebServer(\"8080\") } // é€šè¿‡æŒ‡å®šç«¯å£å¯åŠ¨ Web æœåŠ¡å™¨ func startWebServer(port string) { r := NewRouter() http.Handle(\"/\", r) // é€šè¿‡ router.go ä¸­å®šä¹‰çš„è·¯ç”±å™¨æ¥åˆ†å‘è¯·æ±‚ log.Println(\"Starting HTTP service at \" + port) err := http.ListenAndServe(\":\" + port, nil) // å¯åŠ¨åç¨‹ç›‘å¬è¯·æ±‚ if err != nil { log.Println(\"An error occured starting HTTP listener at port \" + port) log.Println(\"Error: \" + err.Error()) } } è¿™é‡Œæˆ‘ä»¬æŒ‡å®š HTTP æœåŠ¡å™¨ç›‘å¬ 8080 ç«¯å£ï¼Œä½¿ç”¨çš„è·¯ç”±å™¨æ­£æ˜¯ä¸Šè¿° router.go ä¸­ NewRouter æ–¹æ³•è¿”å›çš„ mux.Router æŒ‡é’ˆç±»å‹å®ä¾‹ï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ°å¼•ç”¨çš„æ—¶å€™å¹¶æ²¡æœ‰å¸¦ä¸ŠåŒ…åå‰ç¼€ï¼Œä¹‹æ‰€ä»¥å¯ä»¥è¿™ä¹ˆåšæ˜¯å› ä¸ºé€šè¿‡ç‰¹æ®Šç¬¦å· . å¼•å…¥äº† routesåŒ…ï¼Œé€šè¿‡è¿™ç§æ–¹å¼å¼•å…¥çš„åŒ…å¯ä»¥ç›´æ¥è°ƒç”¨åŒ…ä¸­å¯¹å¤–å¯è§çš„å˜é‡ã€æ–¹æ³•å’Œç»“æ„ä½“ï¼Œè€Œä¸éœ€è¦åŠ ä¸ŠåŒ…åå‰ç¼€ã€‚ ","date":"2020-05-29","objectID":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/:2:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›3-è®¿é—®è®ºå›é¦–é¡µ","uri":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. å¤„ç†é™æ€èµ„æº åœ¨çº¿è®ºå›æ¶‰åŠåˆ°å‰ç«¯é™æ€èµ„æºæ–‡ä»¶çš„å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ startWebServer æ–¹æ³•ä¸­æ–°å¢å¦‚ä¸‹è¿™ä¸¤è¡Œä»£ç ï¼š r := NewRouter() // é€šè¿‡ router.go ä¸­å®šä¹‰çš„è·¯ç”±å™¨æ¥åˆ†å‘è¯·æ±‚ // å¤„ç†é™æ€èµ„æºæ–‡ä»¶ assets := http.FileServer(http.Dir(\"public\")) r.PathPrefix(\"/static/\").Handler(http.StripPrefix(\"/static/\", assets)) http.Handle(\"/\", r) // åº”ç”¨è·¯ç”±å™¨åˆ° HTTP æœåŠ¡å™¨ ... å…¶ä¸­ http.FileServer ç”¨äºåˆå§‹åŒ–æ–‡ä»¶æœåŠ¡å™¨å’Œç›®å½•ä¸ºå½“å‰ç›®å½•ä¸‹çš„ public ç›®å½•ã€‚ ç„¶ååœ¨ç¬¬äºŒæ®µä»£ç ä¸­æŒ‡å®šé™æ€èµ„æºè·¯ç”±åŠå¤„ç†é€»è¾‘ï¼šå°† /static/ å‰ç¼€çš„ URL è¯·æ±‚å»é™¤ static å‰ç¼€ï¼Œç„¶ååœ¨æ–‡ä»¶æœåŠ¡å™¨æŸ¥æ‰¾æŒ‡å®šæ–‡ä»¶è·¯å¾„æ˜¯å¦å­˜åœ¨ï¼ˆpublic ç›®å½•ä¸‹çš„ç›¸å¯¹åœ°å€ï¼‰ã€‚ æ¯”å¦‚ URL è¯·æ±‚è·¯å¾„ä¸º http://localhost:8080/static/css/bootstrap.min.cssï¼Œå¯¹åº”çš„æŸ¥æ‰¾è·¯å¾„æ˜¯ï¼š \u003capplication root\u003e/public/css/bootstrap.min.css å¯¹äºé™æ€èµ„æºæ–‡ä»¶ç›´æ¥è¿”å›æ–‡ä»¶å†…å®¹ï¼Œä¸ä¼šè¿›è¡Œé¢å¤–å¤„ç†ã€‚ ","date":"2020-05-29","objectID":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/:3:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›3-è®¿é—®è®ºå›é¦–é¡µ","uri":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. ç¼–å†™å¤„ç†å™¨å®ç° ","date":"2020-05-29","objectID":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/:4:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›3-è®¿é—®è®ºå›é¦–é¡µ","uri":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4.1 é¦–é¡µå¤„ç†å™¨æ–¹æ³• åšå¥½ä¸Šè¿°å‡†å¤‡å·¥ä½œåï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥åˆ›å»ºè®ºå›é¦–é¡µçš„è·¯ç”±å¤„ç†å™¨ï¼Œåœ¨ handlers ç›®å½•ä¸‹æ–°å¢ä¸€ä¸ª index.go æ¥å®šä¹‰é¦–é¡µçš„å¤„ç†å™¨æ–¹æ³•ï¼š package handlers import ( \"github.com/xueyuanjun/chitchat/models\" \"html/template\" \"net/http\" ) // è®ºå›é¦–é¡µè·¯ç”±å¤„ç†å™¨æ–¹æ³• func Index(w http.ResponseWriter, r *http.Request) { files := []string{\"views/layout.html\", \"views/navbar.html\", \"views/index.html\",} templates := template.Must(template.ParseFiles(files...)) threads, err := models.Threads(); if err == nil { templates.ExecuteTemplate(w, \"layout\", threads) } } ","date":"2020-05-29","objectID":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/:4:1","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›3-è®¿é—®è®ºå›é¦–é¡µ","uri":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4.2 åˆ›å»ºè§†å›¾æ¨¡æ¿ è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ Go è‡ªå¸¦çš„ html/template ä½œä¸ºæ¨¡æ¿å¼•æ“ï¼Œéœ€è¦ä¼ å…¥ä½äº views ç›®å½•ä¸‹çš„è§†å›¾æ¨¡æ¿æ–‡ä»¶ï¼Œè¿™é‡Œä¼ å…¥äº†å¤šä¸ªæ¨¡æ¿æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸»å¸ƒå±€æ–‡ä»¶ layout.htmlï¼š {{ define \"layout\" }} \u003c!DOCTYPE html\u003e \u003chtml lang=\"en\"\u003e \u003chead\u003e \u003cmeta charset=\"utf-8\"\u003e \u003cmeta http-equiv=\"X-UA-Compatible\" content=\"IE=9\"\u003e \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1\"\u003e \u003ctitle\u003eChitChat\u003c/title\u003e \u003clink href=\"/static/css/bootstrap.min.css\" rel=\"stylesheet\"\u003e \u003clink href=\"/static/css/font-awesome.min.css\" rel=\"stylesheet\"\u003e \u003c/head\u003e \u003cbody\u003e {{ template \"navbar\" . }} \u003cdiv class=\"container\"\u003e {{ template \"content\" . }} \u003c/div\u003e \u003c!-- /container --\u003e \u003cscript src=\"/static/js/jquery-2.1.1.min.js\"\u003e\u003c/script\u003e \u003cscript src=\"/static/js/bootstrap.min.js\"\u003e\u003c/script\u003e \u003c/body\u003e \u003c/html\u003e {{ end }} é¡¶éƒ¨å¯¼èˆªæ¨¡æ¿ navbar.htmlï¼š {{ define \"navbar\" }} \u003cdiv class=\"navbar navbar-default navbar-static-top\" role=\"navigation\"\u003e \u003cdiv class=\"container\"\u003e \u003cdiv class=\"navbar-header\"\u003e \u003cbutton type=\"button\" class=\"navbar-toggle collapsed\" data-toggle=\"collapse\" data-target=\".navbar-collapse\"\u003e \u003cspan class=\"sr-only\"\u003eToggle navigation\u003c/span\u003e \u003cspan class=\"icon-bar\"\u003e\u003c/span\u003e \u003cspan class=\"icon-bar\"\u003e\u003c/span\u003e \u003cspan class=\"icon-bar\"\u003e\u003c/span\u003e \u003c/button\u003e \u003ca class=\"navbar-brand\" href=\"/\"\u003e \u003ci class=\"fa fa-comments-o\"\u003e\u003c/i\u003e ChitChat \u003c/a\u003e \u003c/div\u003e \u003cdiv class=\"navbar-collapse collapse\"\u003e \u003cul class=\"nav navbar-nav\"\u003e \u003cli\u003e\u003ca href=\"/\"\u003eHome\u003c/a\u003e\u003c/li\u003e \u003c/ul\u003e \u003cul class=\"nav navbar-nav navbar-right\"\u003e \u003cli\u003e\u003ca href=\"/login\"\u003eLogin\u003c/a\u003e\u003c/li\u003e \u003c/ul\u003e \u003c/div\u003e \u003c/div\u003e \u003c/div\u003e {{ end }} ä»¥åŠé¦–é¡µè§†å›¾æ¨¡æ¿ index.htmlï¼š {{ define \"content\" }} \u003cp class=\"lead\"\u003e \u003ca href=\"/thread/new\"\u003eStart a thread\u003c/a\u003e or join one below! \u003c/p\u003e {{ range . }} \u003cdiv class=\"panel panel-default\"\u003e \u003cdiv class=\"panel-heading\"\u003e \u003cspan class=\"lead\"\u003e \u003ci class=\"fa fa-comment-o\"\u003e\u003c/i\u003e {{ .Topic }}\u003c/span\u003e \u003c/div\u003e \u003cdiv class=\"panel-body\"\u003e Started by {{ .User.Name }} - {{ .CreatedAtDate }} - {{ .NumReplies }} posts. \u003cdiv class=\"pull-right\"\u003e \u003ca href=\"/thread/read?id={{.Uuid }}\"\u003eRead more\u003c/a\u003e \u003c/div\u003e \u003c/div\u003e \u003c/div\u003e {{ end }} {{ end }} å¼•å…¥å¤šä¸ªè§†å›¾æ¨¡æ¿æ˜¯ä¸ºäº†æé«˜æ¨¡æ¿ä»£ç çš„å¤ç”¨æ€§ï¼Œå› ä¸ºå¯¹äºåŒä¸€ä¸ªåº”ç”¨çš„ä¸åŒé¡µé¢æ¥è¯´ï¼Œå¯èƒ½åŸºæœ¬å¸ƒå±€ã€é¡µé¢é¡¶éƒ¨å¯¼èˆªå’Œé¡µé¢åº•éƒ¨ç»„ä»¶éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå…³äºè§†å›¾æ¨¡æ¿çš„ç»†èŠ‚ï¼Œæˆ‘ä»¬åœ¨åé¢è§†å›¾æ¨¡æ¿éƒ¨åˆ†ä¼šè¯¦ç»†ä»‹ç»ï¼Œè¿™é‡Œç®€å•äº†è§£ä¸‹å³å¯ã€‚ ","date":"2020-05-29","objectID":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/:4:2","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›3-è®¿é—®è®ºå›é¦–é¡µ","uri":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4.3 æ¸²æŸ“è§†å›¾æ¨¡æ¿ æˆ‘ä»¬å¯ä»¥ä»æ•°æ®åº“æŸ¥è¯¢ç¾¤ç»„æ•°æ®å¹¶å°†è¯¥æ•°æ®ä¼ é€’åˆ°æ¨¡æ¿æ–‡ä»¶ï¼Œæœ€åå°†æ¨¡æ¿è§†å›¾æ¸²æŸ“å‡ºæ¥ï¼Œå¯¹åº”ä»£ç å¦‚ä¸‹ï¼š threads, err := models.Threads(); if err == nil { templates.ExecuteTemplate(w, \"layout\", threads) } ç¼–è¯‘å¤šä¸ªè§†å›¾æ¨¡æ¿æ—¶ï¼Œé»˜è®¤ä»¥ç¬¬ä¸€ä¸ªæ¨¡æ¿åä½œä¸ºæœ€ç»ˆè§†å›¾æ¨¡æ¿åï¼Œæ‰€ä»¥è¿™é‡Œç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥çš„æ˜¯ layoutï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥è¦æ¸²æŸ“çš„æ•°æ® threadsï¼Œå¯¹åº”çš„æ¸²æŸ“é€»è¾‘ä½äº views/index.html ä¸­ï¼š {{ range . }} \u003cdiv class=\"panel panel-default\"\u003e \u003cdiv class=\"panel-heading\"\u003e \u003cspan class=\"lead\"\u003e \u003ci class=\"fa fa-comment-o\"\u003e\u003c/i\u003e {{ .Topic }}\u003c/span\u003e \u003c/div\u003e \u003cdiv class=\"panel-body\"\u003e Started by {{ .User.Name }} - {{ .CreatedAtDate }} - {{ .NumReplies }} posts. \u003cdiv class=\"pull-right\"\u003e \u003ca href=\"/thread/read?id={{.Uuid }}\"\u003eRead more\u003c/a\u003e \u003c/div\u003e \u003c/div\u003e \u003c/div\u003e {{ end }} å…¶ä¸­ {{ range . }} è¡¨ç¤ºå°†å¤„ç†å™¨æ–¹æ³•ä¼ å…¥çš„å˜é‡ï¼Œè¿™é‡Œæ˜¯ threads è¿›è¡Œå¾ªç¯ã€‚ ","date":"2020-05-29","objectID":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/:4:3","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›3-è®¿é—®è®ºå›é¦–é¡µ","uri":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4.4 æ³¨å†Œé¦–é¡µè·¯ç”± æœ€å¥½ï¼Œæˆ‘ä»¬åœ¨ routes/routes.go ä¸­æ³¨å†Œé¦–é¡µè·¯ç”±åŠå¯¹åº”çš„å¤„ç†å™¨æ–¹æ³• Indexï¼š import \"github.com/xueyuanjun/chitchat/handlers\" // å®šä¹‰æ‰€æœ‰ Web è·¯ç”± var webRoutes = WebRoutes{ { \"home\", \"GET\", \"/\", handlers.Index, }, } ","date":"2020-05-29","objectID":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/:4:4","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›3-è®¿é—®è®ºå›é¦–é¡µ","uri":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"5. è®¿é—®è®ºå›é¦–é¡µ è®¿é—®è®ºå›é¦–é¡µä¹‹å‰ï¼Œæˆ‘ä»¬å°†ç›¸åº”çš„å‰ç«¯èµ„æºæ–‡ä»¶æ‹·è´åˆ° public ç›®å½•ä¸‹ï¼Œæ­¤æ—¶é¡¹ç›®æ•´ä½“ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š ç„¶åæˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œå¦‚ä¸‹ä»£ç å¯åŠ¨ HTTP æœåŠ¡å™¨ $ go run main.go ç„¶åæˆ‘ä»¬åœ¨æµè§ˆå™¨è®¿é—®è®ºå›é¦–é¡µ http://localhost:8080ï¼š ","date":"2020-05-29","objectID":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/:5:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›3-è®¿é—®è®ºå›é¦–é¡µ","uri":"/2020/development-of-online-forum-based-on-golang-3-visit-forum-homepage/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"åœ¨ Go ä¸­ï¼ŒåŠ å¯†æ˜¯å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œæœ¬æ–‡å¯¹æ­¤è¿›è¡Œä»‹ç»ã€‚ ","date":"2020-05-28","objectID":"/2020/golang-cryptographic-algorithm/:0:0","tags":["Goå®æˆ˜"],"title":"Golangå¯†ç å­¦ç®—æ³•","uri":"/2020/golang-cryptographic-algorithm/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. Hash åˆ©ç”¨ Hash ç®—æ³•å¯ä»¥å°†ä»»æ„é•¿åº¦çš„äºŒè¿›åˆ¶å€¼ï¼ˆæ˜æ–‡ï¼‰æ˜ å°„ä¸ºè¾ƒçŸ­çš„å›ºå®šé•¿åº¦çš„äºŒè¿›åˆ¶å€¼ï¼ˆHash å€¼ï¼‰ï¼Œæ˜¯å¯†ç å­¦çš„åŸºç¡€ä¹‹ä¸€ã€‚ ","date":"2020-05-28","objectID":"/2020/golang-cryptographic-algorithm/:1:0","tags":["Goå®æˆ˜"],"title":"Golangå¯†ç å­¦ç®—æ³•","uri":"/2020/golang-cryptographic-algorithm/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.1 æµè¡Œçš„Hashç®—æ³• ç›®å‰å¸¸è§çš„Hashç®—æ³•åŒ…æ‹¬Message Digestï¼ˆMDï¼‰ç³»åˆ—å’ŒSecure HashAlgorithmï¼ˆSHAï¼‰ç³»åˆ—ç®—æ³•ã€‚ MDç®—æ³•ä¸»è¦åŒ…æ‹¬MD4å’ŒMD5ä¸¤ä¸ªç®—æ³•ã€‚MD4ï¼ˆRFC 1320ï¼‰æ˜¯MITçš„Ronald L. Riveståœ¨1990å¹´è®¾è®¡çš„ï¼Œå…¶è¾“å‡ºä¸º128ä½ã€‚MD4å·²è¢«è¯æ˜ä¸å¤Ÿå®‰å…¨ã€‚MD5ï¼ˆRFC 1321ï¼‰æ˜¯Rivestäº1991å¹´å‘å¸ƒçš„MD4æ”¹è¿›ç‰ˆæœ¬ã€‚å®ƒå¯¹è¾“å…¥ä»ä»¥512ä½è¿›è¡Œåˆ†ç»„ï¼Œå…¶è¾“å‡ºæ˜¯128ä½ã€‚MD5æ¯”MD4æ›´åŠ å®‰å…¨ï¼Œä½†è¿‡ç¨‹æ›´åŠ å¤æ‚ï¼Œè®¡ç®—é€Ÿåº¦è¦æ…¢ä¸€ç‚¹ã€‚MD5å·²äº2004å¹´è¢«æˆåŠŸç¢°æ’ï¼Œå…¶å®‰å…¨æ€§å·²ä¸è¶³ä»¥åº”ç”¨äºå•†ä¸šåœºæ™¯ã€‚ SHAç®—æ³•ç”±ç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢ï¼ˆNational Institute ofStandards and Technologyï¼ŒNISTï¼‰å¾é›†åˆ¶å®šã€‚SHA-0ç®—æ³•äº1993å¹´é—®ä¸–ï¼Œ1998å¹´å³é­ç ´è§£ã€‚éšåçš„ä¿®è®¢ç‰ˆæœ¬SHA-1ç®—æ³•åœ¨1995å¹´é¢ä¸–ï¼Œå®ƒçš„è¾“å‡ºä¸ºé•¿åº¦160ä½çš„Hashå€¼ï¼Œå®‰å…¨æ€§æ›´å¥½ã€‚SHA-1è®¾è®¡é‡‡ç”¨äº†MD4ç®—æ³•ç±»ä¼¼åŸç†ã€‚SHA-1å·²äº2005å¹´è¢«æˆåŠŸç¢°æ’ï¼Œæ„å‘³ç€æ— æ³•æ»¡è¶³å•†ç”¨éœ€æ±‚ã€‚ä¸ºäº†æé«˜å®‰å…¨æ€§ï¼ŒNISTåæ¥åˆ¶å®šå‡ºæ›´å®‰å…¨çš„SHA-224ã€SHA-256ã€SHA-384å’ŒSHA-512ç®—æ³•ï¼ˆç»Ÿç§°ä¸ºSHA-2ç®—æ³•ï¼‰ã€‚æ–°ä¸€ä»£çš„SHA-3ç®—æ³•ä¹Ÿæ­£åœ¨ç ”ç©¶ä¸­ã€‚ ç›®å‰MD5å’ŒSHA-1å·²ç»ä¸å¤Ÿå®‰å…¨ï¼Œæ¨èè‡³å°‘ä½¿ç”¨SHA-256ç®—æ³•ã€‚æ¯”ç‰¹å¸ç³»ç»Ÿå°±æ˜¯ä½¿ç”¨SHA-256ç®—æ³•ã€‚ SHA-3ç®—æ³•åˆåKeccakç®—æ³•ã€‚Keccakçš„è¾“å‡ºé•¿åº¦æœ‰ï¼š512ä½ã€384ä½ã€256ä½ã€224ä½ã€‚ SHA-3å¹¶ä¸æ˜¯è¦å–ä»£SHA-2ï¼Œå› ä¸ºSHA-2ç›®å‰å¹¶æ²¡æœ‰æš´éœ²æ˜æ˜¾çš„å¼±ç‚¹ã€‚ç”±äºå¯¹MD5å‡ºç°æˆåŠŸçš„ç ´è§£ï¼Œä»¥åŠå¯¹SHA-1å‡ºç°ç†è®ºä¸Šç ´è§£çš„æ–¹æ³•ï¼ŒNISTè®¤ä¸ºéœ€è¦ä¸€ä¸ªä¸ä¹‹å‰ç®—æ³•ä¸åŒçš„ã€å¯æ›¿æ¢çš„åŠ å¯†æ‚å‡‘ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯ç°åœ¨çš„SHA-3ã€‚åŒºå—é“¾ä¸­çš„ä»¥å¤ªåŠç³»ç»Ÿå°±æ˜¯ä½¿ç”¨Keccak256ç®—æ³• ","date":"2020-05-28","objectID":"/2020/golang-cryptographic-algorithm/:1:1","tags":["Goå®æˆ˜"],"title":"Golangå¯†ç å­¦ç®—æ³•","uri":"/2020/golang-cryptographic-algorithm/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.2 SHA-256 SHA-256ç®—æ³•è¾“å…¥æŠ¥æ–‡çš„æœ€å¤§é•¿åº¦æ˜¯264 bitï¼Œäº§ç”Ÿçš„è¾“å‡ºæ˜¯ä¸€ä¸ª256bitçš„æŠ¥æ–‡æ‘˜è¦ã€‚SHA-256ç®—æ³•æ­¥éª¤å¦‚ä¸‹ã€‚ é™„åŠ å¡«å……æ¯”ç‰¹ï¼šå¯¹æŠ¥æ–‡è¿›è¡Œå¡«å……ï¼Œä½¿æŠ¥æ–‡é•¿åº¦ä¸448æ¨¡512åŒä½™ï¼ˆé•¿åº¦=448 mod512ï¼‰ï¼Œå¡«å……çš„æ¯”ç‰¹æ•°èŒƒå›´æ˜¯1åˆ°512ï¼Œå¡«å……æ¯”ç‰¹ä¸²çš„æœ€é«˜ä½ä¸º1ï¼Œå…¶ä½™ä½ä¸º0ã€‚å°±æ˜¯å…ˆåœ¨æŠ¥æ–‡åé¢åŠ ä¸€ä¸ª1ï¼Œå†åŠ å¾ˆå¤šä¸ª0ï¼Œç›´åˆ°é•¿åº¦æ»¡è¶³mod512=448ã€‚ä¸ºä»€ä¹ˆæ˜¯448ï¼Ÿå› ä¸º448+64=512ã€‚ç¬¬äºŒæ­¥ä¼šåŠ ä¸Šä¸€ä¸ª64bitçš„åŸå§‹æŠ¥æ–‡çš„é•¿åº¦ä¿¡æ¯ã€‚ é™„åŠ é•¿åº¦å€¼ï¼šå°†ç”¨64bitè¡¨ç¤ºçš„åˆå§‹æŠ¥æ–‡ï¼ˆå¡«å……å‰ï¼‰çš„ä½é•¿åº¦é™„åŠ åœ¨æ­¥éª¤1çš„ç»“æœåï¼ˆä½ä½å­—èŠ‚ä¼˜å…ˆï¼‰ã€‚ åˆå§‹åŒ–ç¼“å­˜ï¼šä½¿ç”¨ä¸€ä¸ª256bitçš„ç¼“å­˜æ¥å­˜æ”¾è¯¥Hashå‡½æ•°çš„ä¸­é—´åŠæœ€ç»ˆç»“æœã€‚è¯¥ç¼“å­˜è¡¨ç¤ºä¸ºA=0x6A09E667ï¼ŒB=0xBB67AE85ï¼ŒC=0x3C6EF372ï¼ŒD=0xA54FF53Aï¼ŒE=0x510E527Fï¼ŒF=0x9B05688Cï¼ŒG=0x1F83D9ABï¼ŒH=0x5BE0CD19ã€‚ å¤„ç†512bitï¼ˆ16ä¸ªå­—ï¼‰æŠ¥æ–‡åˆ†ç»„åºåˆ—ï¼šè¯¥ç®—æ³•ä½¿ç”¨äº†6ç§åŸºæœ¬é€»è¾‘å‡½æ•°ï¼Œç”±64æ­¥è¿­ä»£è¿ç®—ç»„æˆã€‚æ¯æ­¥éƒ½ä»¥256bitç¼“å­˜å€¼ABCDEFGHä¸ºè¾“å…¥ï¼Œç„¶åæ›´æ–°ç¼“å­˜å†…å®¹ã€‚ æ¯æ­¥ä½¿ç”¨ä¸€ä¸ª32bit Ktï¼ˆå¸¸æ•°å€¼ï¼‰å’Œä¸€ä¸ª32bit Wtï¼ˆåˆ†ç»„åçš„æŠ¥æ–‡ï¼‰ã€‚ ","date":"2020-05-28","objectID":"/2020/golang-cryptographic-algorithm/:1:2","tags":["Goå®æˆ˜"],"title":"Golangå¯†ç å­¦ç®—æ³•","uri":"/2020/golang-cryptographic-algorithm/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.3 ç¤ºä¾‹ä»£ç  è®¡ç®—å­—ç¬¦ä¸²çš„ SHA-256 ä½¿ç”¨å¦‚ä¸‹å‡½æ•°åŸå‹ func Sum256(data []byte) [Size]byte ","date":"2020-05-28","objectID":"/2020/golang-cryptographic-algorithm/:1:3","tags":["Goå®æˆ˜"],"title":"Golangå¯†ç å­¦ç®—æ³•","uri":"/2020/golang-cryptographic-algorithm/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. å¯¹ç§°åŠ å¯†ç®—æ³•","date":"2020-05-28","objectID":"/2020/golang-cryptographic-algorithm/:2:0","tags":["Goå®æˆ˜"],"title":"Golangå¯†ç å­¦ç®—æ³•","uri":"/2020/golang-cryptographic-algorithm/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"åœ¨æœ¬ç¯‡æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†åœ¨ MySQL ä¸­åˆ›å»ºä¸€ä¸ª chitchat æ•°æ®åº“ä½œä¸ºè®ºå›é¡¹ç›®çš„æ•°æ®åº“ã€‚æˆ‘é€‰æ‹©äº†åœ¨æœ¬åœ°å®‰è£… MySQL Serverï¼Œä½†ä¹Ÿå¯ä»¥åŸºäº Docker å®¹å™¨è¿è¡Œã€‚è½¬è‡ªå­¦é™¢å›çš„æ•™ç¨‹ï¼Œç•¥æœ‰æ”¹åŠ¨ã€‚ ","date":"2020-05-27","objectID":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/:0:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›2-é€šè¿‡æ¨¡å‹ç±»ä¸MySQLæ•°æ®åº“äº¤äº’","uri":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. é¡¹ç›®åˆå§‹åŒ– é¦–å…ˆåˆ›å»ºé¡¹ç›®ç›®å½•ï¼Œå‘½åä¸º chitchatï¼Œç„¶ååˆå§‹åŒ–ç›®å½•ç»“æ„å¦‚ä¸‹ å„ä¸ªå­ç›®å½•/æ–‡ä»¶çš„ä½œç”¨ä»‹ç»å¦‚ä¸‹ï¼š main.goï¼šåº”ç”¨å…¥å£æ–‡ä»¶ config.jsonï¼šå…¨å±€é…ç½®æ–‡ä»¶ handlersï¼šç”¨äºå­˜æ”¾å¤„ç†å™¨ä»£ç ï¼ˆå¯ç±»æ¯”ä¸º MVC æ¨¡å¼ä¸­çš„æ§åˆ¶å™¨ç›®å½•ï¼‰ logsï¼šç”¨äºå­˜æ”¾æ—¥å¿—æ–‡ä»¶ modelsï¼šç”¨äºå­˜æ”¾ä¸æ•°æ®åº“äº¤äº’çš„æ¨¡å‹ç±» publicï¼šç”¨äºå­˜æ”¾å‰ç«¯èµ„æºæ–‡ä»¶ï¼Œæ¯”å¦‚å›¾ç‰‡ã€CSSã€JavaScript ç­‰ routesï¼šç”¨äºå­˜æ”¾è·¯ç”±æ–‡ä»¶å’Œè·¯ç”±å™¨å®ç°ä»£ç  viewsï¼šç”¨äºå­˜æ”¾è§†å›¾æ¨¡æ¿æ–‡ä»¶ åœ¨ Github ç½‘é¡µç«¯åˆ›å»ºåŒåä»“åº“ï¼Œç„¶ååœ¨æœ¬åœ°æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤åˆå§‹åŒ–ä»“åº“ï¼ˆæˆ‘ä»¬ä½¿ç”¨ Github å­˜å‚¨ä»£ç ï¼‰ echo \"# chitchat\" \u003e\u003e README.md git init git add README.md git commit -m \"Initialize project directory\" git remote add origin https://github.com/shuzang/chitchat.git git push -u origin master ç„¶ååœ¨ chitchat ç›®å½•ä¸‹åˆå§‹åŒ– Go é¡¹ç›®ï¼Œ åç»­é€šè¿‡ Go Module æ¥ç®¡ç†ä¾èµ– $ go mod init github.com/shuzang/chitchat ","date":"2020-05-27","objectID":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/:1:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›2-é€šè¿‡æ¨¡å‹ç±»ä¸MySQLæ•°æ®åº“äº¤äº’","uri":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. åˆ›å»ºæ•°æ®è¡¨ åœ¨ MySQL Server ä¸­åˆ›å»º chitchat æ•°æ®åº“ï¼Œç„¶ååˆ›å»ºæ•°æ®è¡¨ï¼Œæ•°æ®è¡¨å¯¹åº”çš„ SQL è¯­å¥å¦‚ä¸‹ createtableusers(idserialprimarykey,uuidvarchar(64)notnullunique,namevarchar(255),emailvarchar(255)notnullunique,passwordvarchar(255)notnull,created_attimestampnotnull);createtablesessions(idserialprimarykey,uuidvarchar(64)notnullunique,emailvarchar(255),user_idintegerreferencesusers(id),created_attimestampnotnull);createtablethreads(idserialprimarykey,uuidvarchar(64)notnullunique,topictext,user_idintegerreferencesusers(id),created_attimestampnotnull);createtableposts(idserialprimarykey,uuidvarchar(64)notnullunique,bodytext,user_idintegerreferencesusers(id),thread_idintegerreferencesthreads(id),created_attimestampnotnull); ä½¿ç”¨ Navicat for MySQL è¿›è¡Œè¿æ¥æµ‹è¯• å¤§é‡çš„è¯­å¥é€æ¡æ‰§è¡Œå¾ˆå®¹æ˜“å‡ºé”™ï¼Œå¯ä»¥é€šè¿‡è„šæœ¬å½¢å¼æ‰¹é‡æ‰§è¡Œ1ã€‚ ","date":"2020-05-27","objectID":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/:2:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›2-é€šè¿‡æ¨¡å‹ç±»ä¸MySQLæ•°æ®åº“äº¤äº’","uri":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. ä¸æ•°æ®åº“äº¤äº’ ","date":"2020-05-27","objectID":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/:3:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›2-é€šè¿‡æ¨¡å‹ç±»ä¸MySQLæ•°æ®åº“äº¤äº’","uri":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.1 æ•°æ®åº“é©±åŠ¨ æ•°æ®è¡¨åˆ›å»ºå®Œæˆåï¼Œæ¥ä¸‹æ¥ï¼Œéœ€è¦åœ¨ Go åº”ç”¨ä»£ç ä¸­ä¸æ•°æ®åº“äº¤äº’ï¼ŒGo è¯­è¨€å¼€å‘ç»„å¹¶æ²¡æœ‰ä¸ºæ­¤æä¾›å®˜æ–¹çš„æ•°æ®åº“é©±åŠ¨å®ç°ï¼Œåªæ˜¯æä¾›äº†æ•°æ®åº“äº¤äº’æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°è¿™äº›æ¥å£çš„ç¬¬ä¸‰æ–¹æ‰©å±•åŒ…å®Œæˆä¸ MySQL æ•°æ®åº“çš„äº¤äº’ï¼Œæœ¬é¡¹ç›®é€‰æ‹©çš„æ‰©å±•åŒ…æ˜¯ go-mysql-driver ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨ Go åº”ç”¨ä¸­ç¼–å†™æ¨¡å‹ç±»åŸºäºè¿™ä¸ªæ‰©å±•åŒ…æä¾›çš„æ–¹æ³•ä¸ MySQL äº¤äº’å®Œæˆå¢åˆ æ”¹æŸ¥æ“ä½œï¼Œå¼€å§‹ä¹‹å‰ï¼Œå¯ä»¥è¿è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£…è¿™ä¸ªä¾èµ–ï¼š $ go get -u github.com/go-sql-driver/mysql ","date":"2020-05-27","objectID":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/:3:1","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›2-é€šè¿‡æ¨¡å‹ç±»ä¸MySQLæ•°æ®åº“äº¤äº’","uri":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.2 æ•°æ®åº“è¿æ¥ ç„¶ååœ¨ chitchat/models ç›®å½•ä¸‹åˆ›å»º db.goï¼Œå¹¶ç¼–å†™æ•°æ®åº“è¿æ¥åˆå§‹åŒ–æ–¹æ³•ä»¥åŠç”Ÿæˆ UUIDã€å“ˆå¸ŒåŠ å¯†æ–¹æ³•ï¼š package models import ( \"crypto/rand\" \"crypto/sha256\" \"database/sql\" \"fmt\" \"log\" _ \"github.com/go-sql-driver/mysql\" ) var Db *sql.DB func init() { var err error Db, err = sql.Open(\"mysql\", \"root:root@/chitchat?charset=utf8\u0026parseTime=true\") if err != nil { log.Fatal(err) } } // create a random UUID with from RFC 4122 // adapted from http://github.com/nu7hatch/gouuid func createUUID() (uuid string) { u := new([16]byte) _, err := rand.Read(u[:]) if err != nil { log.Fatalln(\"Cannot generate UUID\", err) } // 0x40 is reserved variant from RFC 4122 u[8] = (u[8] | 0x40) \u0026 0x7F // Set the four most significant bits (bits 12 through 15) of the // time_hi_and_version field to the 4-bit version number. u[6] = (u[6] \u0026 0xF) | (0x4 \u003c\u003c 4) uuid = fmt.Sprintf(\"%x-%x-%x-%x-%x\", u[0:4], u[4:6], u[6:8], u[8:10], u[10:]) return } // hash plaintext with sha-256 func Encrypt(plaintext string) (cryptext string) { cryptext = fmt.Sprintf(\"%x\", sha256.Sum256([]byte(plaintext))) return } å…¶ä¸­ï¼ŒDb å˜é‡ä»£è¡¨æ•°æ®åº“è¿æ¥æ± ï¼Œé€šè¿‡ init æ–¹æ³•åœ¨ Web åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨åˆå§‹åŒ–æ•°æ®åº“è¿æ¥ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨åº”ç”¨ä¸­é€šè¿‡ Db å˜é‡å¯¹æ•°æ®åº“è¿›è¡Œå¢åˆ æ”¹æŸ¥æ“ä½œäº†ï¼Œè¿™ä¹Ÿæ˜¯è¯¥å˜é‡é¦–å­—æ¯å¤§å†™çš„åŸå› ï¼Œæ–¹ä¾¿åœ¨ models åŒ…ä¹‹å¤–è¢«å¼•ç”¨ï¼Œå…·ä½“çš„æ“ä½œå®ç°æˆ‘ä»¬æ”¾åˆ°ç‹¬ç«‹çš„æ¨¡å‹æ–‡ä»¶ä¸­å¤„ç†ã€‚ æ³¨ï¼šè¿™é‡Œé€šè¿‡ sql.Open åˆå§‹åŒ–æ•°æ®åº“è¿æ¥ï¼Œæˆ‘ä»¬å†™æ­»äº†æ•°æ®åº“è¿æ¥é…ç½®ï¼Œåœ¨å®é™…ç”Ÿäº§ç¯å¢ƒï¼Œè¿™å—é…ç½®å€¼åº”è¯¥ä»é…ç½®æ–‡ä»¶æˆ–ç³»ç»Ÿç¯å¢ƒå˜é‡è·å–ã€‚ ","date":"2020-05-27","objectID":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/:3:2","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›2-é€šè¿‡æ¨¡å‹ç±»ä¸MySQLæ•°æ®åº“äº¤äº’","uri":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.3 ç”¨æˆ·æ¨¡å‹ç›¸å…³ç±» æœ‰äº†ä»£è¡¨æ•°æ®åº“è¿æ¥æ± çš„ Db å˜é‡ä¹‹åï¼Œå°±å¯ä»¥ä¸ºæ¯ä¸ªæ•°æ®è¡¨ç¼–å†™å¯¹åº”çš„æ¨¡å‹ç±»å®ç°å¢åˆ æ”¹æŸ¥æ“ä½œäº†ï¼Œé¦–å…ˆåœ¨ models ç›®å½•ä¸‹åˆ›å»º user.go ç”¨äºå®šä¹‰ç”¨æˆ·æ¨¡å‹ç±» User ä¸ users è¡¨è¿›è¡Œäº¤äº’ï¼Œä»¥åŠä¸ sessions è¡¨è¿›è¡Œå…³è”ï¼š package models import \"time\" type User struct { Id int Uuid string Name string Email string Password string CreatedAt time.Time } // Create a new session for an existing user func (user *User) CreateSession() (session Session, err error) { statement := \"insert into sessions (uuid, email, user_id, created_at) values (?, ?, ?, ?)\" stmtin, err := Db.Prepare(statement) if err != nil { return } defer stmtin.Close() uuid := createUUID() stmtin.Exec(uuid, user.Email, user.Id, time.Now()) stmtout, err := Db.Prepare(\"select id, uuid, email, user_id, created_at from sessions where uuid = ?\") if err != nil { return } defer stmtout.Close() // use QueryRow to return a row and scan the returned id into the Session struct err = stmtout.QueryRow(uuid).Scan(\u0026session.Id, \u0026session.Uuid, \u0026session.Email, \u0026session.UserId, \u0026session.CreatedAt) return } // Get the session for an existing user func (user *User) Session() (session Session, err error) { session = Session{} err = Db.QueryRow(\"SELECT id, uuid, email, user_id, created_at FROM sessions WHERE user_id = ?\", user.Id). Scan(\u0026session.Id, \u0026session.Uuid, \u0026session.Email, \u0026session.UserId, \u0026session.CreatedAt) return } // Create a new user, save user info into the database func (user *User) Create() (err error) { // Postgres does not automatically return the last insert id, because it would be wrong to assume // you're always using a sequence.You need to use the RETURNING keyword in your insert to get this // information from postgres. statement := \"insert into users (uuid, name, email, password, created_at) values (?, ?, ?, ?, ?)\" stmtin, err := Db.Prepare(statement) if err != nil { return } defer stmtin.Close() uuid := createUUID() stmtin.Exec(uuid, user.Name, user.Email, Encrypt(user.Password), time.Now()) stmtout, err := Db.Prepare(\"select id, uuid, created_at from users where uuid = ?\") if err != nil { return } defer stmtout.Close() // use QueryRow to return a row and scan the returned id into the User struct err = stmtout.QueryRow(uuid).Scan(\u0026user.Id, \u0026user.Uuid, \u0026user.CreatedAt) return } // Delete user from database func (user *User) Delete() (err error) { statement := \"delete from users where id = ?\" stmt, err := Db.Prepare(statement) if err != nil { return } defer stmt.Close() _, err = stmt.Exec(user.Id) return } // Update user information in the database func (user *User) Update() (err error) { statement := \"update users set name = ?, email = ? where id = ?\" stmt, err := Db.Prepare(statement) if err != nil { return } defer stmt.Close() _, err = stmt.Exec(user.Name, user.Email, user.Id) return } // Delete all users from database func UserDeleteAll() (err error) { statement := \"delete from users\" _, err = Db.Exec(statement) return } // Get all users in the database and returns it func Users() (users []User, err error) { rows, err := Db.Query(\"SELECT id, uuid, name, email, password, created_at FROM users\") if err != nil { return } for rows.Next() { user := User{} if err = rows.Scan(\u0026user.Id, \u0026user.Uuid, \u0026user.Name, \u0026user.Email, \u0026user.Password, \u0026user.CreatedAt); err != nil { return } users = append(users, user) } rows.Close() return } // Get a single user given the email func UserByEmail(email string) (user User, err error) { user = User{} err = Db.QueryRow(\"SELECT id, uuid, name, email, password, created_at FROM users WHERE email = ?\", email). Scan(\u0026user.Id, \u0026user.Uuid, \u0026user.Name, \u0026user.Email, \u0026user.Password, \u0026user.CreatedAt) return } // Get a single user given the UUID func UserByUUID(uuid string) (user User, err error) { user = User{} err = Db.QueryRow(\"SELECT id, uuid, name, email, password, created_at FROM users WHERE uuid = ?\", uuid). Scan(\u0026user.Id, \u0026user.Uuid, \u0026user.Name, \u0026user.Email, \u0026user.Password, \u0026user.CreatedAt) return } åˆ›å»º session.go ç”¨äºå®šä¹‰ä¼šè¯æ¨¡å‹ç±» Sessionï¼š package models import \"time\" type Session struct { Id int Uuid string Email string UserId int Created","date":"2020-05-27","objectID":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/:3:3","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›2-é€šè¿‡æ¨¡å‹ç±»ä¸MySQLæ•°æ®åº“äº¤äº’","uri":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.4 ä¸»é¢˜æ¨¡å‹ç›¸å…³ç±» ç¼–å†™å¥½ç”¨æˆ·ç›¸å…³æ¨¡å‹ç±»åï¼Œæ¥ä¸‹æ¥åœ¨åŒçº§ç›®å½•ä¸‹åˆ›å»º thread.goï¼Œå®šä¹‰ç¾¤ç»„æ¨¡å‹ç±» Thread ä¸ threads è¡¨è¿›è¡Œäº¤äº’ï¼š package models import \"time\" type Thread struct { Id int Uuid string Topic string UserId int CreatedAt time.Time } // format the CreatedAt date to display nicely on the screen func (thread *Thread) CreatedAtDate() string { return thread.CreatedAt.Format(\"Jan 2, 2006 at 3:04pm\") } // get the number of posts in a thread func (thread *Thread) NumReplies() (count int) { rows, err := Db.Query(\"SELECT count(*) FROM posts where thread_id = ?\", thread.Id) if err != nil { return } for rows.Next() { if err = rows.Scan(\u0026count); err != nil { return } } rows.Close() return } // get posts to a thread func (thread *Thread) Posts() (posts []Post, err error) { rows, err := Db.Query(\"SELECT id, uuid, body, user_id, thread_id, created_at FROM posts where thread_id = ?\", thread.Id) if err != nil { return } for rows.Next() { post := Post{} if err = rows.Scan(\u0026post.Id, \u0026post.Uuid, \u0026post.Body, \u0026post.UserId, \u0026post.ThreadId, \u0026post.CreatedAt); err != nil { return } posts = append(posts, post) } rows.Close() return } // Get all threads in the database and returns it func Threads() (threads []Thread, err error) { rows, err := Db.Query(\"SELECT id, uuid, topic, user_id, created_at FROM threads ORDER BY created_at DESC\") if err != nil { return } for rows.Next() { conv := Thread{} if err = rows.Scan(\u0026conv.Id, \u0026conv.Uuid, \u0026conv.Topic, \u0026conv.UserId, \u0026conv.CreatedAt); err != nil { return } threads = append(threads, conv) } rows.Close() return } // Get a thread by the UUID func ThreadByUUID(uuid string) (conv Thread, err error) { conv = Thread{} err = Db.QueryRow(\"SELECT id, uuid, topic, user_id, created_at FROM threads WHERE uuid = ?\", uuid). Scan(\u0026conv.Id, \u0026conv.Uuid, \u0026conv.Topic, \u0026conv.UserId, \u0026conv.CreatedAt) return } // Get the user who started this thread func (thread *Thread) User() (user User) { user = User{} Db.QueryRow(\"SELECT id, uuid, name, email, created_at FROM users WHERE id = ?\", thread.UserId). Scan(\u0026user.Id, \u0026user.Uuid, \u0026user.Name, \u0026user.Email, \u0026user.CreatedAt) return } ä»¥åŠ post.go ç¼–å†™ä¸»é¢˜æ¨¡å‹ç±»ä¸ posts è¡¨è¿›è¡Œäº¤äº’ï¼š package models import \"time\" type Post struct { Id int Uuid string Body string UserId int ThreadId int CreatedAt time.Time } func (post *Post) CreatedAtDate() string { return post.CreatedAt.Format(\"Jan 2, 2006 at 3:04pm\") } // Get the user who wrote the post func (post *Post) User() (user User) { user = User{} Db.QueryRow(\"SELECT id, uuid, name, email, created_at FROM users WHERE id = ?\", post.UserId). Scan(\u0026user.Id, \u0026user.Uuid, \u0026user.Name, \u0026user.Email, \u0026user.CreatedAt) return } æ­¤å¤–ï¼Œæˆ‘ä»¬åˆ° user.go ä¸­ä¸º User æ¨¡å‹æ–°å¢å¦‚ä¸‹ä¸¤ä¸ªæ–¹æ³•ä¸ Threadã€Post æ¨¡å‹è¿›è¡Œå…³è”ï¼Œç”¨äºåˆ›å»ºæ–°çš„ç¾¤ç»„å’Œä¸»é¢˜ï¼š // Create a new thread func (user *User) CreateThread(topic string) (conv Thread, err error) { statement := \"insert into threads (uuid, topic, user_id, created_at) values (?, ?, ?, ?)\" stmtin, err := Db.Prepare(statement) if err != nil { return } defer stmtin.Close() uuid := createUUID() stmtin.Exec(uuid, topic, user.Id, time.Now()) stmtout, err := Db.Prepare(\"select id, uuid, topic, user_id, created_at from threads where uuid = ?\") if err != nil { return } defer stmtout.Close() // use QueryRow to return a row and scan the returned id into the Session struct err = stmtout.QueryRow(uuid).Scan(\u0026conv.Id, \u0026conv.Uuid, \u0026conv.Topic, \u0026conv.UserId, \u0026conv.CreatedAt) return } // Create a new post to a thread func (user *User) CreatePost(conv Thread, body string) (post Post, err error) { statement := \"insert into posts (uuid, body, user_id, thread_id, created_at) values (?, ?, ?, ?, ?)\" stmtin, err := Db.Prepare(statement) if err != nil { return } defer stmtin.Close() uuid := createUUID() stmtin.Exec(uuid, body, user.Id, conv.Id, time.Now()) stmtout, err := Db.Prepare(\"select id, uuid, body, user_id, thread_id, created_at from posts where uuid = ?\") if err != nil { return } defer stmtout.Close() // use QueryRow to return a row and scan the returned id into the Session struct err = stmtout.QueryRow(uuid).Scan(\u0026post.Id, \u0026post.Uuid, \u0026post.Body,","date":"2020-05-27","objectID":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/:3:4","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›2-é€šè¿‡æ¨¡å‹ç±»ä¸MySQLæ•°æ®åº“äº¤äº’","uri":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. å°ç»“ åœ¨ä¸Šè¿°ç¼–å†™çš„æ¨¡å‹ç±»ä¸­ï¼Œæ¨¡å‹ç±»ä¸æ•°æ®è¡¨çš„æ˜ å°„ç”± go-mysql-driver åº•å±‚å®ç°ï¼Œæ¯æ¬¡ä»æ•°æ®åº“æŸ¥è¯¢åˆ°ç»“æœä¹‹åï¼Œå¯ä»¥é€šè¿‡ Scan æ–¹æ³•å°†æ•°æ®è¡¨å­—æ®µå€¼æ˜ å°„åˆ°å¯¹åº”çš„ç»“æ„ä½“æ¨¡å‹ç±»ï¼Œè€Œå°†æ¨¡å‹ç±»ä¿å­˜åˆ°æ•°æ®åº“æ—¶ï¼Œåˆå¯ä»¥åŸºäºå­—æ®µæ˜ å°„å…³ç³»å°†ç»“æ„ä½“å±æ€§å€¼è½¬åŒ–ä¸ºå¯¹åº”çš„æ•°æ®è¡¨å­—æ®µå€¼ã€‚ åº•å±‚æ•°æ®åº“äº¤äº’é€»è¾‘å®šä¹‰å¥½äº†ä¹‹åï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¼–å†™ä¸Šå±‚å®ç°ä»£ç äº†ï¼Œä¸‹ä¸€ç¯‡ä»‹ç»åœ¨çº¿è®ºå›é¡¹ç›®ä¸Šå±‚è·¯ç”±å’Œå¤„ç†å™¨æ–¹æ³•çš„å®ç°ã€‚ mysqlä¸‹å¦‚ä½•æ‰§è¡Œsqlè„šæœ¬Â â†©ï¸ ","date":"2020-05-27","objectID":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/:4:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›2-é€šè¿‡æ¨¡å‹ç±»ä¸MySQLæ•°æ®åº“äº¤äº’","uri":"/2020/development-of-online-forum-based-on-golang-2-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"è½¬è‡ªå­¦é™¢å›çš„æ•™ç¨‹1 ï¼Œè¿™é‡Œè¿›è¡Œå¤ç°å¹¶æ·±å…¥ç†è§£ï¼Œæ–‡ç« å†…å®¹å¯èƒ½ç•¥æœ‰è°ƒæ•´ã€‚ ","date":"2020-05-27","objectID":"/2020/development-of-online-forum-based-on-golang-1-overall-design-and-data-model/:0:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›1-æ•´ä½“è®¾è®¡ä¸æ•°æ®æ¨¡å‹","uri":"/2020/development-of-online-forum-based-on-golang-1-overall-design-and-data-model/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. é¡¹ç›®ä»‹ç» è¦å®Œæˆçš„æ˜¯ä¸€ä¸ªç®€å•çš„åœ¨çº¿è®ºå›é¡¹ç›®ï¼Œä¸»è¦ä»¿ç…§ Google ç½‘ä¸Šè®ºå› è¿›è¡Œå¼€å‘ï¼Œä½†åŠŸèƒ½å’Œç•Œé¢è¦ç®€åŒ–å¾ˆå¤šï¼ŒåŒ…æ‹¬ ç”¨æˆ·è®¤è¯åŠŸèƒ½ï¼ˆæ³¨å†Œã€ç™»å½•ã€é€€å‡ºç­‰ï¼‰ è®¤è¯åçš„ç”¨æˆ·å¯ä»¥åˆ›å»ºæ–°çš„ç¾¤ç»„ï¼ˆå¸–å­ï¼‰ã€ä»¥åŠåœ¨ç¾¤ç»„ä¸­å‘è¡¨ä¸»é¢˜ï¼ˆè·Ÿå¸–ï¼‰ è®¿å®¢ç”¨æˆ·è®¿é—®è®ºå›é¦–é¡µå¯ä»¥æŸ¥çœ‹ç¾¤ç»„åˆ—è¡¨ï¼Œè¿›å…¥æŒ‡å®šç¾¤ç»„é¡µé¢å¯ä»¥æŸ¥çœ‹å¯¹åº”çš„ä¸»é¢˜ä¿¡æ¯ ","date":"2020-05-27","objectID":"/2020/development-of-online-forum-based-on-golang-1-overall-design-and-data-model/:1:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›1-æ•´ä½“è®¾è®¡ä¸æ•°æ®æ¨¡å‹","uri":"/2020/development-of-online-forum-based-on-golang-1-overall-design-and-data-model/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. æŠ€æœ¯æ–¹æ¡ˆ é‡‡ç”¨å…¸å‹çš„ MVC æ¶æ„2ï¼Œä»¥ç¾¤ç»„è¯¦æƒ…é¡µä¸ºä¾‹ï¼Œå‡è®¾å¯¹åº”çš„ URL æ˜¯ http://chitchat.test/thread/read?id=123ï¼Œå…¶ä¸­ chitchat.test æ˜¯è¯·æ±‚åŸŸåï¼Œthread/read æ˜¯è¯·æ±‚è·¯ç”±ï¼ˆæŸ¥çœ‹ç¾¤ç»„ï¼‰ï¼Œ?id=123 æ˜¯è¯·æ±‚å‚æ•°ï¼ˆç¾¤ç»„IDï¼‰ï¼Œé€šè¿‡åŸŸåç¡®å®šåº”ç”¨æ‰€åœ¨çš„æœåŠ¡å™¨ IPï¼Œé€šè¿‡ç«¯å£å·ï¼ˆæ­¤å¤„æ²¡æœ‰æ˜¾å¼å±•ç¤ºï¼Œä¸€èˆ¬é»˜è®¤æ˜¯ 80 ç«¯å£ï¼‰ç¡®å®šåº”ç”¨è¿›ç¨‹ï¼Œåº”ç”¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œé€šè¿‡è·¯ç”±å°†è¯·æ±‚åˆ†å‘åˆ°æŒ‡å®šå¤„ç†å™¨æ–¹æ³•ï¼ˆè·¯ç”±å™¨ï¼Œæˆ–è€…å«åšå¤šè·¯å¤ç”¨å™¨åšçš„å°±æ˜¯è¿™ä¸ªå·¥ä½œï¼Œæ˜¯æ•´ä¸ªåº”ç”¨è¯·æ±‚åˆ†å‘çš„å…¥å£ï¼‰ï¼Œé€šè¿‡è¯·æ±‚å‚æ•°å¯¹æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢ï¼Œå†å°†è§†å›¾å“åº”å‘é€ç»™è¯·æ±‚ç”¨æˆ·ï¼Œå¦‚æœæ•°æ®åº“æŸ¥è¯¢æ²¡æœ‰ç»“æœï¼Œåˆ™è¿”å› 404 å“åº”ã€‚è¿™é‡Œï¼Œæ•°æ®åº“æ‰¿æ‹…çš„æ˜¯ M çš„è§’è‰²ï¼ˆModelï¼‰ï¼Œè§†å›¾å“åº”æ‰¿æ‹…çš„æ˜¯ V çš„è§’è‰²ï¼ˆViewï¼‰ï¼Œå¤„ç†å™¨æ–¹æ³•æ‰¿æ‹…çš„æ˜¯ C çš„è§’è‰²ï¼ˆControllerï¼‰ï¼š ä¸Šå›¾ä¸­ Client ä»£è¡¨å‘èµ·è¯·æ±‚çš„ç”¨æˆ·ï¼Œè™šæ¡†å†…æ˜¯éƒ¨ç½²åœ¨æœåŠ¡å™¨å·²å¯åŠ¨çš„åœ¨çº¿è®ºå›åº”ç”¨ï¼ŒMultiplexer ä»£è¡¨è·¯ç”±å™¨ï¼ˆæ¯”å¦‚ gorilla/mux ï¼‰ï¼ŒHandler ä»£è¡¨å¤„ç†å™¨/å¤„ç†å™¨æ–¹æ³•ï¼Œæ•°æ®åº“æ“ä½œä½äºå¤„ç†å™¨æ–¹æ³•ä¸­ï¼ŒTemplates ä»£è¡¨æœ€ç»ˆå±•ç¤ºç»™ç”¨æˆ·çš„ç»è¿‡æ¨¡æ¿å¼•æ“ç¼–è¯‘è¿‡çš„è§†å›¾æ¨¡æ¿ã€‚ æˆ‘ä»¬éœ€è¦åœ¨æœ¬åœ°æŒ‰ç…§è¿™ä¸ª MVC æ¶æ„åŸºäºä¸šåŠ¡æµç¨‹ç¼–å†™ä»£ç ï¼Œæœ€åå°†æµ‹è¯•è¿‡çš„åº”ç”¨ä»£ç ç¼–è¯‘æ‰“åŒ…ï¼Œéƒ¨ç½²åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼ˆè¿™æ ·æ‰èƒ½è¢«æ™®é€šç”¨æˆ·è®¿é—®ï¼‰ï¼Œå¹¶å¯åŠ¨è¯¥åº”ç”¨ï¼Œç­‰å¾…å®¢æˆ·ç«¯è¯·æ±‚ï¼Œè¿™æ ·å°±å®Œæˆäº†æ•´ä¸ªåº”ç”¨å¼€å‘æµç¨‹ã€‚ ","date":"2020-05-27","objectID":"/2020/development-of-online-forum-based-on-golang-1-overall-design-and-data-model/:2:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›1-æ•´ä½“è®¾è®¡ä¸æ•°æ®æ¨¡å‹","uri":"/2020/development-of-online-forum-based-on-golang-1-overall-design-and-data-model/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. æ•°æ®æ¨¡å‹ æ ¹æ®æˆ‘ä»¬ä¹‹å‰æ‹Ÿå®šçš„éœ€æ±‚ï¼Œè‡³å°‘éœ€è¦ä¸‰ä¸ªæ¨¡å‹ï¼š ç”¨æˆ·ï¼ˆUserï¼‰ ç¾¤ç»„ï¼ˆThreadï¼‰ ä¸»é¢˜ï¼ˆPostï¼‰ å¦å¤–ï¼Œæˆ‘ä»¬åœ¨æœ¬é¡¹ç›®å¼€å‘æ—¶ï¼Œä¼šæŠŠç”¨æˆ·ä¼šè¯ï¼ˆSessionï¼‰ä¹Ÿå­˜å‚¨åˆ°æ•°æ®åº“ï¼ˆç”¨äºè®¤è¯ï¼‰ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªé¢å¤–çš„ä¼šè¯æ¨¡å‹ï¼Œæ­¤å¤–ï¼Œä¸ºäº†ç®€åŒ–åº”ç”¨ï¼Œæˆ‘ä»¬ä¸ä¼šçœŸçš„åƒ Google ç½‘ä¸Šè®ºå›é‚£æ ·å¯¹ç”¨æˆ·åšæƒé™ç®¡ç†ï¼Œæ•´ä¸ªåº”ç”¨åªåŒ…å«ä¸€ç§ç”¨æˆ·ç±»å‹ï¼Œå¹¶ä¸”å…·å¤‡æ‰€æœ‰æ“ä½œæƒé™ï¼š å­¦é™¢å›ï¼ŒåŸºäº Go è¯­è¨€å¼€å‘åœ¨çº¿è®ºå›Â â†©ï¸ çŸ¥ä¹ï¼ŒMVCæ¶æ„æ¨¡å¼è¯¦ç»†è¯´æ˜ä»¥åŠä¸ä¸‰å±‚æ¶æ„çš„åŒºåˆ«Â â†©ï¸ ","date":"2020-05-27","objectID":"/2020/development-of-online-forum-based-on-golang-1-overall-design-and-data-model/:3:0","tags":["Goå®æˆ˜"],"title":"åŸºäºGoè¯­è¨€å¼€å‘åœ¨çº¿è®ºå›1-æ•´ä½“è®¾è®¡ä¸æ•°æ®æ¨¡å‹","uri":"/2020/development-of-online-forum-based-on-golang-1-overall-design-and-data-model/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"Go å®˜æ–¹æä¾›äº†database åŒ…ï¼Œdatabase åŒ…ä¸‹æœ‰ sql/driverã€‚è¯¥åŒ…ç”¨æ¥å®šä¹‰æ“ä½œæ•°æ®åº“çš„æ¥å£ï¼Œè¿™ä¿è¯äº†æ— è®ºä½¿ç”¨å“ªç§æ•°æ®åº“ï¼Œæ“ä½œæ–¹å¼éƒ½æ˜¯ç›¸åŒçš„ã€‚ä½† Go å®˜æ–¹å¹¶æ²¡æœ‰æä¾›è¿æ¥æ•°æ®åº“çš„ driverï¼Œå¦‚æœè¦æ“ä½œæ•°æ®åº“ï¼Œè¿˜éœ€è¦ç¬¬ä¸‰æ–¹çš„ driver åŒ…ã€‚è¿™é‡Œä»‹ç» go-mysql-driver çš„ä½¿ç”¨ã€‚ ","date":"2020-05-26","objectID":"/2020/golang-interact-with-mysql/:0:0","tags":["Goå®æˆ˜"],"title":"Golangæ•°æ®åº“ç¼–ç¨‹","uri":"/2020/golang-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. å®‰è£… åœ¨æ‰§è¡Œäº† go mod çš„é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œå¦‚ä¸‹å®‰è£…å‘½ä»¤ $ go get -u github.com/go-sql-driver/mysql Win10 ä¸‹ï¼Œgo-sql-driver åŒ…å°†è¢«å®‰è£…åˆ° %GOPATH%\\pkg\\mod\\github.com\\go-sql-driver\\mysql@v1.5.0 ç›®å½•ä¸‹ï¼Œå…¶å®ƒé¡¹ç›®ä½¿ç”¨æ—¶ä¸å¿…é‡å¤ä¸‹è½½ï¼Œæ‰§è¡Œä¸Šè¿°å‘½ä»¤å³å¯ç›´æ¥å¼•å…¥ã€‚ ","date":"2020-05-26","objectID":"/2020/golang-interact-with-mysql/:1:0","tags":["Goå®æˆ˜"],"title":"Golangæ•°æ®åº“ç¼–ç¨‹","uri":"/2020/golang-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. å¯¼å…¥ ç¤ºä¾‹ä»£ç å¦‚ä¸‹ import ( \"database/sql\" \"fmt\" _ \"github.com/go-sql-driver/mysql\" ) Golang æä¾›äº†database/sql åŒ…ï¼Œç”¨äºå¯¹ SQL æ•°æ®åº“çš„è®¿é—®ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—æ¥å£æ–¹æ³•ï¼Œç”¨äºè®¿é—®å…³ç³»æ•°æ®åº“ä½†å¹¶ä¸ä¼šæä¾›æ•°æ®åº“ç‰¹æœ‰çš„æ–¹æ³•ï¼Œé‚£äº›ç‰¹æœ‰çš„æ–¹æ³•äº¤ç»™æ•°æ®åº“é©±åŠ¨å»å®ç°ã€‚ å¯¹äºæ•°æ®åº“æ“ä½œæ¥è¯´ï¼Œå¼€å‘è€…ä¸åº”è¯¥ç›´æ¥ä½¿ç”¨å¯¼å…¥çš„é©±åŠ¨åŒ…æ‰€æä¾›çš„æ–¹æ³•ï¼Œè€Œåº”è¯¥ä½¿ç”¨ sql.DB å¯¹è±¡æ‰€æä¾›çš„ç»Ÿä¸€çš„æ–¹æ³•ã€‚å› æ­¤åœ¨å¯¼å…¥ MySQL é©±åŠ¨æ—¶ï¼Œä½¿ç”¨äº†åŒ¿åå¯¼å…¥åŒ…çš„æ–¹å¼ï¼Œå³å°† go-sql-driver åŒ…é‡å‘½åä¸ºç‰¹æ®Šç¬¦å· _ã€‚é‡‡ç”¨è¿™ç§æ–¹å¼åªä¼šæ‰§è¡Œå…¶ä¸­çš„ init å‡½æ•°å’Œåˆå§‹åŒ–å…¶å…¨å±€å˜é‡ï¼Œæ— æ³•è°ƒç”¨å‡½æ•°ã€‚ ","date":"2020-05-26","objectID":"/2020/golang-interact-with-mysql/:2:0","tags":["Goå®æˆ˜"],"title":"Golangæ•°æ®åº“ç¼–ç¨‹","uri":"/2020/golang-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. è¿æ¥æ•°æ®åº“ è¿æ¥æ•°æ®åº“ä½¿ç”¨ sql åŒ…ä¸­çš„ Open() å‡½æ•°ï¼ŒåŸå‹å¦‚ä¸‹ func Open(driverName, dataSourceName string) (*DB, error) driverNameï¼šä½¿ç”¨çš„é©±åŠ¨åã€‚è¿™ä¸ªåå­—å…¶å®å°±æ˜¯æ•°æ®åº“é©±åŠ¨æ³¨å†Œåˆ° database/sql æ—¶æ‰€ä½¿ç”¨çš„åå­— dataSourceNameï¼šæ•°æ®åº“è¿æ¥ä¿¡æ¯ã€‚å®ƒåŒ…å«äº†æ•°æ®åº“çš„ç”¨æˆ·åã€å¯†ç ã€æ•°æ®åº“ä¸»æœºä»¥åŠéœ€è¦è¿æ¥çš„æ•°æ®åº“åç­‰ä¿¡æ¯ã€‚ ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ db, err := sql.Open(\"mysql\", \"ç”¨æˆ·å:å¯†ç @tcp(IP:ç«¯å£)/æ•°æ®åº“?charset=utf8\") sql.Open() è¿”å›çš„ sql.DB å¯¹è±¡æ˜¯ Goroutine å¹¶å‘å®‰å…¨çš„ã€‚sql.DB é€šè¿‡æ•°æ®åº“é©±åŠ¨ä¸ºå¼€å‘è€…æä¾›ç®¡ç†åº•å±‚æ•°æ®åº“è¿æ¥çš„æ‰“å¼€å’Œå…³é—­æ“ä½œã€‚sql.DB å¸®åŠ©å¼€å‘è€…ç®¡ç†æ•°æ®åº“è¿æ¥æ± ã€‚æ­£åœ¨ä½¿ç”¨çš„è¿æ¥è¢«æ ‡è®°ä¸ºç¹å¿™ï¼Œç”¨å®Œåå›åˆ°è¿æ¥æ± ç­‰å¾…ä¸‹æ¬¡ä½¿ç”¨ã€‚æ‰€ä»¥ï¼Œå¦‚æœå¼€å‘è€…æ²¡æœ‰æŠŠè¿æ¥é‡Šæ”¾å›è¿æ¥æ± ï¼Œä¼šå¯¼è‡´è¿‡å¤šè¿æ¥ä½¿ç³»ç»Ÿèµ„æºè€—å°½ã€‚ sql.DB çš„è®¾è®¡ç›®æ ‡å°±æ˜¯ä½œä¸ºé•¿è¿æ¥ï¼ˆä¸€æ¬¡è¿æ¥å¤šæ¬¡æ•°æ®äº¤äº’ï¼‰ä½¿ç”¨ï¼Œä¸å®œé¢‘ç¹å¼€å…³ã€‚æ¯”è¾ƒå¥½çš„åšæ³•æ˜¯ï¼Œä¸ºæ¯ä¸ªä¸åŒçš„ datastore å»ºä¸€ä¸ªDB å¯¹è±¡ï¼Œä¿æŒè¿™äº›å¯¹è±¡æ‰“å¼€ã€‚å¦‚æœéœ€è¦çŸ­è¿æ¥ï¼ˆä¸€æ¬¡è¿æ¥ä¸€æ¬¡æ•°æ®äº¤äº’ï¼‰ï¼Œå°±æŠŠ DB ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°ï¼Œè€Œä¸è¦åœ¨å‡½æ•°ä¸­å¼€å…³ã€‚ ","date":"2020-05-26","objectID":"/2020/golang-interact-with-mysql/:3:0","tags":["Goå®æˆ˜"],"title":"Golangæ•°æ®åº“ç¼–ç¨‹","uri":"/2020/golang-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. å¢åˆ æ”¹æ•°æ® ç›´æ¥è°ƒç”¨DBå¯¹è±¡çš„ Exec() æ–¹æ³•å¦‚ä¸‹æ‰€ç¤º func (db *DB) Exec(query string, args ...interface{}) (Result, error) é€šè¿‡db.Exec()æ’å…¥æ•°æ®ï¼Œé€šè¿‡è¿”å›çš„ err å¯çŸ¥æ’å…¥å¤±è´¥çš„åŸå› ï¼Œé€šè¿‡è¿”å›çš„ç»“æœå¯ä»¥è¿›ä¸€æ­¥æŸ¥è¯¢æœ¬æ¬¡æ’å…¥æ•°æ®å½±å“çš„è¡Œæ•°ï¼ˆRowsAffectedï¼‰å’Œæœ€åæ’å…¥çš„IDï¼ˆå¦‚æœæ•°æ®åº“æ”¯æŒæŸ¥è¯¢æœ€åæ’å…¥IDï¼‰ã€‚äº‹å®ä¸Šï¼ŒResult æ˜¯å¯¹å·²æ‰§è¡Œçš„ SQL å‘½ä»¤çš„æ€»ç»“ï¼Œç±»å‹å®šä¹‰å¦‚ä¸‹ type Result interface { // LastInsertIdè¿”å›ä¸€ä¸ªæ•°æ®åº“ç”Ÿæˆçš„å›åº”å‘½ä»¤çš„æ•´æ•°ã€‚ // å½“æ’å…¥æ–°è¡Œæ—¶ï¼Œä¸€èˆ¬æ¥è‡ªä¸€ä¸ª\"è‡ªå¢\"åˆ—ã€‚ // ä¸æ˜¯æ‰€æœ‰çš„æ•°æ®åº“éƒ½æ”¯æŒè¯¥åŠŸèƒ½ï¼Œè¯¥çŠ¶æ€çš„è¯­æ³•ä¹Ÿå„æœ‰ä¸åŒã€‚ LastInsertId() (int64, error) // RowsAffectedè¿”å›è¢«updateã€insertæˆ–deleteå‘½ä»¤å½±å“çš„è¡Œæ•°ã€‚ // ä¸æ˜¯æ‰€æœ‰çš„æ•°æ®åº“éƒ½æ”¯æŒè¯¥åŠŸèƒ½ã€‚ RowsAffected() (int64, error) } Exec() æ–¹æ³•çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹æ‰€ç¤º result,err := db.Exec(\"INSERT INTO user_info (username, departname, created) VALUES (?,?,?)\", \"Steven\", \"åŒºå—é“¾æ•™å­¦éƒ¨\"ï¼Œ \"2017-10-1\") é¢„ç¼–è¯‘è¯­å¥ï¼ˆPreparedStatementï¼‰æä¾›äº†è¯¸å¤šå¥½å¤„ã€‚PreparedStatement å¯ä»¥å®ç°è‡ªå®šä¹‰å‚æ•°çš„æŸ¥è¯¢ï¼Œé€šå¸¸æ¥è¯´æ¯”æ‰‹åŠ¨æ‹¼æ¥å­—ç¬¦ä¸²SQLè¯­å¥é«˜æ•ˆï¼›PreparedStatement è¿˜å¯ä»¥é˜²æ­¢SQLæ³¨å…¥æ”»å‡»ã€‚å› æ­¤ï¼Œå¼€å‘ä¸­åº”å°½é‡ä½¿ç”¨å®ƒã€‚ é€šå¸¸ä½¿ç”¨ PreparedStatement å’Œ Exec() å®Œæˆ INSERTã€UPDATEã€DELETE æ“ä½œã€‚ä½¿ç”¨DBå¯¹è±¡çš„Prepare() æ–¹æ³•è·å¾—é¢„ç¼–è¯‘å¯¹è±¡ stmtï¼Œç„¶åè°ƒç”¨ Exec() æ–¹æ³•ï¼Œè¯­æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚ func (db *DB) Prepare(query string) (*Stmt, error) å…·ä½“ç”¨æ³•å¦‚ä¸‹ stmt, err := db.Prepare(\"INSERT INTO user_info SET username=?, departnamt=?, created=?\") result, err := stmt.Exec(\"Jackson\", \"ç ”å‘éƒ¨\", \"2017-10-1\") è·å–å½±å“æ•°æ®åº“çš„è¡Œæ•°ï¼Œå¯ä»¥æ ¹æ®è¯¥æ•°å€¼åˆ¤æ–­æ˜¯å¦æ“ä½œï¼ˆæ’å…¥ã€åˆ é™¤æˆ–ä¿®æ”¹ï¼‰æˆåŠŸã€‚è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚ count, err := result.RowsAffected() é¢„ç¼–è¯‘å¯¹è±¡ stmt å±äº Stmt ç±»å‹ï¼Œæ˜¯ä¸€ä¸ªå‡†å¤‡å¥½çš„çŠ¶æ€ï¼Œå¯ä»¥å®‰å…¨åœ°è¢«å¤šä¸ª Goroutine åŒæ—¶ä½¿ç”¨ï¼Œç±»å‹å®šä¹‰ä¸æ–¹æ³•é›†å¦‚ä¸‹ï¼Œå®šä¹‰åœ¨ DB å¯¹è±¡ä¸Šçš„ Exec å’Œ Stmt å¯¹è±¡ä¸Šçš„ Exec ä¼ å…¥å‚æ•°æœ‰åŒºåˆ«ï¼Œåè€…ä¸éœ€è¦ SQL è¯­å¥ï¼Œä½†ä½œç”¨åº”è¯¥æ˜¯ç›¸åŒçš„ã€‚ type Stmt struct { // å†…å«éšè—æˆ–éå¯¼å‡ºå­—æ®µ } func (s *Stmt) Exec(args ...interface{}) (Result, error) func (s *Stmt) Query(args ...interface{}) (*Rows, error) func (s *Stmt) QueryRow(args ...interface{}) *Row func (s *Stmt) Close() error ","date":"2020-05-26","objectID":"/2020/golang-interact-with-mysql/:4:0","tags":["Goå®æˆ˜"],"title":"Golangæ•°æ®åº“ç¼–ç¨‹","uri":"/2020/golang-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"5. æŸ¥è¯¢æ•°æ® æ•°æ®æŸ¥è¯¢çš„ä¸€èˆ¬æ­¥éª¤å¦‚ä¸‹ è°ƒç”¨ db.Query() æ–¹æ³•æ‰§è¡Œ SQL è¯­å¥ï¼Œæ­¤æ–¹æ³•è¿”å›ä¸€ä¸ª Rows ä½œä¸ºæŸ¥è¯¢ç»“æœï¼Œè¯­æ³•å¦‚ä¸‹æ‰€ç¤º func (db *DB) Query(query string, args ...interface{}) (*Rows, error) æ³¨æ„ï¼ŒRows ä½œä¸ºæŸ¥è¯¢ç»“æœï¼Œå…¶æ¸¸æ ‡æŒ‡å‘ç»“æœé›†çš„ç¬¬é›¶è¡Œ å°† rows.Next() æ–¹æ³•çš„è¿”å›å€¼ä½œä¸º for å¾ªç¯çš„æ¡ä»¶ï¼Œè¿­ä»£æŸ¥è¯¢æ•°æ®ï¼Œè¯­æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚ func (rs *Rows) Next() bool Next çš„è¿”å›å€¼ä¸æ˜¯ç®€å•çš„ä¸€ä¸ªå¯¹ä¸‹ä¸€ä¸ªç»“æœæ˜¯å¦å­˜åœ¨çš„åˆ¤æ–­ï¼Œè€Œæ˜¯å‡†å¤‡ä¸‹ä¸€è¡Œç»“æœç”¨äº Scan æ–¹æ³•è¿›è¡Œæ‰«æï¼Œå¦‚æœå‡†å¤‡å¥½ï¼Œè¿”å› trueï¼Œå¦‚æœæ²¡æœ‰ä¸‹ä¸€è¡Œæˆ–å‡†å¤‡æ—¶å‡ºç°é”™è¯¯ï¼Œè¿”å› false åœ¨å¾ªç¯ä¸­ï¼Œé€šè¿‡ rows.Scan()æ–¹æ³•è¯»å–æ¯ä¸€è¡Œæ•°æ®ï¼Œè¯­æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚ func (rs *Rows) Scan(dest ...interface{}) error rows.Scan() æ–¹æ³•çš„å‚æ•°é¡ºåºå¾ˆé‡è¦ï¼Œå¿…é¡»å’ŒæŸ¥è¯¢ç»“æœçš„åˆ—ç›¸å¯¹åº”ï¼ˆæ•°é‡å’Œé¡ºåºéƒ½éœ€è¦ä¸€è‡´ï¼‰ã€‚å‡è®¾ SELECT * From user_info where age ï¼=20 AND age ï¼œ 30 æŸ¥è¯¢çš„åˆ—é¡ºåºæ˜¯ id, name, ageï¼Œå’Œæ’å…¥æ“ä½œé¡ºåºç›¸åŒï¼Œrows.Scan() çš„å‚æ•°ä¼ å…¥ä¹Ÿéœ€è¦æŒ‰ç…§æ­¤é¡ºåº rows.Scan(ï¼†id, ï¼†name, ï¼†age)ï¼Œä¸ç„¶ä¼šé€ æˆæ•°æ®è¯»å–çš„é”™ä½ã€‚ è°ƒç”¨db.Close()å…³é—­æŸ¥è¯¢ï¼ŒClose å…³é—­ DBå¯¹è±¡ï¼Œé‡Šæ”¾ä»»ä½•æ‰“å¼€çš„èµ„æºï¼Œä½†å®é™…ä¸Šå› ä¸º DB å¥æŸ„é€šå¸¸è¢«å¤šä¸ª Go åç¨‹å…±äº«ï¼Œä¸ä¼šè¢«å…³é—­ã€‚ æŸ¥è¯¢å¤šè¡Œæ•°æ®çš„ä¸€ä¸ªå®Œæ•´ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤º stmt, err := db.Prepare(\"SELECT * FROM user_info WHERE uid\u003c?\") rows, err := stmt.Query(10) // æ³¨æ„è¿™é‡Œçš„ Query ä¹Ÿæ˜¯ stmt çš„æ–¹æ³• user := new(UserTable) for rows.Next() { err := rows.Scan(\u0026user.Uid, \u0026user.Username, \u0026user.Department, \u0026user.Created) if err != nil { panic(err) continue } fmt.Println(*user) } å› ä¸º Golang æ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œæ‰€ä»¥æŸ¥è¯¢æ•°æ®æ—¶å…ˆå®šä¹‰æ•°æ®ç±»å‹ã€‚æ•°æ®åº“ä¸­çš„æ•°æ®æœ‰3ç§å¯èƒ½çŠ¶æ€ï¼šå­˜åœ¨å€¼ã€å­˜åœ¨é›¶å€¼ã€æœªèµ‹å€¼ï¼Œå› æ­¤å¯ä»¥å°†å¾…æŸ¥è¯¢çš„æ•°æ®ç±»å‹å®šä¹‰ä¸º sql.NullStringã€sql.NullInt64 ç±»å‹ç­‰ã€‚å¯ä»¥é€šè¿‡ Valid å€¼æ¥åˆ¤æ–­æŸ¥è¯¢åˆ°çš„å€¼æ˜¯èµ‹å€¼çŠ¶æ€è¿˜æ˜¯æœªèµ‹å€¼çŠ¶æ€ã€‚ æ¯æ¬¡ db.Query() æ“ä½œåï¼Œéƒ½å»ºè®®è°ƒç”¨ rows.Close()ã€‚å› ä¸º db.Query() ä¼šä»æ•°æ®åº“è¿æ¥æ± ä¸­è·å–ä¸€ä¸ªè¿æ¥ï¼Œè¿™ä¸ªåº•å±‚è¿æ¥åœ¨ç»“æœé›†ï¼ˆrowsï¼‰æœªå…³é—­å‰ä¼šè¢«æ ‡è®°ä¸ºå¤„äºç¹å¿™çŠ¶æ€ã€‚å½“éå†è¯»åˆ°æœ€åä¸€æ¡è®°å½•æ—¶ï¼Œä¼šå‘ç”Ÿä¸€ä¸ªå†…éƒ¨ EOF é”™è¯¯ï¼Œè‡ªåŠ¨è°ƒç”¨ rows.Close()ã€‚ä½†å¦‚æœå‡ºç°å¼‚å¸¸ï¼Œæå‰é€€å‡ºå¾ªç¯ï¼Œrows ä¸ä¼šå…³é—­ï¼Œè¿æ¥ä¸ä¼šå›åˆ°è¿æ¥æ± ä¸­ï¼Œè¿æ¥ä¹Ÿä¸ä¼šå…³é—­ï¼Œåˆ™æ­¤è¿æ¥ä¼šä¸€ç›´è¢«å ç”¨ã€‚å› æ­¤é€šå¸¸ä½¿ç”¨ defer rows.Close() æ¥ç¡®ä¿æ•°æ®åº“è¿æ¥å¯ä»¥æ­£ç¡®æ”¾å›åˆ°è¿æ¥æ± ä¸­ã€‚rows.Close() æ“ä½œæ˜¯å¹‚ç­‰æ“ä½œï¼Œè€Œä¸€ä¸ªå¹‚ç­‰æ“ä½œçš„ç‰¹ç‚¹æ˜¯ï¼šå…¶ä»»æ„å¤šæ¬¡æ‰§è¡Œæ‰€äº§ç”Ÿçš„å½±å“ä¸ä¸€æ¬¡æ‰§è¡Œçš„å½±å“ç›¸åŒã€‚æ‰€ä»¥å³ä¾¿å¯¹å·²å…³é—­çš„ rows å†æ‰§è¡Œ close() ä¹Ÿæ²¡å…³ç³»ã€‚ è°ˆåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ° Close æ–¹æ³•ä¸€å…±æœ‰ä¸‰ç§ï¼Œåˆ†åˆ«å®šä¹‰åœ¨ DBã€Stmtã€Rows ä¸‰ä¸ªæ–¹æ³•ä¸Šï¼Œç”¨äºå…³é—­æ•°æ®åº“è¿æ¥ã€é¢„å‡†å¤‡çŠ¶æ€å’ŒæŸ¥è¯¢ç»“æœï¼Œä¸è¿‡æœ¬è´¨ä¸Šéƒ½æ˜¯é‡Šæ”¾æŸä¸ªè¿æ¥æ± ä¸­çš„è¿æ¥ã€‚ å•æ¡æ•°æ®é€šè¿‡ QueryRow() æ–¹æ³•æŸ¥è¯¢ï¼Œè¯­æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚ func (db *DB) QueryRow(query string, args ...interface{}) *Row ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ var username, departname, created string err := db.QueryRow(\"SELECT username, departname, created FROM user_info WHERE uid=?\", 3).Scan(\u0026username, \u0026departname, \u0026created) ","date":"2020-05-26","objectID":"/2020/golang-interact-with-mysql/:5:0","tags":["Goå®æˆ˜"],"title":"Golangæ•°æ®åº“ç¼–ç¨‹","uri":"/2020/golang-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"6. ç¤ºä¾‹ä»£ç  å®šä¹‰ä¸€ä¸ªè¡¨ç»“æ„å¦‚ä¸‹ mysql\u003e CREATE TABLE user_info ( -\u003e uid INT(10) NOT NULL AUTO_INCREMENT, -\u003e username VARCHAR(64) DEFAULT NULL, -\u003e departname VARCHAR(64) DEFAULT NULL, -\u003e created DATE DEFAULT NULL, -\u003e PRIMARY KEY(uid) -\u003e ); Query OK, 0 rows affected, 1 warning (0.03 sec) mysql\u003e DESC user_info; +------------+-------------+------+-----+---------+----------------+ | Field | Type | Null | Key | Default | Extra | +------------+-------------+------+-----+---------+----------------+ | uid | int | NO | PRI | NULL | auto_increment | | username | varchar(64) | YES | | NULL | | | departname | varchar(64) | YES | | NULL | | | created | date | YES | | NULL | | +------------+-------------+------+-----+---------+----------------+ 4 rows in set (0.00 sec) ç¼–å†™ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ä»£ç ï¼Œä½¿ç”¨ä¸Šè¿°æåˆ°çš„æ‰€æœ‰æ•°æ®åº“æ“ä½œ package main import ( \"database/sql\" \"fmt\" _ \"github.com/go-sql-driver/mysql\" ) // å®šä¹‰æ•°æ®åº“è¿æ¥ä¿¡æ¯ type DbConn struct { Dsn string // æ•°æ®åº“é©±åŠ¨å­—ç¬¦ä¸² Db *sql.DB } // æ•°æ®åº“ä¸­çš„ç”¨æˆ·è¡¨çš„æ˜ å°„å¯¹è±¡ type UserTable struct { Uid int Username string Department string Created string } func main() { var err error dbConn := DbConn{ Dsn: \"root:@tcp(127.0.0.1:3306)/testdb?charset=utf8\", } dbConn.Db, err = sql.Open(\"mysql\", dbConn.Dsn) if err != nil { fmt.Println(err) } defer dbConn.Db.Close() //1. æµ‹è¯•ç›´æ¥ä½¿ç”¨ DB çš„ Exec() æ–¹æ³•å¢åˆ æ”¹ execData(\u0026dbConn) //2. æµ‹è¯•ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥å’Œ Exec() æ–¹æ³•å¢åˆ æ”¹ preExecData(\u0026dbConn) //3. æŸ¥è¯¢å•è¡Œæ•°æ®(ä»¥æœ€åä¸€æ¡æ•°æ®ä¸ºä¾‹) result := dbConn.QueryRowData(\"select * from user_info where uid = (select max(uid) from user_info)\") fmt.Println(result) //4. æŸ¥è¯¢å¤šè¡Œæ•°æ® result1 := dbConn.QueryData(\"select * from user_info where uid\u003c10\") fmt.Println(len(result1)) //5. æŸ¥è¯¢å¤šè¡Œæ•°æ®ï¼ˆä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥ï¼‰ result2 := dbConn.PreQueryData(\"select * from user_info where uid\u003c? order by uid desc\", 10) fmt.Println(len(result2)) //éå†æŸ¥è¯¢çš„ç»“æœé›† for k, v := range result2 { fmt.Println(\"uid: \", k, v) } } func execData(dbConn *DbConn) { count, id, err := dbConn.ExecData(\"insert user_info (username,departname,created) values ('Josh', 'business group','2020-06-14')\") if err != nil { fmt.Println(err.Error()) } else { fmt.Println(\"å—å½±å“çš„è¡Œæ•°ï¼š\", count) fmt.Println(\"æ–°æ·»åŠ æ•°æ®çš„idï¼š\", id) } } func (dbConn *DbConn) ExecData(sqlString string) (count, id int64, err error) { result, err := dbConn.Db.Exec(sqlString) if err != nil { fmt.Println(err) return } if id, err = result.LastInsertId(); err != nil { fmt.Println(err) return } if count, err = result.RowsAffected(); err != nil { fmt.Println(err) return } return count, id, nil } func preExecData(dbConn *DbConn) { count, id, err := dbConn.PreExecData(\"insert user_info (username,departname,created) values ('Jackson', 'Education Department','2020-06-14')\") if err != nil { fmt.Println(err.Error()) } else { fmt.Println(\"å—å½±å“çš„è¡Œæ•°ï¼š\", count) fmt.Println(\"æ–°æ·»åŠ æ•°æ®çš„idï¼š\", id) } } func (dbConn *DbConn) PreExecData(sqlString string, args ...interface{}) (count, id int64, err error) { stmt, err := dbConn.Db.Prepare(sqlString) defer stmt.Close() if err != nil { fmt.Println(err) return } result, err := stmt.Exec(args...) if err != nil { fmt.Println(err) return } if id, err = result.LastInsertId(); err != nil { fmt.Println(err) return } if count, err = result.RowsAffected(); err != nil { fmt.Println(err) return } return count, id, nil } func (dbConn *DbConn) QueryRowData(sqlString string) (data UserTable) { user := new(UserTable) err := dbConn.Db.QueryRow(sqlString).Scan(\u0026user.Uid, \u0026user.Username, \u0026user.Department, \u0026user.Created) if err != nil { fmt.Println(err) return } return *user } func (dbConn *DbConn) QueryData(sqlString string) (resultSet map[int]UserTable) { rows, err := dbConn.Db.Query(sqlString) defer rows.Close() if err != nil { fmt.Println(err) return } resultSet = make(map[int]UserTable) user := new(UserTable) for rows.Next() { err := rows.Scan(\u0026user.Uid, \u0026user.Username, \u0026user.Department, \u0026user.Created) if err != nil { fmt.Println(err) continue } resultSet[user.Uid] = *user } return resultSet } func (dbConn *DbConn) PreQueryData(sqlString string, args ...interface{}) (resultSet map[int]UserTable) { stmt, err := dbConn.Db.Prepare(sqlString) defer st","date":"2020-05-26","objectID":"/2020/golang-interact-with-mysql/:6:0","tags":["Goå®æˆ˜"],"title":"Golangæ•°æ®åº“ç¼–ç¨‹","uri":"/2020/golang-interact-with-mysql/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"å®é™…å¼€å‘ä¸­å¯¹ä»£ç è¿›è¡Œæµ‹è¯•æ˜¯ä¸å¯ç¼ºå°‘çš„å·¥ä½œï¼Œåœ¨goä¸­å¯ä»¥é€šè¿‡testingåŒ…æ¥è¿›è¡Œä»£ç çš„æµ‹è¯•ã€‚testingåŒ…å’Œgo testå‘½ä»¤ç›¸äº’é…åˆï¼Œèƒ½å¤Ÿå®Œæˆä»£ç çš„è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚ åœ¨å®é™…å¼€å‘ä¸­ï¼Œå¯¹ä»£ç è¿›è¡Œæµ‹è¯•æ˜¯ä¸å¯ç¼ºå°‘çš„å·¥ä½œï¼Œåœ¨goä¸­å¯ä»¥é€šè¿‡testingåŒ…å¯¹ä»£ç è¿›è¡Œå•å…ƒæµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•ã€‚ åŸºæœ¬è¯´æ˜ testingåŒ…æ˜¯ä¸go testå‘½ä»¤é…åˆä½¿ç”¨çš„ï¼Œç¼–å†™æµ‹è¯•ä»£ç éœ€è¦ä½¿ç”¨testingåŒ…ï¼Œè€Œæ‰§è¡Œæµ‹è¯•éœ€è¦ä½¿ç”¨go testå‘½ä»¤ã€‚æ‰§è¡Œæµ‹è¯•æ—¶ï¼Œä¼šè‡ªåŠ¨è¯»å–æºç ç›®å½•ä¸‹åä¸º*_test.goçš„æ–‡ä»¶ï¼Œç”Ÿæˆå¹¶è¿è¡Œæµ‹è¯•ç”¨çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶æœ€ç»ˆåœ¨ç»ˆç«¯è¾“å‡ºæµ‹è¯•ä¿¡æ¯ã€‚è¾“å‡ºçš„ä¿¡æ¯ç±»ä¼¼äº ok archive/tar 0.011s FAIL archive/zip 0.022s ok compress/gzip 0.033s ... testingåŒ…çš„è¯´æ˜ä½äºï¼šPackage testing go testçš„è¯´æ˜å¯é€šè¿‡æ‰§è¡Œ go help testæŸ¥çœ‹ å•å…ƒæµ‹è¯• å‡è®¾å½“å‰æˆ‘ä»¬åœ¨æºä»£ç ç›®å½•æ‹¥æœ‰åä¸ºhello.goçš„æºç æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š package hello import \"fmt\" //Hello print \"hello! func Hello() { fmt.Println(\"hello!\") } é¦–å…ˆç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œå³åœ¨hello.goæ–‡ä»¶åŒç›®å½•ä¸‹åˆ›å»ºhello_test.goæ–‡ä»¶ï¼Œç¼–è¾‘å…¶å†…å®¹å¦‚ä¸‹ï¼š package hello import \"testing\" func TestHello(t *testing.T) { Hello() } æ³¨æ„ï¼Œå•å…ƒæµ‹è¯•çš„å‡½æ•°å¤´ä¸€èˆ¬ç¬¦åˆå¦‚ä¸‹å½¢å¼ï¼Œå…¶ä¸­Xxxæ˜¯æµ‹è¯•å‡½æ•°åã€‚æ— è®ºåŸå‡½æ•°åé¦–å­—æ¯æ˜¯å¦å¤§å†™ï¼Œæµ‹è¯•å‡½æ•°ä¸­å‡½æ•°åçš„é¦–å­—æ¯å¿…é¡»å¤§å†™ï¼ŒåŸè¯ä¸ºwhere Xxx does not start with a lowercase letter. func TestXxx(t *testing.T) åœ¨è¿™ä¸¤ä¸ªæ–‡ä»¶ç›®å½•ä¸‹æ‰§è¡Œgo testå‘½ä»¤ PS F:\\Go\u003e ls Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 2019/9/19 19:31 154 hello.go -a---- 2019/9/19 19:45 222 hello_test.go PS F:\\Go\u003e go test hello! PASS ok _/F_/Go 0.248s æ ¹æ®è¾“å‡ºç»“æœå¯çŸ¥æµ‹è¯•é€šè¿‡ æ€§èƒ½æµ‹è¯• åœ¨hello.goä¸­æ–°å¢Addå‡½æ•° package hello import \"fmt\" //Hello print \"hello! func Hello() { fmt.Println(\"hello!\") } //Add add para func Add(i int) int { return i } åœ¨hello_test.goæ–‡ä»¶ä¸­æ·»åŠ Addçš„æ€§èƒ½æµ‹è¯•å‡½æ•° package hello import ( \"fmt\" \"testing\" ) func TestHello(t *testing.T) { Hello() } func BenchmarkAdd(b *testing.B) { var sum int for i := 0; i \u003c b.N; i++ { sum += Add(1) } fmt.Println(sum) } æ€§èƒ½æµ‹è¯•çš„å‡½æ•°å¤´ä¹Ÿç¬¦åˆä¸å•å…ƒæµ‹è¯•ç›¸ä¼¼çš„å½¢å¼ func BenchmarkXxx(b *testing.B) æ‰§è¡Œå¸¦benchå‚æ•°çš„go testå‘½ä»¤ PS F:\\Go\u003e go test -bench . hello! 1 goos: windows goarch: amd64 BenchmarkHello-4 100 10000 1000000 100000000 2000000000 2000000000 0.32 ns/op PASS ok _/F_/Go 1.019s ä»¥ä¸Šå‘½ä»¤åªæ‰§è¡Œäº†æ€§èƒ½æµ‹è¯•å‡½æ•°ï¼ŒBenchmarkHelloæ‰§è¡Œäº†2000000000æ¬¡ï¼Œæ¯æ¬¡çš„å¹³å‡æ‰§è¡Œæ—¶é—´ä¸º0.32nsï¼Œæ€»çš„æ‰§è¡Œæ—¶é—´ä¸º1.019sã€‚æµ‹è¯•é€šè¿‡ã€‚ go testå‘½ä»¤çš„å‚æ•° ä»¥ä¸Šæ˜¯åŸºæœ¬çš„å•å…ƒæµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•å‘½ä»¤ï¼Œgo testå‘½ä»¤è¿˜æ‹¥æœ‰å¤§é‡çš„å‚æ•°ï¼Œå¯ä»¥å¯¹æµ‹è¯•è¿›è¡Œå®šåˆ¶ã€‚ usage: go test [build/test flags] [packages] [build/test flags \u0026 test binary flags] å¦‚ä¸Šï¼Œgo testå‘½ä»¤æ¥å—ç”¨äºæœ¬èº«çš„ä¸¤ä¸ªå‚æ•°å’Œç”¨äºç”Ÿæˆçš„æµ‹è¯•ç»“æœæ–‡ä»¶çš„ä¸¤ä¸ªå‚æ•°ã€‚ ç”¨äºtestå‘½ä»¤æœ¬èº«çš„å‚æ•°åˆ—è¡¨å¦‚ä¸‹ -bench regexp åªè¿è¡Œä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æ€§èƒ½æµ‹è¯•ï¼Œé»˜è®¤ä¸æ‰§è¡Œä»»ä½•æ€§èƒ½æµ‹è¯•ã€‚ å¯¹äºæµ‹è¯•ï¼Œæ­£åˆ™è¡¨è¾¾å¼ç”±æ–œæ ï¼ˆ/ï¼‰å­—ç¬¦æ‹†åˆ†ä¸ºæ­£åˆ™è¡¨è¾¾å¼åºåˆ— è¦è¿è¡Œæ‰€æœ‰çš„æ€§èƒ½æµ‹è¯•, ä½¿ç”¨ '-bench .' æˆ– '-bench=.'. -benchtime t Run enough iterations of each benchmark to take t, specified as a time.Duration (for example, -benchtime 1h30s). The default is 1 second (1s). The special syntax Nx means to run the benchmark N times (for example, -benchtime 100x). -count n è¿è¡Œæ¯ä¸ªæµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•næ¬¡ï¼ˆé»˜è®¤1æ¬¡ï¼‰ å¦‚æœè®¾ç½®äº† -cpu å‚æ•°, ä¸ºæ¯ä¸ª GOMAXPROCS å€¼è¿è¡Œ n æ¬¡ -cover å¯ç”¨æµ‹è¯•è¦†ç›–ç‡åˆ†æã€‚è¿™é‡Œè¦æ³¨æ„ï¼Œæµ‹è¯•è¦†ç›–ç‡åˆ†ææ˜¯é€šè¿‡åœ¨ç¼–è¯‘å‰æ³¨é‡Šæºç æ¥å®ç°çš„ï¼Œå› æ­¤ï¼Œå‡ºç°é”™è¯¯æ—¶æŠ¥å‘Šçš„è¡Œ å·å¯èƒ½ä¸å¯¹åº”ã€‚ -covermode set,count,atomic ä¸ºæ­£åœ¨æµ‹è¯•çš„åŒ…è®¾ç½®æµ‹è¯•è¦†ç›–ç‡åˆ†æçš„æ¨¡å¼ã€‚ é»˜è®¤ä¸º \"set\" å¯ç”¨äº† -race åˆ™ä¸º \"atomic\". å„æ¨¡å¼è¯´æ˜ï¼š set: bool: è¿™ä¸ªå£°æ˜è¿è¡Œäº†å— count: int: è¿™ä¸ªå£°æ˜è¿è¡Œäº†å¤šå°‘æ¬¡ atomic: int: count, but correct in multithreaded tests; significantly more expensive. éœ€è¦è®¾ç½® -cover -coverpkg pattern1,pattern2,pattern3 åœ¨æ¯ä¸ªæµ‹è¯•ä¸­å¯¹ä¸æ¨¡å¼åŒ¹é…çš„åŒ…åº”ç”¨æµ‹è¯•è¦†ç›–ç‡åˆ†æã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªæµ‹è¯•åªåˆ†ææ­£åœ¨æµ‹è¯•çš„åŒ…ã€‚ è¿è¡Œ 'go help packages' å¯è·å¾—åŒ…æ¨¡å¼çš„è¯´æ˜ éœ€è¦è®¾ç½® -cover -cpu 1,2,4 æŒ‡å®šåº”ä¸ºå…¶æ‰§è¡Œæµ‹è¯•æˆ–æ€§èƒ½æµ‹è¯•çš„GOMAXPROCSå€¼çš„åˆ—è¡¨ã€‚é»˜è®¤å€¼æ˜¯GOMAXPROCSçš„å½“å‰å€¼ã€‚ -failfast ç¬¬ä¸€æ¬¡æµ‹è¯•å¤±è´¥åä¸å¼€å¯æ–°çš„æµ‹è¯• -list regexp åˆ—å‡ºä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„æµ‹è¯•ã€æ€§èƒ½æµ‹è¯•æˆ–ç¤ºä¾‹æµ‹è¯•ã€‚ ä½†ä¸ä¼šè¿è¡Œä»»ä½•æµ‹è¯•ã€æ€§èƒ½æµ‹è¯•æˆ–ç¤ºä¾‹æµ‹è¯•ã€‚ åªåˆ—å‡ºé¡¶çº§æµ‹è¯•ã€‚ä¸ä¼šæ˜¾ç¤ºå­æµ‹è¯•æˆ–å­æ€§èƒ½æµ‹è¯•ã€‚ -parallel n å…è®¸è°ƒç”¨t.parallelçš„æµ‹è¯•å‡½æ•°å¹¶è¡Œæ‰§è¡Œã€‚ næ˜¯è¦åŒæ—¶è¿è¡Œçš„æœ€å¤§æµ‹è¯•æ•°ï¼›é»˜è®¤è®¾ç½®ä¸ºGOMAXPROCSçš„å€¼ã€‚ è¯¥å‚æ•°åªé€‚ç”¨äºå•ä¸ªæµ‹è¯•äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ å¹¶è¡Œæµ‹è¯•ä¸åŒçš„packageå‚åŠ  'go help build' å‘½ä»¤çš„è¯´æ˜ -run regexp ä»…è¿è¡Œä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„é‚£äº›æµ‹è¯•å’Œç¤ºä¾‹æµ‹è¯•ã€‚ å¯¹äºæµ‹è¯•ï¼Œæ­£åˆ™è¡¨è¾¾å¼ç”±æ–œæ ï¼ˆ/ï¼‰å­—ç¬¦æ‹†åˆ†ä¸ºæ­£åˆ™è¡¨è¾¾å¼åºåˆ— -short æµ‹è¯•é•¿æ—¶é—´è¿è¡Œæ—¶å£°æ˜éœ€è¦ç¼©çŸ­æ—¶é—´ï¼Œé»˜è®¤å…³é—­ã€‚ -timeout d å¦‚æœæµ‹è¯•æ–‡ä»¶çš„è¿è¡Œæ—¶é—´é•¿äº d, panicã€‚ å¦‚æœdä¸º 0, æœªè¶…æ—¶ã€‚ é»˜è®¤ä¸º 10 åˆ†é’Ÿ (10m). -v è¯¦ç»†è¾“å‡ºï¼šè®°å½•æ‰€æœ‰è¿è¡Œçš„æµ‹è¯•ã€‚å³ä½¿æµ‹è¯•æˆåŠŸï¼Œä¹Ÿæ‰“å°æ—¥å¿—ã€‚ -vet list åœ¨â€œgo testâ€æœŸé—´é…ç½®â€œgo vetâ€çš„è°ƒç”¨ï¼Œä»è€Œä½¿ç”¨ä»¥é€—å·åˆ†éš”çš„vetæ£€æŸ¥åˆ—è¡¨ã€‚ å¦‚æœlistä¸ºç©ºï¼Œåˆ™â€œgo testâ€è¿è¡Œâ€œgo vetâ€ï¼Œå…¶ä¸­åˆ—å‡ºäº†ä¸€ç³»åˆ—è¢«è®¤ä¸ºå€¼å¾—è§£å†³çš„æ£€æŸ¥ã€‚ å¦‚æœlistæ˜¯â€œoffâ€ï¼Œåˆ™â€œgo testâ€æ ¹æœ¬ä¸ä¼šè¿è¡Œâ€œgo vetâ€ã€‚ ç”¨äºç”Ÿæˆçš„æµ‹è¯•ç»“æœæ–‡ä»¶çš„å‚æ•°åˆ—è¡¨å¦‚ä¸‹ -benchmem æ‰“å°æ€§èƒ½æµ‹è¯•çš„å†…å­˜åˆ†é…ç»Ÿè®¡ä¿¡æ¯ -blockprofile block.out Write a goroutine blocking profile to the specified file when all tests are complete. Writes test binary as -c would. -blockprofilerate n Control the detail provided in goroutine blocking profiles by calling runtime.SetBlockProfileRate with n. See 'go doc runtime.SetBlockProfileRate'. The profiler aims to sample, on average, one blocking event every n nanoseconds the program spends blocked. By default, if -test.blockprofile is set without this flag, all blocking events are recorded, equivalent to -test.","date":"2019-12-22","objectID":"/2019/golang-syntax-12-test/:0:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€12-æµ‹è¯•","uri":"/2019/golang-syntax-12-test/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"Goä¸­æœ‰ä¸¤å¥—é”™è¯¯å¤„ç†çš„æ–¹å¼ æ™®é€šé”™è¯¯ï¼š åœ¨å‡½æ•°å’Œæ–¹æ³•ä¸­è¿”å›é”™è¯¯å¯¹è±¡ä½œä¸ºå®ƒä»¬çš„å”¯ä¸€æˆ–æœ€åä¸€ä¸ªè¿”å›å€¼ ï¼Œå¦‚æœè¿”å›nilï¼Œè¡¨ç¤ºæ²¡æœ‰é”™è¯¯ å¼‚å¸¸ï¼šä½¿ç”¨panicå’Œrecover ä¸»è°ƒå‡½æ•°æ€»æ˜¯åº”è¯¥æ£€æŸ¥æ”¶åˆ°çš„é”™è¯¯ï¼Œä¸è¦å¿½ç•¥ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´ä¸¥é‡çš„åæœã€‚ ","date":"2019-12-20","objectID":"/2019/golang-syntax-11-error-and-panic/:0:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€11-é”™è¯¯å¤„ç†","uri":"/2019/golang-syntax-11-error-and-panic/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. æ™®é€šé”™è¯¯ Goæœ‰ä¸€ä¸ªé¢„å®šä¹‰çš„erroræ¥å£ç±»å‹ type error interface { Error() string } errorsåŒ…ä¸­æœ‰ä¸€ä¸ªerrorStringç»“æ„ä½“å®ç°äº†è¯¥æ¥å£ï¼Œå…¶å® errors åŒ…å®ç°å¾ˆç®€å•ï¼Œå¦‚ä¸‹ package errors // New returns an error that formats as the given text. // Each call to New returns a distinct error value even if the text is identical. func New(text string) error { return \u0026errorString{text} } // errorString is a trivial implementation of error. type errorString struct { s string } func (e *errorString) Error() string { return e.s } ","date":"2019-12-20","objectID":"/2019/golang-syntax-11-error-and-panic/:1:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€11-é”™è¯¯å¤„ç†","uri":"/2019/golang-syntax-11-error-and-panic/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.1 å®šä¹‰é”™è¯¯ å½“æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–°çš„é”™è¯¯ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨errorsåŒ…çš„errors.Newå‡½æ•°æ¥æ”¶åˆé€‚çš„ä¿¡æ¯æ¥åˆ›å»ºï¼Œå¦‚ä¸‹ä¾‹ err := errors.New(\"math - square root of negative number\") ä»ä¸Šé¢çš„å®ç°ä¸­å¯ä»¥çœ‹åˆ°è°ƒç”¨ errors.New å…¶å®å°±æ˜¯å°†ä¼ å…¥çš„å­—ç¬¦ä¸²ç»™äº†ç»“æ„ä½“ errorStringï¼Œç”±äºè¯¥ç»“æ„ä½“å®ç°äº† error æ¥å£ï¼Œå› æ­¤ New å‡½æ•°è¿”å›çš„æ—¶å€™å°†ç»“æ„ä½“èµ‹ç»™äº†ä¸€ä¸ª error æ¥å£å˜é‡ï¼Œæ‰€ä»¥ä»¥åæˆ‘ä»¬åœ¨ä¸»è°ƒå‡½æ•°è¾“å‡ºè¯¥è¿”å›å€¼æ—¶ï¼Œä¼šè¾“å‡ºç»“æ„ä½“çš„å€¼ã€‚ æ‹¿ä¸€ä¸ªè®¡ç®—å¹³æ–¹æ ¹çš„å‡½æ•°ä¸¾ä¾‹ï¼Œå¯ä»¥è¿™æ ·ä½¿ç”¨ func Sqrt(f float64) (float64, error) { if f \u003c 0 { return 0, errors.New(\"math - square root of negative number\") } //implementation of Sqrt } ç„¶ååƒä¸‹é¢è¿™æ ·è°ƒç”¨Sqrtå‡½æ•° if f, err := Sqrt(-1); err != nil { fmt.Printf(\"Error: %s\\n\", err) } ä½¿ç”¨fmt.Printfå°†é”™è¯¯ä¿¡æ¯æ‰“å°å‡ºæ¥ï¼Œå®šä¹‰çš„é”™è¯¯ä¿¡æ¯é€šè¿‡ä¼šæœ‰åƒError:è¿™æ ·çš„å‰ç¼€ï¼Œæ‰€ä»¥é”™è¯¯ä¿¡æ¯çš„å†…å®¹ä¸è¦ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œå¦‚ä¸Šä¾‹ä¸­ä½¿ç”¨mathè€Œä¸æ˜¯Math å¤§éƒ¨åˆ†æƒ…å†µè‡ªå®šä¹‰é”™è¯¯ç±»å‹éƒ½æ˜¯å¾ˆæœ‰ç”¨çš„æ–¹æ³•ï¼Œå¯ä»¥å°†åº•å±‚é”™è¯¯ä¿¡æ¯ä¹‹å¤–çš„å…¶å®ƒæœ‰ç”¨ä¿¡æ¯æ‰“å°å‡ºæ¥ã€‚å¦‚æœæœ‰ä¸åŒçš„é”™è¯¯æ¡ä»¶ï¼Œå°±å¯ä»¥ç”¨ç±»å‹æ–­è¨€åˆ¤æ–­é”™è¯¯åœºæ™¯ï¼Œå¹¶åšä¸€äº›è¡¥æ•‘å’Œæ¢å¤ switch err := err.(type) { case ParseError: PrintParseError(err) case PathError: PrintPathError(err) ... default: fmt.Printf(\"Not a special error, just %s\\n\", err) } åŒ…ä¹Ÿå¯ä»¥ç”¨é¢å¤–çš„æ–¹æ³•å®šä¹‰ç‰¹å®šçš„é”™è¯¯ï¼Œå¦‚net.Error: package net type Error interface { Timeout() bool // Is the error a timeout? Temporary() bool // Is the error temporary? } å¦‚å‰æ‰€è¿°ï¼Œæ‰€æœ‰çš„ä¾‹å­éƒ½éµå¾ªåŒä¸€ç§å‘½åè§„èŒƒï¼š é”™è¯¯ç±»å‹ä»¥ â€œErrorâ€ ç»“å°¾ï¼Œé”™è¯¯å˜é‡ä»¥ â€œerrâ€ æˆ– â€œErrâ€ å¼€å¤´ã€‚ ","date":"2019-12-20","objectID":"/2019/golang-syntax-11-error-and-panic/:1:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€11-é”™è¯¯å¤„ç†","uri":"/2019/golang-syntax-11-error-and-panic/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.2 è¾“å‡ºæ›´å¤šçš„é”™è¯¯ä¿¡æ¯ fmt.Errorf()æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„fmtåŒ…çš„å‡½æ•°ï¼Œç”¨äºè¾“å‡ºæ›´å¤šçš„é”™è¯¯ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å•å•ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å¦‚å‰é¢å¹³æ–¹æ ¹çš„ä¾‹å­ if f \u003c 0 { return 0, fmt.Errorf(\"math: squre root of negative number %g\", f) } å®é™…ä¸Šï¼Œfmt.Errorfå’Œerrors.Newä¸€æ ·éƒ½è¿”å›errorç±»å‹çš„å˜é‡ ","date":"2019-12-20","objectID":"/2019/golang-syntax-11-error-and-panic/:1:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€11-é”™è¯¯å¤„ç†","uri":"/2019/golang-syntax-11-error-and-panic/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. å¼‚å¸¸ æˆ–è€…ç§°ä¸ºè¿è¡Œæ—¶å¼‚å¸¸ï¼ŒæŒ‡çš„æ˜¯é‚£äº›æ— æ³•é¢„æµ‹çš„é”™è¯¯ã€‚æ¯”å¦‚æ•°ç»„ä¸‹æ ‡è¶Šç•Œæˆ–ç±»å‹æ–­è¨€å¤±è´¥ï¼Œå°±ä¼šè§¦å‘å¼‚å¸¸ï¼Œå¹¶ä¸”ä¼´éšç€ç¨‹åºç»ˆæ­¢è¿”å›ä¸€ä¸ªruntime.Erroræ¥å£ç±»å‹çš„å€¼ï¼Œè¿™ä¸ªå€¼å’Œæ™®é€šé”™è¯¯çš„åŒºåˆ«åœ¨äºæœ‰ä¸€ä¸ªRuntimeError()æ–¹æ³• ","date":"2019-12-20","objectID":"/2019/golang-syntax-11-error-and-panic/:2:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€11-é”™è¯¯å¤„ç†","uri":"/2019/golang-syntax-11-error-and-panic/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 panic panicå°±æ˜¯Goä¸­ç”¨äºç”Ÿæˆå¼‚å¸¸çš„æ–¹æ³•ã€‚å½“é”™è¯¯ä¸å¯ä¿®å¤ã€ç¨‹åºæ— æ³•ç»§ç»­è¿è¡Œæ—¶ï¼Œä½¿ç”¨panicå‡½æ•°æ¥äº§ç”Ÿä¸€ä¸ªä¸­æ­¢ç¨‹åºçš„è¿è¡Œæ—¶é”™è¯¯ï¼Œpanicæ¥æ”¶ä»»æ„ç±»å‹çš„å‚æ•°ï¼Œé€šå¸¸æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå‚æ•°ä¼šåœ¨ç¨‹åºç»ˆæ­¢æ—¶è¢«æ‰“å°å‡ºæ¥ã€‚ä¸­æ­¢ç¨‹åºå’Œæ‰“å°å‚æ•°çš„è¿‡ç¨‹ç”±Go runtimeè´Ÿè´£ã€‚ä¸€ä¸ªä¾‹å­å¦‚ä¸‹ package main import \"fmt\" func main() { fmt.Println(\"Starting the program\") panic(\"A severe error occurred: stopping the program!\") fmt.Println(\"Ending the program\") } è¾“å‡ºå¦‚ä¸‹ Starting the program panic: A severe error occurred: stopping the program! goroutine 1 [running]: main.main() F:/Gotest/main.go:7 +0x9c exit status 2 ä¸€ä¸ªæ£€æµ‹åˆ°é”™è¯¯ç„¶åä½¿ç”¨panicæŠ›å‡ºå¼‚å¸¸çš„å®Œæ•´ä¾‹å­å¦‚ä¸‹ if err != nil { panic(\"ERROR occurred:\" + err.Error()) } ä½†panicæŠ›å‡ºå¼‚å¸¸å¹¶ä¸­æ­¢ç¨‹åºæ˜¯æœ€åçš„åŠæ³•ï¼Œå¦‚æœæœ‰ä¿®å¤çš„å¯èƒ½å°±ä¸åº”è¯¥ä½¿ç”¨ ","date":"2019-12-20","objectID":"/2019/golang-syntax-11-error-and-panic/:2:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€11-é”™è¯¯å¤„ç†","uri":"/2019/golang-syntax-11-error-and-panic/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 panicking åœ¨å¤šå±‚åµŒå¥—çš„å‡½æ•°è°ƒç”¨ä¸­ä½¿ç”¨panicï¼Œå¯ä»¥é©¬ä¸Šä¸­æ­¢å½“å‰å‡½æ•°çš„æ‰§è¡Œï¼Œæ‰€æœ‰çš„deferè¯­å¥éƒ½ä¼šä¿è¯æ‰§è¡Œå¹¶æŠŠæ§åˆ¶æƒäº¤è¿˜ç»™æ¥æ”¶åˆ°panicçš„å‡½æ•°è°ƒç”¨è€…ã€‚è¿™æ ·å‘ä¸Šå†’æ³¡ç›´åˆ°æœ€é¡¶å±‚ï¼Œå¹¶æ‰§è¡Œï¼ˆæ¯å±‚çš„ï¼‰deferï¼Œåœ¨æ ˆé¡¶å¤„ç¨‹åºå´©æºƒï¼Œå¹¶åœ¨å‘½ä»¤è¡Œä¸­ç”¨ä¼ ç»™panicçš„å€¼æŠ¥å‘Šé”™è¯¯æƒ…å†µï¼šè¿™ä¸ªç»ˆæ­¢çš„è¿‡ç¨‹å°±æ˜¯panickingã€‚ ","date":"2019-12-20","objectID":"/2019/golang-syntax-11-error-and-panic/:2:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€11-é”™è¯¯å¤„ç†","uri":"/2019/golang-syntax-11-error-and-panic/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 recover revocerå‡½æ•°ç”¨äºè®©ç¨‹åºä»panickingé‡æ–°è·å¾—æ§åˆ¶æƒï¼Œåœæ­¢ç»ˆæ­¢è¿‡ç¨‹è¿›è€Œæ¢å¤æ­£å¸¸æ‰§è¡Œï¼Œä½†recoveråªèƒ½åœ¨deferä¿®é¥°çš„å‡½æ•°ä¸­ä½¿ç”¨ã€‚å¦‚æœæ­£å¸¸æ‰§è¡Œï¼Œè°ƒç”¨recoverä¼šè¿”å›nilï¼Œæ²¡æœ‰å…¶å®ƒæ•ˆæœã€‚ ç®€è€Œè¨€ä¹‹ï¼Œpanickingæœ‰ä¸¤ä¸ªç»“æœï¼Œä¸€ä¸ªæ˜¯ç¨‹åºç»ˆæ­¢ï¼Œä¸€ä¸ªæ˜¯é‡åˆ°deferä¿®é¥°çš„recover()å‡½æ•°ç„¶åæ¢å¤ã€‚ä¸€ä¸ªä¾‹å­å¦‚ä¸‹ func protect(g func()) { defer func() { log.Println(\"done\") // Println executes normally even if there is a panic if err := recover(); err != nil { log.Printf(\"run time panic: %v\", err) } }() log.Println(\"start\") g() // possible runtime-error } å°†panicï¼Œdeferå’Œrecoverç»“åˆçš„å®Œæ•´ä¾‹å­å¦‚ä¸‹ package main import ( \"fmt\" ) func badCall() { panic(\"bad end\") } func test() { defer func() { if e := recover(); e != nil { fmt.Printf(\"Panicing %s\\r\\n\", e) } }() badCall() fmt.Printf(\"After bad call\\r\\n\") // \u003c-- wordt niet bereikt } func main() { fmt.Printf(\"Calling test\\r\\n\") test() fmt.Printf(\"Test completed\\r\\n\") } è¾“å‡º Calling test Panicing bad end Test completed ","date":"2019-12-20","objectID":"/2019/golang-syntax-11-error-and-panic/:2:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€11-é”™è¯¯å¤„ç†","uri":"/2019/golang-syntax-11-error-and-panic/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. é”™è¯¯å¤„ç†çš„ä¸€äº›åŸåˆ™ è¿™æ˜¯åœ¨ç¼–å†™è‡ªå·±çš„åŒ…æ—¶éœ€è¦éµå¾ªçš„ä¸€äº›åŸåˆ™ï¼Œæœ‰åŠ©äºåˆ«äººè°ƒç”¨å’Œç¨‹åºæ­£å¸¸è¿è¡Œ åœ¨åŒ…å†…éƒ¨ï¼Œæ€»æ˜¯åœ¨panicåä½¿ç”¨recoverï¼Œä¸è¦è®©panicè¿”å›çš„å±‚æ¬¡è¶…å‡ºå½“å‰åŒ…çš„èŒƒå›´ å‘åŒ…çš„è°ƒç”¨è€…è¿”å›é”™è¯¯å€¼ï¼Œè€Œä¸æ˜¯panic åœ¨åŒ…å†…éƒ¨çš„ä¸å¯å¯¼å‡ºå‡½æ•°ä¸­æœ‰æ·±å±‚æ¬¡è°ƒç”¨æ—¶ï¼Œå°†panicè½¬æ¢æˆerroræ¥é€šçŸ¥è°ƒç”¨è€…å‡ºé”™ä¿¡æ¯ æ ¹æ®æ­¤åŸåˆ™ï¼Œä¸€ä¸ªparseåŒ…å¦‚ä¸‹ï¼Œä½œç”¨æ˜¯æŠŠè¾“å…¥çš„å­—ç¬¦ä¸²è§£æä¸ºæ•´æ•°åˆ‡ç‰‡ package parse import ( \"fmt\" \"strings\" \"strconv\" ) // A ParseError indicates an error in converting a word into an integer. type ParseError struct { Index int // The index into the space-separated list of words. Word string // The word that generated the parse error. Err error // The raw error that precipitated this error, if any. } // String returns a human-readable error message. func (e *ParseError) String() string { return fmt.Sprintf(\"pkg parse: error parsing %q as int\", e.Word) } // Parse parses the space-separated words in in put as integers. func Parse(input string) (numbers []int, err error) { defer func() { if r := recover(); r != nil { var ok bool err, ok = r.(error) if !ok { err = fmt.Errorf(\"pkg: %v\", r) } } }() fields := strings.Fields(input) numbers = fields2numbers(fields) return } func fields2numbers(fields []string) (numbers []int) { if len(fields) == 0 { panic(\"no words to parse\") } for idx, field := range fields { num, err := strconv.Atoi(field) if err != nil { panic(\u0026ParseError{idx, field, err}) } numbers = append(numbers, num) } return } è¯¥åŒ…å®šä¹‰äº†è‡ªå·±çš„ParseErrorï¼Œå½“æ²¡æœ‰ä¸œè¥¿éœ€è¦è½¬æ¢æˆ–è½¬æ¢æˆæ•´æ•°å¤±è´¥æ—¶ï¼Œäº§ç”Ÿpanicï¼Œä½†å¯å¯¼å‡ºçš„Parseå‡½æ•°ä¼šä»panicä¸­recoverå¹¶æ•´åˆä¿¡æ¯è¿”å›ä¸€ä¸ªé”™è¯¯ç»™è°ƒç”¨è€…ã€‚ ä¸€ä¸ªè°ƒç”¨parseåŒ…çš„å®ä¾‹å¦‚ä¸‹ package main import ( \"fmt\" \"./parse/parse\" ) func main() { var examples = []string{ \"1 2 3 4 5\", \"100 50 25 12.5 6.25\", \"2 + 2 = 4\", \"1st class\", \"\", } for _, ex := range examples { fmt.Printf(\"Parsing %q:\\n \", ex) nums, err := parse.Parse(ex) if err != nil { fmt.Println(err) // here String() method from ParseError is used continue } fmt.Println(nums) } } è¾“å‡º Parsing \"1 2 3 4 5\": [1 2 3 4 5] Parsing \"100 50 25 12.5 6.25\": pkg: pkg parse: error parsing \"12.5\" as int Parsing \"2 + 2 = 4\": pkg: pkg parse: error parsing \"+\" as int Parsing \"1st class\": pkg: pkg parse: error parsing \"1st\" as int Parsing \"\": pkg: no words to parse ","date":"2019-12-20","objectID":"/2019/golang-syntax-11-error-and-panic/:3:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€11-é”™è¯¯å¤„ç†","uri":"/2019/golang-syntax-11-error-and-panic/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. é—­åŒ…å¤„ç†é”™è¯¯ æ ¹æ®ä¸Šé¢çš„åŸåˆ™ï¼Œåªè¦æœ‰å‡½æ•°è¿”å›ï¼Œå°±åº”è¯¥æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯å‘ç”Ÿï¼Œä½†è¿™ä¼šå¯¼è‡´é‡å¤ä¹å‘³çš„ä»£ç ã€‚ç»“åˆ defer/panic/recover æœºåˆ¶å’Œé—­åŒ…å¯ä»¥å¾—åˆ°ä¸€ç§æ›´åŠ ä¼˜é›…çš„å†™æ³•ã€‚ä¸è¿‡è¿™ç§å†™æ³•çš„é™åˆ¶æ˜¯æ‰€æœ‰å‡½æ•°éƒ½éœ€è¦æ˜¯åŒä¸€ç§ç­¾åã€‚ å‡è®¾æ‰€æœ‰å‡½æ•°ç­¾åéƒ½æ˜¯ä¸‹é¢è¿™ç§å½¢å¼ func f(a type1, b type2) å‚æ•°çš„æ•°é‡å’Œç±»å‹æ˜¯ä¸ç›¸å…³çš„ï¼Œæˆ‘ä»¬ç»™è¿™ä¸ªç±»å‹ä¸€ä¸ªåå­—ï¼š fType1 = func f(a type1, b type2) ä½¿ç”¨ä¸¤ä¸ªè¾…åŠ©å‡½æ•°å¸®å¿™å®Œæˆæ•´ä¸ªè¿‡ç¨‹ checkï¼šç”¨æ¥æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯å’Œpanicå‘ç”Ÿçš„å‡½æ•° func check(err error) { if err != nil { panic(err) } } errorhandlerï¼šæ¥æ”¶ä¸€ä¸ª fType1 ç±»å‹çš„å‡½æ•° fn å¹¶è¿”å›ä¸€ä¸ªè°ƒç”¨ fn çš„å‡½æ•°, å…¶ä¸­åŒ…å«æœ‰ defer/recover æœºåˆ¶ func errorHandler(fn fType1) fType1 { return func(a type1, b type2) { defer func() { if err, ok := recover().(error); ok { log.Printf(â€œrun time panic: %vâ€, err) } }() fn(a, b) } } å½“é”™è¯¯å‘ç”Ÿæ—¶ä¼š recover å¹¶æ‰“å°åœ¨æ—¥å¿—ä¸­ï¼Œcheck() å‡½æ•°ä¼šåœ¨æ‰€æœ‰çš„è¢«è°ƒå‡½æ•°ä¸­è°ƒç”¨ï¼Œåƒè¿™æ ·ï¼š ```go func f1(a type1, b type2) { f, _, err := // call function/method check(err) t, err := // call function/method check(err) _, err2 := // call function/method check(err2) } é€šè¿‡è¿™ç§æœºåˆ¶ï¼Œæ‰€æœ‰çš„é”™è¯¯éƒ½ä¼šè¢« recoverï¼Œå¹¶ä¸”è°ƒç”¨å‡½æ•°åçš„é”™è¯¯æ£€æŸ¥ä»£ç ä¹Ÿè¢«ç®€åŒ–ä¸ºè°ƒç”¨ check(err) å³å¯ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œä¸åŒçš„é”™è¯¯å¤„ç†å¿…é¡»å¯¹åº”ä¸åŒçš„å‡½æ•°ç±»å‹ï¼›å®ƒä»¬ï¼ˆé”™è¯¯å¤„ç†ï¼‰å¯èƒ½è¢«éšè—åœ¨é”™è¯¯å¤„ç†åŒ…å†…éƒ¨ã€‚å¯é€‰çš„æ›´åŠ é€šç”¨çš„æ–¹å¼æ˜¯ç”¨ä¸€ä¸ªç©ºæ¥å£ç±»å‹çš„åˆ‡ç‰‡ä½œä¸ºå‚æ•°å’Œè¿”å›å€¼ã€‚ æœ€æœ€é‡è¦çš„ä¸€ç‚¹ï¼ŒGoroutine ä¸­æŠ›å‡ºçš„å¼‚å¸¸ï¼Œåªèƒ½åœ¨æœ¬åç¨‹ä¸­ä½¿ç”¨ recover æ•è·ï¼Œä¸»åç¨‹æ˜¯æ— æ³•æ¥æ”¶åˆ°çš„ï¼ŒåŒæ—¶ï¼Œå­åç¨‹å‘ç”Ÿçš„ panic å¦‚æœæ²¡æœ‰è¢«æ•è·ï¼Œä¼šå¯¼è‡´æ•´ä¸ªç¨‹åºä¸­æ–­ã€‚ ","date":"2019-12-20","objectID":"/2019/golang-syntax-11-error-and-panic/:4:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€11-é”™è¯¯å¤„ç†","uri":"/2019/golang-syntax-11-error-and-panic/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"é¦–å…ˆæ¥å›é¡¾åœ¨æ“ä½œç³»ç»Ÿä¸­å­¦è¿‡çš„ä¸€äº›æ¦‚å¿µã€‚è¿›ç¨‹(processes)æ˜¯ç¨‹åºæ‰§è¡Œçš„åŸºæœ¬å•ä½ï¼Œè¿è¡Œåœ¨ä¸€ä¸ªç‹¬ç«‹çš„å†…å­˜åœ°å€ç©ºé—´ä¸­ï¼›ä¸€ä¸ªè¿›ç¨‹ç”±å¤šä¸ªçº¿ç¨‹(threads)ç»„æˆï¼Œçº¿ç¨‹çš„å­˜åœ¨æ˜¯ä¸ºäº†èƒ½å¤ŸåŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œæœ€å¤§åŒ–åˆ©ç”¨æ—¶é—´ï¼Œé˜²æ­¢äº§ç”Ÿç­‰å¾…ï¼Œçº¿ç¨‹é—´æ˜¯å…±äº«å†…å­˜åœ°å€ç©ºé—´çš„ã€‚ä»windowsèµ„æºç®¡ç†å™¨çœ‹è¿™ä¸€ç‚¹èƒ½çœ‹çš„å¾ˆæ˜ç™½ï¼Œå¦‚ä¸‹ï¼Œæ¯ä¸ªåº”ç”¨ç¨‹åºæ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼ŒTyporaç¨‹åºä¸‹æœ‰ä¸¤ä¸ªçº¿ç¨‹åœ¨åŒæ—¶è¿è¡Œã€‚ å¹¶å‘æ˜¯å»ºç«‹åœ¨å¤šçº¿ç¨‹ä¹‹ä¸Šçš„æ¦‚å¿µï¼Œå°†CPUçš„æ‰§è¡Œæ—¶é—´åˆ’åˆ†ä¸ºè®¸å¤šå¾ˆå°çš„é—´éš”ï¼Œå¤šä¸ªçº¿ç¨‹ä¸æ–­åœ°åˆ‡æ¢æ‰§è¡Œï¼Œä»ä¸Šå±‚çœ‹èµ·æ¥å°±åƒåœ¨åŒæ—¶æ‰§è¡Œä¸€æ ·ï¼Œä½†æœ¬è´¨ä¸Šä¾ç„¶æ˜¯çº¿æ€§çš„ã€‚å¹¶è¡Œåˆ™æ˜¯ç¨‹åºåœ¨æŸä¸ªç‰¹å®šçš„äº‹ä»¶åŒæ—¶è¿è¡Œåœ¨å¤šä¸ªCPUä¸Šï¼Œå¤šæ ¸å¤„ç†å™¨ä¸ºå¹¶è¡Œæä¾›äº†å¯èƒ½ã€‚å› æ­¤ï¼Œå¹¶å‘ä¹Ÿå¯èƒ½æ˜¯å¹¶è¡Œçš„ã€‚ æ“ä½œç³»ç»Ÿè¯¾ç¨‹ä¸­ä¸€ä¸ªæœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯å¤šçº¿ç¨‹å¯¹å…±äº«å†…å­˜ç©ºé—´çš„è®¿é—®ï¼Œæˆ‘ä»¬å­¦åˆ°çš„è§£å†³æ–¹å¼æ˜¯é€šè¿‡åŠ äº’æ–¥é”æ¥å®ç°ï¼Œä½†åœ¨è®¾è®¡å®ç°ä¸Šæ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ï¼Œéå¸¸å®¹æ˜“å‡ºé”™ï¼Œé‰´äºæ“ä½œç³»ç»Ÿè€ƒè¯•çš„æƒ¨ç—›ç»å†ï¼Œç°åœ¨å®Œå…¨ä¸æƒ³å›å¿†ã€‚Goä¸­çš„æ ‡å‡†åº“syncä¸­æœ‰ä¸€äº›å·¥å…·å¯ä»¥ç”¨æ¥å®ç°äº’æ–¥é”çš„ç›¸å…³æ“ä½œï¼Œä½†å®ƒæ˜¾ç„¶æ²¡æœ‰Goè‡ªèº«æ”¯æŒçš„Goroutinesé«˜æ•ˆã€‚ ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:0:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. Goroutines GoåŸç”Ÿæ”¯æŒå¹¶å‘ï¼Œä¾é çš„æ˜¯åç¨‹(goroutine)å’Œé€šé“(channel)ä¸¤ä¸ªæ¦‚å¿µã€‚goroutinesçš„æ¦‚å¿µæ˜¯ä¸ºäº†å’Œprocessesã€threadsã€coroutinesç­‰æ¦‚å¿µåŒºåˆ«ã€‚å…¶ä¸­coroutinesä¹Ÿå«åšåç¨‹ï¼Œè€Œä¸”è¿™æ‰æ˜¯å¸¸è§„æ„ä¹‰ä¸‹çš„åç¨‹ï¼Œgoroutinesåªåœ¨Goä¸­æœ‰æ•ˆã€‚ coroutinesæ˜¯æ¯”çº¿ç¨‹æ›´è½»çš„ä¸€ä¸ªæ¦‚å¿µï¼Œåªä½¿ç”¨å¾ˆå°‘çš„å†…å­˜å’Œèµ„æºã€‚å®ƒå¯¹æ ˆè¿›è¡Œåˆ†éš”ï¼Œä»è€ŒåŠ¨æ€åœ°å¢åŠ æˆ–ç¼©å‡å†…å­˜çš„ä½¿ç”¨ï¼Œæ ˆçš„ç®¡ç†ä¹Ÿæ˜¯è‡ªåŠ¨çš„ï¼Œåœ¨åç¨‹é€€å‡ºåè‡ªåŠ¨é‡Šæ”¾ç©ºé—´ã€‚åç¨‹å¯ä»¥è¿è¡Œåœ¨å¤šä¸ªçº¿ç¨‹é—´ï¼Œä¹Ÿå¯ä»¥è¿è¡Œåœ¨çº¿ç¨‹å†…ï¼Œå®ƒçš„åˆ›å»ºå»‰ä»·åˆ°å¯ä»¥åœ¨åŒä¸€åœ°å€ç©ºé—´å­˜åœ¨100000ä¸ªã€‚è¿™ä¸€æ¦‚å¿µä¹Ÿå­˜åœ¨äºå…¶å®ƒè¯­è¨€(C#, Javaç­‰)ä¸­ï¼Œå®ƒä¸goroutinesçš„åŒºåˆ«åœ¨äºï¼š Goåç¨‹æ„å‘³ç€å¹¶è¡Œ(æˆ–è€…å¯ä»¥ä»¥å¹¶è¡Œçš„æ–¹å¼éƒ¨ç½²)ï¼Œåç¨‹ä¸€èˆ¬ä¸æ˜¯ Goåç¨‹é€šè¿‡é€šé“æ¥é€šä¿¡ï¼Œåç¨‹åˆ™é€šè¿‡è®©å‡ºä¸æ¢å¤æ“ä½œæ¥é€šä¿¡ ç†è®ºä¸Šï¼ŒGoåç¨‹æ¯”åç¨‹æ›´åŠ å¼ºå¤§ã€‚ ä»¥ä¸€ä¸ªç®€å•æ¨¡å‹æ¥æè¿°goroutineï¼šå®ƒæ˜¯ä¸€ä¸ªå’Œå…¶å®ƒåç¨‹åœ¨åŒä¸€åœ°å€ç©ºé—´å¹¶å‘æ‰§è¡Œçš„å‡½æ•°ã€‚é€šè¿‡åœ¨å‡½æ•°æˆ–æ–¹æ³•åå‰åŠ ä¸Šgoå…³é”®å­—æ¥åˆ›å»ºå’Œè¿è¡Œä¸€ä¸ªåç¨‹ï¼Œè¿è¡Œç»“æŸåå®‰é™çš„é€€å‡º(æ²¡æœ‰ä»»ä½•è¿”å›å€¼)ã€‚ go list.Sort() //å¹¶è¡Œçš„è¿è¡Œlist.Sortï¼Œä¸ç­‰å¾… Goç¨‹åºä¸­å¿…é¡»å«æœ‰çš„main()å‡½æ•°å¯ä»¥çœ‹ä½œä¸€ä¸ªåç¨‹ï¼Œå°½ç®¡å®ƒæ²¡æœ‰é€šè¿‡goå…³é”®å­—å¯åŠ¨ï¼Œåœ¨ç¨‹åºåˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­(init()å‡½æ•°è¿è¡Œ)ï¼Œgoroutineä¹Ÿå¯ä»¥è¿è¡Œã€‚ å•çº¯çš„ç»“æŸåç¨‹çš„æ¦‚å¿µæ˜¯ä¸å¤Ÿå…·ä½“çš„ï¼Œåç¨‹éœ€è¦å’Œé€šé“æ¥é…åˆ ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:1:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. Channel å¹¶å‘ç¼–ç¨‹çš„å›°éš¾ä¹‹å¤„åœ¨äºå®ç°å¯¹å…±äº«å˜é‡çš„æ­£ç¡®è®¿é—®ï¼Œäº’æ–¥é‡çš„æ–¹å¼æ˜¯å¤æ‚çš„ï¼ŒGoé¼“åŠ±é‡‡ç”¨ä¸€ç§ä¸åŒçš„æ–¹æ³•ï¼Œå³åœ¨é€šé“(channel)ä¸Šä¼ é€’å…±äº«å€¼ï¼Œå¦‚åŒUnixç®¡é“ä¸€èˆ¬ï¼Œé€šé“ç”¨äºå‘é€ç±»å‹åŒ–çš„æ•°æ®ï¼Œåœ¨ä»»ä½•ç»™å®šçš„æ—¶é—´ï¼Œåªæœ‰ä¸€ä¸ªåç¨‹å¯ä»¥å¯¹é€šé“ä¸­çš„æ•°æ®è¿›è¡Œè®¿é—®ï¼Œä»è€Œå®Œæˆåç¨‹é—´çš„é€šä¿¡ï¼Œä¹Ÿé¿å¼€äº†æ‰€æœ‰ç”±å…±äº«å†…å­˜å¯¼è‡´çš„é™·é˜±ã€‚è¿™ç§é€šè¿‡é€šé“è¿›è¡Œé€šä¿¡çš„æ–¹å¼ä¿è¯åŒæ­¥æ€§çš„åŒæ—¶ï¼Œæ•°æ®çš„æ‰€æœ‰æƒä¹Ÿå› æ­¤è¢«ä¼ é€’ã€‚ è¿™ä¸€è®¾è®¡ç†å¿µæœ€ç»ˆç®€åŒ–ä¸ºä¸€å¥è¯ï¼šä¸è¦é€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡ï¼Œè€Œé€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜ã€‚ ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:2:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 å£°æ˜ä¸åˆå§‹åŒ– å£°æ˜é€šé“çš„åŸºæœ¬å½¢å¼å¦‚ä¸‹ï¼Œæœªåˆå§‹åŒ–çš„é€šé“å€¼ä¸ºnil var identifier chan datatype é€šé“åªèƒ½ä¼ è¾“ä¸€ç§ç±»å‹çš„æ•°æ®ï¼Œæ¯”å¦‚chan intæˆ–chan stringï¼Œå¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼ŒåŒ…æ‹¬ç©ºæ¥å£interface{}å’Œé€šé“è‡ªå·± å’Œmapç›¸åŒï¼Œé€šé“ä¹Ÿæ˜¯å¼•ç”¨ç±»å‹ï¼Œå› æ­¤ä½¿ç”¨makeè¿›è¡Œåˆå§‹åŒ–ï¼Œå¯ä»¥æŒ‡å®šç¬¬äºŒä¸ªå‚æ•°ç”¨æ¥æŒ‡å®šç¼“å†²åŒºçš„å¤§å°ï¼Œå³é€šé“å¯å®¹çº³çš„æ•°æ®ä¸ªæ•°ï¼Œè¿™ä¸€ä¸ªå€¼é»˜è®¤æ˜¯0ï¼Œæ„æ€æ˜¯æ— ç¼“å†²ï¼Œæ— ç¼“å†²çš„é€šé“å°†é€šä¿¡ã€å€¼çš„äº¤æ¢ã€åŒæ­¥ä¸‰è€…ç»“åˆï¼Œä¿è¯ä¸¤ä¸ªåç¨‹çš„è®¡ç®—å¤„äºå·²çŸ¥çŠ¶æ€ã€‚ var ci chan string ci = make(chan string) // unbuffered channel of integers cj := make(chan int, 0) // unbuffered channel of integers cs := make(chan *os.File, 100) // buffered channel of pointers to Files ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:2:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 é€šä¿¡æ“ä½œç¬¦\u003c- è¿™ä¸€æ“ä½œç¬¦ç›´è§‚çš„è¡¨ç¤ºæ•°æ®çš„ä¼ è¾“ï¼šä¿¡æ¯æŒ‰ç…§ç®­å¤´æ–¹å‘æµåŠ¨ã€‚ æµå‘é€šé“(å‘é€)ç”¨ch \u003c- int1è¡¨ç¤ºï¼Œæ„ä¸ºåˆ©ç”¨é€šé“chå‘é€å˜é‡int1 ä»é€šé“æµå‡º(æ¥æ”¶)ç”¨int2 = \u003c- chè¡¨ç¤ºï¼Œæ„ä¸ºå˜é‡int2ä»é€šé“chæ¥æ”¶æ•°æ®ï¼Œå¦‚æœint2æ²¡æœ‰å£°æ˜è¿‡ï¼Œå¯ä»¥ä½¿ç”¨int2 := \u003c- ch \u003c- chåˆ™ç”¨äºè¡¨ç¤ºä¸¢å¼ƒå½“å‰å€¼ï¼Œè·å–é€šé“çš„ä¸‹ä¸€ä¸ªå€¼ï¼Œå¯ä»¥ç”¨æ¥éªŒè¯ï¼Œå¦‚ if \u003c- ch != 1000 { ... } ä¸ºäº†å¯è¯»æ€§é€šé“çš„å‘½åé€šå¸¸ä»¥ ch å¼€å¤´æˆ–è€…åŒ…å« chanã€‚é€šé“çš„å‘é€å’Œæ¥æ”¶éƒ½æ˜¯åŸå­æ“ä½œï¼Œæ€»æ˜¯äº’ä¸å¹²æ‰°çš„å®Œæˆã€‚ä¸‹é¢çš„ç¤ºä¾‹å±•ç¤ºäº†é€šä¿¡æ“ä½œç¬¦çš„ä½¿ç”¨ã€‚ package main import ( \"fmt\" \"time\" ) func main() { ch := make(chan string) go sendData(ch) go getData(ch) time.Sleep(1e9) } func sendData(ch chan string) { ch \u003c- \"Washington\" ch \u003c- \"Tripoli\" ch \u003c- \"London\" ch \u003c- \"Beijing\" ch \u003c- \"Tokyo\" } func getData(ch chan string) { var input string // time.Sleep(2e9) for { input = \u003c-ch fmt.Printf(\"%s \", input) } } //Output: Washington Tripoli London Beijing tokyo å¦‚æœ2ä¸ªåç¨‹éœ€è¦é€šä¿¡ï¼Œå¿…é¡»ç»™å®ƒä»¬åŒä¸€ä¸ªé€šé“ä½œä¸ºå‚æ•°ã€‚ä¸Šä¾‹ä¸­ main() å‡½æ•°ä¸­å¯åŠ¨äº†ä¸¤ä¸ªåç¨‹ï¼šsendData() é€šè¿‡é€šé“ ch å‘é€äº† 5 ä¸ªå­—ç¬¦ä¸²ï¼ŒgetData() æŒ‰é¡ºåºæ¥æ”¶å®ƒä»¬å¹¶æ‰“å°å‡ºæ¥ã€‚ ä¸€äº›åŒæ­¥çš„ç»†èŠ‚å¦‚ä¸‹ï¼š main() ç­‰å¾…äº† 1 ç§’è®©ä¸¤ä¸ªåç¨‹å®Œæˆï¼Œå¦‚æœä¸è¿™æ ·(æ³¨é‡Šæ‰time.Sleep(1e9))ï¼ŒsendData() å°±æ²¡æœ‰æœºä¼šè¾“å‡ºã€‚ getData() ä½¿ç”¨äº†æ— é™å¾ªç¯ï¼šå®ƒéšç€ sendData() çš„å‘é€å®Œæˆå’Œ ch å˜ç©ºä¹Ÿç»“æŸäº†ã€‚ å¦‚æœæˆ‘ä»¬ç§»é™¤ä¸€ä¸ªæˆ–æ‰€æœ‰ go å…³é”®å­—ï¼Œç¨‹åºæ— æ³•è¿è¡Œï¼ŒGo è¿è¡Œæ—¶ä¼šæŠ›å‡º panicã€‚è¿™æ˜¯å› ä¸ºè¿è¡Œæ—¶(runtime)ä¼šæ£€æŸ¥æ‰€æœ‰çš„åç¨‹æ˜¯å¦åœ¨ç­‰å¾…ä»€ä¹ˆä¸œè¥¿(ä»é€šé“è¯»å–æˆ–å†™å…¥æŸä¸ªé€šé“)ï¼Œè¿™æ„å‘³ç€é™·å…¥æ­»é”ï¼Œç¨‹åºæ— æ³•ç»§ç»­æ‰§è¡Œã€‚ é€šé“çš„å‘é€å’Œæ¥æ”¶é¡ºåºæ˜¯æ— æ³•é¢„çŸ¥çš„ï¼Œå¦‚æœä½¿ç”¨æ‰“å°çŠ¶æ€æ¥è¾“å‡ºï¼Œç”±äºä¸¤è€…é—´çš„æ—¶é—´å»¶è¿Ÿï¼Œæ‰“å°çš„é¡ºåºå’ŒçœŸå®å‘ç”Ÿçš„é¡ºåºæ˜¯ä¸åŒçš„ã€‚ ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:2:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 é€šé“é˜»å¡ å‰é¢æåˆ°é»˜è®¤æƒ…å†µä¸‹é€šä¿¡æ˜¯åŒæ­¥ä¸”æ— ç¼“å†²çš„ï¼Œå› æ­¤é€šé“çš„å‘é€/æ¥æ”¶æ“ä½œåœ¨å¯¹æ–¹å‡†å¤‡å¥½ä¹‹å‰æ˜¯é˜»å¡çš„ã€‚ å¯¹äºåŒä¸€ä¸ªé€šé“ï¼Œå‘é€æ“ä½œï¼ˆåç¨‹æˆ–è€…å‡½æ•°ä¸­çš„ï¼‰ï¼Œåœ¨æ¥æ”¶è€…å‡†å¤‡å¥½ä¹‹å‰æ˜¯é˜»å¡çš„ï¼šå¦‚æœchä¸­çš„æ•°æ®æ— äººæ¥æ”¶ï¼Œå°±æ— æ³•å†ç»™é€šé“ä¼ å…¥å…¶ä»–æ•°æ® å¯¹äºåŒä¸€ä¸ªé€šé“ï¼Œæ¥æ”¶æ“ä½œåœ¨å‘é€è€…å¯ç”¨ä¹‹å‰æ˜¯é˜»å¡çš„ï¼ˆåç¨‹æˆ–å‡½æ•°ä¸­çš„ï¼‰ ä¸‹ä¾‹ä¸­çš„åç¨‹åœ¨æ— é™å¾ªç¯ä¸­ä¸æ–­åœ°ç»™é€šé“å‘é€æ•°æ®ï¼Œä½†ç”±äºæ²¡æœ‰æ¥æ”¶è€…ï¼Œåªè¾“å‡ºäº†æ•°å­—0 package main import \"fmt\" func main() { ch1 := make(chan int) go pump(ch1) // pump hangs fmt.Println(\u003c-ch1) // prints only 0 } func pump(ch chan int) { for i := 0; ; i++ { ch \u003c- i } } //Output:0 å®šä¹‰ä¸€ä¸ªæ–°çš„åç¨‹ç”¨æ¥æ¥æ”¶é€šé“å€¼å¯ä»¥æŒç»­è¾“å‡º package main import \"fmt\" func main() { ch1 := make(chan int) go pump(ch1) go suck(ch1) time.Sleep(1e9) } func pump(ch chan int) { for i := 0; ; i++ { ch \u003c- i } } func suck(ch chan int) { for { fmt.Println(\u003c-ch) } } ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:2:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.4 ä¿¡å·é‡æ¨¡å¼ ä¿¡å·é‡æ¨¡å¼çš„æ„æ€æ˜¯åˆ©ç”¨é€šé“é˜»å¡ç‰¹æ€§ï¼Œç­‰å¾…æ‰€æœ‰è®¡ç®—å®Œæˆåæ‰è®©ç¨‹åºé€€å‡ºï¼Œç”¨äºå¹¶è¡Œæ‰§è¡Œå‡½æ•°æˆ–forå¾ªç¯ï¼ŒåŠ å¿«ç¨‹åºæ‰§è¡Œé€Ÿåº¦ï¼Œä¸€ä¸ªä¾‹å­ç‘å°å®‰ type Empty interface {} var empty Empty ... data := make([]float64, N) res := make([]float64, N) sem := make(chan Empty, N) ... for i, xi := range data { go func (i int, xi float64) { res[i] = doSomething(i, xi) sem \u003c- empty } (i, xi) } // wait for goroutines to finish for i := 0; i \u003c N; i++ { \u003c-sem } ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:2:4","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.5 é€šé“å·¥å‚ ç¼–ç¨‹æ—¶å¸¸ç”¨ä¸€ç§é€šé“å·¥å‚çš„æ¨¡å¼ï¼Œå³ä¸å°†é€šé“ä½œä¸ºå‚æ•°ä¼ é€’ç»™åç¨‹ï¼Œè€Œæ˜¯ç”¨å‡½æ•°æ¥ç”Ÿæˆä¸€ä¸ªé€šé“å¹¶è¿”å› package main import ( \"fmt\" \"time\" ) func main() { stream := pump() go suck(stream) time.Sleep(1e9) } func pump() chan int { ch := make(chan int) go func() { for i := 0; ; i++ { ch \u003c- i } }() return ch } func suck(ch chan int) { for { fmt.Println(\u003c-ch) } } ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:2:5","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.6 ç»™é€šé“ä½¿ç”¨forå¾ªç¯ for å¾ªç¯çš„ range è¯­å¥å¯ä»¥ç”¨åœ¨é€šé“ ch ä¸Šï¼Œä¾¿å¯ä»¥ä»é€šé“ä¸­è·å–å€¼ï¼Œåƒè¿™æ ·ï¼š for v := range ch { fmt.Printf(\"The value is %v\\n\", v) } è¿™æ ·çš„ä½¿ç”¨ä¾ç„¶å¿…é¡»å’Œé€šé“çš„å†™å…¥å’Œå…³é—­ç›¸é…åˆï¼Œ ä¸èƒ½å•ç‹¬å­˜åœ¨ package main import ( \"fmt\" \"time\" ) func main() { suck(pump()) time.Sleep(1e9) } func pump() chan int { ch := make(chan int) go func() { for i := 0; ; i++ { ch \u003c- i } }() return ch } func suck(ch chan int) { go func() { for v := range ch { fmt.Println(v) } }() } ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:2:6","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.7 å…³é—­é€šé“ é€šé“å¯ä»¥è¢«æ˜¾å¼çš„å…³é—­ï¼Œä¸è¿‡åªæœ‰å‘é€è€…æ‰éœ€è¦å…³é—­é€šé“ï¼Œæ¥æ”¶è€…æ°¸è¿œä¸éœ€è¦ã€‚ ch := make(chan float64) defer close(ch) æµ‹è¯•é€šé“æ˜¯å¦å…³é—­åˆ™å¯ä»¥ä½¿ç”¨okæ“ä½œç¬¦ v, ok := \u003c-ch // ok is true if v received value ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­å¦‚ä¸‹ package main import \"fmt\" func main() { ch := make(chan string) go sendData(ch) getData(ch) } func sendData(ch chan string) { ch \u003c- \"Washington\" ch \u003c- \"Tripoli\" ch \u003c- \"London\" ch \u003c- \"Beijing\" ch \u003c- \"Tokio\" close(ch) } func getData(ch chan string) { for { input, open := \u003c-ch if !open { break } fmt.Printf(\"%s \", input) } } ä½†æ˜¯ä½¿ç”¨for-rangeè¯»å–é€šé“æ˜¯æ›´å¥½çš„åŠæ³•ï¼Œå› ä¸ºè¿™ä¼šè‡ªåŠ¨æ£€æµ‹é€šé“æ˜¯å¦å…³é—­ for input := range ch { process(input) } ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:2:7","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. Select ä»ä¸åŒçš„å¹¶å‘æ‰§è¡Œçš„åç¨‹ä¸­è·å–å€¼å¯ä»¥é€šè¿‡å…³é”®å­—selectæ¥å®Œæˆï¼Œå®ƒå’Œswitchæ§åˆ¶è¯­å¥éå¸¸ç›¸ä¼¼ï¼Œå…¶è¡Œä¸ºåƒæ˜¯â€œä½ å‡†å¤‡å¥½äº†å—â€çš„è½®è¯¢æœºåˆ¶ï¼›selectç›‘å¬è¿›å…¥é€šé“çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ˜¯ç”¨é€šé“å‘é€å€¼çš„æ—¶å€™ã€‚ select { case u:= \u003c- ch1: ... case v:= \u003c- ch2: ... ... default: // no value ready to be received ... } select åšçš„äº‹æƒ…æ˜¯ï¼šé€‰æ‹©å¤„ç†åˆ—å‡ºçš„å¤šä¸ªé€šä¿¡æƒ…å†µä¸­çš„ä¸€ä¸ªã€‚ å¦‚æœéƒ½é˜»å¡äº†ï¼Œä¼šç­‰å¾…ç›´åˆ°å…¶ä¸­ä¸€ä¸ªå¯ä»¥å¤„ç† å¦‚æœå¤šä¸ªå¯ä»¥å¤„ç†ï¼Œéšæœºé€‰æ‹©ä¸€ä¸ª å¦‚æœæ²¡æœ‰é€šé“æ“ä½œå¯ä»¥å¤„ç†å¹¶ä¸”å†™äº† default è¯­å¥ï¼Œå®ƒå°±ä¼šæ‰§è¡Œï¼šdefault æ°¸è¿œæ˜¯å¯è¿è¡Œçš„ï¼ˆè¿™å°±æ˜¯å‡†å¤‡å¥½äº†ï¼Œå¯ä»¥æ‰§è¡Œï¼‰ã€‚ ä½¿ç”¨defaultå¯ä»¥ä¿è¯å‘é€ä¸è¢«é˜»å¡ï¼Œä½†æ²¡æœ‰defaultçš„ç›‘å¬æ¨¡å¼ä¹Ÿå¯èƒ½è¢«ä½¿ç”¨ï¼Œé€šè¿‡breakè¯­å¥é€€å‡ºå¾ªç¯ã€‚ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­å¦‚ä¸‹ package main import ( \"fmt\" \"time\" ) func main() { ch1 := make(chan int) ch2 := make(chan int) go pump1(ch1) go pump2(ch2) go suck(ch1, ch2) time.Sleep(1e9) } func pump1(ch chan int) { for i := 0; ; i++ { ch \u003c- i * 2 } } func pump2(ch chan int) { for i := 0; ; i++ { ch \u003c- i + 5 } } func suck(ch1, ch2 chan int) { for { select { case v := \u003c-ch1: fmt.Printf(\"Received on channel 1: %d\\n\", v) case v := \u003c-ch2: fmt.Printf(\"Received on channel 2: %d\\n\", v) } } } æœ‰ 2 ä¸ªé€šé“ ch1 å’Œ ch2ï¼Œä¸‰ä¸ªåç¨‹ pump1()ã€pump2() å’Œ suck()ã€‚åœ¨æ— é™å¾ªç¯ä¸­ï¼Œch1 å’Œ ch2 é€šè¿‡ pump1() å’Œ pump2() å¡«å……æ•´æ•°ï¼›suck() ä¹Ÿåœ¨æ— é™å¾ªç¯ä¸­è½®è¯¢è¾“å…¥ï¼Œé€šè¿‡ select è¯­å¥è·å– ch1 å’Œ ch2 çš„æ•´æ•°å¹¶è¾“å‡ºã€‚é€‰æ‹©å“ªä¸€ä¸ª case å–å†³äºå“ªä¸€ä¸ªé€šé“æ”¶åˆ°äº†ä¿¡æ¯ã€‚ç¨‹åºåœ¨ main æ‰§è¡Œ 1 ç§’åç»“æŸã€‚ ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:3:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. åº”ç”¨ ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:4:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4.1 æƒ°æ€§ç”Ÿæˆå™¨ ç”Ÿæˆå™¨æ˜¯æŒ‡å½“è¢«è°ƒç”¨æ—¶è¿”å›ä¸€ä¸ªåºåˆ—ä¸­ä¸‹ä¸€ä¸ªå€¼çš„å‡½æ•°ï¼Œä¾‹å¦‚ï¼š generateInteger() =\u003e 0 generateInteger() =\u003e 1 generateInteger() =\u003e 2 .... ç”Ÿæˆå™¨æ¯æ¬¡è¿”å›çš„æ˜¯åºåˆ—ä¸­ä¸‹ä¸€ä¸ªå€¼è€Œéæ•´ä¸ªåºåˆ—ï¼›è¿™ç§ç‰¹æ€§ä¹Ÿç§°ä¹‹ä¸ºæƒ°æ€§æ±‚å€¼ï¼šåªåœ¨ä½ éœ€è¦æ—¶è¿›è¡Œæ±‚å€¼ï¼ŒåŒæ—¶ä¿ç•™ç›¸å…³å˜é‡èµ„æºï¼ˆå†…å­˜å’Œcpuï¼‰ï¼šè¿™æ˜¯ä¸€é¡¹åœ¨éœ€è¦æ—¶å¯¹è¡¨è¾¾å¼è¿›è¡Œæ±‚å€¼çš„æŠ€æœ¯ã€‚ä¾‹å¦‚ï¼Œç”Ÿæˆä¸€ä¸ªæ— é™æ•°é‡çš„å¶æ•°åºåˆ—ï¼šè¦äº§ç”Ÿè¿™æ ·ä¸€ä¸ªåºåˆ—å¹¶ä¸”åœ¨ä¸€ä¸ªä¸€ä¸ªçš„ä½¿ç”¨å¯èƒ½ä¼šå¾ˆå›°éš¾ï¼Œè€Œä¸”å†…å­˜ä¼šæº¢å‡ºï¼ä½†æ˜¯ä¸€ä¸ªå«æœ‰é€šé“å’Œgoåç¨‹çš„å‡½æ•°èƒ½è½»æ˜“å®ç°è¿™ä¸ªéœ€æ±‚ã€‚ ä¸‹ä¾‹ä¸­å®ç°äº†ä¸€ä¸ªä½¿ç”¨ int å‹é€šé“æ¥å®ç°çš„ç”Ÿæˆå™¨ã€‚é€šé“è¢«å‘½åä¸ºyieldå’Œresumeï¼Œè¿™äº›è¯ç»å¸¸åœ¨åç¨‹ä»£ç ä¸­ä½¿ç”¨ã€‚ package main import ( \"fmt\" ) var resume chan int func integers() chan int { yield := make(chan int) count := 0 go func() { for { yield \u003c- count count++ } }() return yield } func generateInteger() int { return \u003c-resume } func main() { resume = integers() fmt.Println(generateInteger()) //=\u003e 0 fmt.Println(generateInteger()) //=\u003e 1 fmt.Println(generateInteger()) //=\u003e 2 } ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:4:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4.2 Futures æ¨¡å¼ æ‰€è°“Futureså°±æ˜¯æŒ‡ï¼šæœ‰æ—¶å€™åœ¨ä½ ä½¿ç”¨æŸä¸€ä¸ªå€¼ä¹‹å‰éœ€è¦å…ˆå¯¹å…¶è¿›è¡Œè®¡ç®—ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å°±å¯ä»¥åœ¨å¦ä¸€ä¸ªå¤„ç†å™¨ä¸Šè¿›è¡Œè¯¥å€¼çš„è®¡ç®—ï¼Œåˆ°ä½¿ç”¨æ—¶ï¼Œè¯¥å€¼å°±å·²ç»è®¡ç®—å®Œæ¯•äº†ã€‚ Futuresæ¨¡å¼é€šè¿‡é—­åŒ…å’Œé€šé“å¯ä»¥å¾ˆå®¹æ˜“å®ç°ï¼Œç±»ä¼¼äºç”Ÿæˆå™¨ï¼Œä¸åŒåœ°æ–¹åœ¨äºFutureséœ€è¦è¿”å›ä¸€ä¸ªå€¼ã€‚ ä¸€ä¸ªä¾‹å­ï¼š å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªçŸ©é˜µç±»å‹ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—ä¸¤ä¸ªçŸ©é˜µAå’ŒBä¹˜ç§¯çš„é€†ï¼Œé¦–å…ˆæˆ‘ä»¬é€šè¿‡å‡½æ•°Inverse(M)åˆ†åˆ«å¯¹å…¶è¿›è¡Œæ±‚é€†è¿ç®—ï¼Œå†å°†ç»“æœç›¸ä¹˜ã€‚å¦‚ä¸‹å‡½æ•°InverseProduct()å®ç°äº†å¦‚ä¸Šè¿‡ç¨‹ï¼š func InverseProduct(a Matrix, b Matrix) { a_inv := Inverse(a) b_inv := Inverse(b) return Product(a_inv, b_inv) } åœ¨è¿™é‡Œä¾‹å­ä¸­ï¼Œaå’Œbçš„æ±‚é€†å¥å­çš„è¿‡ç¨‹å¯ä»¥åŒæ—¶è¿›è¡Œï¼Œå› æ­¤æ¢ç”¨å¹¶è¡Œè®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š func InverseProduct(a Matrix, b Matrix) { a_inv_future := InverseFuture(a) // start as a goroutine b_inv_future := InverseFuture(b) // start as a goroutine a_inv := \u003c-a_inv_future b_inv := \u003c-b_inv_future return Product(a_inv, b_inv) } InverseFutureå‡½æ•°ä»¥goroutineçš„å½¢å¼èµ·äº†ä¸€ä¸ªé—­åŒ…ï¼Œè¯¥é—­åŒ…ä¼šå°†çŸ©é˜µæ±‚é€†ç»“æœæ”¾å…¥åˆ°futureé€šé“ä¸­ï¼š func InverseFuture(a Matrix) chan Matrix { future := make(chan Matrix) go func() { future \u003c- Inverse(a) }() return future } å¯¹è®¡ç®—å¯†é›†å‹çš„åœºæ™¯ï¼Œä½¿ç”¨Futuresæ¨¡å¼æ˜¯å¾ˆæœ‰æ„ä¹‰çš„ ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:4:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4.3 C/Sæ¨¡å¼ å®¢æˆ·ç«¯/æœåŠ¡å™¨(C/S)æ¨¡å¼æ˜¯goroutineså’Œchannelsæœ€å¸¸è§çš„åº”ç”¨ã€‚ å®¢æˆ·ç«¯(Client)å¯ä»¥æ˜¯è¿è¡Œåœ¨ä»»æ„è®¾å¤‡ä¸Šçš„ä»»æ„ç¨‹åºï¼Œå®ƒä¼šæŒ‰éœ€å‘é€è¯·æ±‚(request)è‡³æœåŠ¡å™¨ã€‚æœåŠ¡å™¨(Server)æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚åå¼€å§‹ç›¸åº”çš„å·¥ä½œï¼Œç„¶åå†å°†å“åº”(response)è¿”å›ç»™å®¢æˆ·ç«¯ã€‚å…¸å‹æƒ…å†µä¸‹ä¸€èˆ¬æ˜¯å¤šä¸ªå®¢æˆ·ç«¯ï¼ˆå³å¤šä¸ªè¯·æ±‚ï¼‰å¯¹åº”ä¸€ä¸ªï¼ˆæˆ–å°‘é‡ï¼‰æœåŠ¡å™¨ã€‚ä¾‹å¦‚æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„æµè§ˆå™¨å®¢æˆ·ç«¯ï¼Œå…¶åŠŸèƒ½å°±æ˜¯å‘æœåŠ¡å™¨è¯·æ±‚ç½‘é¡µã€‚è€ŒWebæœåŠ¡å™¨åˆ™ä¼šå‘æµè§ˆå™¨å“åº”ç½‘é¡µæ•°æ®ã€‚ ä½¿ç”¨Goçš„æœåŠ¡å™¨é€šå¸¸ä¼šåœ¨åç¨‹ä¸­æ‰§è¡Œå‘å®¢æˆ·ç«¯çš„å“åº”ï¼Œæ•…è€Œä¼šå¯¹æ¯ä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚å¯åŠ¨ä¸€ä¸ªåç¨‹ã€‚ä¸€ä¸ªå¸¸ç”¨çš„æ“ä½œæ–¹æ³•æ˜¯å®¢æˆ·ç«¯è¯·æ±‚è‡ªèº«ä¸­åŒ…å«ä¸€ä¸ªé€šé“ï¼Œè€ŒæœåŠ¡å™¨åˆ™å‘è¿™ä¸ªé€šé“å‘é€å“åº”ã€‚ ä¸‹é¢æ˜¯è¯·æ±‚Requestçš„ç»“æ„ï¼Œå“åº”æš—å«åœ¨è¯·æ±‚çš„ç»“æ„é‡Œé¢ type Request struct { a, b int replyc chan int // reply channel inside the Request } æœåŠ¡å™¨æ— é™å¾ªç¯ä»chan *Requestæ¥æ”¶è¯·æ±‚ï¼Œä¸ºäº†é¿å…æŸä¸ªè¯·æ±‚é•¿æ—¶é—´æ“ä½œé€ æˆå µå¡ï¼Œä¸ºæ¯ä¸ªè¯·æ±‚å¯åŠ¨ä¸€ä¸ªåç¨‹ï¼Œç„¶åå¯åŠ¨run()å‡½æ•°å¤„ç†è¯¥è¯·æ±‚ï¼Œå¤„ç†åçš„å€¼é€åˆ°chan *Replyé€šé“ã€‚ func server(op binOp, service chan *Request) { for { req := \u003c-service; // requests arrive here // start goroutine for request: go run(op, req); // donâ€™t wait for op to complete } } type binOp func(a, b int) int func run(op binOp, req *Request) { req.replyc \u003c- op(req.a, req.b) } ä½†ä»¥ä¸Šè¿‡ç¨‹ä»…ä»…æ˜¯å¯¹å®¢æˆ·ç«¯çš„è¯·æ±‚æ˜¯å¹¶å‘å¤„ç†çš„ï¼Œå®é™…ä¸Šï¼Œserveræœ¬èº«ä¹Ÿæ˜¯ä»¥åç¨‹æ–¹å¼å¯åŠ¨çš„ func startServer(op binOp) chan *Request { reqChan := make(chan *Request); go server(op, reqChan); return reqChan; } startServerä¼šåœ¨mainå‡½æ•°ä¸­è¢«è°ƒç”¨ï¼Œä¸‹é¢æ˜¯mainå‡½æ•°è°ƒç”¨ç¤ºä¾‹ï¼Œä¸€å…±å‘é€äº†100ä¸ªè¯·æ±‚åˆ°æœåŠ¡å™¨è¿›è¡Œå¤„ç†ï¼Œ åªæœ‰å®ƒä»¬å…¨éƒ¨è¢«é€è¾¾åæˆ‘ä»¬æ‰ä¼šæŒ‰ç›¸åçš„é¡ºåºæ£€æŸ¥å“åº”ï¼š func main() { adder := startServer(func(a, b int) int { return a + b }) const N = 100 var reqs [N]Request for i := 0; i \u003c N; i++ { req := \u0026reqs[i] req.a = i req.b = i + N req.replyc = make(chan int) adder \u003c- req // adder is a channel of requests } // checks: for i := N - 1; i \u003e= 0; i-- { // doesnâ€™t matter what order if \u003c-reqs[i].replyc != N+2*i { fmt.Println(â€œfail atâ€, i) } else { fmt.Println(â€œRequest â€œ, i, â€œis ok!â€) } } fmt.Println(â€œdoneâ€) } //Output: Request 99 is ok! Request 98 is ok! ... Request 1 is ok! Request 0 is ok! done å®Œæ•´çš„ç¨‹åºå¦‚ä¸‹ï¼Œå› ä¸ºserveråœ¨mainå‡½æ•°è¿”å›åæ˜¯è¢«å¼ºåˆ¶ç»“æŸçš„ï¼Œä¸‹é¢è¿˜é’ˆå¯¹è¿™ä¸€ç‚¹åšå‡ºæ”¹è¿›ï¼Œæ–¹æ³•æ˜¯æä¾›ä¸€ä¸ªé€€å‡ºé€šé“ç»™server package main import \"fmt\" type Request struct { a, b int replyc chan int // reply channel inside the Request } type binOp func(a, b int) int func run(op binOp, req *Request) { req.replyc \u003c- op(req.a, req.b) } func server(op binOp, service chan *Request, quit chan bool) { for { select { case req := \u003c-service: go run(op, req) case \u003c-quit: return } } } func startServer(op binOp) (service chan *Request, quit chan bool) { service = make(chan *Request) quit = make(chan bool) go server(op, service, quit) return service, quit } func main() { adder, quit := startServer(func(a, b int) int { return a + b }) const N = 100 var reqs [N]Request for i := 0; i \u003c N; i++ { req := \u0026reqs[i] req.a = i req.b = i + N req.replyc = make(chan int) adder \u003c- req } // checks: for i := N - 1; i \u003e= 0; i-- { // doesn't matter what order if \u003c-reqs[i].replyc != N+2*i { fmt.Println(\"fail at\", i) } else { fmt.Println(\"Request \", i, \" is ok!\") } } quit \u003c- true fmt.Println(\"done\") } ","date":"2019-12-16","objectID":"/2019/golang-syntax-10-goroutine-and-channel/:4:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€10-åç¨‹ä¸é€šé“","uri":"/2019/golang-syntax-10-goroutine-and-channel/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"ç»“æ„ä½“æ˜¯ä¸€ç§éå¸¸é‡è¦çš„ç»“æ„ï¼Œç”¨åˆ°çš„åœ°æ–¹éå¸¸å¤šï¼Œåœ¨ Go ä¸­ï¼Œç»“æ„ä½“è¿˜æ˜¯å®ç°é¢å‘å¯¹è±¡ç¼–ç¨‹çš„åŸºç¡€ã€‚ ","date":"2019-11-26","objectID":"/2019/golang-syntax-8-struct-and-method/:0:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€8-ç»“æ„ä½“ä¸æ–¹æ³•","uri":"/2019/golang-syntax-8-struct-and-method/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. ç»“æ„ä½“ ","date":"2019-11-26","objectID":"/2019/golang-syntax-8-struct-and-method/:1:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€8-ç»“æ„ä½“ä¸æ–¹æ³•","uri":"/2019/golang-syntax-8-struct-and-method/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.1 å®šä¹‰ä¸åˆå§‹åŒ– ç»“æ„ä½“å®šä¹‰æ–¹å¼å¦‚ä¸‹ï¼š type identifier struct { field1 type1 field2 type2 ... } å¤§æ‹¬å·ä¸­çš„æ¯ä¸€è¡Œç§°ä¸ºä¸€ä¸ªå­—æ®µï¼Œæ¯ä¸ªå­—æ®µéƒ½æœ‰ä¸€ä¸ªç±»å‹å’Œä¸€ä¸ªåå­—ï¼Œåœ¨ä¸€ä¸ªç»“æ„ä½“ä¸­ï¼Œå­—æ®µåå¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚ç»“æ„ä½“åå’Œå­—æ®µåçš„å‘½åéµå¾ªå¯è§æ€§è§„åˆ™ï¼Œå³ä½¿ç”¨é¦–å­—æ¯çš„å¤§å°å†™æ¥è¡¨ç¤ºå¯å¯¼å‡ºå’Œä¸å¯å¯¼å‡ºã€‚ä½†æ˜¯éœ€è¦æ³¨æ„ï¼Œä¸€ä¸ªå¯å¯¼å‡ºçš„ç»“æ„ä½“ç±»å‹ä¸­å¯ä»¥å­˜åœ¨ä¸å¯å¯¼å‡ºçš„å­—æ®µã€‚ ç»“æ„ä½“çš„å­—æ®µå¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œç”šè‡³å¯ä»¥æ˜¯ç»“æ„ä½“æœ¬èº«ã€å‡½æ•°æˆ–è€…æ¥å£ã€‚ä¸€ä¸ªç®€å•çš„ç»“æ„ä½“å®šä¹‰ç¤ºä¾‹å¦‚ä¸‹ type T struct { a,b int } ç»“æ„ä½“æ˜¯è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å‘åŸºæœ¬æ•°æ®ç±»å‹ä¸€æ ·å£°æ˜/å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ç±»å‹çš„å˜é‡ï¼Œå£°æ˜æ—¶ä¼šåˆ†é…å†…å­˜å¹¶é»˜è®¤ä½¿ç”¨æ¯ä¸ªå­—æ®µç±»å‹çš„é›¶å€¼æ¥åˆå§‹åŒ–ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆå§‹åŒ–ä¸€ä¸ªç»“æ„ä½“ï¼Œä½¿ç”¨ç‚¹å·ç¬¦ç»™å­—æ®µèµ‹å€¼ï¼Œç¤ºä¾‹å¦‚ä¸‹ã€‚å¦å¤–ï¼Œè®¿é—®ç»“æ„ä½“å†…å­—æ®µçš„å€¼æ—¶åŒæ ·ä½¿ç”¨ç‚¹å·ç¬¦ï¼Œè¿™ç§ä½¿ç”¨ç‚¹å·ç¬¦èµ‹å€¼å’Œè·å–å­—æ®µå€¼çš„æ–¹å¼å«åšé€‰æ‹©å™¨(selector)ï¼Œ var s T s.a = 5 s.b = 8 ç”±äºç»“æ„ä½“ä¹Ÿæ˜¯å€¼ç±»å‹ï¼Œä½¿ç”¨newå‡½æ•°åˆ›å»ºã€‚æ³¨æ„ï¼Œä½¿ç”¨ new å¾—åˆ°çš„ t æ˜¯æŒ‡å‘ç»“æ„ä½“çš„æŒ‡é’ˆã€‚ var t *T = new(T) t := new(T) // ç®€å•æ–¹ä¾¿åœ°å†™æ³•ï¼Œæœ€å¸¸ç”¨ è‡³æ­¤æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œä½¿ç”¨ç»“æ„ä½“æ—¶æˆ‘ä»¬å¯èƒ½é‡åˆ°ä¸¤ç§ç±»å‹ï¼šç»“æ„ä½“ç±»å‹å’Œç»“æ„ä½“æŒ‡é’ˆç±»å‹ï¼Œè¿™ä¸¤ç§ç±»å‹éƒ½å¯ä»¥é€šè¿‡é€‰æ‹©å™¨çš„æ–¹å¼æ¥ä½¿ç”¨ï¼Œå¦‚ä¸‹ï¼Œv.i å’Œ p.i éƒ½å¯ä»¥å¾—åˆ°æ­£ç¡®çš„å€¼ï¼Œåœ¨ç†è§£çš„æ—¶å€™å¯ä»¥æƒ³è±¡åº•å±‚å¯¹ç»“æ„ä½“æŒ‡é’ˆ p è‡ªåŠ¨åšäº†è§£å¼•ç”¨ï¼Œå¦‚ (*p).iã€‚ type myStruct struct { i int } var v myStruct // væ˜¯ç»“æ„ä½“ç±»å‹å˜é‡ var p *myStruct // pæ˜¯æŒ‡å‘ä¸€ä¸ªç»“æ„ä½“ç±»å‹å˜é‡çš„æŒ‡é’ˆ v.i p.i (*p).i é™¤ä½¿ç”¨é€‰æ‹©å™¨åˆå§‹åŒ–ç»“æ„ä½“å­—æ®µå¤–ï¼Œä¸€ç§æ›´ç®€çŸ­æ›´å¸¸ç”¨çš„ç»“æ„ä½“åˆå§‹åŒ–æ–¹æ³•å¦‚ä¸‹ ms := struct1{10, 15.5, \"Chris\"} //ç»“æ„ä½“ç±»å‹ ms := \u0026struct1{10, 15.5, \"Chris\"} //ç»“æ„ä½“æŒ‡é’ˆç±»å‹ ms := \u0026struct1{f1:15.5ï¼Œi1:10} //æ‹¬å·å†…å£°æ˜å­—æ®µåï¼Œè¿™æ ·å¯ä»¥ä¸æŒ‰å®šä¹‰çš„å­—æ®µé¡ºåºï¼Œç”šè‡³çœç•¥éƒ¨åˆ†å­—æ®µ å…¶ä¸­ç¬¬äºŒè¡Œç§°ä¸ºæ··åˆå­—é¢é‡è¯­æ³•ï¼Œä½†åº•å±‚ä»ç„¶ä¼šè°ƒç”¨new()ï¼Œå› æ­¤ä¸ä½¿ç”¨ new() åˆå§‹åŒ–æ˜¯ç­‰åŒçš„ã€‚ä»¥type Point struct {x,y int}ä¸ºä¾‹ï¼Œè¿™å‡ ç§åˆå§‹åŒ–æ–¹å¼çš„å†…å­˜å¸ƒå±€å¦‚ä¸‹ ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œç»“æ„ä½“å’Œå®ƒåŒ…å«çš„æ•°æ®åœ¨å†…å­˜ä¸­æ˜¯ä»¥è¿ç»­å—çš„å½¢å¼å­˜åœ¨çš„ï¼Œå³ä½¿ç»“æ„ä½“ä¸­åµŒå¥—å…¶å®ƒçš„ç»“æ„ä½“ï¼ŒåŒæ ·å¦‚æ­¤ã€‚ type Rect1 struct {Min, Max Point } type Rect2 struct {Min, Max *Point } ä¸€ä¸ªä½¿ç”¨ç»“æ„ä½“çš„å®Œæ•´ä¾‹å­å¦‚ä¸‹ package main import \"fmt\" type struct1 struct { i1 int f1 float32 str string } func main() { ms := new(struct1) ms.i1 = 10 ms.f1 = 15.5 ms.str= \"Chris\" fmt.Printf(\"The int is: %d\\n\", ms.i1) fmt.Printf(\"The float is: %f\\n\", ms.f1) fmt.Printf(\"The string is: %s\\n\", ms.str) fmt.Println(ms) } //Output: The int is: 10 The float is: 15.500000 The string is: Chris \u0026{10 15.5 Chris} ","date":"2019-11-26","objectID":"/2019/golang-syntax-8-struct-and-method/:1:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€8-ç»“æ„ä½“ä¸æ–¹æ³•","uri":"/2019/golang-syntax-8-struct-and-method/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.2 ç»“æ„ä½“æ ‡ç­¾ å®é™…ä¸Šï¼Œä¸€ä¸ªå®Œæ•´çš„ç»“æ„ä½“å®šä¹‰ï¼Œåœ¨å­—æ®µåå’Œç±»å‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªæ ‡ç­¾(tag)éƒ¨åˆ†ã€‚æ ‡ç­¾æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨æ¥å¯¹å­—æ®µè¿›è¡Œä¸€å®šçš„è¯´æ˜ï¼Œå¯¹ç¨‹åºåŠŸèƒ½æ²¡æœ‰å¤ªå¤§çš„ä½œç”¨ï¼Œå› æ­¤å‰é¢æ‰æ²¡æœ‰ä»‹ç»ã€‚æ­£å¦‚æˆ‘ä»¬è¯´çš„ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨å°±æ˜¯å¯¹å­—æ®µè¿›è¡Œè¯´æ˜ï¼Œæ ‡ç­¾åªæœ‰åŒ… reflect èƒ½è·å–ã€‚ package main import ( \"fmt\" \"reflect\" ) type TagType struct { // tags field1 bool \"An important answer\" field2 string \"The name of the thing\" field3 int \"How much there are\" } func main() { tt := TagType{true, \"Barak Obama\", 1} for i := 0; i \u003c 3; i++ { refTag(tt, i) } } func refTag(tt TagType, ix int) { ttType := reflect.TypeOf(tt) ixField := ttType.Field(ix) fmt.Printf(\"%v\\n\", ixField.Tag) } //Output: An important answer The name of the thing How much there are ","date":"2019-11-26","objectID":"/2019/golang-syntax-8-struct-and-method/:1:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€8-ç»“æ„ä½“ä¸æ–¹æ³•","uri":"/2019/golang-syntax-8-struct-and-method/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.3 åŒ¿åå­—æ®µä¸å†…åµŒç»“æ„ä½“ ç»“æ„ä½“çš„å­—æ®µåå…¶å®å’Œå˜é‡å¾ˆç›¸ä¼¼ï¼Œä¸éœ€è¦æ—¶ä¹Ÿå¯ä»¥ç”¨ç©ºç™½ç¬¦ _ ä»£æ›¿ï¼Œä½†å®é™…ä¸Šï¼Œä¹Ÿå¯ä»¥ç›´æ¥çœç•¥ï¼Œå³æ•´ä¸ªå­—æ®µåªæœ‰ç±»å‹ï¼Œæ­¤æ—¶ç±»å‹å°±æ˜¯å­—æ®µåï¼Œè¿™ç§å­—æ®µå«åšåŒ¿åå­—æ®µã€‚å¦‚ä¸‹ä¾‹ï¼Œé€šè¿‡ç±»å‹ t.float32 æ¥è·å–å­˜å‚¨åœ¨åŒ¿åå­—æ®µä¸­çš„æ•°æ®ï¼Œä¹Ÿå› ä¸ºè¿™ç§è°ƒç”¨æ–¹å¼ï¼Œä¸€ä¸ªç»“æ„ä½“ä¸­å¯¹æ¯ä¸€ç§æ•°æ®ç±»å‹åªèƒ½æœ‰ä¸€ä¸ªåŒ¿åå­—æ®µã€‚ package main import \"fmt\" type T struct { a int float32 // anonymous field } func main() { t := T{6, 7.5} fmt.Println(t.float32) } //Output: {6 7.5} ç”±äºç»“æ„ä½“æœ¬èº«ä¹Ÿæ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œå› æ­¤ä¹Ÿå¯ä»¥ä½œä¸ºåŒ¿åå­—æ®µä½¿ç”¨ï¼Œç§°ä¸ºå†…åµŒç»“æ„ä½“ã€‚é€šè¿‡å†…åµŒç»“æ„ä½“å¯ä»¥å®ç° OO ç¼–ç¨‹ç§çš„ç»§æ‰¿ã€‚ package main import \"fmt\" type A struct { ax, ay int } type B struct { A bx, by float32 } func main() { b := B{A{1, 2}, 3.0, 4.0} fmt.Println(b.ax, b.ay, b.bx, b.by) fmt.Println(b.A) } //Output: 1 2 3 4 {1 2} ä½¿ç”¨å†…åµŒç»“æ„ä½“çš„æ—¶å€™ï¼Œå¾ˆå¯èƒ½ä¼šå‡ºç°å‘½åå†²çªï¼ˆç»§æ‰¿æ¥çš„å­—æ®µåå’Œå½“å‰ç»“æ„ä½“çš„æŸä¸ªå­—æ®µåç›¸åŒï¼‰ï¼Œè¿™ç§æƒ…å†µä¸‹å¤–å±‚çš„åå­—ä¼šè¦†ç›–å†…å±‚çš„åå­—ï¼Œä½†ä¸¤è€…çš„å†…å­˜ç©ºé—´éƒ½ä¼šä¿ç•™ï¼Œä¸‹ä¾‹ä¸­d.bçš„è°ƒç”¨ä¸ä¼šå‡ºé”™ï¼ŒæŒ‡çš„æ˜¯float32ï¼Œè€Œä¸æ˜¯B.bï¼Œè¿›è¡Œå†…å±‚è°ƒç”¨å¯ä»¥ä½¿ç”¨d.B.b type B struct {a, b int} type D struct {B; b float32} var d D ä½†ä¸‹é¢è¿™ç§æƒ…å†µï¼Œc.açš„è°ƒç”¨ä¼šå¯¼è‡´ç¼–è¯‘å™¨é”™è¯¯,åªèƒ½ç”±ç¨‹åºå‘˜æ‰‹åŠ¨ä¿®æ”¹ type A struct {a int} type B struct {a, b int} type C struct {A; B} var c C ","date":"2019-11-26","objectID":"/2019/golang-syntax-8-struct-and-method/:1:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€8-ç»“æ„ä½“ä¸æ–¹æ³•","uri":"/2019/golang-syntax-8-struct-and-method/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.4 ç»“æ„ä½“å·¥å‚ å¯ä»¥ä¸ºç»“æ„ä½“å®šä¹‰ä¸€ä¸ªå·¥å‚æ¥åˆ›å»ºç»“æ„ä½“å®ä¾‹ï¼Œå·¥å‚çš„åå­—é€šå¸¸ä»¥newæˆ–Newå¼€å¤´ï¼Œè¿™æ˜¯ä¸€ç§å¾ˆå¸¸ç”¨çš„æ–¹æ³•ã€‚å‡è®¾å®šä¹‰äº†å¦‚ä¸‹Fileç»“æ„ä½“ç±»å‹ type File struct { fd int //æ–‡ä»¶æè¿°ç¬¦ name string //æ–‡ä»¶å } ä¸‹é¢æ˜¯ä¸ºFileç»“æ„ä½“åˆ›å»ºçš„å·¥å‚ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘ç»“æ„ä½“çš„æŒ‡é’ˆ func NewFile(fd int, name string) *File { if fd \u003c 0 { return nil } return \u0026File{fd, name} } ç„¶åè¿™æ ·è°ƒç”¨å®ƒ f := NewFile(10, \"./test.txt\") è¿™ç§æ–¹å¼å¯ä»¥æ¨¡æ‹ŸOOç¼–ç¨‹ä¸­ä½¿ç”¨newçš„å®ä¾‹åŒ–ï¼Œå¦‚æœè¦å®Œå…¨ç­‰åŒï¼Œè¿˜éœ€è¦åˆ©ç”¨å¯è§æ€§è§„åˆ™ç¦æ­¢ä½¿ç”¨Goå†…ç½®çš„new()å‡½æ•° type matrix struct { ... } func NewMatrix(params) *matrix { m := new(matrix) // åˆå§‹åŒ– m return m } ç„¶ååœ¨å…¶å®ƒåŒ…é‡Œå°±åªèƒ½ä½¿ç”¨å·¥å‚åˆ›å»ºç»“æ„ä½“å®ä¾‹ package main import \"matrix\" ... wrong := new(matrix.matrix) // ç¼–è¯‘å¤±è´¥ï¼ˆmatrix æ˜¯ç§æœ‰çš„ï¼‰ right := matrix.NewMatrix(...) // å®ä¾‹åŒ– matrix çš„å”¯ä¸€æ–¹å¼ ","date":"2019-11-26","objectID":"/2019/golang-syntax-8-struct-and-method/:1:4","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€8-ç»“æ„ä½“ä¸æ–¹æ³•","uri":"/2019/golang-syntax-8-struct-and-method/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. æ–¹æ³• Goä¸­çš„æ–¹æ³•æ˜¯ä½œç”¨åœ¨æ¥æ”¶è€…ä¸Šçš„ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶è€…æ˜¯æŸç§ç±»å‹çš„å˜é‡ã€‚å®šä¹‰æ–¹æ³•çš„ä¸€èˆ¬æ ¼å¼å¦‚ä¸‹ func (recv receiver_type) methodName(parameter_list) (return_value_list) { ... } åœ¨funcå…³é”®å­—ä¹‹åï¼Œæ–¹æ³•åä¹‹å‰çš„æ‹¬å·ä¸­å£°æ˜æ¥æ”¶è€…å’Œæ¥æ”¶è€…ç±»å‹ã€‚åŒæ ·è¿˜å¯ä»¥çœ‹åˆ°ï¼Œæ–¹æ³•çš„æœ¬è´¨ä»ç„¶æ˜¯å‡½æ•°ï¼Œåªä¸è¿‡æ˜¯é’ˆå¯¹ç‰¹å®šå˜é‡çš„å‡½æ•°ï¼Œé™¤äº†æ‹¬å·ä¸­çš„æ¥æ”¶è€…å£°æ˜ï¼Œå…¶å®ƒéƒ¨åˆ†å’Œæ™®é€šå‡½æ•°æ²¡æœ‰ä¸åŒã€‚ æ¥æ”¶è€…å‡ ä¹å¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å˜é‡ï¼ŒåŒ…æ‹¬åŸºæœ¬æ•°æ®ç±»å‹ã€æ•°ç»„çš„åˆ«åç±»å‹ã€ç»“æ„ä½“ã€å‡½æ•°ç­‰ï¼Œä½†ä¸å¯ä»¥æ˜¯æ¥å£ï¼Œå› ä¸ºæ–¹æ³•æ˜¯éœ€è¦å®ç°çš„ï¼Œè€Œæ¥å£åªæ˜¯æŠ½è±¡å®šä¹‰ã€‚ å¦‚æœæ¥æ”¶è€…å˜é‡recvå·²ç»åœ¨å…¶å®ƒåœ°æ–¹è¿›è¡Œäº†åˆå§‹åŒ–ï¼ŒMethod1æ˜¯å®ƒçš„æ–¹æ³•åï¼Œé‚£ä¹ˆæ–¹æ³•çš„è°ƒç”¨æ ¼å¼ä¸ºrecv.Method1()ï¼ŒåŒç»“æ„ä½“ç›¸ä¼¼ï¼Œå¦‚æœrecvæ˜¯æŒ‡é’ˆï¼Œè°ƒç”¨æ—¶è‡ªåŠ¨è§£å¼•ç”¨ã€‚ å¦‚æœæ–¹æ³•ä¸éœ€è¦ä½¿ç”¨recvçš„å€¼ï¼Œå¯ä»¥ç”¨ç©ºç™½ç¬¦_æ›¿æ¢å®ƒ func (_ receiver_type) methodName(parameter_list) (return_value_list) { ... } ç±»å‹ Tï¼ˆæˆ– *Tï¼‰ä¸Šçš„æ‰€æœ‰æ–¹æ³•çš„é›†åˆå«åšç±»å‹ Tï¼ˆæˆ– *Tï¼‰çš„æ–¹æ³•é›†ï¼ˆmethod setï¼‰ã€‚ ä¸€ä¸ªæ¥æ”¶è€…å˜é‡åŠ ä¸Šå®ƒçš„æ–¹æ³•ç­‰ä»·äºé¢å‘å¯¹è±¡ä¸­çš„ä¸€ä¸ªç±»ï¼ŒåŒºåˆ«åªåœ¨äºGoä¸­æ–¹æ³•çš„ä»£ç ä¸å˜é‡å®šä¹‰æ˜¯åˆ†ç¦»çš„ï¼Œåªè¦åœ¨åŒä¸€ä¸ªåŒ…ä¸­å³å¯ã€‚ å› ä¸ºæ–¹æ³•æ˜¯å‡½æ•°ï¼Œæ‰€ä»¥æ–¹æ³•åŒæ ·ä¸å…è®¸é‡è½½ï¼Œä½†ä¸åŒçš„æ¥æ”¶è€…å˜é‡å¯ä»¥æœ‰ç›¸åŒåå­—çš„æ–¹æ³•ï¼Œå³ä½¿å®ƒä»¬åœ¨åŒä¸€ä¸ªåŒ…ä¸­ï¼Œä¸€ä¸ªä¾‹å­å¦‚ä¸‹ func (a *denseMatrix) Add(b Matrix) Matrix func (a *sparseMatrix) Add(b Matrix) Matrix ä¸€ä¸ªç»“æ„ä½“æ–¹æ³•çš„ä¾‹å­å¦‚ä¸‹ package main import \"fmt\" type TwoInts struct { a int b int } func main() { two1 := new(TwoInts) two1.a = 12 two1.b = 10 fmt.Printf(\"The sum is: %d\\n\", two1.AddThem()) fmt.Printf(\"Add them to the param: %d\\n\", two1.AddToParam(20)) two2 := TwoInts{3, 4} fmt.Printf(\"The sum is: %d\\n\", two2.AddThem()) } func (tn *TwoInts) AddThem() int { return tn.a + tn.b } func (tn *TwoInts) AddToParam(param int) int { return tn.a + tn.b + param } //Output: The sum is: 22 Add them to the param: 42 The sum is: 7 ä¸€ä¸ªéç»“æ„ä½“ç±»å‹(æ•°ç»„åˆ«å)æ–¹æ³•çš„ä¾‹å­å¦‚ä¸‹ package main import \"fmt\" type IntVector []int func (v IntVector) Sum() (s int) { for _, x := range v { s += x } return } func main() { fmt.Println(IntVector{1, 2, 3}.Sum()) // è¾“å‡ºæ˜¯6 } å˜é‡å’Œå®šä¹‰åœ¨å®ƒä¸Šé¢çš„æ–¹æ³•å¿…é¡»åœ¨åŒä¸€ä¸ªåŒ…é‡Œå®šä¹‰ï¼Œå¦‚ä¸‹ä¾‹æ˜¯é”™è¯¯çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸èƒ½å®šä¹‰intè¿™æ ·çš„åŸºæœ¬ç±»å‹çš„æ–¹æ³•ï¼Œä½†å¯ä»¥å®šä¹‰åŸºæœ¬ç±»å‹çš„åˆ«åçš„æ–¹æ³• package main import \"container/list\" func (p *list.List) Iter() { // ... } func main() { lst := new(list.List) for _= range lst.Iter() { } } ","date":"2019-11-26","objectID":"/2019/golang-syntax-8-struct-and-method/:2:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€8-ç»“æ„ä½“ä¸æ–¹æ³•","uri":"/2019/golang-syntax-8-struct-and-method/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 å‡½æ•°å’Œæ–¹æ³•çš„åŒºåˆ« å‡½æ•°å°†å˜é‡ä½œä¸ºå‚æ•°ï¼šFunction1(recv) æ–¹æ³•åœ¨å˜é‡ä¸Šè¢«è°ƒç”¨ï¼šrecv.Method1() åœ¨æ¥æ”¶è€…æ˜¯æŒ‡é’ˆæ—¶ï¼Œæ–¹æ³•å¯ä»¥æ”¹å˜æ¥æ”¶è€…çš„å€¼ï¼ˆæˆ–çŠ¶æ€ï¼‰ï¼Œè¿™ç‚¹å‡½æ•°ä¹Ÿå¯ä»¥åšåˆ°ï¼ˆå½“å‚æ•°ä½œä¸ºæŒ‡é’ˆä¼ é€’ï¼Œå³é€šè¿‡å¼•ç”¨è°ƒç”¨æ—¶ï¼Œå‡½æ•°ä¹Ÿå¯ä»¥æ”¹å˜å‚æ•°çš„çŠ¶æ€ï¼‰ã€‚ ä¸è¦å¿˜è®° Method1 åè¾¹çš„æ‹¬å· ()ï¼Œå¦åˆ™ä¼šå¼•å‘ç¼–è¯‘å™¨é”™è¯¯ï¼šmethod recv.Method1 is not an expression, must be called æ¥æ”¶è€…å¿…é¡»æœ‰ä¸€ä¸ªæ˜¾å¼çš„åå­—ï¼Œè¿™ä¸ªåå­—å¿…é¡»åœ¨æ–¹æ³•ä¸­è¢«ä½¿ç”¨ã€‚ receiver_type å«åš ï¼ˆæ¥æ”¶è€…ï¼‰åŸºæœ¬ç±»å‹ï¼Œè¿™ä¸ªç±»å‹å¿…é¡»åœ¨å’Œæ–¹æ³•åŒæ ·çš„åŒ…ä¸­è¢«å£°æ˜ã€‚ åœ¨ Go ä¸­ï¼Œï¼ˆæ¥æ”¶è€…ï¼‰ç±»å‹å…³è”çš„æ–¹æ³•ä¸å†™åœ¨ç±»å‹ç»“æ„é‡Œé¢ï¼Œå°±åƒç±»é‚£æ ·ï¼›è€¦åˆæ›´åŠ å®½æ¾ï¼›ç±»å‹å’Œæ–¹æ³•ä¹‹é—´çš„å…³è”ç”±æ¥æ”¶è€…æ¥å»ºç«‹ã€‚ æ–¹æ³•æ²¡æœ‰å’Œæ•°æ®å®šä¹‰ï¼ˆç»“æ„ä½“ï¼‰æ··åœ¨ä¸€èµ·ï¼šå®ƒä»¬æ˜¯æ­£äº¤çš„ç±»å‹ï¼›è¡¨ç¤ºï¼ˆæ•°æ®ï¼‰å’Œè¡Œä¸ºï¼ˆæ–¹æ³•ï¼‰æ˜¯ç‹¬ç«‹çš„ã€‚ ","date":"2019-11-26","objectID":"/2019/golang-syntax-8-struct-and-method/:2:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€8-ç»“æ„ä½“ä¸æ–¹æ³•","uri":"/2019/golang-syntax-8-struct-and-method/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 æŒ‡é’ˆæˆ–å€¼ä½œä¸ºæ¥æ”¶è€… å¦‚æœæƒ³è¦æ–¹æ³•æ”¹å˜æ¥æ”¶è€…çš„æ•°æ®ï¼Œå°±åœ¨æ¥æ”¶è€…çš„æŒ‡é’ˆç±»å‹ä¸Šå®šä¹‰è¯¥æ–¹æ³•ã€‚å¦åˆ™ï¼Œå°±åœ¨æ™®é€šçš„å€¼ç±»å‹ä¸Šå®šä¹‰æ–¹æ³•ã€‚ä¸€ä¸ªä¾‹å­å¦‚ä¸‹ package main import ( \"fmt\" ) type B struct { thing int } func (b *B) change() { b.thing = 1 } func (b B) write() string { return fmt.Sprint(b) } func main() { var b1 B // b1æ˜¯å€¼ b1.change() fmt.Println(b1.write()) b2 := new(B) // b2æ˜¯æŒ‡é’ˆ b2.change() fmt.Println(b2.write()) } /* è¾“å‡ºï¼š {1} {1} */ æŒ‡é’ˆæ–¹æ³•å’Œå€¼æ–¹æ³•éƒ½å¯ä»¥åœ¨æŒ‡é’ˆæˆ–éæŒ‡é’ˆä¸Šè¢«è°ƒç”¨ï¼Œå¦‚ä¸Šä¾‹ï¼Œb1æ˜¯å€¼ç±»å‹ï¼Œè€Œchange()æ–¹æ³•ä½œç”¨åœ¨æŒ‡é’ˆç±»å‹ä¸Šï¼Œb1.change()ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸º(\u0026b1).change()ï¼›b2æ˜¯æŒ‡é’ˆç±»å‹ï¼Œä½†write()æ–¹æ³•æ˜¯å€¼ç±»å‹ï¼Œb2.write()ä¼šè¢«è‡ªåŠ¨è½¬æ¢æˆ(*b2).write() ","date":"2019-11-26","objectID":"/2019/golang-syntax-8-struct-and-method/:2:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€8-ç»“æ„ä½“ä¸æ–¹æ³•","uri":"/2019/golang-syntax-8-struct-and-method/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 åˆ©ç”¨æ–¹æ³•è¯»å–ç»“æ„ä½“ä¸­çš„æœªå¯¼å‡ºå­—æ®µ æœ¬æ–‡å¼€å§‹å¯¹ç»“æ„ä½“çš„ä»‹ç»ä¸­ï¼Œæåˆ°ç»“æ„ä½“å¯¹å¤–éƒ¨å¯è§ï¼Œè€Œç»“æ„ä½“ä¸­çš„å­—æ®µå¯¹å¤–éƒ¨ä¸å¯è§æ˜¯å¯èƒ½å‘ç”Ÿçš„ï¼Œå¯¹äºè¿™ç§æƒ…å†µï¼Œè¯»å–æˆ–ä¿®æ”¹ç»“æ„ä½“ä¸­çš„å­—æ®µå€¼å¯ä»¥é€šè¿‡ä½œç”¨åœ¨ç»“æ„ä½“ä¸Šçš„æ–¹æ³•å®Œæˆï¼Œä¸€ä¸ªä¾‹å­å¦‚ä¸‹ package person type Person struct { firstName string lastName string } func (p *Person) FirstName() string { return p.firstName } func (p *Person) SetFirstName(newName string) { p.firstName = newName } å¯¹å…¶ä¸­å®šä¹‰çš„ç»“æ„ä½“å­—æ®µè¿›è¡Œè°ƒç”¨ package main import ( \"./person\" \"fmt\" ) func main() { p := new(person.Person) // p.firstName undefined // (cannot refer to unexported field or method firstName) // p.firstName = \"Eric\" p.SetFirstName(\"Eric\") fmt.Println(p.FirstName()) // Output: Eric } ","date":"2019-11-26","objectID":"/2019/golang-syntax-8-struct-and-method/:2:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€8-ç»“æ„ä½“ä¸æ–¹æ³•","uri":"/2019/golang-syntax-8-struct-and-method/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.4 å†…åµŒç±»å‹çš„æ–¹æ³•ä¸ç»§æ‰¿ å½“ä¸€ä¸ªåŒ¿åç±»å‹è¢«å†…åµŒåœ¨ç»“æ„ä½“ä¸­æ—¶ï¼ŒåŒ¿åç±»å‹çš„å¯è§æ–¹æ³•ä¹ŸåŒæ ·è¢«å†…åµŒï¼Œè¿™åœ¨æ•ˆæœä¸Šç­‰åŒäºå¤–å±‚ç±»å‹ ç»§æ‰¿ äº†è¿™äº›æ–¹æ³• ï¼Œ è¿™ä¸ªæœºåˆ¶æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹å¼æ¥æ¨¡æ‹Ÿé¢å‘å¯¹è±¡è¯­è¨€ä¸­çš„å­ç±»å’Œç»§æ‰¿ç›¸å…³çš„æ•ˆæœã€‚ä¸€ä¸ªç¤ºä¾‹å¦‚ä¸‹ package main import ( \"fmt\" \"math\" ) type Point struct { x, y float64 } func (p *Point) Abs() float64 { return math.Sqrt(p.x*p.x + p.y*p.y) } type NamedPoint struct { Point name string } func main() { n := \u0026NamedPoint{Point{3, 4}, \"Pythagoras\"} fmt.Println(n.Abs()) // æ‰“å°5 } ä½¿ç”¨åŒåæ–¹æ³•å¯ä»¥è¦†ç›–çˆ¶ç±»å‹ä¸­çš„æ–¹æ³•ï¼Œæ¯”å¦‚åœ¨ä¸Šä¾‹ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œä¼šæ‰“å°100 func (n *NamedPoint) Abs() float64 { return n.Point.Abs() * 100. } å› ä¸ºä¸€ä¸ªç»“æ„ä½“å¯ä»¥åµŒå…¥å¤šä¸ªåŒ¿åç±»å‹ï¼Œæ‰€ä»¥å®é™…ä¸Šå¯ä»¥å®ç°ç®€å•çš„å¤šé‡ç»§æ‰¿ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤º package main import ( \"fmt\" ) type Camera struct{} func (c *Camera) TakeAPicture() string { return \"Click\" } type Phone struct{} func (p *Phone) Call() string { return \"Ring Ring\" } type CameraPhone struct { Camera Phone } func main() { cp := new(CameraPhone) fmt.Println(\"Our new CameraPhone exhibits multiple behaviors...\") fmt.Println(\"It exhibits behavior of a Camera: \", cp.TakeAPicture()) fmt.Println(\"It works like a Phone too: \", cp.Call()) } //Output: Our new CameraPhone exhibits multiple behaviors... It exhibits behavior of a Camera: Click It works like a Phone too: Ring Ring ","date":"2019-11-26","objectID":"/2019/golang-syntax-8-struct-and-method/:2:4","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€8-ç»“æ„ä½“ä¸æ–¹æ³•","uri":"/2019/golang-syntax-8-struct-and-method/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.5 åœ¨ç±»å‹ä¸­åµŒå…¥åŠŸèƒ½ ä¸»è¦æœ‰ä¸¤ç§æ–¹æ³•æ¥å®ç°åœ¨ç±»å‹ä¸­åµŒå…¥åŠŸèƒ½ï¼š Aï¼šèšåˆï¼ˆæˆ–ç»„åˆï¼‰ï¼šåŒ…å«ä¸€ä¸ªæ‰€éœ€åŠŸèƒ½ç±»å‹çš„å…·åå­—æ®µã€‚ Bï¼šå†…åµŒï¼šå†…åµŒï¼ˆåŒ¿ååœ°ï¼‰æ‰€éœ€åŠŸèƒ½ç±»å‹ï¼Œåƒå‰ä¸€èŠ‚ 10.6.5 æ‰€æ¼”ç¤ºçš„é‚£æ ·ã€‚ å‡è®¾æœ‰ä¸€ä¸ª Customer ç±»å‹ï¼Œæˆ‘ä»¬æƒ³è®©å®ƒé€šè¿‡ Log ç±»å‹æ¥åŒ…å«æ—¥å¿—åŠŸèƒ½ï¼ŒLog ç±»å‹åªæ˜¯ç®€å•åœ°åŒ…å«ä¸€ä¸ªç´¯ç§¯çš„æ¶ˆæ¯ï¼ˆå½“ç„¶å®ƒå¯ä»¥æ˜¯å¤æ‚çš„ï¼‰ã€‚å¦‚æœæƒ³è®©ç‰¹å®šç±»å‹éƒ½å…·å¤‡æ—¥å¿—åŠŸèƒ½ï¼Œä½ å¯ä»¥å®ç°ä¸€ä¸ªè¿™æ ·çš„ Log ç±»å‹ï¼Œç„¶åå°†å®ƒä½œä¸ºç‰¹å®šç±»å‹çš„ä¸€ä¸ªå­—æ®µï¼Œå¹¶æä¾› Log()ï¼Œå®ƒè¿”å›è¿™ä¸ªæ—¥å¿—çš„å¼•ç”¨ã€‚ ä½¿ç”¨èšåˆæ–¹å¼å®ç°å¦‚ä¸‹ package main import ( \"fmt\" ) type Log struct { msg string } type Customer struct { Name string log *Log } func main() { c := new(Customer) c.Name = \"Barak Obama\" c.log = new(Log) c.log.msg = \"1 - Yes we can!\" // shorter c = \u0026Customer{\"Barak Obama\", \u0026Log{\"1 - Yes we can!\"}} // fmt.Println(c) \u0026{Barak Obama 1 - Yes we can!} c.Log().Add(\"2 - After me the world will be a better place!\") //fmt.Println(c.log) fmt.Println(c.Log()) } func (l *Log) Add(s string) { l.msg += \"\\n\" + s } func (l *Log) String() string { return l.msg } func (c *Customer) Log() *Log { return c.log } //Output: 1 - Yes we can! 2 - After me the world will be a better place! ä½¿ç”¨å†…åµŒæ–¹å¼å®ç°å¦‚ä¸‹ package main import ( \"fmt\" ) type Log struct { msg string } type Customer struct { Name string Log } func main() { c := \u0026Customer{\"Barak Obama\", Log{\"1 - Yes we can!\"}} c.Add(\"2 - After me the world will be a better place!\") fmt.Println(c) } func (l *Log) Add(s string) { l.msg += \"\\n\" + s } func (l *Log) String() string { return l.msg } func (c *Customer) String() string { return c.Name + \"\\nLog:\" + fmt.Sprintln(c.Log) } //Output: Barak Obama Log:{1 - Yes we can! 2 - After me the world will be a better place!} å†…åµŒçš„ç±»å‹ä¸éœ€è¦æŒ‡é’ˆï¼ŒCustomer ä¹Ÿä¸éœ€è¦ Add æ–¹æ³•ï¼Œå®ƒä½¿ç”¨ Log çš„ Add æ–¹æ³•ï¼ŒCustomer æœ‰è‡ªå·±çš„ String æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨å®ƒé‡Œé¢è°ƒç”¨äº† Log çš„ String æ–¹æ³•ã€‚ å¦‚æœå†…åµŒç±»å‹åµŒå…¥äº†å…¶ä»–ç±»å‹ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œé‚£äº›ç±»å‹çš„æ–¹æ³•å¯ä»¥ç›´æ¥åœ¨å¤–å±‚ç±»å‹ä¸­ä½¿ç”¨ã€‚ å› æ­¤ä¸€ä¸ªå¥½çš„ç­–ç•¥æ˜¯åˆ›å»ºä¸€äº›å°çš„ã€å¯å¤ç”¨çš„ç±»å‹ä½œä¸ºä¸€ä¸ªå·¥å…·ç®±ï¼Œç”¨äºç»„æˆåŸŸç±»å‹ã€‚ ","date":"2019-11-26","objectID":"/2019/golang-syntax-8-struct-and-method/:2:5","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€8-ç»“æ„ä½“ä¸æ–¹æ³•","uri":"/2019/golang-syntax-8-struct-and-method/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æœ¬ç¯‡ä»‹ç» Golang ä¸­çš„æ¥å£ä¸åå°„ã€‚ ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:0:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. æ¥å£ ç±»å‹ Tï¼ˆæˆ– *Tï¼‰ä¸Šçš„æ‰€æœ‰æ–¹æ³•çš„é›†åˆå«åšç±»å‹ Tï¼ˆæˆ– *Tï¼‰çš„æ–¹æ³•é›†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¥å£æ¥å®šä¹‰æ–¹æ³•é›†ï¼Œä½†æ˜¯è¿™ç§å®šä¹‰æ˜¯æŠ½è±¡çš„ï¼Œä¸åŒ…å«æ–¹æ³•çš„ä»£ç å®ç°ï¼Œæ¥å£ä¸­ä¹Ÿä¸èƒ½åŒ…å«å˜é‡ã€‚ æ¥å£å®šä¹‰çš„åŸºæœ¬æ ¼å¼å¦‚ä¸‹ type Namer interface { Method1(param_list) return_type Method2(param_list) return_type ... } ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:1:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.1 æ¥å£ç†è§£ æ¥å£å¯ä»¥æ˜¯ç©ºçš„ï¼Œä¹Ÿå°±æ˜¯ä¸åŒ…å«ä»»ä½•æ–¹æ³•ï¼Œç©ºæ¥å£çš„åº•å±‚å®ç°æ˜¯ä¸€ä¸ªåä¸º eface çš„ç»“æ„ä½“ type eface struct { _type *_type data unsafe.Pointer } type _type struct { size uintptr // type size ptrdata uintptr // size of memory prefix holding all pointers hash uint32 // hash of type; avoids computation in hash tables tflag tflag // extra type information flags align uint8 // alignment of variable with this type fieldalign uint8 // alignment of struct field with this type kind uint8 // enumeration for C alg *typeAlg // algorithm table gcdata *byte // garbage collection data str nameOff // string form ptrToThis typeOff // type for pointer to this type, may be zero } éç©ºæ¥å£çš„åº•å±‚å®ç°ä¸ç©ºæ¥å£ä¸åŒï¼Œæ˜¯ä¸€ä¸ªåä¸º iface çš„ç»“æ„ä½“ï¼Œéç©ºæ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•çš„å…·ä½“å®ç°éƒ½æ”¾åœ¨ itab.fun å˜é‡ä¸­ type iface struct { tab *itab data unsafe.Pointer } // layout of Itab known to compilers // allocated in non-garbage-collected memory // Needs to be in sync with // ../cmd/compile/internal/gc/reflect.go:/^func.dumptypestructs. type itab struct { inter *interfacetype _type *_type link *itab bad int32 inhash int32 // has this itab been added to hash? fun [1]uintptr // variable sized } type interfacetype struct { typ _type pkgpath name mhdr []imethod } type imethod struct { //è¿™é‡Œçš„ method åªæ˜¯ä¸€ç§å‡½æ•°å£°æ˜çš„æŠ½è±¡ï¼Œæ¯”å¦‚ func Print() error name nameOff ityp typeOff } itab å¯ä»¥ç®€å•ç†è§£ä¸º æ¥å£ç±»å‹+å…·ä½“ç±»å‹ï¼Œinterfacetype æ˜¯æ¥å£ç±»å‹ï¼ŒåŒ…å«åŒ…è·¯å¾„ã€æ–¹æ³•ç­‰ä¿¡æ¯ã€‚_type åˆ™æ˜¯å…·ä½“ç±»å‹ï¼Œç©ºæ¥å£ä¹ŸåŒ…å«è¿™ä¸ªå­—æ®µã€‚ å…³äºæ¥å£å€¼çš„ç†è§£æ˜¯ä¸€ä»¶å¾ˆé‡è¦çš„äº‹ï¼Œä½†æ˜¯æ¯”è¾ƒå¤æ‚ã€‚æˆ‘ä»¬é€šè¿‡äº†è§£æ¥å£çš„å†…å­˜å¸ƒå±€æ¥ç†è§£æ¥å£çš„æœ¬è´¨ï¼Œä»è€Œç†è§£æ¥å£å€¼ã€‚å…ˆçœ‹ä¸€ä¸ªä¾‹å­ type Stringer interface { String() string } type Binary uint64 func (i Binary) String() string { return strconv.Uitob64(i.Get(), 2) } func (i Binary) Get() uint64 { return uint64(i) } func main() { b := Binary{} s := Stringer(b) fmt.Print(s.String()) } å¯¹æ¯”éç©ºæ¥å£çš„åº•å±‚å®ç°ï¼Œå‘ç°æ¥å£åœ¨å†…å­˜ä¸­å®é™…ä¸Šç”±ä¸¤ä¸ªæˆå‘˜ç»„æˆï¼Œå¦‚ä¸‹å›¾ï¼Œtab æŒ‡å‘è™šè¡¨ï¼Œdata æŒ‡å‘å®é™…å¼•ç”¨çš„æ•°æ® è™šè¡¨æç»˜äº†å®é™…çš„ç±»å‹ä¿¡æ¯åŠæ¥å£çš„æ–¹æ³•é›†ï¼Œå…·ä½“æœ‰å“ªäº›éƒ¨åˆ†æˆ‘ä»¬ä»¥åŠä» itab ç»“æ„ä½“ä¸­çœ‹åˆ°äº†ã€‚æ³¨æ„åœ¨è¿™é‡Œæ˜¯ Stringer æ¥å£çš„å‡½æ•°æŒ‡é’ˆåˆ—è¡¨ï¼Œè€Œä¸æ˜¯å®é™…ç±»å‹ Binary çš„å‡½æ•°æŒ‡é’ˆåˆ—è¡¨ï¼Œåªæœ‰åœ¨è¿è¡Œæ—¶é‡åˆ° s := Stringer(b) è¿™æ ·çš„è¯­å¥ï¼Œæ‰ä¼šç”Ÿæˆæ¥å£å¯¹åº”çš„ Binary ç±»å‹çš„è™šè¡¨ã€‚è¿™æ ·ï¼Œå½“åˆ¤å®šä¸€ç§ç±»å‹æ˜¯å¦æ»¡è¶³æŸä¸ªæ¥å£æ—¶ï¼Œåªéœ€è¦åˆ¤æ–­ç±»å‹çš„æ–¹æ³•é›†æ˜¯å¦å®Œå…¨åŒ…å«æ¥å£çš„æ–¹æ³•é›†å³å¯ã€‚ ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:1:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.2 æ¥å£å€¼ æˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ªå˜é‡å£°æ˜ä¸ºæ¥å£ç±»å‹ï¼Œvar ai Namerï¼Œæœªåˆå§‹åŒ–æ—¶ï¼Œæ¥å£å€¼ä¸º nilã€‚ type Shape interface { Area() float32 } func main() { var s Shape fmt.Println(\"value of s is\", s) fmt.Printf(\"type of s is %T\\n\", s) } //Output: value of s is \u003cnil\u003e type of s is \u003cnil\u003e æˆ‘ä»¬å¯ä»¥ç†è§£æ¥å£å˜é‡çš„å€¼ä¸º nilï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆç±»å‹ä¹Ÿæ˜¯ nil å‘¢ï¼Ÿä¸Šä¸€å°èŠ‚æˆ‘ä»¬ç†è§£æ¥å£çš„æ—¶å€™çŸ¥é“ï¼Œæ¥å£å…¶å®å°±æ˜¯å®šä¹‰åœ¨ç»“æ„ä½“ä¸­çš„ä¸¤ä¸ªæŒ‡é’ˆï¼Œæœªåˆå§‹åŒ–æ—¶è¿™ä¸¤ä¸ªæŒ‡é’ˆéƒ½æ˜¯ nilï¼Œå› æ­¤æ¥å£å€¼æ˜¯ nilï¼Œæ¥å£ç±»å‹ä¹Ÿæ˜¯nilã€‚ å½“æˆ‘ä»¬åˆå§‹åŒ–æ¥å£å˜é‡åï¼Œä¸¤ä¸ªæŒ‡é’ˆéƒ½æœ‰äº†å…·ä½“æŒ‡å‘çš„å€¼ï¼Œæ­¤æ—¶æ¥å£çš„å€¼å°±æ˜¯æ¥å£æŒ‡å‘çš„ç±»å‹çš„å€¼ï¼Œæ¥å£çš„ç±»å‹å°±æ˜¯å®ç°äº†æ¥å£çš„å˜é‡ç±»å‹ã€‚å¦‚ä¸‹ä¾‹ï¼Œå˜é‡ i æœ¬èº«æ˜¯æ¥å£ç±»å‹ Namerï¼Œå…ˆåæŒ‡å‘å®ç°äº†æ¥å£ç±»å‹çš„ St1 å’Œ St2 ä¸¤ä¸ªç©ºç»“æ„ä½“ï¼Œå…¶å€¼å’Œç±»å‹å°±å‘ç”Ÿäº†å˜åŒ–ã€‚ type Namer interface { Name() } type St1 struct { a int } func (st1 St1) Name() { fmt.Println(st1.a) } type St2 struct{} func (St2) Name() {} func main() { var i Namer = St1{2} fmt.Printf(\"type is %T\\n\", i) fmt.Printf(\"value is %v\\n\", i) i = St2{} fmt.Printf(\"type is %T\\n\", i) fmt.Printf(\"value is %v\\n\", i) } //Output: type is main.St1 value is {2} type is main.St2 value is {} ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:1:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.3 æ¥å£çš„å®ç° æ¥å£çš„å®ç°æ˜¯ä¸€ç§éšå¼çš„å®ç°ï¼Œåªè¦æŸä¸ªç±»å‹çš„æ–¹æ³•é›†å®Œå…¨åŒ…å«æ¥å£çš„æ–¹æ³•é›†ï¼Œå°±å±äºå®ç°äº†è¯¥æ¥å£ï¼Œå®ç°äº†æ¥å£çš„å˜é‡å¯ä»¥èµ‹å€¼ç»™æ¥å£å€¼ã€‚ package main import \"fmt\" type Shaper interface { Area() float32 } type Square struct { side float32 } func (sq *Square) Area() float32 { return sq.side * sq.side } func main() { sq1 := new(Square) sq1.side = 5 var areaIntf Shaper areaIntf = sq1 // shorter,without separate declaration: // areaIntf := Shaper(sq1) // or even: // areaIntf := sq1 fmt.Printf(\"The square has area: %f\\n\", areaIntf.Area()) } //Output: The square has area: 25.000000 ç©ºæ¥å£å¯ä»¥å£°æ˜ä¸º interface{}ï¼ŒåŒæ—¶å› ä¸ºç©ºæ¥å£ä¸åŒ…å«ä»»ä½•æ–¹æ³•ï¼Œæ‰€ä»¥ä»»ä½•ç±»å‹éƒ½é»˜è®¤å®ç°äº†ç©ºæ¥å£ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œfmt åŒ…ä¸­çš„ Println() å‡½æ•°ï¼Œå¯ä»¥æ¥æ”¶å¤šç§ç±»å‹çš„å€¼ï¼Œæ¯”å¦‚ï¼šintã€stringã€arrayç­‰ã€‚è¿™æ˜¯å› ä¸ºå®ƒçš„å½¢å‚å°±æ˜¯æ¥å£ç±»å‹ï¼Œå¯ä»¥æ¥æ”¶ä»»æ„ç±»å‹çš„å€¼ã€‚ func Println(a ...interface{}) (n int, err error) {} å¤šä¸ªç±»å‹å¯ä»¥å®ç°åŒä¸€ä¸ªæ¥å£ï¼Œå¦‚ä¸‹ä¾‹ï¼Œä¸€ä¸ªç±»å‹ä¹Ÿå¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚ package main import \"fmt\" type Shaper interface { Area() float32 } type Square struct { side float32 } func (sq *Square) Area() float32 { return sq.side * sq.side } type Rectangle struct { length, width float32 } func (r Rectangle) Area() float32 { return r.length * r.width } func main() { r := Rectangle{5, 3} // Area() of Rectangle needs a value q := \u0026Square{5} // Area() of Square needs a pointer // shapes := []Shaper{Shaper(r), Shaper(q)} // or shorter shapes := []Shaper{r, q} fmt.Println(\"Looping through shapes for area ...\") for n, _ := range shapes { fmt.Println(\"Shape details: \", shapes[n]) fmt.Println(\"Area of this shape is: \", shapes[n].Area()) } } //Output: Looping through shapes for area ... Shape details: {5 3} Area of this shape is: 15 Shape details: \u0026{5} Area of this shape is: 25 ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:1:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.4 æ¥å£åµŒå¥— Go ä¸­çš„æ¥å£å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå…¶å®ƒæ¥å£ï¼Œè¿™ç›¸å½“äºç›´æ¥å°†è¿™äº›å†…åµŒæ¥å£çš„æ–¹æ³•åˆ—ä¸¾åœ¨å¤–å±‚æ¥å£ä¸­ã€‚ä¸‹ä¾‹ä¸­Fileæ¥å£åŒ…å«äº†ReadWriteå’ŒLockæ¥å£çš„æ‰€æœ‰æ–¹æ³• type ReadWrite interface { Read(b Buffer) bool Write(b Buffer) bool } type Lock interface { Lock() Unlock() } type File interface { ReadWrite Lock Close() } ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:1:4","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.5 ç±»å‹æ–­è¨€ å¦‚æœä¸€ä¸ªå˜é‡æ˜¯æ¥å£å˜é‡ï¼Œå®é™…ä¸Šå…¶å€¼çš„ç±»å‹æ˜¯ä¸ç¡®å®šçš„ï¼Œæˆ‘ä»¬ä½¿ç”¨ç±»å‹æ–­è¨€æ¥æ£€æµ‹å€¼çš„å…·ä½“ç±»å‹ v := varI.(T) varIæ˜¯ä¸€ä¸ªæ¥å£å˜é‡ï¼ŒTæ˜¯å¾…æ£€æµ‹ç±»å‹ï¼Œè¿™ä¸€è¯­å¥çš„ä½œç”¨æ˜¯æ£€æµ‹ varI çš„åŠ¨æ€ç±»å‹æ˜¯å¦å’Œ T ä¸€è‡´ï¼Œå®è´¨æ˜¯å°† varI è½¬æ¢ä¸º T ç±»å‹çš„å€¼ package main import ( \"fmt\" \"math\" ) type Square struct { side float32 } type Circle struct { radius float32 } type Shaper interface { Area() float32 } func main() { var areaIntf Shaper sq1 := new(Square) sq1.side = 5 areaIntf = sq1 // Is Square the type of areaIntf? if t, ok := areaIntf.(*Square); ok { fmt.Printf(\"The type of areaIntf is: %T\\n\", t) } if u, ok := areaIntf.(*Circle); ok { fmt.Printf(\"The type of areaIntf is: %T\\n\", u) } else { fmt.Println(\"areaIntf does not contain a variable of type Circle\") } } func (sq *Square) Area() float32 { return sq.side * sq.side } func (ci *Circle) Area() float32 { return ci.radius * ci.radius * math.Pi } //Output: The type of areaIntf is: *main.Square areaIntf does not contain a variable of type Circle ç±»å‹æ–­è¨€å¯èƒ½å¤±è´¥ï¼Œä¸ºäº†æ›´å®‰å…¨çš„ä½¿ç”¨ç±»å‹æ–­è¨€ï¼Œä½¿ç”¨å¦‚ä¸‹çš„æ–¹å¼ if v, ok := varI.(T); ok { // checked type assertion Process(v) return } // varI is not of type T ç”±äºæ–­è¨€æ˜¯ä¸€ä¸ªæ¯”è¾ƒçš„è¿‡ç¨‹ï¼Œå› æ­¤éœ€è¦å¤šæ¬¡å°è¯•ï¼Œä½¿ç”¨ switch è¯­å¥æœ€ä¸ºç®€ä¾¿ï¼Œä¸è¿‡è¦æ±‚æ‰€æœ‰ case è¯­å¥ä¸­åˆ—ä¸¾çš„ç±»å‹(nilé™¤å¤–)éƒ½å¿…é¡»å®ç°å¯¹åº”çš„æ¥å£ã€‚ switch t := areaIntf.(type) { case *Square: fmt.Printf(\"Type Square %T with value %v\\n\", t, t) case *Circle: fmt.Printf(\"Type Circle %T with value %v\\n\", t, t) case nil: fmt.Printf(\"nil value: nothing to check?\\n\") default: fmt.Printf(\"Unexpected type %T\\n\", t) } //Output: Type Square *main.Square with value \u0026{5} ç±»å‹æ–­è¨€è¿˜æœ‰ä¸€ç§åå‘ç”¨æ³•ï¼Œå°±æ˜¯æµ‹è¯•å®ƒæ˜¯å¦å®ç°äº†æŸä¸ªæ¥å£ï¼Œå¦‚ä¸‹ type Stringer interface { String() string } if sv, ok := v.(Stringer); ok { fmt.Printf(\"v implements String(): %s\\n\", sv.String()) // note: sv, not v } æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„è¯†åˆ°ï¼Œæ–­è¨€æ ¼å¼ varI.(T) ä¸­çš„ varI å¯ä»¥æ˜¯ä»»æ„å˜é‡ï¼ŒT æ˜¯ä»»æ„ç±»å‹ï¼Œæ–­è¨€çš„å®è´¨å°±æ˜¯å°†å˜é‡è½¬æ¢ä¸º T ç±»å‹çš„å€¼ï¼Œç„¶åè¿›è¡Œæ¯”è¾ƒã€‚ ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:1:5","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.6 ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶è€…å’Œå€¼æ¥æ”¶è€…å®ç°æ¥å£ è™½ç„¶ä½œç”¨äºå˜é‡çš„æ–¹æ³•ä¸åŒºåˆ†å˜é‡æ˜¯æŒ‡é’ˆè¿˜æ˜¯å€¼ï¼Œä½†æ˜¯é‡åˆ°æ¥å£æ—¶ï¼Œä¼šå˜å¾—ç¨å¾®å¤æ‚ä¸€ç‚¹ã€‚ package main import ( \"fmt\" ) type List []int func (l List) Len() int { return len(l) } func (l *List) Append(val int) { *l = append(*l, val) } type Appender interface { Append(int) } func CountInto(a Appender, start, end int) { for i := start; i \u003c= end; i++ { a.Append(i) } } type Lener interface { Len() int } func LongEnough(l Lener) bool { return l.Len()*10 \u003e 42 } func main() { // A bare value var lst List // compiler error: // cannot use lst (type List) as type Appender in argument to CountInto: // List does not implement Appender (Append method has pointer receiver) // CountInto(lst, 1, 10) if LongEnough(lst) { // VALID:Identical receiver type fmt.Printf(\"- lst is long enough\\n\") } // A pointer value plst := new(List) CountInto(plst, 1, 10) //VALID:Identical receiver type if LongEnough(plst) { // VALID: a *List can be dereferenced for the receiver fmt.Printf(\"- plst is long enough\\n\") } } åœ¨ lst ä¸Šè°ƒç”¨ CountInto æ—¶ä¼šå¯¼è‡´ä¸€ä¸ªç¼–è¯‘å™¨é”™è¯¯ï¼Œå› ä¸º CountInto éœ€è¦ä¸€ä¸ª Appenderï¼Œè€Œå®ƒçš„æ–¹æ³• Append åªå®šä¹‰åœ¨æŒ‡é’ˆä¸Šã€‚ åœ¨ lst ä¸Šè°ƒç”¨ LongEnough æ˜¯å¯ä»¥çš„ï¼Œå› ä¸º Len å®šä¹‰åœ¨å€¼ä¸Šã€‚ åœ¨ plst ä¸Šè°ƒç”¨ CountInto æ˜¯å¯ä»¥çš„ï¼Œå› ä¸º CountInto éœ€è¦ä¸€ä¸ª Appenderï¼Œå¹¶ä¸”å®ƒçš„æ–¹æ³• Append å®šä¹‰åœ¨æŒ‡é’ˆä¸Šã€‚ åœ¨ plst ä¸Šè°ƒç”¨ LongEnough ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºæŒ‡é’ˆä¼šè¢«è‡ªåŠ¨è§£å¼•ç”¨ã€‚ Goè¯­è¨€è§„èŒƒä¸­æ¥å£æ–¹æ³•é›†çš„è°ƒç”¨è§„åˆ™ä¸ºï¼š ç±»å‹ *T çš„å¯è°ƒç”¨æ–¹æ³•é›†åŒ…å«æ¥å—è€…ä¸º *T æˆ– T çš„æ‰€æœ‰æ–¹æ³•é›† ç±»å‹ T çš„å¯è°ƒç”¨æ–¹æ³•é›†åŒ…å«æ¥å—è€…ä¸º T çš„æ‰€æœ‰æ–¹æ³• ç±»å‹ T çš„å¯è°ƒç”¨æ–¹æ³•é›†ä¸åŒ…å«æ¥å—è€…ä¸º *T çš„æ–¹æ³• ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:1:6","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. åå°„ åå°„æ˜¯æŒ‡åœ¨ç¨‹åºè¿è¡ŒæœŸé—´å¯¹ç¨‹åºæœ¬èº«è¿›è¡Œè®¿é—®å’Œä¿®æ”¹çš„èƒ½åŠ›ã€‚ç¨‹åºåœ¨ç¼–è¯‘æ—¶ï¼Œå˜é‡è¢«è½¬æ¢ä¸ºå†…å­˜åœ°å€ï¼Œå˜é‡åä¸ä¼šè¢«ç¼–è¯‘å™¨å†™å…¥åˆ°å¯æ‰§è¡Œéƒ¨åˆ†ï¼Œåœ¨è¿è¡Œç¨‹åºæ—¶ï¼Œç¨‹åºæ— æ³•è·å–è‡ªèº«çš„ä¿¡æ¯ã€‚ æ”¯æŒåå°„çš„è¯­è¨€å¯ä»¥åœ¨ç¨‹åºç¼–è¯‘æœŸå°†å˜é‡çš„åå°„ä¿¡æ¯ï¼Œå¦‚å­—æ®µåç§°ã€ç±»å‹ä¿¡æ¯ã€ç»“æ„ä½“ä¿¡æ¯ç­‰æ•´åˆåˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œå¹¶ç»™ç¨‹åºæä¾›æ¥å£è®¿é—®åå°„ä¿¡æ¯ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ç¨‹åºè¿è¡ŒæœŸè·å–ç±»å‹çš„åå°„ä¿¡æ¯ï¼Œå¹¶ä¸”æœ‰èƒ½åŠ›ä¿®æ”¹å®ƒä»¬ã€‚ Go è¯­è¨€çš„åå°„ç³»ç»Ÿæ— æ³•è·å–åˆ°ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ç©ºé—´æˆ–è€…ä¸€ä¸ªåŒ…ä¸­çš„æ‰€æœ‰ç±»å‹ä¿¡æ¯ï¼Œä»…ä»…æ˜¯åœ¨è¿è¡Œæ—¶é€šè¿‡ reflect åŒ…æ¥è®¿é—®æŒ‡å®šçš„ç±»å‹ä¿¡æ¯ã€‚ https://mp.weixin.qq.com/s/qJVfEWngSDg3It3UytPuxA ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:2:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 æ–¹æ³•å’Œç±»å‹çš„åå°„ Go çš„åå°„åŒ…ä¸­æ¯”è¾ƒé‡è¦å’Œå¸¸ç”¨çš„æœ‰ä¸‰ä¸ªç±»å‹ï¼šKindï¼ŒTypeï¼ŒValueï¼Œå…¶ä¸­ Typeç”¨æ¥è¡¨ç¤ºä¸€ä¸ªGoç±»å‹ï¼ŒValueä¸ºGoå€¼æä¾›äº†åå°„æ¥å£ã€‚ reflect.TypeOf å’Œ reflect.ValueOf åˆ†åˆ«æ˜¯å®šä¹‰åœ¨è¿™ä¸¤è€…ä¹‹ä¸Šçš„æ–¹æ³•ï¼Œå‡½æ•°åŸå‹å¦‚ä¸‹ func TypeOf(i interface{}) Type func ValueOf(i interface{}) Value å…¶æœ¬è´¨æ˜¯æ£€æŸ¥æ¥å£çš„åŠ¨æ€ç±»å‹å’ŒåŠ¨æ€å€¼ï¼Œä¸€èˆ¬ç”¨æ¥è¿”å›è¢«æ£€æŸ¥å¯¹è±¡çš„ç±»å‹å’Œå€¼ã€‚ä¾‹å¦‚ï¼Œxè¢«å®šä¹‰ä¸ºvar x float64 = 3.4ï¼Œé‚£ä¹ˆreflect.TypeOf(x)è¿”å›type: float64ï¼Œreflect.ValueOf(x)è¿”å›value: 3.4 å› æ­¤ï¼Œä½¿ç”¨ValueOfè½¬æ¢è·å¾—çš„å€¼ï¼Œä¾ç„¶æ‹¥æœ‰è‡ªå·±çš„ç±»å‹å’Œå€¼ï¼Œåå°„åŒ…çš„Valueæœ‰ä¸å°‘æ–¹æ³•éƒ½å¯ä»¥ä½œç”¨äºå®ƒï¼Œæ¯”å¦‚kindæ–¹æ³•è¿”å›ä¸€ä¸ªå¸¸é‡æ¥è¡¨ç¤ºç±»å‹ï¼ŒTypeæ–¹æ³•ä¹Ÿè¿”å›å€¼çš„ç±»å‹ï¼ŒIntå’ŒFloatç­‰æ–¹æ³•å¯ä»¥è·å–å­˜å‚¨åœ¨å†…éƒ¨çš„å€¼ï¼ŒInterfaceæ–¹æ³•å¯ä»¥è¿˜åŸæ¥å£å€¼ã€‚ç¤ºä¾‹å¦‚ä¸‹ package main import ( \"fmt\" \"reflect\" ) func main() { var x float64 = 3.4 fmt.Println(\"type:\", reflect.TypeOf(x)) v := reflect.ValueOf(x) fmt.Println(\"value:\", v) fmt.Println(\"type:\", v.Type()) fmt.Println(\"kind:\", v.Kind()) fmt.Println(\"value:\", v.Float()) fmt.Println(v.Interface()) fmt.Printf(\"value is %5.2e\\n\", v.Interface()) y := v.Interface().(float64) fmt.Println(y) } //Output: type: float64 value: 3.4 type: float64 kind: float64 value: 3.4 3.4 value is 3.40e+00 3.4 ç”±äºxæ˜¯ä¸€ä¸ªfloat64ç±»å‹çš„å€¼ï¼Œå› æ­¤ä½¿ç”¨v.Float()è·å–å®ƒçš„å®é™…å€¼ï¼Œå…¶å®ƒç±»å‹çš„å€¼å¯ä»¥ä½¿ç”¨Int(), Bool(), Complex, String() Kindæ–¹æ³•æ€»æ˜¯è¿”å›åº•å±‚ç±»å‹ï¼Œå¦‚ type MyInt int var m MyInt = 5 v := reflect.ValueOf(m) v.Kind()å°†è¿”å›reflect.Int ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:2:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 é€šè¿‡åå°„ä¿®æ”¹å€¼ æ— è®ºå¦‚ä½•ï¼Œåˆ©ç”¨åå°„ä¿®æ”¹å€¼æ€»æ˜¯åº”è¯¥æä¸ºè°¨æ…çš„ï¼Œè€Œä¸”ï¼Œä¸æ˜¯æ‰€æœ‰çš„åå°„å€¼éƒ½å¯ä»¥ä¿®æ”¹ï¼Œæ˜¯å¦å¯ä¿®æ”¹å¯é€šè¿‡CanSet()æ–¹æ³•æ£€æµ‹ã€‚v := reflect.ValueOf(x)å‡½æ•°ä¼ é€’äº†ä¸€ä¸ªxçš„æ‹·è´ï¼Œå¯¹æ‹·è´çš„ä¿®æ”¹æ— æ³•å½±å“åŸå€¼ï¼Œå› æ­¤ï¼Œè‹¥æƒ³ä¿®æ”¹åŸå€¼ï¼Œåº”ä¼ é€’æŒ‡é’ˆï¼Œv = reflect.ValueOf(\u0026x)ã€‚æ­¤æ—¶vçš„ç±»å‹æ˜¯*float64ï¼Œä½†ä¾ç„¶ä¸å¯ä¿®æ”¹ï¼Œè¿˜éœ€è¦æœ€åä¸€æ­¥ï¼Œä½¿ç”¨Elem()æ–¹æ³•ï¼Œè‡³æ­¤æ‰èƒ½ä½¿ç”¨SetFloat()ä¿®æ”¹åŸå€¼ï¼Œä¸€ä¸ªå®Œæ•´çš„ä¾‹å­å¦‚ä¸‹ package main import ( \"fmt\" \"reflect\" ) func main() { var x float64 = 3.4 v := reflect.ValueOf(x) // setting a value: // v.SetFloat(3.1415) // Error: will panic: reflect.Value.SetFloat using unaddressable value fmt.Println(\"settability of v:\", v.CanSet()) v = reflect.ValueOf(\u0026x) // Note: take the address of x. fmt.Println(\"type of v:\", v.Type()) fmt.Println(\"settability of v:\", v.CanSet()) v = v.Elem() fmt.Println(\"The Elem of v is: \", v) fmt.Println(\"settability of v:\", v.CanSet()) v.SetFloat(3.1415) // this works! fmt.Println(v.Interface()) fmt.Println(v) } //Output: settability of v: false type of v: *float64 settability of v: false The Elem of v is: \u003cfloat64 Value\u003e settability of v: true 3.1415 \u003cfloat64 Value\u003e ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:2:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 ç»“æ„ä½“çš„åå°„ å¯¹ç»“æ„ä½“è¿›è¡Œåå°„ï¼Œéœ€è¦ä½¿ç”¨NumField()æ–¹æ³•è¿”å›ç»“æ„å†…çš„å­—æ®µæ•°é‡ï¼Œç„¶åé€šè¿‡forå¾ªç¯ç”¨ç´¢å¼•è·å¾—æ¯ä¸ªå­—æ®µçš„å€¼Field(i)ï¼Œæœ€åå¯ä»¥ä½¿ç”¨ç´¢å¼•è°ƒç”¨ç­¾ååœ¨ç»“æ„ä½“ä¸Šçš„æ–¹æ³•ï¼šMethod(i).Call(nil) package main import ( \"fmt\" \"reflect\" ) type NotknownType struct { s1, s2, s3 string } func (n NotknownType) String() string { return n.s1 + \" - \" + n.s2 + \" - \" + n.s3 } // variable to investigate: var secret interface{} = NotknownType{\"Ada\", \"Go\", \"Oberon\"} func main() { value := reflect.ValueOf(secret) // \u003cmain.NotknownType Value\u003e typ := reflect.TypeOf(secret) // main.NotknownType // alternative: //typ := value.Type() // main.NotknownType fmt.Println(typ) knd := value.Kind() // struct fmt.Println(knd) // iterate through the fields of the struct: for i := 0; i \u003c value.NumField(); i++ { fmt.Printf(\"Field %d: %v\\n\", i, value.Field(i)) // error: panic: reflect.Value.SetString using value obtained using unexported field //value.Field(i).SetString(\"C#\") } // call the first method, which is String(): results := value.Method(0).Call(nil) fmt.Println(results) // [Ada - Go - Oberon] } //Output: main.NotknownType struct Field 0: Ada Field 1: Go Field 2: Oberon [Ada - Go - Oberon] ä½†æ˜¯å°è¯•ä¿®æ”¹ä¼šå¾—åˆ°é”™è¯¯ï¼Œç»“æ„ä½“ä¸­åªæœ‰è¢«å¯¼å‡ºå­—æ®µæ‰æ˜¯å¯è®¾ç½®çš„ã€‚ ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:2:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. æ€»ç»“ï¼šé¢å‘å¯¹è±¡ é¢å‘å¯¹è±¡æœ€é‡è¦çš„ä¸‰ä¸ªæ–¹é¢ï¼šå°è£…ã€ç»§æ‰¿å’Œå¤šæ€ï¼Œåœ¨Goä¸­éƒ½å¯ä»¥å¯»æ‰¾åˆ°æ›¿ä»£çš„å®ç°æ–¹å¼ å°è£…(æ•°æ®éšè—)ï¼šå³Goä¸­çš„å¯è§æ€§è§„åˆ™ï¼Œä¸åŒäºåˆ«çš„OOè¯­è¨€ä¸­çš„4ç§è®¿é—®æ€§ï¼ŒGoåªæœ‰ä¸¤ç§ ç»§æ‰¿ï¼š ç”¨ç»„åˆæˆ–å†…åµŒå®ç°ï¼Œç»“æ„ä½“ä¸€ç¯‡ä¸­è°ˆåˆ°è¿‡è¿™ä¸ªã€‚ å¤šæ€ï¼šç”¨æ¥å£å®ç°ã€‚æŸä¸ªç±»å‹çš„å®ä¾‹å¯ä»¥èµ‹ç»™å®ƒæ‰€å®ç°çš„ä»»æ„æ¥å£ç±»å‹çš„å˜é‡ã€‚ç±»å‹å’Œæ¥å£æ˜¯æ¾è€¦åˆçš„ï¼Œå¹¶ä¸”å¤šé‡ç»§æ‰¿å¯ä»¥é€šè¿‡å®ç°å¤šä¸ªæ¥å£å®ç°ã€‚Go æ¥å£ä¸æ˜¯ Java å’Œ C# æ¥å£çš„å˜ä½“ï¼Œè€Œä¸”æ¥å£é—´æ˜¯ä¸ç›¸å…³çš„ï¼Œå¹¶ä¸”æ˜¯å¤§è§„æ¨¡ç¼–ç¨‹å’Œå¯é€‚åº”çš„æ¼”è¿›å‹è®¾è®¡çš„å…³é”® ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:3:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.1 ç»„åˆå®ç°ç»§æ‰¿ ç»„åˆçš„å«ä¹‰æ˜¯åŒ…å«æ‰€éœ€åŠŸèƒ½çš„å…·åå­—æ®µ package main import ( \"fmt\" ) type Log struct { msg string } type Customer struct { Name string log *Log } func main() { c := new(Customer) c.Name = \"Barak Obama\" c.log = new(Log) c.log.msg = \"1 - Yes we can!\" // shorter c = \u0026Customer{\"Barak Obama\", \u0026Log{\"1 - Yes we can!\"}} // fmt.Println(c) \u0026{Barak Obama 1 - Yes we can!} c.Log().Add(\"2 - After me the world will be a better place!\") //fmt.Println(c.log) fmt.Println(c.Log()) } func (l *Log) Add(s string) { l.msg += \"\\n\" + s } func (l *Log) String() string { return l.msg } func (c *Customer) Log() *Log { return c.log } //Output: 1 - Yes we can! 2 - After me the world will be a better place! ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:3:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.2 å†…åµŒå®ç°ç»§æ‰¿ å†…åµŒçš„å«ä¹‰æ˜¯åŒ¿åçš„å®ç°æ‰€éœ€åŠŸèƒ½ package main import ( \"fmt\" ) type Log struct { msg string } type Customer struct { Name string Log } func main() { c := \u0026Customer{\"Barak Obama\", Log{\"1 - Yes we can!\"}} c.Add(\"2 - After me the world will be a better place!\") fmt.Println(c) } func (l *Log) Add(s string) { l.msg += \"\\n\" + s } func (l *Log) String() string { return l.msg } func (c *Customer) String() string { return c.Name + \"\\nLog:\" + fmt.Sprintln(c.Log) } //Output: Barak Obama Log:{1 - Yes we can! 2 - After me the world will be a better place!} å†…åµŒçœ‹èµ·æ¥æ›´ç®€å•ä¸€ç‚¹ï¼Œå› æ­¤æœ€åˆé€‚çš„åŠæ³•å°±æ˜¯åˆ©ç”¨å†…åµŒåˆ›å»ºä¸€äº›å°çš„ã€å¯å¤ç”¨çš„ç±»å‹ä½œä¸ºå·¥å…·ç®±ï¼Œæ¥è¢«å…¶å®ƒç±»å‹è°ƒç”¨ã€‚ ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:3:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.3 å¤šé‡ç»§æ‰¿ package main import ( \"fmt\" ) type Camera struct{} func (c *Camera) TakeAPicture() string { return \"Click\" } type Phone struct{} func (p *Phone) Call() string { return \"Ring Ring\" } type CameraPhone struct { Camera Phone } func main() { cp := new(CameraPhone) fmt.Println(\"Our new CameraPhone exhibits multiple behaviors...\") fmt.Println(\"It exhibits behavior of a Camera: \", cp.TakeAPicture()) fmt.Println(\"It works like a Phone too: \", cp.Call()) } //Output: Our new CameraPhone exhibits multiple behaviors... It exhibits behavior of a Camera: Click It works like a Phone too: Ring Ring ","date":"2019-11-26","objectID":"/2019/golang-syntax-9-interface-and-reflect/:3:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€9-æ¥å£ä¸åå°„","uri":"/2019/golang-syntax-9-interface-and-reflect/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. å‡½æ•°å£°æ˜ä¸å®šä¹‰ Goä¸­æœ‰ä¸‰ç§ç±»å‹çš„å‡½æ•°ï¼š æ™®é€šçš„å¸¦æœ‰åå­—çš„å‡½æ•° åŒ¿åå‡½æ•° æ–¹æ³•ï¼ˆMethodsï¼Œåœ¨ç»“æ„ä½“éƒ¨åˆ†ä»‹ç»ï¼‰ æ™®é€šå‡½æ•°å£°æ˜çš„åŸºæœ¬æ ¼å¼ä¸º func functionName(param1 type1, param2 type2,...) (ret1 type1, ret2 type2,...) å®šä¹‰å°±éœ€è¦æ·»åŠ å¤§æ‹¬å·å’Œå‡½æ•°ä½“ func functionName(param1 type1, param2 type2,...) (ret1 type1, ret2 type2,...) { ... } ä¸¤ä¸ªæ‹¬å·ä¸­åˆ†åˆ«ä¸ºå‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼åˆ—è¡¨ï¼Œå‚æ•°ä¸ªæ•°å’Œè¿”å›å€¼ä¸ªæ•°å…è®¸ä¸º0ã€‚å·¦å¤§æ‹¬å·å¿…é¡»ä¸å£°æ˜è¯­å¥åœ¨åŒä¸€è¡Œï¼Œæµç¨‹æ§åˆ¶éƒ¨åˆ†å·²ç»è§è¿‡è¿™ä¸ªè§„å®šï¼Œè¿™æ˜¯ç¼–è¯‘å™¨å¼ºåˆ¶è§„å®šã€‚ å½“å‡½æ•°æ‰§è¡Œåˆ°ä»£ç å—æœ€åä¸€è¡Œï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€ä¸ª}ä¹‹å‰ï¼Œæˆ–è€…æ‰§è¡Œåˆ°returnè¯­å¥çš„æ—¶å€™å°±ä¼šé€€å‡ºã€‚ mainå‡½æ•°æ˜¯æ¯ä¸ªç¨‹åºå¿…é¡»åŒ…å«çš„ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯å¯åŠ¨åç¬¬ä¸€ä¸ªæ‰§è¡Œçš„å‡½æ•°ï¼Œä½†å¦‚æœæœ‰init()å‡½æ•°ä¼šå…ˆæ‰§è¡Œè¯¥å‡½æ•°ã€‚ mainå‡½æ•°æ—¢æ²¡æœ‰å‚æ•°ï¼Œä¹Ÿæ²¡æœ‰è¿”å›å€¼ï¼Œå¦‚æœæ·»åŠ äº†ä¸¤è€…ä¸­ä»»ä¸€è€…ï¼Œéƒ½ä¼šå¼•å‘æ„å»ºé”™è¯¯ã€‚mainå‡½æ•°ä¸€æ—¦è¿”å›å°±è¡¨ç¤ºç¨‹åºå·²æˆåŠŸæ‰§è¡Œå¹¶ç«‹å³é€€å‡ºã€‚åŒæ ·ï¼Œinit()å‡½æ•°ä¹Ÿæ²¡æœ‰è¿”å›å€¼ ","date":"2019-11-25","objectID":"/2019/golang-syntax-7-function/:1:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€7-å‡½æ•°","uri":"/2019/golang-syntax-7-function/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. å‡½æ•°è°ƒç”¨ åŒä¸€ä¸ªåŒ…å†…ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å‡½æ•°åè°ƒç”¨è¯¥å‡½æ•°ï¼Œä¸åŒåŒ…å†…ï¼Œéœ€è¦æ·»åŠ åŒ…åï¼Œå¦‚ä¸‹æ‰€ç¤º pack1.functionName(arg1, arg2, ..., argn) pack1æ˜¯åŒ…åï¼ŒfunctionNameæ˜¯è¯¥åŒ…ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œæ‹¬å·é‡Œæ˜¯ä¼ å…¥çš„å®å‚ã€‚ä¸€ä¸ªç®€å•çš„è°ƒç”¨å…¶å®ƒå‡½æ•°çš„ä¾‹å­å¦‚ä¸‹ package main func main() { println(\"In main before calling greeting\") greeting() println(\"In main after calling greeting\") } func greeting() { println(\"In greeting: Hi!!!!!\") } //Output: In main before calling greeting In greeting: Hi!!!!! In main after calling greeting Goä¸­ä¸å…è®¸å‡½æ•°é‡è½½ ","date":"2019-11-25","objectID":"/2019/golang-syntax-7-function/:2:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€7-å‡½æ•°","uri":"/2019/golang-syntax-7-function/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. å‡½æ•°å‚æ•°ä¸è¿”å›å€¼ é™¤äº†mian()å’Œinit()å‡½æ•°å¤–ï¼Œå…¶å®ƒå‡½æ•°éƒ½å¯ä»¥æ‹¥æœ‰å‚æ•°å’Œè¿”å›å€¼ã€‚è€Œä¸”ä»»æ„ä¸€ä¸ªæœ‰è¿”å›å€¼çš„å‡½æ•°éƒ½å¿…é¡»ä»¥returnæˆ–panicè¯­å¥ç»“å°¾ï¼Œreturnå¯ä»¥è¿”å›å¤šä¸ªå€¼ï¼Œå¤šå€¼è¿”å›æ˜¯Goçš„ä¸€å¤§ç‰¹æ€§ã€‚ ","date":"2019-11-25","objectID":"/2019/golang-syntax-7-function/:3:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€7-å‡½æ•°","uri":"/2019/golang-syntax-7-function/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.1 å‚æ•°ä¼ é€’ç±»å‹ Goä¸­çš„å‚æ•°ä¼ é€’ç±»å‹æœ‰ä¸¤ç§ï¼šæŒ‰å€¼ä¼ é€’å’ŒæŒ‰å¼•ç”¨ä¼ é€’ã€‚ Goé»˜è®¤ä½¿ç”¨æŒ‰å€¼ä¼ é€’æ¥ä¼ é€’å‚æ•°ï¼Œä¹Ÿå°±æ˜¯ä¼ é€’å‚æ•°çš„å‰¯æœ¬ï¼Œå› æ­¤å‚æ•°åœ¨å‡½æ•°ä¸­è¢«æ›´æ”¹åä¸ä¼šå½±å“åŸå€¼ã€‚å¦‚æœå¸Œæœ›å‡½æ•°è¿è¡Œçš„åŒæ—¶æ”¹å˜åŸå˜é‡çš„å€¼ï¼Œåº”è¯¥æ·»åŠ å–åœ°å€ç¬¦\u0026ï¼Œä¼ é€’å˜é‡çš„æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯æŒ‰å¼•ç”¨ä¼ é€’ï¼ŒæŒ‰å¼•ç”¨ä¼ é€’æ—¶ï¼Œä¼ å…¥çš„æ˜¯æŒ‡é’ˆçš„å‰¯æœ¬ï¼Œä½†æŒ‡å‘çš„å€¼ä¾ç„¶æ˜¯åŸå˜é‡ã€‚ å‡½æ•°è°ƒç”¨æ—¶ï¼Œåˆ‡ç‰‡ã€æ˜ å°„ã€æ¥å£ã€é€šé“è¿™äº›å¼•ç”¨ç±»å‹é»˜è®¤ä½¿ç”¨æŒ‰å¼•ç”¨ä¼ é€’ å‡ ä¹åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼ŒæŒ‰å¼•ç”¨ä¼ é€’çš„æ¶ˆè€—éƒ½æ¯”æŒ‰å€¼ä¼ é€’å° æŒ‰å¼•ç”¨ä¼ é€’å¯ä»¥ç›´æ¥ä¿®æ”¹å¤–éƒ¨å˜é‡çš„å€¼ï¼Œå› æ­¤è¢«ä¿®æ”¹çš„å˜é‡ä¸å†éœ€è¦ä½¿ç”¨returnè¿”å› ","date":"2019-11-25","objectID":"/2019/golang-syntax-7-function/:3:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€7-å‡½æ•°","uri":"/2019/golang-syntax-7-function/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.2 å‘½åå‚æ•° å‡½æ•°å®šä¹‰æ—¶ï¼Œå½¢å‚ä¸€èˆ¬éƒ½æœ‰åå­—ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥å®šä¹‰æ²¡æœ‰å½¢å‚åçš„å‡½æ•°ï¼Œåªæœ‰å½¢å‚ç±»å‹ï¼Œæ¯”å¦‚func f(int, int, float64)ï¼Œè¿”å›å€¼åŒæ ·å¦‚æ­¤ã€‚åªæœ‰ç±»å‹çš„è¿”å›å€¼ç§°ä¸ºéå‘½åè¿”å›å€¼ï¼Œæœ‰åå­—çš„è¿”å›å€¼ç§°ä¸ºå‘½åè¿”å›å€¼ã€‚ä¸€ä¸ªä¾‹å­å¦‚ä¸‹ package main import \"fmt\" var num int = 10 var numx2, numx3 int func main() { numx2, numx3 = getX2AndX3(num) PrintValues() numx2, numx3 = getX2AndX3_2(num) PrintValues() } func PrintValues() { fmt.Printf(\"num = %d, 2x num = %d, 3x num = %d\\n\", num, numx2, numx3) } func getX2AndX3(input int) (int, int) { return 2 * input, 3 * input } func getX2AndX3_2(input int) (x2 int, x3 int) { x2 = 2 * input x3 = 3 * input // return x2, x3 return } //Output: num = 10, 2x num = 20, 3x num = 30 num = 10, 2x num = 20, 3x num = 30 å‘½åè¿”å›å€¼ä¼šè¢«åˆå§‹åŒ–ä¸ºç›¸åº”ç±»å‹çš„é›¶å€¼ï¼Œè¿”å›æ—¶åªéœ€è¦ä¸€æ¡ç®€å•çš„ä¸å¸¦å‚æ•°çš„returnè¯­å¥ï¼ˆå¸¦å‚æ•°ä¹Ÿä¸ä¼šå‡ºé”™ï¼‰ã€‚ å½“éœ€è¦è¿”å›å¤šä¸ªéå‘½åè¿”å›å€¼æ—¶ï¼Œéœ€è¦ä½¿ç”¨æ‹¬å·åŒ…å›´ï¼Œå¦‚(int, int)ï¼Œä½†å¯¹å‘½åè¿”å›å€¼ï¼Œå³ä½¿åªæœ‰ä¸€ä¸ªè¿”å›å€¼ï¼Œä¹Ÿè¦ç”¨æ‹¬å·åŒ…å›´ã€‚ ","date":"2019-11-25","objectID":"/2019/golang-syntax-7-function/:3:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€7-å‡½æ•°","uri":"/2019/golang-syntax-7-function/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.3 ç©ºç™½ç¬¦ ç©ºç™½ç¬¦_ç”¨æ¥åŒ¹é…ä¸éœ€è¦çš„è¿”å›å€¼ï¼Œç„¶åä¸¢å¼ƒæ‰ï¼Œä¹‹å‰å·²ç»ä»‹ç»è¿‡ã€‚ ","date":"2019-11-25","objectID":"/2019/golang-syntax-7-function/:3:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€7-å‡½æ•°","uri":"/2019/golang-syntax-7-function/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.4 å˜é•¿å‚æ•° å¦‚æœå‡½æ•°æœ€åä¸€ä¸ªå‚æ•°æ˜¯...typeçš„å½¢å¼ï¼Œé‚£ä¹ˆå‡½æ•°å°±å¯ä»¥å¤„ç†ä¸€ä¸ªå˜é•¿çš„å‚æ•°ï¼Œè¿™ä¸ªé•¿åº¦å¯ä»¥æ˜¯0ï¼Œè¿™æ ·çš„å‡½æ•°ç§°ä¸ºå˜å‚å‡½æ•° func myFunc(a, b, arg ...int) {} å˜é•¿å‚æ•°çš„æœ¬è´¨æ˜¯ä¸€ä¸ªåˆ‡ç‰‡ï¼Œå¦‚ä¸‹ä¾‹ func Greeting(prefix string, who ...string) Greeting(\"hello:\", \"Joe\", \"Anna\", \"Eileen\") å˜é‡whoçš„å€¼ä¸º []string{\"Joe\", \"Anna\", \"Eileen\"} å¦‚æœå‚æ•°æœ¬èº«å°±å­˜åœ¨ä¸€ä¸ªåˆ‡ç‰‡ç±»å‹ä¸­ï¼Œæ¯”å¦‚åˆ‡ç‰‡slice1ï¼Œåˆ™å¯ä»¥é€šè¿‡slice1...çš„å½¢å¼ä¼ é€’å‚æ•°ï¼Œä¹‹å‰çš„åˆ‡ç‰‡éƒ¨åˆ†ä½¿ç”¨appendå‡½æ•°æ—¶å·²ç»è¿™æ ·ä½¿ç”¨è¿‡ package main import \"fmt\" func main() { x := min(1, 3, 2, 0) fmt.Printf(\"The minimum is: %d\\n\", x) slice := []int{7,9,3,5,1} x = min(slice...) fmt.Printf(\"The minimum in the slice is: %d\", x) } func min(s ...int) int { if len(s)==0 { return 0 } min := s[0] for _, v := range s { if v \u003c min { min = v } } return min } //Output: The minimum is: 0 The minimum in the slice is: 1 ä¸€ä¸ªæ¥å—å˜é•¿å‚æ•°çš„å‡½æ•°å¯ä»¥å°†è¿™ä¸ªå‚æ•°ä½œä¸ºå…¶å®ƒå‡½æ•°çš„å‚æ•°è¿›è¡Œä¼ é€’ func F1(s ...string) { F2(s...) F3(s) } func F2(s ...string) { } func F3(s []string) { } ","date":"2019-11-25","objectID":"/2019/golang-syntax-7-function/:3:4","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€7-å‡½æ•°","uri":"/2019/golang-syntax-7-function/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.5 å‡½æ•°ä½œä¸ºå‚æ•° å‡½æ•°å¯ä»¥ä½œä¸ºå…¶å®ƒå‡½æ•°çš„å‚æ•°è¿›è¡Œä¼ é€’ï¼Œç„¶ååœ¨å…¶å®ƒå‡½æ•°å†…è°ƒç”¨æ‰§è¡Œï¼Œåªè¦å‡½æ•°è¿”å›å€¼ä¸ªæ•°ã€è¿”å›å€¼ç±»å‹å’Œè¿”å›å€¼é¡ºåºåŒè°ƒç”¨å‡½æ•°çš„å½¢å‚åˆ—è¡¨å®šä¹‰ç›¸åŒï¼Œç§°ä¹‹ä¸ºå›è°ƒã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå°†å‡½æ•°ä½œä¸ºå‚æ•°çš„ç®€å•ä¾‹å­ package main import ( \"fmt\" ) func main() { callback(1, Add) } func Add(a, b int) { fmt.Printf(\"The sum of %d and %d is: %d\\n\", a, b, a+b) } func callback(y int, f func(int, int)) { f(y, 2) // this becomes Add(1, 2) } //Output: The sum of 1 and 2 is: 3 ","date":"2019-11-25","objectID":"/2019/golang-syntax-7-function/:3:5","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€7-å‡½æ•°","uri":"/2019/golang-syntax-7-function/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. å†…ç½®å‡½æ•° Goè¯­è¨€æ‹¥æœ‰ä¸€äº›ä¸éœ€è¦å¯¼å…¥å°±å¯ä»¥ä½¿ç”¨çš„å†…ç½®å‡½æ•°ï¼Œä¹‹å‰å·²ç»æ¥è§¦è¿‡ä¸€äº›ï¼Œæ¯”å¦‚len, cap, appendï¼Œä»¥ä¸‹æ˜¯å†…ç½®å‡½æ•°åˆ—è¡¨ åç§° è¯´æ˜ close ç”¨äºç®¡é“é€šä¿¡ lenã€cap len ç”¨äºè¿”å›æŸä¸ªç±»å‹çš„é•¿åº¦æˆ–æ•°é‡ï¼ˆå­—ç¬¦ä¸²ã€æ•°ç»„ã€åˆ‡ç‰‡ã€map å’Œç®¡é“ï¼‰ï¼›cap æ˜¯å®¹é‡çš„æ„æ€ï¼Œç”¨äºè¿”å›æŸä¸ªç±»å‹çš„æœ€å¤§å®¹é‡ï¼ˆåªèƒ½ç”¨äºåˆ‡ç‰‡å’Œ mapï¼‰ newã€make new å’Œ make å‡æ˜¯ç”¨äºåˆ†é…å†…å­˜ï¼šnew ç”¨äºå€¼ç±»å‹å’Œç”¨æˆ·å®šä¹‰çš„ç±»å‹ï¼Œå¦‚è‡ªå®šä¹‰ç»“æ„ï¼Œmake ç”¨äºå†…ç½®å¼•ç”¨ç±»å‹ï¼ˆåˆ‡ç‰‡ã€map å’Œç®¡é“ï¼‰ã€‚å®ƒä»¬çš„ç”¨æ³•å°±åƒæ˜¯å‡½æ•°ï¼Œä½†æ˜¯å°†ç±»å‹ä½œä¸ºå‚æ•°ï¼šnew(type)ã€make(type)ã€‚new(T) åˆ†é…ç±»å‹ T çš„é›¶å€¼å¹¶è¿”å›å…¶åœ°å€ï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘ç±»å‹ T çš„æŒ‡é’ˆã€‚å®ƒä¹Ÿå¯ä»¥è¢«ç”¨äºåŸºæœ¬ç±»å‹ï¼šv := new(int)ã€‚make(T) è¿”å›ç±»å‹ T çš„åˆå§‹åŒ–ä¹‹åçš„å€¼ï¼Œå› æ­¤å®ƒæ¯” new è¿›è¡Œæ›´å¤šçš„å·¥ä½œ copyã€append ç”¨äºå¤åˆ¶å’Œè¿æ¥åˆ‡ç‰‡ panicã€recover ä¸¤è€…å‡ç”¨äºé”™è¯¯å¤„ç†æœºåˆ¶ printã€println åº•å±‚æ‰“å°å‡½æ•°ï¼Œåœ¨éƒ¨ç½²ç¯å¢ƒä¸­å»ºè®®ä½¿ç”¨ fmt åŒ… complexã€real imag ç”¨äºåˆ›å»ºå’Œæ“ä½œå¤æ•° ","date":"2019-11-25","objectID":"/2019/golang-syntax-7-function/:4:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€7-å‡½æ•°","uri":"/2019/golang-syntax-7-function/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"5. åŒ¿åå‡½æ•°ä¸é—­åŒ… åŒ¿åå‡½æ•°æ˜¯ç±»ä¼¼ func(x, y int) int { return x + y } è¿™æ ·æ²¡æœ‰åå­—çš„å‡½æ•°ã€‚ åŒ¿åå‡½æ•°å¯ä»¥è¢«ç›´æ¥è°ƒç”¨ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªè®¡ç®—ä» 1 åˆ° 1 ç™¾ä¸‡æ•´æ•°çš„æ€»å’Œçš„åŒ¿åå‡½æ•°ã€‚è¡¨ç¤ºå‚æ•°åˆ—è¡¨çš„ç¬¬ä¸€å¯¹æ‹¬å·å¿…é¡»ç´§æŒ¨ç€å…³é”®å­— funcï¼Œå› ä¸ºåŒ¿åå‡½æ•°æ²¡æœ‰åç§°ã€‚èŠ±æ‹¬å· {} æ¶µç›–ç€å‡½æ•°ä½“ï¼Œæœ€åçš„ä¸€å¯¹æ‹¬å·è¡¨ç¤ºå¯¹è¯¥åŒ¿åå‡½æ•°çš„è°ƒç”¨ã€‚ func() { sum := 0 for i := 1; i \u003c= 1e6; i++ { sum += i } }() å¦å¤–ï¼ŒåŒ¿åå‡½æ•°å¯ä»¥åƒå…¶å®ƒå‡½æ•°ä¸€æ ·æ¥å—å‚æ•°ï¼Œä¸‹ä¾‹å±•ç¤ºäº†å¦‚ä½•ä¼ é€’å‚æ•°åˆ°åŒ¿åå‡½æ•°ä¸­ func (u string) { fmt.Println(u) â€¦ }(v) è¿˜åº”è¯¥çŸ¥é“çš„ï¼ŒåŒ¿åå‡½æ•°å¯ä»¥è¢«èµ‹å€¼ç»™æŸä¸ªå˜é‡ï¼Œå¦‚fplus := func(x, y int) int { return x + y }ï¼Œè¿™æ ·å‡½æ•°çš„åœ°å€å°±ä¿å­˜åˆ°äº†å˜é‡ä¸­ï¼Œä¹‹åå¯ä»¥é€šè¿‡å˜é‡åå¯¹å‡½æ•°è¿›è¡Œè°ƒç”¨ï¼šfplus(3, 4) æ‰€è°“é—­åŒ…å°±æ˜¯å‡½æ•°åŠå…¶å¼•ç”¨ç¯å¢ƒçš„ç»„åˆï¼Œè¿™ä¹ˆè¯´æ¯”è¾ƒéš¾ç†è§£ï¼Œä¸¾ä¸ªä¾‹å­ func f(i int) func() int { return func() int { i++ return i } } åœ¨è¿™é‡Œä¾‹å­é‡Œï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æœ¬èº«æ²¡æœ‰å®šä¹‰å˜é‡ï¼Œè€Œæ˜¯å¼•ç”¨äº†å®ƒæ‰€åœ¨ç¯å¢ƒçš„å˜é‡ iï¼Œè¿™å°±å½¢æˆäº†ä¸€ä¸ªé—­åŒ…ã€‚ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œé—­åŒ…ä¸åŒ¿åå‡½æ•°æ¯æ¯ç›¸å…³ï¼Œå› ä¸ºåŒ¿åå‡½æ•°è¢«ç”¨ä½œå‡½æ•°è¿”å›å€¼éå¸¸åˆé€‚ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ package main import \"fmt\" func main() { var f = Adder() fmt.Print(f(1), \" - \") fmt.Print(f(20), \" - \") fmt.Print(f(300)) } func Adder() func(int) int { var x int return func(delta int) int { x += delta return x } } //Output: 1 - 21 - 321 ä»è¿™é‡Œä¾‹å­ä¸­æˆ‘ä»¬æ³¨æ„åˆ° x çš„å€¼æ˜¯ä¸æ–­ç´¯åŠ çš„ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€é—­åŒ…å‡½æ•°å…¶å®ä¼šä¿å­˜å¹¶ç§¯ç´¯å…¶ä¸­çš„å˜é‡çš„å€¼ï¼Œä¸ç®¡å¤–éƒ¨å‡½æ•°é€€å‡ºä¸å¦ï¼Œå®ƒéƒ½èƒ½å¤Ÿç»§ç»­æ“ä½œå¤–éƒ¨å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡ã€‚ è¿™é‡Œå¯ä»¥ç†è§£ä¸ºå‡½æ•°è¢«èµ‹å€¼ç»™ f ä¹‹åï¼Œå…¶å®å°†æ•´ä¸ªé—­åŒ…åŒ…æ‹¬ç¯å¢ƒéƒ½èµ‹å€¼ç»™äº† fï¼Œå˜é‡ f çš„ç”Ÿå­˜å‘¨æœŸå†…ï¼Œå…¶å€¼æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥ç»“æœæ‰ä¼šç´¯ç§¯ã€‚ è¿™ç§è¿”å›å€¼ä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„å‡½æ•°çš„å½¢å¼ä¹Ÿè¢«ç§°ä¹‹ä¸ºå·¥å‚å‡½æ•°ï¼Œåœ¨éœ€è¦åˆ›å»ºä¸€ç³»åˆ—ç›¸ä¼¼çš„å‡½æ•°çš„æ—¶å€™éå¸¸æœ‰ç”¨ã€‚ä¸‹é¢çš„å‡½æ•°æ¼”ç¤ºäº†å¦‚ä½•åŠ¨æ€è¿”å›è¿½åŠ åç¼€çš„å‡½æ•°ï¼š func MakeAddSuffix(suffix string) func(string) string { return func(name string) string { if !strings.HasSuffix(name, suffix) { return name + suffix } return name } } ç°åœ¨å¯ä»¥ç”Ÿæˆå¦‚ä¸‹å‡½æ•° addBmp := MakeAddSuffix(\".bmp\") addJpeg := MakeAddSuffix(\".jpeg\") ç„¶åè°ƒç”¨å®ƒä»¬ addBmp(\"file\") // returns: file.bmp addJpeg(\"file\") // returns: file.jpeg ","date":"2019-11-25","objectID":"/2019/golang-syntax-7-function/:5:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€7-å‡½æ•°","uri":"/2019/golang-syntax-7-function/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"6. deferå’Œè¿½è¸ª å…³é”®å­— defer æ˜¯ Go ä¸­ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç‰¹æ€§ï¼Œä½œç”¨æ˜¯å°†æŸä¸ªè¯­å¥æˆ–å‡½æ•°æ¨è¿Ÿåˆ°å‡½æ•°è¿”å›ä¹‹å‰æ‰§è¡Œã€‚å‡†ç¡®çš„è¯´ï¼Œdefer çš„æ‰§è¡Œæ—¶æœºæœ‰ä¸‰ç§ï¼š åŒ…å« defer è¯­å¥çš„å‡½æ•°è¿”å›å‰ åŒ…å« defer è¯­å¥çš„å‡½æ•°æ‰§è¡Œåˆ°æœ«å°¾ æ‰€åœ¨çš„ goroutine å‘ç”Ÿ panic æ—¶ ä¸€ä¸ªä¾‹å­å¦‚ä¸‹ func main() { defer fmt.Println(\"Fourth\") fmt.Println(\"First\") fmt.Println(\"Third\") } //Output: First Third Fourth defer è¯­å¥ä¸­è°ƒç”¨çš„å‡½æ•°å‚æ•°çš„å€¼åœ¨ defer è¯­å¥è¢«å®šä¹‰æ—¶å°±ç¡®å®šäº†ï¼Œå¦‚ä¸‹ä¾‹ i := 1 defer fmt.Println(\"Deferred print:\", i) i++ fmt.Println(\"Normal print:\", i) // Output: Normal print: 2 Deferred print: 1 ä½†ä¸åŒ¿åå‡½æ•°ç»“åˆèµ·æ¥åï¼Œå˜é‡çš„å€¼åœ¨å‡½æ•°è¿è¡Œæ—¶æ‰ä¼šç¡®å®š func f1() (r int) { r = 1 defer func() { r++ fmt.Println(r) }() r = 2 return } func main() { f1() } // Output: 3 ä¸Šä¾‹ä¸­å‡ºç°äº† return è¯­å¥ï¼Œdefer ä¸ return çš„æ‰§è¡Œé¡ºåºæ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œè¦å…ˆç†è§£ä¸¤ä»¶äº‹ defer å‡½æ•°æ‰§è¡Œæ—¶æœºæ˜¯å¤–å±‚å‡½æ•°è®¾ç½®è¿”å›å€¼ä¹‹åï¼Œå³å°†è¿”å›ä¹‹å‰ return xxx æ“ä½œå¹¶ä¸æ˜¯åŸå­çš„ ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ return 0 å®é™…ä¸Šå¯ä»¥æ‹†åˆ†ä¸º r = 0; return ä¸¤æ¡è¯­å¥ï¼Œå› æ­¤è¾“å‡ºæ˜¯1ä¸æ˜¯0 func f1() (r int) { defer func() { r++ }() return 0 } func main() { fmt.Println(f1()) } æ¥ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ func double(x int) int { return x + x } func triple(x int) (r int) { defer func() { r += x }() return double(x) } func main() { fmt.Println(triple(3)) } // Output: 9 ä¸Šé¢çš„ä¾‹å­å®é™…ä¸Šç­‰ä»·äº func triple(x int) (r int) { r = double(x) func() { r += x }() return } å¤šä¸ª defer åŒæ—¶ä½¿ç”¨æ—¶ï¼Œä»¥é€†åºæ‰§è¡Œï¼Œå³åè¿›å…ˆå‡º func f() { for i := 0; i \u003c 5; i++ { defer fmt.Printf(\"%d \", i) } } //Output: 4 3 2 1 0 defer å…³é”®å­—ä¸€èˆ¬ç”¨äºé‡Šæ”¾æŸäº›å·²åˆ†é…çš„èµ„æºæˆ–åœ¨å‡½æ•°æ‰§è¡Œå®Œè¿›è¡Œä¸€äº›æ”¶å°¾å·¥ä½œï¼Œæ¯”å¦‚ å…³é—­æ–‡ä»¶æµ //open a file defer file.Close() è§£é”ä¸€ä¸ªåŠ é”çš„èµ„æº mu.Lock() defer mu.Unlock() æ‰“å°æœ€ç»ˆæŠ¥å‘Š printHeader() defer printFooter() å…³é—­æ•°æ®åº“é“¾æ¥ //open a database connection defer disconnectFromDB() ","date":"2019-11-25","objectID":"/2019/golang-syntax-7-function/:6:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€7-å‡½æ•°","uri":"/2019/golang-syntax-7-function/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"7. ç¼–å†™è§„èŒƒ Goæ˜¯ç¼–è¯‘å‹çš„è¯­è¨€ï¼Œå› æ­¤å‡½æ•°çš„ç¼–å†™é¡ºåºæ— å…³ç´§è¦ï¼Œä½†é‰´äºå¯è¯»æ€§çš„éœ€æ±‚ï¼Œæœ€å¥½éµå¾ªä¸€å®šçš„ç¼–ç¨‹è§„èŒƒï¼Œæˆ‘è¿™é‡Œé‡‡ç”¨çš„æ˜¯Uberå¼€æºåœ¨githubçš„ç¼–ç è§„èŒƒï¼Œæœ‰ä¸¤æ¡ä¸»è¦è§„åˆ™ å‡½æ•°åº”æŒ‰ç²—ç•¥çš„è°ƒç”¨é¡ºåºæ’åº åŒä¸€æ–‡ä»¶ä¸­çš„å‡½æ•°åº”æŒ‰æ¥æ”¶è€…æ’åºï¼Œæ„å³å¯è¢«å¤–éƒ¨è®¿é—®çš„å‡½æ•°ï¼ˆå‚è€ƒå¯è§æ€§è§„åˆ™ï¼‰åº”æ”¾åœ¨å‰é¢ï¼Œæ™®é€šå·¥å…·å‡½æ•°æ”¾åœ¨åé¢ã€‚å¦å¤–ï¼Œåœ¨ç±»å‹å®šä¹‰ï¼ˆç»“æ„ä½“ã€æ¥å£ç­‰ï¼‰åï¼Œå¯è¢«å¤–éƒ¨è®¿é—®çš„å‡½æ•°å‰ï¼Œå¯èƒ½ä¼šå‡ºç°ç±»ä¼¼äºnewXYZ()è¿™æ ·çš„æ–°å»ºæŸä¸ªç±»å‹çš„å‡½æ•°ã€‚ä¸€ä¸ªç®€å•çš„ä¾‹å­å¦‚ä¸‹ type something struct{ ... } func newSomething() *something { return \u0026something{} } func (s *something) Cost() { return calcCost(s.weights) } func calcCost(n []int) int {...} æœ€åï¼Œmainå‡½æ•°æ”¾åœ¨æ‰€æœ‰å‡½æ•°çš„æœ€åã€‚ ","date":"2019-11-25","objectID":"/2019/golang-syntax-7-function/:7:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€7-å‡½æ•°","uri":"/2019/golang-syntax-7-function/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"åªæœ‰åŸºæœ¬çš„æ•°æ®ç±»å‹æ— æ³•é€‚åº”æ‰€æœ‰çš„æƒ…å†µï¼Œå½“éœ€è¦å­˜å‚¨å’Œå¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œé€šå¸¸ä¼šä½¿ç”¨æ•°ç»„ã€æ˜ å°„ã€é“¾è¡¨ç­‰æ•°æ®ç»“æ„ï¼Œç§°ä¹‹ä¸ºå®¹å™¨(container)ã€‚åœ¨Goè¯­è¨€ä¸­ï¼Œç”±äºæ•°ç»„ä¸å¤Ÿçµæ´»ï¼Œå¢åŠ äº†åˆ‡ç‰‡(slice)ç±»å‹ï¼Œåˆ‡ç‰‡ä¹Ÿæ˜¯ä¸€ç§å®¹å™¨ã€‚ Cè¯­è¨€æ²¡æœ‰æä¾›å®¹å™¨å°è£…ï¼Œå¼€å‘è€…éœ€è¦è‡ªå·±æ ¹æ®æ€§èƒ½éœ€æ±‚è¿›è¡Œå°è£…ï¼Œæˆ–è€…ä½¿ç”¨ç¬¬ä¸‰æ–¹æä¾›çš„å®¹å™¨ã€‚C++ è¯­è¨€çš„å®¹å™¨é€šè¿‡æ ‡å‡†åº“æä¾›ï¼Œå¦‚ vector å¯¹åº”æ•°ç»„ï¼Œlist å¯¹åº”åŒé“¾è¡¨ï¼Œmap å¯¹åº”æ˜ å°„ç­‰ã€‚ æœ¬ç¯‡åªä»‹ç»æ•°ç»„å’Œåˆ‡ç‰‡ï¼Œæ˜ å°„ç±»å‹æ”¾åœ¨ä¸‹ç¯‡ä»‹ç»ï¼Œé“¾è¡¨ç±»å‹åœ¨æ•°æ®ç»“æ„ä¸­ä»‹ç»ã€‚ ","date":"2019-11-18","objectID":"/2019/golang-syntax-6-array-slice-and-map/:0:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€6-æ•°ç»„ã€åˆ‡ç‰‡ä¸æ˜ å°„","uri":"/2019/golang-syntax-6-array-slice-and-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. æ•°ç»„ æ•°ç»„æ˜¯æœ‰é™ä¸ªç›¸åŒç±»å‹çš„æ•°æ®çš„é›†åˆï¼ŒGoè¯­è¨€ä¸­æ•°ç»„å£°æ˜çš„æ ¼å¼ä¸º var identifier [len]type æ•°ç»„å…ƒç´ å¯ä»¥æ˜¯ä»»æ„åŸºæœ¬ç±»å‹ï¼Œæ•°ç»„æœ¬èº«ï¼Œç»“æ„ä½“ç”šè‡³æ¥å£ï¼ˆç©ºï¼‰ï¼Œå½“å…ƒç´ ç±»å‹æ˜¯æ•°ç»„æœ¬èº«æ—¶ï¼Œå³ä¸ºäºŒç»´æˆ–å¤šç»´æ•°ç»„ã€‚ åº”æ³¨æ„ï¼Œæ•°ç»„é•¿åº¦ä¹Ÿæ˜¯æ•°ç»„ç±»å‹çš„ä¸€éƒ¨åˆ†ï¼Œ[5]intå’Œ[10]intæ˜¯ä¸¤ä¸ªä¸åŒç±»å‹ã€‚ æ•°ç»„å…ƒç´ é€šè¿‡ç´¢å¼•æ¥è¯»å–æˆ–ä¿®æ”¹ï¼Œä¸åŒäºå­—ç¬¦ä¸²ï¼Œæ•°ç»„æ˜¯å¯å˜çš„ã€‚ç´¢å¼•çš„èŒƒå›´ä»0åˆ°len(arr)-1ï¼Œå†…ç½®å‡½æ•°len()å¯ç”¨æ¥è·å–æ•°ç»„é•¿åº¦ï¼Œæ•°ç»„é•¿åº¦æœ€å¤§ä¸º2Gbã€‚ å£°æ˜æ•°ç»„æ—¶æ‰€æœ‰çš„å…ƒç´ éƒ½ä¼šè¢«è‡ªåŠ¨åˆå§‹åŒ–ä¸ºå…ƒç´ ç±»å‹çš„é›¶å€¼ï¼Œåˆå§‹åŒ–çš„è¿‡ç¨‹æ˜¯æŒ‰ç…§æ•°ç»„å…ƒç´ çš„é¡ºåºè¿›è¡Œçš„ã€‚ å½“æ•°ç»„å…ƒç´ è¾ƒå°‘æ—¶ï¼Œå¯ä»¥åœ¨å£°æ˜æ—¶ç›´æ¥è¿›è¡Œåˆå§‹åŒ–ï¼Œä¸€äº›è¡¨è¾¾æ–¹å¼å¦‚ä¸‹ var arr1 = [3]int{1, 2, 3} var arr2 = [10]int{1, 2, 3} //å‰©ä¸‹çš„å…ƒç´ ä¼šè‡ªåŠ¨è¡¥å…¨ï¼Œå…¶å€¼ä¸º0 var arr3 = [3]string{2:\"test\"} //åªæœ‰ç´¢å¼•2è¢«èµ‹äºˆäº†å®é™…çš„å€¼ï¼Œå…¶å®ƒå…ƒç´ éƒ½åˆå§‹åŒ–ä¸ºç©ºå­—ç¬¦ä¸² æ•°ç»„é•¿åº¦çš„ä½ç½®ä¹Ÿå¯ä»¥ä½¿ç”¨çœç•¥å·ï¼Œæ­¤æ—¶æ•°ç»„é•¿åº¦ä¼šæ ¹æ®æä¾›çš„å€¼çš„ä¸ªæ•°è‡ªåŠ¨æ¨æ–­ arr := [...]int{1, 2, 3} fmt.Println(len(arr)) //3 æ•°ç»„å…ƒç´ è¾ƒå¤šæ—¶ä½¿ç”¨forå¾ªç¯åˆå§‹åŒ– var arr [100]int //ä½¿ç”¨forå¾ªç¯åˆå§‹åŒ– for i:=0; i \u003c len(arr); i++ { arr[i] = i * 2 } Goè¯­è¨€ä¸­æ•°ç»„æ˜¯ä¸€ç§å€¼ç±»å‹ï¼Œè€Œä¸åƒCè¯­è¨€æ˜¯æŒ‡å‘é¦–å…ƒç´ çš„æŒ‡é’ˆï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å†…ç½®å‡½æ•°new()æ¥åˆ›å»ºæ•°ç»„ï¼ˆnew()ç”¨æ¥åˆ›å»ºå€¼ç±»å‹ï¼Œè¿”å›æ‰€åˆ›å»ºç±»å‹çš„æŒ‡é’ˆï¼‰ var arr1 = new([5]int) è¿™ç§æ–¹å¼å’Œvar arr2 [5]intçš„åŒºåˆ«æ˜¯ï¼Œarr1çš„ç±»å‹æ˜¯*[5]intï¼Œè€Œarr2çš„ç±»å‹æ˜¯[5]intï¼Œä¸€ä¸ªç®€å•çš„å¼å­å¯ä»¥å¸®åŠ©ç†è§£ arr2 := *arr1 å½“åƒä¸Šå¼è¿™æ ·è¿›è¡Œèµ‹å€¼æ—¶ï¼Œæˆ‘ä»¬æŠŠarr1çš„å€¼åšäº†ä¸€æ¬¡æ‹·è´ï¼Œå› æ­¤ä¿®æ”¹arr2ä¸ä¼šå¯¹arr1äº§ç”Ÿå½±å“ã€‚åŒç†ï¼Œå‡½æ•°ä¸­æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥æ—¶ï¼Œä¼ å…¥å€¼ç±»å‹çš„æ•°ç»„ä¸ä¼šæ”¹å˜åŸå€¼ï¼Œä½†æ˜¯ç›´æ¥ä¼ å…¥æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œå½“æ•°ç»„å¾ˆå¤§æ—¶ä¼šæ¶ˆè€—å¾ˆå¤šå†…å­˜ï¼Œå¯ä»¥ä¼ å…¥æ•°ç»„çš„æŒ‡é’ˆæˆ–ä½¿ç”¨åˆ‡ç‰‡æ¥è§£å†³ã€‚ä»¥ä¸‹æ˜¯ä¼ å…¥æŒ‡é’ˆçš„ä¾‹å­ã€‚ package main import \"fmt\" func f(a [3]int) { fmt.Println(a) } func fp(a *[3]int) { fmt.Println(a) } func main() { var ar = [3]int{1, 2, 3} f(ar) // passes a copy of ar fp(\u0026ar) // passes a pointer to ar } æ•°ç»„å¯ä»¥ç»„è£…æˆå¤šç»´æ•°ç»„ï¼Œä¸€ä¸ªäºŒç»´æ•°ç»„å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ•°ç»„ç±»å‹çš„æ•°ç»„ï¼Œä»¥ä¸‹æ¼”ç¤ºä¸€ä¸ªäºŒç»´æ•°ç»„çš„å£°æ˜ // å£°æ˜ä¸€ä¸ªäºŒç»´æ•´å‹æ•°ç»„ï¼Œä¸¤ä¸ªç»´åº¦çš„é•¿åº¦åˆ†åˆ«æ˜¯ 4 å’Œ 2 var array [4][2]int // å£°æ˜å¹¶åˆå§‹åŒ–æ•°ç»„ä¸­ç´¢å¼•ä¸º 1 å’Œ 3 çš„å…ƒç´  array = [4][2]int{1: {20, 21}, 3: {40, 41}} // å£°æ˜å¹¶åˆå§‹åŒ–æ•°ç»„ä¸­æŒ‡å®šçš„å…ƒç´  array = [4][2]int{1: {0: 20}, 3: {1: 41}} ","date":"2019-11-18","objectID":"/2019/golang-syntax-6-array-slice-and-map/:1:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€6-æ•°ç»„ã€åˆ‡ç‰‡ä¸æ˜ å°„","uri":"/2019/golang-syntax-6-array-slice-and-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. åˆ‡ç‰‡ åˆ‡ç‰‡ï¼ˆsliceï¼‰å°±æ˜¯åŠ¨æ€æ•°ç»„ï¼Œå¯ä»¥ç†è§£ä¸ºå¯¹æ•°ç»„ä¸€ä¸ªè¿ç»­ç‰‡æ®µçš„å¼•ç”¨ï¼Œæ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ã€‚ ","date":"2019-11-18","objectID":"/2019/golang-syntax-6-array-slice-and-map/:2:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€6-æ•°ç»„ã€åˆ‡ç‰‡ä¸æ˜ å°„","uri":"/2019/golang-syntax-6-array-slice-and-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 å£°æ˜ä¸ä½¿ç”¨ åˆ‡ç‰‡å£°æ˜çš„æ ¼å¼å¦‚ä¸‹ï¼ŒåŸºæœ¬å°±æ˜¯å»æ‰äº†æ•°ç»„å£°æ˜ä¸­çš„é•¿åº¦ var identifier []type æœªåˆå§‹åŒ–çš„åˆ‡ç‰‡é»˜è®¤ä¸ºnilï¼Œé•¿åº¦ä¸º0ã€‚åˆ‡ç‰‡çš„åˆå§‹åŒ–æ ¼å¼ä¸º var slice []type = arr[start:end] è¡¨ç¤ºsliceæ˜¯æ•°ç»„arrä»startç´¢å¼•åˆ°end-1ç´¢å¼•ä¹‹é—´çš„å…ƒç´ æ„æˆçš„å­é›†ï¼Œåˆ‡ç‰‡çš„å¤§å°å¯ä»¥å’Œæ•°ç»„ç›¸ç­‰ï¼Œä½†åº”æ³¨æ„åˆ°ç»ˆæ­¢ç´¢å¼•çš„é¡¹å¹¶ä¸åŒ…å«åœ¨åˆ‡ç‰‡å†…ã€‚ä¸€äº›åˆ‡ç‰‡çš„æ–¹å¼å¦‚ä¸‹ var arr = [5]int{1,2,3,4,5} s := arr[:] s := arr[0:5] //è¿™ä¸¤ä¸ªåˆ‡ç‰‡éƒ½ç­‰äºæ•´ä¸ªæ•°ç»„ s := arr[:3] s := arr[0:3] //è¿™ä¸¤å¼è¾“å‡ºéƒ½æ˜¯[1,2,3] s := arr[2:] s := arr[2:5] //è¿™ä¸¤å¼è¾“å‡ºéƒ½æ˜¯[3,4,5] åˆ‡ç‰‡æ˜¯å¯ç´¢å¼•çš„ï¼Œä½†åˆ‡ç‰‡çš„ç´¢å¼•ä¸åŸæ•°ç»„çš„ç´¢å¼•ä¸ä¸€å®šç›¸åŒï¼Œå¦‚ä¸Šä¾‹æœ€åä¸€è¡Œï¼Œs[0] = arr[2]ã€‚ åˆ‡ç‰‡çš„é•¿åº¦åœ¨è¿è¡Œæ—¶å¯ä¿®æ”¹ï¼Œæœ€å°ä¸º0æœ€å¤§ä¸ºç›¸å…³æ•°ç»„çš„é•¿åº¦ï¼Œå…·ä½“çš„é•¿åº¦å€¼å¯é€šè¿‡len()å‡½æ•°è·å¾—ã€‚ cap()å‡½æ•°å¯ä»¥è®¡ç®—åˆ‡ç‰‡çš„å®¹é‡ï¼Œä¹Ÿå°±æ˜¯åˆ‡ç‰‡æœ€é•¿å¯ä»¥è¾¾åˆ°å¤šå°‘ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœ s æ˜¯ä¸€ä¸ªåˆ‡ç‰‡ï¼Œcap(s) å°±æ˜¯ä» s[0] åˆ°æ•°ç»„æœ«å°¾çš„æ•°ç»„é•¿åº¦ã€‚åˆ‡ç‰‡çš„é•¿åº¦æ°¸è¿œä¸ä¼šè¶…è¿‡å®ƒçš„å®¹é‡ã€‚å®¹é‡ä¹‹æ‰€ä»¥ä»s[0]å¼€å§‹è®¡æ•°ï¼Œæ˜¯å› ä¸ºåˆ‡ç‰‡åªèƒ½å‘åç§»åŠ¨ï¼Œä»»ä½•è¯•å›¾è·å–åˆ‡ç‰‡ç¬¬ä¸€ä¸ªå…ƒç´ ä¹‹å‰çš„æ•°ç»„å…ƒç´ çš„åšæ³•éƒ½ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚ arr := [5]int{1, 2, 3, 4, 5} s := arr[2:4] //len(s)ä¸º2ï¼Œcap(s)ä¸º3 ä¸¤ä¸ªç›´æ¥åˆ›å»ºåˆ‡ç‰‡çš„ä¾‹å­å¦‚ä¸‹ s := [3]int{1,2,3}[:] x := []int{2,3,4,5,6} ä½†æœ¬è´¨ä¸Šè¿™ä¸¤è€…éƒ½æ˜¯å…ˆåˆ›å»ºçš„æ•°ç»„ï¼Œç„¶åå–äº†ä¸æ•°ç»„ç­‰é•¿çš„åˆ‡ç‰‡ã€‚ æ³¨ï¼šåˆ‡ç‰‡æœ¬èº«å·²æ˜¯å¼•ç”¨ï¼Œå®ƒæ²¡æœ‰æŒ‡é’ˆï¼Œå› æ­¤ä¸è¦å¯¹å®ƒä½¿ç”¨å–åœ°å€ç¬¦ã€‚ åœ¨ä¸Šé¢çš„æ•°ç»„éƒ¨åˆ†æˆ‘ä»¬è°ˆåˆ°å½“æ•°ç»„å¾ˆå¤§æ—¶ï¼Œç›´æ¥å°†æ•°ç»„ä½œä¸ºå‚æ•°ä¼ ç»™å‡½æ•°ä¼šå ç”¨å¤§é‡å†…å­˜ï¼Œå› æ­¤æˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•ä¼ å…¥æ•°ç»„çš„æŒ‡é’ˆï¼Œè¿™é‡Œæˆ‘ä»¬å†ä»‹ç»å¦‚ä½•ä¼ å…¥åˆ‡ç‰‡ï¼šæˆ‘ä»¬åº”å½“åœ¨å‡½æ•°ä¸­å£°æ˜å‚æ•°ä¸ºåˆ‡ç‰‡ç±»å‹ï¼Œè°ƒç”¨å‡½æ•°æ—¶ï¼ŒæŠŠæ•°ç»„åˆ†ç‰‡ï¼Œåˆ›å»ºä¸€ä¸ªåˆ‡ç‰‡å¼•ç”¨ä¼ é€’ç»™è¯¥å‡½æ•°ï¼Œç¤ºä¾‹å¦‚ä¸‹ func sum(a []int) int { s := 0 for i := 0; i \u003c len(a); i++ { s += a[i] } return s } func main() { var arr = [5]int{0, 1, 2, 3, 4} sum(arr[:]) } æ•°ç»„ä½œä¸ºå€¼ç±»å‹ä½¿ç”¨new()æ¥åˆ›å»ºï¼Œè€Œåˆ‡ç‰‡ä½œä¸ºå¼•ç”¨ç±»å‹ï¼Œéœ€è¦ä½¿ç”¨make()ã€‚ var slice []type = make([]type, len) slice := make([]type, len) //ç®€å†™å½¢å¼ å…¶ä¸­ç¬¬äºŒä¸ªå‚æ•°lenæ˜¯æ•°ç»„çš„é•¿åº¦ï¼Œä¹Ÿæ˜¯sliceçš„åˆå§‹é•¿åº¦ï¼Œä¾‹å¦‚å®šä¹‰s1 := make([]int, 10)ï¼Œé‚£ä¹ˆcap(s1) == len(s1) == 10 ä¹Ÿå¯ä»¥åœ¨å£°æ˜æ—¶åˆ©ç”¨ç¬¬ä¸‰ä¸ªå‚æ•°æŒ‡å®šåˆ‡ç‰‡å®¹é‡ slice := make([]type, len, cap) å› æ­¤ï¼Œä¸‹é¢ä¸¤ç§æ–¹æ³•å¯ç”Ÿæˆç›¸åŒåˆ‡ç‰‡ make([]int, 50, 100) new([100]int)[0:50] å­—ç¬¦ä¸²å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªä¸å¯å˜çš„å­—èŠ‚æ•°ç»„ï¼Œå› æ­¤ä¹Ÿå¯ä»¥åˆ‡åˆ†ä¸ºåˆ‡ç‰‡ä½¿ç”¨ã€‚ ","date":"2019-11-18","objectID":"/2019/golang-syntax-6-array-slice-and-map/:2:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€6-æ•°ç»„ã€åˆ‡ç‰‡ä¸æ˜ å°„","uri":"/2019/golang-syntax-6-array-slice-and-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 å¸¸ç”¨æ“ä½œ ç”±äºåˆ‡ç‰‡çš„çµæ´»æ€§ï¼Œä¼šç»å¸¸ä½¿ç”¨åˆ‡ç‰‡è¿›è¡Œä¸€äº›æ“ä½œï¼Œè¿™é‡Œç®€å•ä»‹ç»å‡ ç§ã€‚ é‡ç»„ ä½¿ç”¨makeåˆ›å»ºåˆ‡ç‰‡çš„æ—¶å€™å¯ä»¥æŒ‡å®šå®¹é‡ï¼Œå› æ­¤å¿…è¦æ—¶å¯ä»¥æ”¹å˜åˆ‡ç‰‡é•¿åº¦ç›´åˆ°è¾¾åˆ°å®¹é‡ä¸Šé™ï¼Œæ”¹å˜åˆ‡ç‰‡é•¿åº¦çš„è¿‡ç¨‹ç§°ä¸ºåˆ‡ç‰‡é‡ç»„ï¼ˆresliceï¼‰ï¼Œå¦‚å°†åˆ‡ç‰‡æ‰©å±•1ä½ s = s[0:len(s)+1] //len(s)+1 \u003c= cap(s) å¤åˆ¶ å¢åŠ åˆ‡ç‰‡çš„å®¹é‡å¿…é¡»åˆ›å»ºä¸€ä¸ªæ–°çš„æ›´å¤§çš„åˆ‡ç‰‡å¹¶æŠŠåŸåˆ†ç‰‡çš„å†…å®¹éƒ½æ‹·è´è¿‡æ¥ã€‚åˆ‡ç‰‡æ‹·è´ä½¿ç”¨copy()å‡½æ•°ï¼Œå‡½æ•°åŸå‹å¦‚ä¸‹ copy(destSlice, srcSlice []T) int ä½œç”¨æ˜¯å°† srcSlice å¤åˆ¶åˆ° destSliceï¼Œä¸¤è€…ç±»å‹å¿…é¡»ä¸€è‡´ï¼Œè¿”å›å€¼ä¸ºå®é™…å¤åˆ¶çš„å…ƒç´ ä¸ªæ•°ã€‚æºåœ°å€å’Œç›®æ ‡åœ°å€å¯èƒ½ä¼šæœ‰é‡å ã€‚å¤åˆ¶çš„å…ƒç´ ä¸ªæ•°æ˜¯ srcSlice å’Œ dstSlice çš„é•¿åº¦æœ€å°å€¼ã€‚ç¤ºä¾‹å¦‚ä¸‹ sl_from := []int{1, 2, 3} sl_to1 := make([]int, 5) sl_to2 := make([]int, 2) n1 := copy(sl_to1, sl_from) // n1 = 3, s1_to1 = [1,2,3,0,0] n2 := copy(sl_to2, sl_from) // n2 = 2, s1_to2 = [1,2] è¿½åŠ  è¿½åŠ ä¹Ÿæ˜¯ä¸€ç§åˆ‡ç‰‡æ‰©å®¹çš„æ–¹å¼ï¼Œä¸»è¦ä½¿ç”¨append()å‡½æ•°ï¼Œå‡½æ•°åŸå‹æ˜¯ func append(s []T, x ...T) []T ä½œç”¨æ˜¯å°†0ä¸ªæˆ–å¤šä¸ªå…·æœ‰ç›¸åŒç±»å‹Tçš„å…ƒç´ è¿½åŠ åˆ°åˆ‡ç‰‡såé¢ç—…å¹¶å›æ–°çš„åˆ‡ç‰‡ï¼Œè¿½åŠ çš„å…ƒç´ ç±»å‹éœ€è¦å’ŒåŸåˆ‡ç‰‡çš„å…ƒç´ åŒç±»å‹ã€‚å¦‚æœ s çš„å®¹é‡ä¸è¶³ä»¥å­˜å‚¨æ–°å¢å…ƒç´ ï¼Œappend ä¼šåˆ†é…æ–°çš„åˆ‡ç‰‡æ¥ä¿è¯å·²æœ‰åˆ‡ç‰‡å…ƒç´ å’Œæ–°å¢å…ƒç´ çš„å­˜å‚¨ã€‚å› æ­¤ï¼Œè¿”å›çš„åˆ‡ç‰‡å¯èƒ½å·²ç»æŒ‡å‘ä¸€ä¸ªä¸åŒçš„ç›¸å…³æ•°ç»„äº†ã€‚append æ–¹æ³•æ€»æ˜¯è¿”å›æˆåŠŸï¼Œé™¤éç³»ç»Ÿå†…å­˜è€—å°½äº†ã€‚ sl3 := []int{1, 2, 3} sl3 = append(sl3, 4, 5, 6) // sl2 = [1,2,3,4,5,6] åˆ é™¤ åˆ é™¤åˆ‡ç‰‡å…ƒç´ æ²¡æœ‰ä¸“ç”¨è¯­æ³•ï¼Œéœ€è¦ä½¿ç”¨åˆ‡ç‰‡æœ¬èº«çš„ç‰¹æ€§ã€‚åˆ†ä¸ºä¸‰ç§æƒ…å†µï¼šä»å¼€å§‹ä½ç½®åˆ é™¤ï¼Œä»ä¸­é—´ä½ç½®åˆ é™¤ï¼Œä»æœ«å°¾åˆ é™¤ ä»å¼€å§‹ä½ç½®åˆ é™¤ ç›´æ¥ç§»åŠ¨æ•°æ®æŒ‡é’ˆ a = []int{1, 2, 3} a = a[1:] // åˆ é™¤å¼€å¤´1ä¸ªå…ƒç´  a = a[N:] // åˆ é™¤å¼€å¤´Nä¸ªå…ƒç´  ä¸ç§»åŠ¨æ•°æ®æŒ‡é’ˆï¼Œè€Œæ˜¯å°†åé¢çš„æ•°æ®å‘å¼€å¤´ç§»åŠ¨ a = []int{1, 2, 3} a = append(a[:0], a[1:]...) // åˆ é™¤å¼€å¤´1ä¸ªå…ƒç´  a = append(a[:0], a[N:]...) // åˆ é™¤å¼€å¤´Nä¸ªå…ƒç´  ä½¿ç”¨copy()å‡½æ•° a = []int{1, 2, 3} a = a[:copy(a, a[1:])] // åˆ é™¤å¼€å¤´1ä¸ªå…ƒç´  a = a[:copy(a, a[N:])] // åˆ é™¤å¼€å¤´Nä¸ªå…ƒç´  ä»ä¸­é—´ä½ç½®åˆ é™¤ å¯¹å‰©ä½™çš„å…ƒç´ åšä¸€æ¬¡æ•´ä½“ç§»åŠ¨ï¼Œå¯ä»¥ä½¿ç”¨copy()æˆ–append() a = []int{1, 2, 3, ...} a = append(a[:i], a[i+1:]...) // åˆ é™¤ä¸­é—´1ä¸ªå…ƒç´  a = append(a[:i], a[i+N:]...) // åˆ é™¤ä¸­é—´Nä¸ªå…ƒç´  a = a[:i+copy(a[i:], a[i+1:])] // åˆ é™¤ä¸­é—´1ä¸ªå…ƒç´  a = a[:i+copy(a[i:], a[i+N:])] // åˆ é™¤ä¸­é—´Nä¸ªå…ƒç´  ä»æœ«å°¾åˆ é™¤ a = []int{1, 2, 3} a = a[:len(a)-1] // åˆ é™¤å°¾éƒ¨1ä¸ªå…ƒç´  a = a[:len(a)-N] // åˆ é™¤å°¾éƒ¨Nä¸ªå…ƒç´  åˆ é™¤å¼€å¤´å’Œæœ«å°¾éƒ½æ˜¯åˆ é™¤ä¸­é—´çš„ç‰¹æ®Šæƒ…å†µ æ’å…¥ æ’å…¥çš„ä¸€èˆ¬æ–¹å¼æ˜¯ä½¿ç”¨ä¸¤æ¬¡append()å‡½æ•° a = append(a[:i], append([]T{x}, a[i:]...)...) //åœ¨ç´¢å¼•içš„ä½ç½®æ’å…¥å…ƒç´ x a = append(a[:i], append(make([]T, j), a[i:]...)...) //åœ¨ç´¢å¼•içš„ä½ç½®æ’å…¥é•¿åº¦ä¸ºjçš„æ–°åˆ‡ç‰‡ a = append(a[:i], append(b, a[i:]...)...) //åœ¨ç´¢å¼•içš„ä½ç½®æ’å…¥åˆ‡ç‰‡bçš„æ‰€æœ‰å…ƒç´  æ˜ å°„(map)å…¶å®å°±æ˜¯æ•°æ®ç»“æ„é‡Œçš„å“ˆå¸Œè¡¨ï¼Œä½†ä¸å°‘è¯­è¨€éƒ½å·²ç»æŠŠå®ƒä½œä¸ºäº†å†…ç½®çš„æ•°æ®ç±»å‹ã€‚æ˜ å°„æ˜¯å…ƒç´ å¯¹çš„æ— åºé›†åˆï¼Œç”±é”®(key)å’Œå€¼(value)ä¸¤éƒ¨åˆ†æ„æˆï¼Œå¯ä»¥é€šè¿‡é”®å¿«é€ŸæŸ¥æ‰¾å€¼ï¼ˆæ¯”çº¿æ€§æŸ¥æ‰¾å¿«ï¼Œä½†å®é™…ä¸Šæ¯”é€šè¿‡æ•°ç»„æˆ–åˆ‡ç‰‡ç´¢å¼•ç›´æ¥è¯»å–è¦æ…¢ï¼‰ã€‚ ","date":"2019-11-18","objectID":"/2019/golang-syntax-6-array-slice-and-map/:2:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€6-æ•°ç»„ã€åˆ‡ç‰‡ä¸æ˜ å°„","uri":"/2019/golang-syntax-6-array-slice-and-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. æ˜ å°„ ","date":"2019-11-18","objectID":"/2019/golang-syntax-6-array-slice-and-map/:3:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€6-æ•°ç»„ã€åˆ‡ç‰‡ä¸æ˜ å°„","uri":"/2019/golang-syntax-6-array-slice-and-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.1 å£°æ˜ä¸åˆå§‹åŒ– Golang ä¸­çš„ map æ˜¯å¼•ç”¨ç±»å‹ï¼Œå£°æ˜æ–¹æ³•å¦‚ä¸‹ //è¯­æ³•æ ¼å¼ var mapname map[keytype]valuetype //ç¤ºä¾‹ var map1 map[string]int å‡¡æ˜¯å¯ä»¥ç”¨ == æˆ– != æ“ä½œç¬¦æ¯”è¾ƒçš„ç±»å‹éƒ½å¯ä»¥ä½œä¸ºé”®çš„ç±»å‹ï¼Œæ¯”å¦‚stringã€intã€floatã€åªåŒ…å«åŸºæœ¬ç±»å‹çš„ç»“æ„ä½“ã€æŒ‡é’ˆå’Œæ¥å£ï¼Œè€Œæ•°ç»„ã€åˆ‡ç‰‡ä»¥åŠå«æœ‰æ•°ç»„åˆ‡ç‰‡çš„ç»“æ„ä½“æ— æ³•ä½œä¸ºé”®ç±»å‹ã€‚å€¼çš„ç±»å‹æ˜¯ä»»æ„çš„ï¼Œå½“å€¼ç±»å‹æ˜¯ä¸€äº›å¤æ‚ç»“æ„æ—¶ï¼Œå¾€å¾€æœ‰æ¯”è¾ƒç‰¹æ®Šçš„ç”¨é€”ï¼Œæ¯”å¦‚ å‡½æ•°ã€‚å€¼ç±»å‹ä¸ºå‡½æ•°æ—¶å¯ä»¥è§†ä½œåˆ†æ”¯ç»“æ„ï¼Œkeyç”¨æ¥é€‰æ‹©è¦æ‰§è¡Œçš„å‡½æ•°ã€‚ ç©ºæ¥å£ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ç©ºæ¥å£ä½œä¸ºå€¼ç±»å‹å­˜å‚¨ä»»æ„ç±»å‹çš„å€¼ï¼Œåªæ˜¯åœ¨ä½¿ç”¨å‰éœ€è¦åšä¸€æ¬¡ç±»å‹æ–­è¨€ã€‚ åˆ‡ç‰‡ã€‚é€šè¿‡å°†å€¼ç±»å‹å®šä¹‰ä¸ºåˆ‡ç‰‡ç±»å‹ï¼Œåº”å¯¹ä¸€ä¸ªKeyå¯¹åº”å¤šä¸ªå€¼çš„æƒ…å†µï¼Œç¤ºä¾‹å¦‚ä¸‹ mp1 := make(map[int][]int) map å¯ä»¥åŠ¨æ€å¢é•¿ï¼Œå£°æ˜æ—¶ä¸å…³å¿ƒé•¿åº¦ï¼Œä½¿ç”¨æ—¶å…¶é•¿åº¦ä½¿ç”¨å†…ç½®å‡½æ•°len()è·å–ã€‚ æœªåˆå§‹åŒ–çš„ map å€¼ä¸º nilï¼Œå¦‚æœæ­¤æ—¶è¯•å›¾ç»™mapæ·»åŠ å…ƒç´ ä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯ï¼Œå› æ­¤æ·»åŠ å…ƒç´ å¿…é¡»é¦–å…ˆåˆå§‹åŒ–ã€‚mapåˆå§‹åŒ–çš„æ–¹æ³•æœ‰ä¸¤ç§ ç›´æ¥ä½¿ç”¨å¤§æ‹¬å·ï¼Œåœ¨æ•°ç»„ä¸åˆ‡ç‰‡çš„åˆå§‹åŒ–ä¸­å·²ç»è§è¿‡è¿™ç§æ–¹æ³•ï¼Œç¤ºä¾‹å¦‚ä¸‹ var mapLit map[string]int mapLit = map[string]int{\"one\":1, \"two\":2} ä½¿ç”¨makeï¼Œmapæ˜¯å¼•ç”¨ç±»å‹ï¼Œå› æ­¤ä½¿ç”¨makeåˆå§‹åŒ–ã€‚ä»¥makeæ–¹å¼åˆå§‹åŒ–å…¶å®ç›¸å½“äºmapLit := map[string]int{} mapLit := make(map[string]int) è™½ç„¶mapå¯ä»¥åŠ¨æ€å¢é•¿ï¼Œæ²¡æœ‰é•¿åº¦é™åˆ¶ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥åœ¨ä¸€å¼€å§‹æ ‡æ˜å…¶åˆå§‹å®¹é‡ mapLit := make(map[string]int, 100) å½“mapå¢é•¿åˆ°å®¹é‡ä¸Šé™åï¼Œç»§ç»­å¢åŠ æ–°çš„é”®å€¼å¯¹ï¼Œmapçš„å¤§å°ä¼šè‡ªåŠ¨åŠ 1ï¼Œå› æ­¤å®¹é‡å¯¹mapå¹¶æ²¡æœ‰å¤šå¤§å½±å“ã€‚ ","date":"2019-11-18","objectID":"/2019/golang-syntax-6-array-slice-and-map/:3:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€6-æ•°ç»„ã€åˆ‡ç‰‡ä¸æ˜ å°„","uri":"/2019/golang-syntax-6-array-slice-and-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.2 è®¿é—®ä¸åˆ é™¤mapä¸­çš„å…ƒç´  å¦‚æœ key1 æ˜¯ map1 çš„ keyï¼Œé‚£ä¹ˆ map1[key1] å°±æ˜¯å¯¹åº” key1 çš„å€¼ï¼Œmapä¸­å°±é€šè¿‡è¿™ç§ç±»ä¼¼æ•°ç»„ç´¢å¼•çš„æ–¹å¼è®¿é—®å…ƒç´  val1 := map1[key1] ä¸Šå¼å°† key1 å¯¹åº”çš„å€¼èµ‹ç»™äº† val1ï¼Œä½†åè¿‡æ¥ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿™ç§å½¢å¼è®¾ç½®å¯¹åº”key1çš„å€¼ï¼Œå¦‚ä¸‹ map1[key1] = val1 è®¿é—® map ä¸­ä¸å­˜åœ¨çš„ key ä¼šè·å¾—å®ƒæ‰€å¯¹åº”çš„å€¼ç±»å‹çš„ç©ºå€¼ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦æœ‰ä¸€ç§åŠæ³•æ¥åˆ¤æ–­é”®å€¼å¯¹æ˜¯å¦å­˜åœ¨ï¼Œè¿™æ ·æ‰èƒ½åŒºåˆ†åˆ°åº•æ˜¯é”®å€¼å¯¹æœ¬èº«ä¸å­˜åœ¨ï¼Œè¿˜æ˜¯å€¼æ˜¯ç©ºå€¼ã€‚å®é™…ä¸Šé€šè¿‡é”®æ¥è®¿é—®å€¼ä¼šè¿”å›ä¸¤ä¸ªç»“æœï¼Œå¦‚ä¸‹ val1, ok := map1[key1] å½“é”®å€¼å¯¹å­˜åœ¨æ—¶ï¼Œok çš„å€¼ä¸º trueï¼Œè€Œå½“é”®å€¼å¯¹ä¸å­˜åœ¨æ—¶ï¼Œok çš„å€¼ä¸º falseã€‚å¦‚æœåªæƒ³åˆ¤æ–­æŸä¸ªé”®å€¼å¯¹æ˜¯å¦å­˜åœ¨ï¼Œå¯ä»¥å°†è¿”å›çš„çœŸæ­£çš„å€¼è®¾ç½®ä¸ºåŒ¿åå˜é‡ _, ok := map1[key1] mapä¸­å…ƒç´ çš„åˆ é™¤ä½¿ç”¨å†…ç½®å‡½æ•°delete()ï¼Œæ ¼å¼å¦‚ä¸‹ delete(mapname, keyname) å¦‚æœé”®å€¼å¯¹ä¸å­˜åœ¨ï¼Œåˆ é™¤æ“ä½œä¹Ÿä¸ä¼šäº§ç”Ÿé”™è¯¯ mapLit := map[string]int{\"one\": 1, \"two\": 2} delete(mapLit, \"one\") ä½† Golang å¹¶æ²¡æœ‰æä¾›æ¸…ç©º map ä¸­æ‰€æœ‰å…ƒç´ çš„æ–¹æ³•ï¼Œæ¸…ç©º map çš„å”¯ä¸€åŠæ³•å°±æ˜¯é‡æ–° make ä¸€ä¸ªæ–°çš„ map mapLit := map[string]int{\"one\": 1, \"two\": 2} mapLit = make(map[string]int) ","date":"2019-11-18","objectID":"/2019/golang-syntax-6-array-slice-and-map/:3:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€6-æ•°ç»„ã€åˆ‡ç‰‡ä¸æ˜ å°„","uri":"/2019/golang-syntax-6-array-slice-and-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.3 éå†map for-rangeå¯ç”¨äºéå†map for key, value := range map1 { ... } å…¶ä¸­ç¬¬ä¸€ä¸ªè¿”å›å€¼ key æ˜¯ map ä¸­çš„ key å€¼ï¼Œç¬¬äºŒä¸ªè¿”å›å€¼ value åˆ™æ˜¯ key å¯¹åº”çš„ value å€¼ã€‚å¦‚æœåªå…³å¿ƒå€¼ï¼Œå¯ä»¥çœç•¥é”® for _, value := range map1 { ... } è€Œå¦‚æœåªå…³å¿ƒé”®ï¼Œåˆ™å¯ä»¥çœç•¥å€¼ for key := range map1 { fmt.Printf(\"key is: %d\\n\", key) } è¿˜éœ€è¦çŸ¥é“çš„ä¸€ç‚¹æ˜¯ï¼Œfor-range ç»“æ„è™½ç„¶èƒ½éå†æ•´ä¸ª mapï¼Œä½†æˆ‘ä»¬å¹¶ä¸çŸ¥é“ map ä¸­é”®å€¼å¯¹æ’åˆ—çš„é¡ºåºï¼Œå¹¶ä¸æ˜¯æŒ‰ key çš„é¡ºåºæ’åˆ—çš„ï¼Œä¹Ÿä¸æ˜¯æŒ‰ value çš„é¡ºåºæ’åˆ—ã€‚ å¦‚æœæƒ³è¦ä¸º map æ’åºï¼Œé‚£ä¹ˆå°±éœ€è¦å…ˆé€šè¿‡éå†å°† map çš„æ‰€æœ‰æ•°æ®å¤åˆ¶åˆ°åˆ‡ç‰‡ä¸­ï¼Œå†å¯¹åˆ‡ç‰‡æ’åºï¼Œæœ€åæ‰“å°å‡ºæ¥ // the telephone alphabet: package main import ( \"fmt\" \"sort\" ) var barVal = map[string]int{\"alpha\": 34, \"bravo\": 56, \"charlie\": 23} func main() { fmt.Println(\"unsorted:\") for k, v := range barVal { fmt.Printf(\"Key: %v, Value: %v ; \", k, v) } keys := make([]string, len(barVal)) i := 0 for k := range barVal { keys[i] = k i++ } sort.Strings(keys) fmt.Println() fmt.Println(\"sorted:\") for _, k := range keys { fmt.Printf(\"Key: %v, Value: %v ; \", k, barVal[k]) } } //Output: unsorted: Key: alpha, Value: 34 ; Key: bravo, Value: 56 ; Key: charlie, Value: 23 ; sorted: Key: alpha, Value: 34 ; Key: bravo, Value: 56 ; Key: charlie, Value: 23 ; ä¸Šä¾‹æŒ‰keyè¿›è¡Œäº†æ’åºå¹¶è¾“å‡ºï¼Œå¦‚æœæƒ³è¦æ›´å¥½çš„æ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨ç»“æ„ä½“åˆ‡ç‰‡ type name struct { key string value int } ","date":"2019-11-18","objectID":"/2019/golang-syntax-6-array-slice-and-map/:3:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€6-æ•°ç»„ã€åˆ‡ç‰‡ä¸æ˜ å°„","uri":"/2019/golang-syntax-6-array-slice-and-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.4 mapç±»å‹çš„åˆ‡ç‰‡ mapç±»å‹çš„åˆ‡ç‰‡æ˜¯ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„ç»“æ„ï¼Œæ„é€ å®ƒéœ€è¦ä½¿ç”¨ä¸¤æ¬¡make()å‡½æ•°ï¼Œç¬¬ä¸€æ¬¡åˆ†é…åˆ‡ç‰‡ï¼Œç¬¬äºŒæ¬¡åˆ†é…åˆ‡ç‰‡ä¸­çš„æ¯ä¸ªmapå…ƒç´  package main import \"fmt\" func main() { // Version A: items := make([]map[int]int, 5) for i:= range items { items[i] = make(map[int]int, 1) items[i][1] = 2 } fmt.Printf(\"Version A: Value of items: %v\\n\", items) // Version B: NOT GOOD! items2 := make([]map[int]int, 5) for _, item := range items2 { item = make(map[int]int, 1) // item is only a copy of the slice element. item[1] = 2 // This 'item' will be lost on the next iteration. } fmt.Printf(\"Version B: Value of items: %v\\n\", items2) } //Output: Version A: Value of items: [map[1:2] map[1:2] map[1:2] map[1:2] map[1:2]] Version B: Value of items: [map[] map[] map[] map[] map[]] åº”è¯¥æ„è¯†åˆ°ï¼Œfor-range ç»“æ„ä¸­ï¼Œvalue åªæ˜¯å€¼çš„æ‹·è´ï¼Œå¯¹å®ƒåšæ“ä½œä¸ä¼šå½±å“åŸå€¼ï¼Œå› æ­¤ä¸Šä¾‹ä¸­ç¬¬äºŒç§å†™æ³•æ˜¯é”™è¯¯çš„ï¼ŒçœŸæ­£çš„ map å…ƒç´ å¹¶æ²¡æœ‰å¾—åˆ°åˆå§‹åŒ–ã€‚ ","date":"2019-11-18","objectID":"/2019/golang-syntax-6-array-slice-and-map/:3:4","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€6-æ•°ç»„ã€åˆ‡ç‰‡ä¸æ˜ å°„","uri":"/2019/golang-syntax-6-array-slice-and-map/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æœ¬ç¯‡ä»‹ç»å­—ç¬¦ä¸²çš„ç›¸å…³æ“ä½œï¼Œæ¶‰åŠstringå’Œstrconvä¸¤ä¸ªæ ‡å‡†åº“ï¼Œä»¥åŠä»‹ç»è¾“å…¥è¾“å‡ºçš„åŸºæœ¬æ–¹æ³•ï¼Œæ¶‰åŠfmtå’Œbufioä¸¤ä¸ªæ ‡å‡†åº“ã€‚ ","date":"2019-11-11","objectID":"/2019/golang-syntax-5-string-input-and-output/:0:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€5-å­—ç¬¦ä¸²æ“ä½œä¸è¾“å…¥è¾“å‡º","uri":"/2019/golang-syntax-5-string-input-and-output/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. å­—ç¬¦ä¸²æ“ä½œ å¯¹å­—ç¬¦ä¸²çš„æ“ä½œæ— è®ºåœ¨ä»€ä¹ˆè¯­è¨€é‡Œéƒ½æ˜¯å¾ˆé‡è¦çš„ï¼Œå› æ­¤åœ¨åŸºæœ¬æ•°æ®ç±»å‹ä¸­ä»‹ç»è¿‡å­—ç¬¦ä¸²ä¹‹åï¼Œè¿™é‡Œä»ç„¶ä¸“é—¨æ‹¿å‡ºä¸€ç¯‡æ¥ä»‹ç»å…³äºå­—ç¬¦ä¸²çš„å¤„ç†ã€‚ å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€è¿°ï¼Œå†…ç½®çš„å­—ç¬¦ä¸²æ“ä½œæ˜¯å­—ç¬¦ä¸²çš„æ‹¼æ¥ï¼Œé€šè¿‡æ‹¼æ¥ç¬¦+æ¥å®Œæˆã€‚ s := \"hel\" + \"lo,\" s += \"world!\" fmt.Println(s) //Output: //hello, world! ä½†ä½¿ç”¨æ‹¼æ¥ç¬¦+å¹¶ä¸æ˜¯æœ€é«˜æ•ˆçš„åšæ³•ï¼ŒåŒæ—¶ï¼Œç”±äºå­—ç¬¦ä¸²æ˜¯ä¸€ç§å†…å®¹ä¸å¯å˜çš„å€¼ç±»å‹ï¼Œæ— æ³•ç›´æ¥é€šè¿‡ç´¢å¼•æ“ä½œå…¶å†…çš„ä»»æ„å­—ç¬¦ã€‚Goè¯­è¨€å†…ç½®äº†stringsåŒ…æ¥æä¾›å¯¹å­—ç¬¦ä¸²çš„ç§ç§æ“ä½œï¼Œæ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨ï¼Œå½“ç„¶ï¼Œå¾ˆå¤šæ—¶å€™ä¹Ÿä¼šä½¿ç”¨strconvåŒ…ï¼Œè¿™ä¸ªåŒ…çš„ä½¿ç”¨æˆ‘ä»¬åœ¨ç±»å‹è½¬æ¢éƒ¨åˆ†æåˆ°è¿‡ã€‚ ","date":"2019-11-11","objectID":"/2019/golang-syntax-5-string-input-and-output/:1:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€5-å­—ç¬¦ä¸²æ“ä½œä¸è¾“å…¥è¾“å‡º","uri":"/2019/golang-syntax-5-string-input-and-output/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.1 åˆ¤æ–­åŒ…å«å…³ç³» HasPrefix åˆ¤æ–­å­—ç¬¦ä¸² s æ˜¯å¦ä»¥ prefix å¼€å¤´ï¼š strings.HasPrefix(s, prefix string) bool HasSuffix åˆ¤æ–­å­—ç¬¦ä¸² s æ˜¯å¦ä»¥ suffix ç»“å°¾ï¼š strings.HasSuffix(s, suffix string) bool ç¤ºä¾‹å¦‚ä¸‹ package main import ( \"fmt\" \"strings\" ) func main() { var str string = \"This is an example of a string\" fmt.Printf(\"T/F? Does the string \\\"%s\\\" have prefix %s? \", str, \"Th\") fmt.Printf(\"%t\\n\", strings.HasPrefix(str, \"Th\")) } //Output: //T/F? Does the string \"This is an example of a string\" have prefix Th? true æ›´ä¸€èˆ¬åŒ–çš„ï¼ŒContains åˆ¤æ–­å­—ç¬¦ä¸² s æ˜¯å¦åŒ…å« substrï¼š strings.Contains(s, substr string) bool ","date":"2019-11-11","objectID":"/2019/golang-syntax-5-string-input-and-output/:1:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€5-å­—ç¬¦ä¸²æ“ä½œä¸è¾“å…¥è¾“å‡º","uri":"/2019/golang-syntax-5-string-input-and-output/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.2 è·å–å­å­—ç¬¦ä¸²çš„ä½ç½® Index è¿”å›å­—ç¬¦ä¸² str åœ¨å­—ç¬¦ä¸² s ä¸­çš„ç´¢å¼•ï¼ˆstr çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç´¢å¼•ï¼‰ï¼Œ-1 è¡¨ç¤ºå­—ç¬¦ä¸² s ä¸åŒ…å«å­—ç¬¦ä¸² strï¼š strings.Index(s, str string) int LastIndex è¿”å›å­—ç¬¦ä¸² str åœ¨å­—ç¬¦ä¸² s ä¸­æœ€åå‡ºç°ä½ç½®çš„ç´¢å¼•ï¼ˆstr çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç´¢å¼•ï¼‰ï¼Œ-1 è¡¨ç¤ºå­—ç¬¦ä¸² s ä¸åŒ…å«å­—ç¬¦ä¸² strï¼š strings.LastIndex(s, str string) int å¦‚æœéœ€è¦æŸ¥è¯¢é ASCII ç¼–ç çš„å­—ç¬¦åœ¨çˆ¶å­—ç¬¦ä¸²ä¸­çš„ä½ç½®ï¼Œä½¿ç”¨ä»¥ä¸‹å‡½æ•°æ¥å¯¹å­—ç¬¦è¿›è¡Œå®šä½ï¼š strings.IndexRune(s string, r rune) int ç¤ºä¾‹å¦‚ä¸‹ package main import ( \"fmt\" \"strings\" ) func main() { var str string = \"Hi, I'm Marc, Hi.\" fmt.Printf(\"The position of \\\"Marc\\\" is: \") fmt.Printf(\"%d\\n\", strings.Index(str, \"Marc\")) fmt.Printf(\"The position of the first instance of \\\"Hi\\\" is: \") fmt.Printf(\"%d\\n\", strings.Index(str, \"Hi\")) fmt.Printf(\"The position of the last instance of \\\"Hi\\\" is: \") fmt.Printf(\"%d\\n\", strings.LastIndex(str, \"Hi\")) fmt.Printf(\"The position of \\\"Burger\\\" is: \") fmt.Printf(\"%d\\n\", strings.Index(str, \"Burger\")) } /*Output: The position of \"Marc\" is: 8 The position of the first instance of \"Hi\" is: 0 The position of the last instance of \"Hi\" is: 14 The position of \"Burger\" is: -1 */ ","date":"2019-11-11","objectID":"/2019/golang-syntax-5-string-input-and-output/:1:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€5-å­—ç¬¦ä¸²æ“ä½œä¸è¾“å…¥è¾“å‡º","uri":"/2019/golang-syntax-5-string-input-and-output/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.3 ç»Ÿè®¡å‡ºç°æ¬¡æ•° Count ç”¨äºè®¡ç®—å­—ç¬¦ä¸² str åœ¨å­—ç¬¦ä¸² s ä¸­å‡ºç°çš„éé‡å æ¬¡æ•°ï¼š strings.Count(s, str string) int ç¤ºä¾‹ package main import ( \"fmt\" \"strings\" ) func main() { var str string = \"Hello, how is it going, Hugo?\" var manyG = \"gggggggggg\" fmt.Printf(\"Number of H's in %s is: \", str) fmt.Printf(\"%d\\n\", strings.Count(str, \"H\")) fmt.Printf(\"Number of double g's in %s is: \", manyG) fmt.Printf(\"%d\\n\", strings.Count(manyG, \"gg\")) } /*Output: Number of H's in Hello, how is it going, Hugo? is: 2 Number of double gâ€™s in gggggggggg is: 5 */ ","date":"2019-11-11","objectID":"/2019/golang-syntax-5-string-input-and-output/:1:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€5-å­—ç¬¦ä¸²æ“ä½œä¸è¾“å…¥è¾“å‡º","uri":"/2019/golang-syntax-5-string-input-and-output/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.4 æ›¿æ¢ä¸é‡å¤ Replace ç”¨äºå°†å­—ç¬¦ä¸² str ä¸­çš„å‰ n ä¸ªå­—ç¬¦ä¸² old æ›¿æ¢ä¸ºå­—ç¬¦ä¸² newï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœ n = -1 åˆ™æ›¿æ¢æ‰€æœ‰å­—ç¬¦ä¸² old ä¸ºå­—ç¬¦ä¸² newï¼š strings.Replace(str, old, new, n) string Repeat ç”¨äºé‡å¤ count æ¬¡å­—ç¬¦ä¸² s å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼š strings.Repeat(s, count int) string ç¤ºä¾‹ package main import ( \"fmt\" \"strings\" ) func main() { var origS string = \"Hi there! \" var newS string newS = strings.Repeat(origS, 3) fmt.Printf(\"The new repeated string is: %s\\n\", newS) } //Output: //The new repeated string is: Hi there! Hi there! Hi there! ","date":"2019-11-11","objectID":"/2019/golang-syntax-5-string-input-and-output/:1:4","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€5-å­—ç¬¦ä¸²æ“ä½œä¸è¾“å…¥è¾“å‡º","uri":"/2019/golang-syntax-5-string-input-and-output/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.5 å¤§å°å†™è½¬æ¢ ToLower å°†å­—ç¬¦ä¸²ä¸­çš„ Unicode å­—ç¬¦å…¨éƒ¨è½¬æ¢ä¸ºç›¸åº”çš„å°å†™å­—ç¬¦ï¼š strings.ToLower(s) string ToUpper å°†å­—ç¬¦ä¸²ä¸­çš„ Unicode å­—ç¬¦å…¨éƒ¨è½¬æ¢ä¸ºç›¸åº”çš„å¤§å†™å­—ç¬¦ï¼š strings.ToUpper(s) string ç¤ºä¾‹ package main import ( \"fmt\" \"strings\" ) func main() { var orig string = \"Hey, how are you George?\" var lower string var upper string fmt.Printf(\"The original string is: %s\\n\", orig) lower = strings.ToLower(orig) fmt.Printf(\"The lowercase string is: %s\\n\", lower) upper = strings.ToUpper(orig) fmt.Printf(\"The uppercase string is: %s\\n\", upper) } /*Output: The original string is: Hey, how are you George? The lowercase string is: hey, how are you george? The uppercase string is: HEY, HOW ARE YOU GEORGE? */ ","date":"2019-11-11","objectID":"/2019/golang-syntax-5-string-input-and-output/:1:5","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€5-å­—ç¬¦ä¸²æ“ä½œä¸è¾“å…¥è¾“å‡º","uri":"/2019/golang-syntax-5-string-input-and-output/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.6 ä¿®å‰ªä¸åˆ†å‰² å¯ä»¥ä½¿ç”¨ strings.TrimSpace(s) æ¥å‰”é™¤å­—ç¬¦ä¸²å¼€å¤´å’Œç»“å°¾çš„ç©ºç™½ç¬¦å·ï¼› å¯ä»¥ä½¿ç”¨ strings.Trim(s, \"cut\") æ¥å°†å¼€å¤´å’Œç»“å°¾çš„æŒ‡å®šå­—ç¬¦ä¸²ï¼ˆcutï¼‰å»é™¤æ‰ã€‚ å¦‚æœåªæƒ³å‰”é™¤å¼€å¤´æˆ–è€…ç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ TrimLeft æˆ–è€… TrimRight æ¥å®ç°ã€‚ strings.Fields(s) å°†ä¼šåˆ©ç”¨ 1 ä¸ªæˆ–å¤šä¸ªç©ºç™½ç¬¦å·æ¥ä½œä¸ºåŠ¨æ€é•¿åº¦çš„åˆ†éš”ç¬¦å°†å­—ç¬¦ä¸²åˆ†å‰²æˆè‹¥å¹²å°å—ï¼Œå¹¶è¿”å›ä¸€ä¸ª sliceï¼Œå¦‚æœå­—ç¬¦ä¸²åªåŒ…å«ç©ºç™½ç¬¦å·ï¼Œåˆ™è¿”å›ä¸€ä¸ªé•¿åº¦ä¸º 0 çš„ sliceã€‚ strings.Split(s, sep) ç”¨äºè‡ªå®šä¹‰åˆ†å‰²ç¬¦å·æ¥å¯¹æŒ‡å®šå­—ç¬¦ä¸²è¿›è¡Œåˆ†å‰²ï¼ŒåŒæ ·è¿”å› sliceã€‚ å› ä¸ºè¿™ 2 ä¸ªå‡½æ•°éƒ½ä¼šè¿”å› sliceï¼Œæ‰€ä»¥ä¹ æƒ¯ä½¿ç”¨ for-range å¾ªç¯æ¥å¯¹å…¶è¿›è¡Œå¤„ç† ","date":"2019-11-11","objectID":"/2019/golang-syntax-5-string-input-and-output/:1:6","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€5-å­—ç¬¦ä¸²æ“ä½œä¸è¾“å…¥è¾“å‡º","uri":"/2019/golang-syntax-5-string-input-and-output/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.7 æ‹¼æ¥ Join ç”¨äºå°†å…ƒç´ ç±»å‹ä¸º string çš„ slice ä½¿ç”¨åˆ†å‰²ç¬¦å·æ¥æ‹¼æ¥ç»„æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼š strings.Join(sl []string, sep string) string ç¤ºä¾‹ package main import ( \"fmt\" \"strings\" ) func main() { str := \"The quick brown fox jumps over the lazy dog\" sl := strings.Fields(str) fmt.Printf(\"Splitted in slice: %v\\n\", sl) for _, val := range sl { fmt.Printf(\"%s - \", val) } fmt.Println() str2 := \"GO1|The ABC of Go|25\" sl2 := strings.Split(str2, \"|\") fmt.Printf(\"Splitted in slice: %v\\n\", sl2) for _, val := range sl2 { fmt.Printf(\"%s - \", val) } fmt.Println() str3 := strings.Join(sl2,\";\") fmt.Printf(\"sl2 joined by ;: %s\\n\", str3) } /*Output: Splitted in slice: [The quick brown fox jumps over the lazy dog] The - quick - brown - fox - jumps - over - the - lazy - dog - Splitted in slice: [GO1 The ABC of Go 25] GO1 - The ABC of Go - 25 - sl2 joined by ;: GO1;The ABC of Go;25 */ ","date":"2019-11-11","objectID":"/2019/golang-syntax-5-string-input-and-output/:1:7","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€5-å­—ç¬¦ä¸²æ“ä½œä¸è¾“å…¥è¾“å‡º","uri":"/2019/golang-syntax-5-string-input-and-output/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. è¾“å…¥è¾“å‡º ç¼–å†™ç¨‹åºè¿›è¡Œæ•°æ®çš„è¯»å†™å¿…ä¸å¯å°‘ï¼Œä¸€èˆ¬ä¼šç”¨åˆ°fmt, oså’Œbufioä¸‰ä¸ªåŒ…ï¼Œä¸‹é¢å¯¹ä¸€äº›è¯»å†™æ–¹å¼è¿›è¡Œæ€»ç»“ã€‚ ","date":"2019-11-11","objectID":"/2019/golang-syntax-5-string-input-and-output/:2:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€5-å­—ç¬¦ä¸²æ“ä½œä¸è¾“å…¥è¾“å‡º","uri":"/2019/golang-syntax-5-string-input-and-output/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 è¯»å–ç”¨æˆ·è¾“å…¥ ç”¨æˆ·è¾“å…¥æ¥è‡ªä¸‰ç§ï¼šæ ‡å‡†è¾“å…¥ï¼Œå­—ç¬¦ä¸²ï¼Œio.Readerç±»å‹ æ¥è‡ªæ ‡å‡†è¾“å…¥ è¯»å–ç”¨æˆ·è¾“å…¥ä¸€èˆ¬æŒ‡çš„æ˜¯è¯»å–ç”¨æˆ·çš„é”®ç›˜ï¼ˆæ§åˆ¶å°ï¼‰è¾“å…¥ï¼Œå®šä¹‰ä¸ºæ ‡å‡†è¾“å…¥os.Stdinï¼Œæœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨fmtåŒ…æä¾›çš„Scanå¼€å¤´çš„å‡½æ•°ã€‚ func Scan(a ...interface{}) (n int, err error) func Scanf(format string, a ...interface{}) (n int, err error) func Scanln(a ...interface{}) (n int, err error) Scanä»æ ‡å‡†è¾“å…¥æ‰«ææ–‡æœ¬ï¼Œå°†æˆåŠŸè¯»å–çš„ç©ºç™½åˆ†éš”çš„å€¼ä¼ é€’ç»™å‡½æ•°çš„å‚æ•°ã€‚æ¢è¡Œè§†ä¸ºç©ºç™½ã€‚è¿”å›æˆåŠŸæ‰«æçš„æ¡ç›®ä¸ªæ•°å’Œé‡åˆ°çš„ä»»ä½•é”™è¯¯ã€‚å¦‚æœè¯»å–çš„æ¡ç›®æ¯”æä¾›çš„å‚æ•°å°‘ï¼Œä¼šè¿”å›ä¸€ä¸ªé”™è¯¯æŠ¥å‘ŠåŸå› ã€‚ Scanfä»æ ‡å‡†è¾“å…¥æ‰«ææ–‡æœ¬ï¼Œæ ¹æ®format å‚æ•°æŒ‡å®šçš„æ ¼å¼å°†æˆåŠŸè¯»å–çš„ç©ºç™½åˆ†éš”çš„å€¼ä¼ é€’ç»™å‡½æ•°çš„å‚æ•°ã€‚è¿”å›æˆåŠŸæ‰«æçš„æ¡ç›®ä¸ªæ•°å’Œé‡åˆ°çš„ä»»ä½•é”™è¯¯ã€‚ Scanlnç±»ä¼¼Scanï¼Œä½†ä¼šåœ¨æ¢è¡Œæ—¶æ‰åœæ­¢æ‰«æã€‚æœ€åä¸€ä¸ªæ¡ç›®åå¿…é¡»æœ‰æ¢è¡Œæˆ–è€…åˆ°è¾¾ç»“æŸä½ç½®ã€‚ ä¸€ä¸ªç¤ºä¾‹ç¨‹åºå¦‚ä¸‹ï¼š package main import \"fmt\" var firstName, lastName string func main() { fmt.Println(\"Please enter your full name: \") fmt.Scanln(\u0026firstName, \u0026lastName) // fmt.Scanf(\"%s %s\", \u0026firstName, \u0026lastName) } æ¥è‡ªå­—ç¬¦ä¸² è¯»å–æ¥è‡ªå­—ç¬¦ä¸²çš„è¾“å…¥ä¸€èˆ¬ä½¿ç”¨fmtåŒ…ä¸­SScanå¼€å¤´çš„å‡½æ•° func Sscan(str string, a ...interface{}) (n int, err error) func Sscanf(str string, format string, a ...interface{}) (n int, err error) func Sscanln(str string, a ...interface{}) (n int, err error) SScanå¼€å¤´çš„å‡½æ•°åŸºæœ¬å’ŒScanç›¸ä¼¼ï¼Œå”¯ä¸€çš„ä¸åŒæ˜¯å¤šäº†ç¬¬ä¸€ä¸ªå‚æ•°strï¼Œä»£è¡¨ä»å­—ç¬¦ä¸²stræ‰«ææ–‡æœ¬ã€‚ä¸€ä¸ªç¤ºä¾‹ç¨‹åºå¦‚ä¸‹ï¼š package main import \"fmt\" func main() { var name string var age int n, err := fmt.Sscanf(\"Kim is 22 years old\", \"%s is %d years old\", \u0026name, \u0026age) if err != nil { panic(err) } fmt.Printf(\"%d: %s, %d\\n\", n, name, age) } //Output 2: Kim, 22 æ¥è‡ªio.Readerç±»å‹ ä¸»è¦æ˜¯ä½¿ç”¨Fscanå¼€å¤´çš„å‡½æ•° func Fscan(r io.Reader, a ...interface{}) (n int, err error) func Fscanf(r io.Reader, format string, a ...interface{}) (n int, err error) func Fscanln(r io.Reader, a ...interface{}) (n int, err error) åŒæ ·ï¼Œä¸Scançš„ä¸åŒæ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ræ˜¯io.Readerç±»å‹ï¼Œç¤ºä¾‹ç¨‹åºå¦‚ä¸‹ï¼š package main import ( \"fmt\" \"os\" \"strings\" ) func main() { var ( i int b bool s string ) r := strings.NewReader(\"5 true gophers\") //è¿”å›ä¸€ä¸ªio.Readerç±»å‹ n, err := fmt.Fscanf(r, \"%d %t %s\", \u0026i, \u0026b, \u0026s) if err != nil { fmt.Fprintf(os.Stderr, \"Fscanf: %v\\n\", err) } fmt.Println(i, b, s) fmt.Println(n) } 5 true gophers 3 ","date":"2019-11-11","objectID":"/2019/golang-syntax-5-string-input-and-output/:2:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€5-å­—ç¬¦ä¸²æ“ä½œä¸è¾“å…¥è¾“å‡º","uri":"/2019/golang-syntax-5-string-input-and-output/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 è¾“å‡ºæŒ‡å®šå†…å®¹ è¾“å‡ºå’Œè¯»å–è¾“å…¥åŸºæœ¬æ˜¯æ˜¯ç›¸åçš„ï¼Œå„å‡½æ•°åŸå‹å¦‚ä¸‹ï¼š func Print(a ...interface{}) (n int, err error) func Printf(format string, a ...interface{}) (n int, err error) func Println(a ...interface{}) (n int, err error) func Sprint(a ...interface{}) string func Sprintf(format string, a ...interface{}) string func Sprintln(a ...interface{}) string func Fprint(w io.Writer, a ...interface{}) (n int, err error) func Fprintf(w io.Writer, format string, a ...interface{}) (n int, err error) func Fprintln(w io.Writer, a ...interface{}) (n int, err error) ç¤ºä¾‹ç¨‹åºå¦‚ä¸‹ï¼š package main import ( \"fmt\" \"io\" \"os\" ) func main() { const name, age = \"Kim\", 22 fmt.Printf(\"%s is %d years old.\\n\", name, age) s := fmt.Sprintf(\"%s is %d years old.\\n\", name, age) io.WriteString(os.Stdout, s) // Ignoring error for simplicity. n, err := fmt.Fprintf(os.Stdout, \"%s is %d years old.\\n\", name, age) if err != nil { fmt.Fprintf(os.Stderr, \"Fprintf: %v\\n\", err) } fmt.Printf(\"%d bytes written.\\n\", n) } //Output Kim is 22 years old. Kim is 22 years old. Kim is 22 years old. 21 bytes written. ","date":"2019-11-11","objectID":"/2019/golang-syntax-5-string-input-and-output/:2:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€5-å­—ç¬¦ä¸²æ“ä½œä¸è¾“å…¥è¾“å‡º","uri":"/2019/golang-syntax-5-string-input-and-output/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 ä½¿ç”¨bufioåŒ… ä½¿ç”¨fmtè¿›è¡Œè¯»å†™ï¼Œè¯»å†™æ¬¡æ•°æ¯”è¾ƒå¤šæ—¶ï¼Œæ—¶é—´è€—è´¹æå¤§ã€‚goæä¾›äº†ä¸€ä¸ªbufioåŒ…ï¼Œä½¿ç”¨è¯¥åŒ…å¯ä»¥å¤§å¹…æé«˜æ–‡ä»¶è¯»å†™æ•ˆç‡ã€‚ bufioåŒ…åŸç† ä»‹ç»æ¥è‡ªèŒ¹å§-GOè¯­è¨€åŸºç¡€è¿›é˜¶æ•™ç¨‹ï¼šbufioåŒ…ã€‚ioæ“ä½œæœ¬èº«çš„æ•ˆç‡å¹¶ä¸ä½ï¼Œä½çš„æ˜¯é¢‘ç¹çš„è®¿é—®æœ¬åœ°ç£ç›˜çš„æ–‡ä»¶ã€‚æ‰€ä»¥bufioå°±æä¾›äº†ç¼“å†²åŒº(åˆ†é…ä¸€å—å†…å­˜)ï¼Œè¯»å’Œå†™éƒ½å…ˆåœ¨ç¼“å†²åŒºä¸­ï¼Œæœ€åå†è¯»å†™æ–‡ä»¶ï¼Œæ¥é™ä½è®¿é—®æœ¬åœ°ç£ç›˜çš„æ¬¡æ•°ï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚ è¯»å…¥ package main import ( \"fmt\" \"bufio\" \"os\" ) func main() { inputReader := bufio.NewReader(os.Stdin) fmt.Println(\"Please enter some input: \") input, err := inputReader.ReadString('\\n') if err == nil { fmt.Printf(\"The input was: %s\\n\", input) } } bufio.NewReader() æ„é€ å‡½æ•°çš„ç­¾åä¸ºï¼šfunc NewReader(rd io.Reader) *Reader inputReader æ˜¯ä¸€ä¸ªæŒ‡å‘ bufio.Reader çš„æŒ‡é’ˆã€‚inputReader := bufio.NewReader(os.Stdin) è¿™è¡Œä»£ç ï¼Œå°†ä¼šåˆ›å»ºä¸€ä¸ªè¯»å–å™¨ï¼Œå¹¶å°†å…¶ä¸æ ‡å‡†è¾“å…¥ç»‘å®šã€‚è¿”å›çš„è¯»å–å™¨å¯¹è±¡æä¾›ä¸€ä¸ªæ–¹æ³• ReadString(delim byte)ï¼Œè¯¥æ–¹æ³•ä»è¾“å…¥ä¸­è¯»å–å†…å®¹ï¼Œç›´åˆ°ç¢°åˆ° delim æŒ‡å®šçš„å­—ç¬¦ï¼Œç„¶åå°†è¯»å–åˆ°çš„å†…å®¹è¿åŒ delim å­—ç¬¦ä¸€èµ·æ”¾åˆ°ç¼“å†²åŒºã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¼šè¯»å–é”®ç›˜è¾“å…¥ï¼Œç›´åˆ°å›è½¦é”®ï¼ˆ\\nï¼‰è¢«æŒ‰ä¸‹ã€‚ å†™å‡º package main import ( \"os\" \"fmt\" \"bufio\" ) func main() { w1 := bufio.NewWriter(os.Stdout) for i:=1;i\u003c=1000;i++{ w1.WriteString(fmt.Sprintf(\"%d:hello\",i)) } w1.Flush() } ","date":"2019-11-11","objectID":"/2019/golang-syntax-5-string-input-and-output/:2:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€5-å­—ç¬¦ä¸²æ“ä½œä¸è¾“å…¥è¾“å‡º","uri":"/2019/golang-syntax-5-string-input-and-output/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.4 æ–‡ä»¶è¯»å†™ ä¸»è¦æ˜¯ä½¿ç”¨os.Openå‡½æ•°æ‰“å¼€æ–‡ä»¶ï¼Œä»¥åŠdeferå…³é”®å­—å’Œcloseæ–¹æ³•åœ¨ç¨‹åºç»“æŸæ—¶å…³é—­æ–‡ä»¶ã€‚ package main import ( \"bufio\" \"fmt\" \"io\" \"os\" ) func main() { inputFile, inputError := os.Open(\"input.dat\") if inputError != nil { fmt.Printf(\"An error occurred on opening the inputfile\\n\" + \"Does the file exist?\\n\" + \"Have you got acces to it?\\n\") return // exit the function on error } defer inputFile.Close() inputReader := bufio.NewReader(inputFile) for { inputString, readerError := inputReader.ReadString('\\n') fmt.Printf(\"The input was: %s\", inputString) if readerError == io.EOF { return } } } æœªå®Œå¾…ç»­â€¦ ","date":"2019-11-11","objectID":"/2019/golang-syntax-5-string-input-and-output/:2:4","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€5-å­—ç¬¦ä¸²æ“ä½œä¸è¾“å…¥è¾“å‡º","uri":"/2019/golang-syntax-5-string-input-and-output/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æœ¬æ–‡ä»‹ç» Golang ä¸­çš„è¿ç®—ç¬¦å’Œæµç¨‹æ§åˆ¶ ","date":"2019-10-29","objectID":"/2019/golang-syntax-4-operators-and-flow-control/:0:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€4-è¿ç®—ç¬¦ä¸æµç¨‹æ§åˆ¶","uri":"/2019/golang-syntax-4-operators-and-flow-control/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. è¿ç®—ç¬¦ Goè¯­è¨€çš„è¿ç®—ç¬¦æœ‰6ç§ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤º è¿ç®—ç¬¦ç±»å‹ è¿ç®—ç¬¦ ç®—æœ¯è¿ç®—ç¬¦ +ï¼Œ-ï¼Œ*ï¼Œ/ï¼Œ%ï¼Œ++ï¼Œâ€“ å…³ç³»è¿ç®—ç¬¦ ==ï¼Œ!=ï¼Œ\u003eï¼Œ\u003cï¼Œ\u003e=ï¼Œ\u003c= é€»è¾‘è¿ç®—ç¬¦ \u0026\u0026ï¼Œ||ï¼Œ! ä½è¿ç®—ç¬¦ \u0026ï¼Œ|ï¼Œ^ï¼ŒÂ«ï¼ŒÂ»ï¼Œ\u0026^ èµ‹å€¼è¿ç®—ç¬¦ =ï¼Œ+=ï¼Œ-=ï¼Œ*=ï¼Œ/=ï¼Œ%=ï¼ŒÂ«=ï¼ŒÂ»=ï¼Œ\u0026=ï¼Œ^=ï¼Œ!= å…¶å®ƒè¿ç®—ç¬¦ \u0026ï¼Œ* åŸºæœ¬çš„è¿ç®—è§„åˆ™éƒ½ä¸Cè¯­è¨€ç›¸åŒï¼Œä¸€äº›æ³¨æ„äº‹é¡¹åˆ—ä¸¾å¦‚ä¸‹ ç®—æœ¯è¿ç®—ç¬¦ä¸­è‡ªå¢è‡ªå‡è¿ç®—ç¬¦åªèƒ½ä½œä¸ºè¯­å¥ä½¿ç”¨ï¼Œä¸èƒ½ç”¨äºè¡¨è¾¾å¼ a++ // å…è®¸ a-- // å…è®¸ a = a++ //ä¸å…è®¸ï¼Œç¼–è¯‘é”™è¯¯ a[i] = b[i++] //ä¸å…è®¸ï¼Œç¼–è¯‘é”™è¯¯ æ•´æ•°é™¤ä»¥0ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼Œå¦‚æœç¼–è¯‘æ—¶æœªæ£€å‡ºä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚æµ®ç‚¹æ•°é™¤ä»¥0.0ä¼šè¿”å›æ— ç©·å¤§ï¼Œç”¨+Infè¡¨ç¤º é€»è¾‘è¿ç®—ç¬¦å…·æœ‰çŸ­è·¯æ•ˆæœ ä½è¿ç®—ç¬¦æ˜¯å¯¹æ•´æ•°åœ¨å†…å­˜ä¸­çš„äºŒè¿›åˆ¶ä½è¿›è¡Œæ“ä½œçš„ï¼Œå‡å®šA = 60ï¼ŒB = 13ï¼Œåˆ™ A = 0011 1100 B = 0000 1101 A\u0026B = 0000 1100 // ç»“æœä¸º12 A|B = 0011 1101 // ç»“æœä¸º61 A^B = 0011 0001 // ç»“æœä¸º49 A\u003c\u003c2 = 1111 0000 // ç»“æœä¸º240 A\u003e\u003e2 = 0000 1111 // ç»“æœä¸º15 å…¶å®ƒè¿ç®—ç¬¦ä¸­çš„\u0026æ˜¯å–åœ°å€ç¬¦ï¼Œ*æ˜¯æŒ‡é’ˆå˜é‡ è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§æ˜¯ä¸åŒçš„ï¼Œä¸‹è¡¨ä»ä¸Šå¾€ä¸‹ä»£è¡¨ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ ä¼˜å…ˆçº§ è¿ç®—ç¬¦ 7 ^ ï¼Œ! 6 * ï¼Œ/ ï¼Œ% ï¼ŒÂ« ï¼ŒÂ»ï¼Œ \u0026ï¼Œ \u0026^ 5 +ï¼Œ -ï¼Œ | ï¼Œ^ 4 ==ï¼Œ !=ï¼Œ \u003c ï¼Œ\u003c= ï¼Œ\u003e=ï¼Œ \u003e 3 \u003c- 2 \u0026\u0026 1 || äºŒå…ƒè¿ç®—ç¬¦çš„è¿ç®—æ–¹å‘å‡æ˜¯ä»å·¦åˆ°å³ï¼Œå¿…è¦æ—¶å¯ä»¥ä½¿ç”¨æ‹¬å·æå‡ä¼˜å…ˆçº§æˆ–æ›´æ¸…æ¥šåœ°è¡¨è¾¾ã€‚ ","date":"2019-10-29","objectID":"/2019/golang-syntax-4-operators-and-flow-control/:1:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€4-è¿ç®—ç¬¦ä¸æµç¨‹æ§åˆ¶","uri":"/2019/golang-syntax-4-operators-and-flow-control/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. æ§åˆ¶ç»“æ„ é™¤å»é¡ºåºç»“æ„å¤–ï¼ŒGoè¯­è¨€æä¾›çš„åŸºæœ¬æµç¨‹æ§åˆ¶ç»“æ„åŒ…æ‹¬ æ¡ä»¶ç»“æ„ if-else ç»“æ„ switch ç»“æ„ select ç»“æ„ï¼Œç”¨äºchannelçš„é€‰æ‹©ï¼ˆåç¨‹ä¸é€šé“éƒ¨åˆ†ï¼‰ å¾ªç¯ç»“æ„ for for-range åŒæ—¶ï¼ŒGoè¿˜æä¾›äº†å…³é”®å­—breakã€continueå’Œgotoç”¨æ¥è¾…åŠ©è¿›è¡Œæµç¨‹æ§åˆ¶ï¼Œä»¥åŠreturnè¯­å¥æå‰ç»“æŸæ‰§è¡Œã€‚ æ³¨1ï¼šåœ¨è¿™äº›ç»“æ„ä¸­ï¼ŒGoéƒ½çœç•¥äº†æ¡ä»¶è¯­å¥ä¸¤ä¾§çš„å°æ‹¬å·ï¼Œä½¿è§†è§‰ä¸Šæ›´åŠ ç®€æ´ã€‚ æ³¨2ï¼šé™¤caseå…³é”®å­—åçš„è¯­å¥ï¼Œå³ä½¿ä»£ç å—åªæœ‰ä¸€è¡Œï¼Œå¤§æ‹¬å·ä¹Ÿä¸å¯çœç•¥ æ³¨3ï¼šå·¦å¤§æ‹¬å·å¿…é¡»å’Œå…³é”®å­—åœ¨åŒä¸€è¡Œï¼Œå¯¹å¤šåˆ†æ”¯ç»“æ„ä¸­çš„elseå…³é”®å­—ï¼Œå³å¤§æ‹¬å·ä¹Ÿè¦å’Œå®ƒåœ¨ä¸€è¡Œã€‚è¿™ä¸¤æ¡è§„åˆ™æ˜¯ç¼–è¯‘å™¨çš„å¼ºåˆ¶è§„å®šã€‚ ","date":"2019-10-29","objectID":"/2019/golang-syntax-4-operators-and-flow-control/:2:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€4-è¿ç®—ç¬¦ä¸æµç¨‹æ§åˆ¶","uri":"/2019/golang-syntax-4-operators-and-flow-control/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 if-else ç»“æ„ if-else ç»“æ„çš„åŸºæœ¬å½¢æ€ä¸Cè¯­è¨€ç›¸åŒã€‚å¯ä»¥çœç•¥elseå…³é”®å­—å˜æˆå•åˆ†æ”¯ç»“æ„ï¼Œä¹Ÿå¯ä»¥æ·»åŠ else ifå˜æˆå¤šåˆ†æ”¯ï¼Œä½†ä¸ºäº†ä»£ç ç®€æ´ï¼Œè¿‡å¤šçš„åˆ†æ”¯æœ€å¥½æ¢ç”¨switchç»“æ„å®ç°ã€‚ if condition1 { // do something } else { // do something else } å½“åŒåˆ†æ”¯ç»“æ„åœ¨ä»£ç å—çš„æœ«å°¾æ—¶ï¼Œé€šå¸¸ä¼šå°†elseä¸­åŸæœ¬çš„ä»£ç å—è¿ç§»å‡ºæ¥æ”¾åœ¨æœ€åï¼Œå¦‚ if condition { return true } return false Goä¸­ if è¿˜å¯ä»¥åœ¨æ¡ä»¶è¯­å¥å‰æ·»åŠ ä¸€ä¸ªåˆå§‹åŒ–è¯­å¥ï¼Œä»¥åˆ†å·åˆ†éš” if initialization; condition { // do something } ä¾‹å¦‚ if val := 10; val \u003e max { // do something } ä½†éœ€è¦æ³¨æ„çš„æ—¶ï¼Œä½¿ç”¨ç®€çŸ­æ–¹å¼ := å£°æ˜å’Œåˆå§‹åŒ–çš„å˜é‡ä½œç”¨åŸŸåªé™äº if ç»“æ„çš„ä»£ç å—å†…ï¼Œå±äºå±€éƒ¨å˜é‡ã€‚ ç”±äºGoè¯­è¨€å¹¶è¡Œèµ‹å€¼çš„ç‰¹æ€§ï¼Œif è¯­å¥ç»å¸¸ç”¨äºæµ‹è¯•å¤šè¿”å›å€¼å‡½æ•°çš„é”™è¯¯ã€‚è¿”å›æŸä¸ªå€¼ä»¥åŠtrueè¡¨ç¤ºæˆåŠŸï¼Œè¿”å›é›¶å€¼ï¼ˆæˆ–nilï¼‰ä»¥åŠfalseè¡¨ç¤ºå¤±è´¥ if value, ok := readData(); ok { â€¦ } å½“ä¸ä½¿ç”¨trueæˆ–falseæ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªerrorç±»å‹çš„å˜é‡æ¥ä»£æ›¿ä½œä¸ºç¬¬äºŒä¸ªè¿”å›å€¼ï¼ŒæˆåŠŸæ‰§è¡Œï¼Œerrorçš„å€¼ä¸ºnilï¼Œå¤±è´¥è¿”å›çš„å€¼ä¼šåŒ…å«ç›¸åº”çš„é”™è¯¯ä¿¡æ¯ã€‚ var err error if err := file.Chmod(0664); err != nil { fmt.Println(err) return err } ","date":"2019-10-29","objectID":"/2019/golang-syntax-4-operators-and-flow-control/:2:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€4-è¿ç®—ç¬¦ä¸æµç¨‹æ§åˆ¶","uri":"/2019/golang-syntax-4-operators-and-flow-control/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 switch ç»“æ„ switchç»“æ„çš„åŸºæœ¬å½¢æ€ä¾ç„¶åŒCè¯­è¨€ç›¸åŒ switch var1 { case val1: ... case val2: ... default: ... } ä¸åŒçš„æ˜¯ï¼ŒGoä¸­switchè¯­å¥æ¥å—ä»»æ„å½¢å¼çš„è¡¨è¾¾å¼ï¼Œå¦‚ä¸Šä¾‹ä¸­var1å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œè€Œval1å’Œval2å¯ä»¥æ˜¯åŒç±»å‹çš„ä»»æ„å€¼ï¼Œä¸å±€é™äºæ•°å€¼ã€‚ å¯ä»¥åŒæ—¶æµ‹è¯•å¤šä¸ªå¯èƒ½ç¬¦åˆæ¡ä»¶çš„å€¼ï¼Œä½¿ç”¨é€—å·åˆ†éš”ï¼Œä¾‹å¦‚case val1, val2, val3 æ¯ä¸ªcaseåˆ†æ”¯éƒ½æ˜¯å”¯ä¸€çš„ï¼Œä»ä¸Šåˆ°ä¸‹é€ä¸€æµ‹è¯•ï¼Œä¸€æ—¦æˆåŠŸåŒ¹é…åˆ°æŸä¸ªåˆ†æ”¯ï¼Œæ‰§è¡Œå®Œå¯¹åº”çš„ä»£ç å—åä¼šè‡ªåŠ¨é€€å‡ºæ•´ä¸ª switch ç»“æ„ï¼Œè€Œä¸éœ€è¦ä½¿ç”¨breakç»“æŸã€‚å› æ­¤ï¼Œç¨‹åºä¸ä¼šè‡ªåŠ¨çš„å»æ‰§è¡Œå‰©ä¸‹çš„caseåˆ†æ”¯çš„ä»£ç ï¼Œå¦‚æœæƒ³ç»§ç»­æ‰§è¡Œï¼Œéœ€è¦ä½¿ç”¨fallthroughå…³é”®å­— switch i { case 0: fallthrough case 1: f() // å½“ i == 0 æ—¶å‡½æ•°ä¹Ÿä¼šè¢«è°ƒç”¨ } caseè¯­å¥åä¸éœ€è¦ç”¨å¤§æ‹¬å·åŒ…å›´ä»£ç å—ï¼Œdefaultåˆ†æ”¯å¯ä»¥å‡ºç°åœ¨ä»»ä½•é¡ºåºï¼Œä½†æœ€å¥½æ”¾åœ¨æœ€å package main import \"fmt\" func main() { var num1 int = 100 switch num1 { case 98, 99: fmt.Println(\"It's equal to 98\") case 100: fmt.Println(\"It's equal to 100\") default: fmt.Println(\"It's not equal to 98 or 100\") } } //Output: //It's equal to 100 switchå¯ä»¥ä¸æä¾›æ¡ä»¶è¯­å¥ï¼Œç„¶ååœ¨æ¯ä¸ªcaseåˆ†æ”¯æµ‹è¯•ä¸åŒæ¡ä»¶ï¼Œå¯ä»¥æ›¿æ¢åˆ†æ”¯æ¯”è¾ƒå¤šçš„if-elseç»“æ„ï¼Œç®€åŒ–ä»£ç  switch { case i \u003c 0: f1() case i == 0: f2() case i \u003e 0: f3() default: ... } switchçš„æ¡ä»¶è¯­å¥è¿˜å¯ä»¥æ˜¯åˆå§‹åŒ–è¯­å¥ switch a, b := x[i], y[j] { case a \u003c b: t = -1 case a == b: t = 0 case a \u003e b: t = 1 } ","date":"2019-10-29","objectID":"/2019/golang-syntax-4-operators-and-flow-control/:2:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€4-è¿ç®—ç¬¦ä¸æµç¨‹æ§åˆ¶","uri":"/2019/golang-syntax-4-operators-and-flow-control/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 for ç»“æ„ Goä¸­åªæœ‰forç”¨äºå¾ªç¯ç»“æ„ï¼Œæ²¡æœ‰Cä¸­çš„whileæˆ–do whileï¼ŒåŸºæœ¬å½¢æ€å¦‚ä¸‹ for åˆå§‹åŒ–è¯­å¥; æ¡ä»¶è¯­å¥; ä¿®é¥°è¯­å¥ { ... } åŒæ ·ï¼Œfor å…³é”®å­—åçš„ä¸‰ä¸ªè¯­å¥ä¸éœ€è¦å°æ‹¬å·ï¼Œå·¦å¤§æ‹¬å·éœ€å’Œå…³é”®å­—åœ¨åŒä¸€è¡Œ å¯ä»¥åªä¿ç•™æ¡ä»¶è¯­å¥ï¼Œè¿™ç§æƒ…å†µä¸‹å¯ä»¥å»æ‰æ‰€æœ‰åˆ†å·ï¼Œå¤§è‡´ç­‰åŒäºå…¶å®ƒè¯­è¨€çš„whileå¾ªç¯ package main import \"fmt\" func main() { var i int = 5 for i \u003e= 0 { i = i - 1 fmt.Printf(\"The variable i is now: %d\\n\", i) } } æˆ–è€…çœç•¥æ¡ä»¶è¯­å¥ï¼Œä½†å¿…é¡»åœ¨å¾ªç¯ä½“ä¸­å­˜åœ¨æ¡ä»¶åˆ¤æ–­ä»¥ç¡®ä¿åœ¨æŸä¸ªæ—¶å€™é€€å‡ºå¾ªç¯ï¼Œé€€å‡ºå¯ä»¥ä½¿ç”¨breakæˆ–return for i := 0; ; i++ { ... } æˆ–è€…ä¸‰æ¡è¯­å¥å…¨éƒ¨çœç•¥ï¼Œä½†åŒæ ·éœ€è¦åœ¨å¾ªç¯ä½“ä¸­æ·»åŠ é€€å‡ºæ¡ä»¶ for { ... } ","date":"2019-10-29","objectID":"/2019/golang-syntax-4-operators-and-flow-control/:2:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€4-è¿ç®—ç¬¦ä¸æµç¨‹æ§åˆ¶","uri":"/2019/golang-syntax-4-operators-and-flow-control/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.4 for-range ç»“æ„ è¿™æ˜¯ Go ä¸­ç‰¹æœ‰çš„è¿­ä»£ç»“æ„ï¼Œå¯ä»¥è¿­ä»£æ•°ç»„ã€åˆ‡ç‰‡ã€mapã€å­—ç¬¦ä¸²ç­‰ä»»æ„ä¸€ä¸ªé›†åˆï¼Œä¸€èˆ¬å½¢å¼ä¸º for k, v := range set { ... } k ä¸ºç´¢å¼•ï¼Œæ¯æ¬¡é€’å¢ï¼Œv ä¸ºç´¢å¼•å¯¹åº”çš„å€¼çš„æ‹·è´ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äº v åªæ˜¯å€¼çš„æ‹·è´ï¼Œä»»ä½•å¯¹å®ƒçš„ä¿®æ”¹éƒ½ä¸ä¼šå½±å“é›†åˆä¸­åŸæ¥çš„å€¼ï¼Œé™¤éç´¢å¼•æ˜¯æŒ‡é’ˆã€‚ å¦‚æœä¸éœ€è¦ç´¢å¼•ï¼Œå¯ä»¥ä½¿ç”¨åŒ¿åå˜é‡_å¿½ç•¥å®ƒ for _, v := range set{ ... } ä½†å¦‚æœåªéœ€è¦ç´¢å¼•è€Œä¸éœ€è¦å€¼ï¼Œå¯ä»¥ç›´æ¥çœç•¥ä¸å†™ for k := range set { ... } // Output: 0 1 2 ... å­—ç¬¦ä¸²é€šè¿‡for-rangeç»“æ„è·å–çš„å…ƒç´ æ˜¯runeç±»å‹ ","date":"2019-10-29","objectID":"/2019/golang-syntax-4-operators-and-flow-control/:2:4","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€4-è¿ç®—ç¬¦ä¸æµç¨‹æ§åˆ¶","uri":"/2019/golang-syntax-4-operators-and-flow-control/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. è¾…åŠ©å…³é”®å­— breakç”¨æ¥è·³å‡ºå¾ªç¯ï¼Œåœ¨forå¾ªç¯ä¸­è·³å‡ºä¸€å±‚å¾ªç¯ï¼Œåœ¨switchæˆ–selectè¯­å¥ä¸­ï¼Œè·³è¿‡æ•´æ®µä»£ç å— for i:=0; i\u003c3; i++ { for j:=0; j\u003c10; j++ { if j\u003e5 { break } print(j) } print(\" \") } //Output: //012345 012345 012345 continueç”¨æ¥å¿½ç•¥å‰©ä½™çš„å¾ªç¯ä½“ç›´æ¥è¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯ï¼Œåªå­˜åœ¨äºforå¾ªç¯ä¸­ for i := 0; i \u003c 10; i++ { if i == 5 { continue } print(i) print(\" \") } //Output: //0 1 2 3 4 6 7 8 9 forã€switch æˆ– select è¯­å¥éƒ½å¯ä»¥é…åˆæ ‡ç­¾ï¼ˆlabelï¼‰å½¢å¼çš„æ ‡è¯†ç¬¦ä½¿ç”¨ï¼Œå³æŸä¸€è¡Œç¬¬ä¸€ä¸ªä»¥å†’å·ï¼ˆ:ï¼‰ç»“å°¾çš„å•è¯ï¼Œä¸‹ä¾‹ä¸­continueè¯­å¥æŒ‡å‘LABEL1ï¼Œå½“æ‰§è¡Œåˆ°è¯¥è¯­å¥æ—¶ï¼Œå°±ä¼šè·³è½¬åˆ°LABEL1æ ‡ç­¾çš„ä½ç½®èµ·ç»§ç»­æ‰§è¡Œï¼Œä¸è¿‡æ­¤æ—¶æ³¨æ„å¾ªç¯ä½“å†…çš„å˜é‡å¹¶ä¸ä¼šè¢«é‡Šæ”¾ï¼Œå½“j==4å¾ªç¯è·³å‡ºåï¼Œiä¼šè‡ªåŠ¨å˜æˆä¸‹ä¸€ä¸ªå¾ªç¯çš„å€¼ï¼Œä¸ä¼šé™·å…¥æ— é™å¾ªç¯ã€‚ package main import \"fmt\" func main() { LABEL1: for i := 0; i \u003c= 5; i++ { for j := 0; j \u003c= 5; j++ { if j == 4 { continue LABEL1 } fmt.Printf(\"i is: %d, and j is: %d\\n\", i, j) } } } æ ‡ç­¾çš„åç§°å’Œä¸€èˆ¬çš„æ ‡è¯†ç¬¦ç›¸åŒï¼Œéƒ½æ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œä½†ä¸ºäº†å¯è¯»æ€§ï¼Œä¸€èˆ¬å…¨éƒ¨ä½¿ç”¨å¤§å†™å­—æ¯ã€‚åŒå˜é‡ç›¸åŒï¼Œæ ‡ç­¾å®šä¹‰æœªä½¿ç”¨ä¹Ÿä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚ gotoå…³é”®å­—æ˜¯é…åˆæ ‡ç­¾ä½¿ç”¨çš„ï¼Œä½†è¿™ç§ç”¨æ³•å¹¶ä¸è¢«æ¨èï¼Œå› ä¸ºå¾ˆå¯èƒ½å¯¼è‡´ç³Ÿç³•çš„ä»£ç ç»“æ„ï¼Œä¸€å¦‚å½“å¹´çš„PASCAL é€†åºçš„æ ‡ç­¾è™½ç„¶å¯èƒ½å¯¼è‡´é”™è¯¯ï¼Œä½†æ­£åºçš„æ ‡ç­¾(æ ‡ç­¾ä½äºgotoè¯­å¥ä¹‹å)åˆ™å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œä½†æ ‡ç­¾å’Œgotoä¹‹é—´ä¸èƒ½æœ‰æ–°å®šä¹‰å˜é‡çš„è¯­å¥ï¼Œå¦åˆ™ä¼šå¯¼è‡´ç¼–è¯‘å¤±è´¥ // compile error goto2.go:8: goto TARGET jumps over declaration of b at goto2.go:8 package main import \"fmt\" func main() { a := 1 goto TARGET // compile error b := 9 TARGET: b += a fmt.Printf(\"a is %v *** b is %v\", a, b) } ","date":"2019-10-29","objectID":"/2019/golang-syntax-4-operators-and-flow-control/:3:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€4-è¿ç®—ç¬¦ä¸æµç¨‹æ§åˆ¶","uri":"/2019/golang-syntax-4-operators-and-flow-control/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æœ¬æ–‡ä»‹ç» Go ä¸­çš„å¸¸é‡ã€å˜é‡ã€åŸºæœ¬æ•°æ®ç±»å‹å’Œå¸¸ç”¨çš„ç±»å‹è½¬æ¢ã€‚ ","date":"2019-10-22","objectID":"/2019/golang-syntax-3-constants-variables-and-elementary-types/:0:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€3-å¸¸é‡å˜é‡ä¸åŸºæœ¬æ•°æ®ç±»å‹","uri":"/2019/golang-syntax-3-constants-variables-and-elementary-types/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. å¸¸é‡ å¸¸é‡ç”¨äºå­˜å‚¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šæ”¹å˜çš„æ•°æ®ï¼Œè¯•å›¾æ”¹å˜ä¼šå¼•å‘ç¼–è¯‘é”™è¯¯ã€‚Go ä¸­å¸¸é‡ä½¿ç”¨å…³é”®å­— const å®šä¹‰ï¼Œå£°æ˜ä¸åˆå§‹åŒ–è¯­å¥æ”¾åœ¨ä¸€èµ·ï¼Œæ ¼å¼å¦‚ä¸‹ const identifier [type] = value å¸¸é‡çš„å€¼å¿…é¡»åœ¨ç¼–è¯‘æ—¶èƒ½å¤Ÿç¡®å®šï¼Œå› æ­¤åªèƒ½æ˜¯åŸºæœ¬æ•°æ®ç±»å‹å’Œè¡¨è¾¾å¼ã€‚ä¸€ä¸ªå¸¸é‡å®šä¹‰çš„ä¾‹å­å¦‚ä¸‹ const Pi float64 = 3.14159 å¦å¤–ï¼Œç”±äº Go çš„ä¸€äº›ç‰¹æ€§ï¼Œå¸¸é‡çš„å®šä¹‰æœ‰ä¸€äº›ä¸åŒçš„å½¢å¼ Go æ”¯æŒæ ¹æ®å€¼æ¨æ–­å…¶ç±»å‹ï¼Œå› æ­¤ç±»å‹å®šä¹‰å¯çœç•¥ const Pi = 3.14159 Go æ”¯æŒåœ¨åŒä¸€è¡ŒåŒæ—¶å®šä¹‰å¤šä¸ªå€¼ï¼Œç§°ä¸ºå¤šé‡èµ‹å€¼ const Monday, Tuesday, Wednesday, Thursday, Friday, Saturday = 1, 2, 3, 4, 5, 6 Go æ”¯æŒæ‰¹é‡å£°æ˜ï¼Œè¿™ç§å®šä¹‰å½¢å¼å«åšå› å¼åˆ†è§£å…³é”®å­— const ( Monday, Tuesday, Wednesday = 1, 2, 3 Thursday, Friday, Saturday = 4, 5, 6 ) æ­¤å¤–ï¼ŒGo è¿˜æä¾›å…³é”®å­— iotaï¼Œç”¨ä½œå¸¸é‡è®¡æ•°å™¨ï¼Œåªèƒ½åœ¨å¸¸é‡å®šä¹‰æ—¶ä½¿ç”¨ã€‚iota åœ¨ const å…³é”®å­—å‡ºç°æ—¶è¢«é‡ç½®ä¸º 0ï¼Œæ¯æ–°å¢ä¸€è¡Œå¸¸é‡å£°æ˜æ–°å¢ä¸€ä¸ªè®¡æ•°ï¼Œèƒ½æå¤§çš„ç®€åŒ–å®šä¹‰ã€‚ä¸€ä¸ªä¾‹å­å¦‚ä¸‹ const a = iota // a=0 const ( b = iota //b=0 c //c=1 ç›¸å½“äºc=iota ) å¯ä»¥ä½¿ç”¨ç©ºç™½æ ‡è¯†ç¬¦è·³è¿‡ä¸æƒ³è¦çš„å€¼ const ( a = iota // 0 _ c // 2 ) åŒä¸€è¡Œæœ‰å¤šä¸ªå˜é‡ä¸äº§ç”Ÿå½±å“ï¼Œä¸­é—´æœ‰æ•°å€¼æ’é˜Ÿä¹Ÿä¸äº§ç”Ÿå½±å“ï¼Œå› ä¸º iota çš„å€¼æ˜¯æ¯æ–°å¢ä¸€è¡Œå£°æ˜å¢åŠ  1 const ( a,b = iota,iota+1 // 0,1 c,d // 1,2 e,f // 2,3 ) const ( a = iota // 0 b = 3.14 c // 2 ) ","date":"2019-10-22","objectID":"/2019/golang-syntax-3-constants-variables-and-elementary-types/:1:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€3-å¸¸é‡å˜é‡ä¸åŸºæœ¬æ•°æ®ç±»å‹","uri":"/2019/golang-syntax-3-constants-variables-and-elementary-types/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. å˜é‡ å˜é‡ä½¿ç”¨ var å…³é”®å­—å£°æ˜ï¼Œæ ¼å¼ä¸º var identifier type å½“ä¸€ä¸ªå˜é‡è¢«å£°æ˜åï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨èµ‹äºˆå®ƒè¯¥ç±»å‹çš„é›¶å€¼ï¼šint ä¸º 0ï¼Œfloat ä¸º 0.0ï¼Œbool ä¸º falseï¼Œstring ä¸ºç©ºå­—ç¬¦ä¸²ï¼ŒæŒ‡é’ˆä¸º nilã€‚ å˜é‡ä¸å¸¸é‡çš„ä¸€ä¸ªä¸åŒä¹‹å¤„åœ¨äºï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå£°æ˜ä¸åˆå§‹åŒ–æ˜¯åˆ†ç¦»çš„ï¼Œä¸€ä¸ªä¾‹å­å¦‚ä¸‹ var a int a = 15 ä½†å˜é‡ä¹Ÿå¯ä»¥å°†å£°æ˜å’Œåˆå§‹åŒ–æ”¾åˆ°ä¸€èµ·ï¼Œå°±åƒå¸¸é‡ä¸€æ ·ï¼Œè¿™ä¹Ÿæ˜¯æœ€å¸¸ä½¿ç”¨çš„æ–¹å¼ var a int = 15 æœ€åï¼Œç”±äºå¸¸é‡éƒ¨åˆ†æåˆ°çš„ä¸‰ä¸ª Go çš„ç‰¹æ€§ï¼Œå˜é‡çš„å£°æ˜å’Œä½¿ç”¨ä¹Ÿæœ‰ä¸€äº›ä¸åŒçš„å½¢å¼ ç±»å‹æ¨æ–­ï¼Œä»è€Œå¯ä»¥çœç•¥ç±»å‹å®šä¹‰ var a = 15 å¤šé‡èµ‹å€¼ var a, b, c = 5, 6, 7 æ‰¹é‡å£°æ˜ var ( a = 15 b = false str = \"Go says hello to the world!\" numShips = 50 city string ) ä¸Šé¢æåˆ°çš„æ‰€æœ‰æ–¹å¼å¯ä»¥ç”¨äºå…¨å±€å˜é‡ï¼Œä¹Ÿå¯ä»¥ç”¨äºå±€éƒ¨å˜é‡ï¼Œä½†è¿˜æœ‰ä¸€ç§æ›´åŠ ç®€çŸ­çš„å£°æ˜ä¸å®šä¹‰æ–¹å¼ï¼Œä»…èƒ½ç”¨äºå±€éƒ¨å˜é‡ï¼ˆå‡½æ•°ä½“å†…ï¼ŒåŒ…æ‹¬ main å‡½æ•°ï¼‰ï¼Œè¿™æ˜¯æˆ‘ä»¬ä½¿ç”¨éå¸¸å¤šçš„ä¸€ç§å†™æ³• a := 15 è¿™é‡Œè¯¦ç»†ä»‹ç»ä¸€ä¸‹å¸¸é‡éƒ¨åˆ†æåˆ°è¿‡çš„ç©ºç™½æ ‡è¯†ç¬¦ï¼Œç©ºç™½æ ‡è¯†ç¬¦æŒ‡çš„æ˜¯ä¸‹åˆ’çº¿ _ï¼Œä¹Ÿå«åšåŒ¿åå˜é‡ï¼Œåªå…è®¸å†™å…¥ï¼Œä»»ä½•ç±»å‹éƒ½å¯ä»¥èµ‹å€¼ç»™å®ƒï¼Œä½†æ— æ³•ä½¿ç”¨å®ƒçš„å€¼ã€‚æˆ‘ä»¬åœ¨ä½¿ç”¨ iota å…³é”®å­—æ—¶å¯ä»¥ä½¿ç”¨ç©ºç™½æ ‡è¯†ç¬¦è·³è¿‡ä¸æƒ³è¦çš„å€¼ï¼Œå¦å¤–ä¸€ç§å¸¸è§çš„ä½¿ç”¨åœºæ™¯æ˜¯åœ¨å¤šé‡èµ‹å€¼ä¸­æŠ›å¼ƒä¸éœ€è¦çš„å˜é‡ _, b = 5, 7 åŒ¿åå˜é‡ä¸ä¼šè¢«åˆ†é…å†…å­˜ï¼Œå› æ­¤ä¸å ç”¨å†…å­˜ç©ºé—´ï¼Œå¤šæ¬¡å£°æ˜ä¹Ÿä¸ä¼šå¼•èµ·å†²çªã€‚ Go è¿˜æä¾›äº†ä¸€ç§éå¸¸å‹å¥½çš„åŠŸèƒ½ï¼Œå¦‚æœæƒ³è¦äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ a, b = b, a è¿™ç§å½¢å¼ï¼Œä¸éœ€è¦å†ä½¿ç”¨ä¸´æ—¶å˜é‡ï¼Œä¸ºç¨‹åºç¼–å†™å¸¦æ¥äº†æå¤§çš„ä¾¿åˆ©ã€‚ å˜é‡çš„å‘½åè§„åˆ™æœ€å¥½éµå¾ªé©¼å³°å‘½åæ³•ï¼Œå³é¦–ä¸ªå•è¯å°å†™ï¼Œæ¯ä¸ªæ–°å•è¯çš„é¦–å­—æ¯å¤§å†™ï¼Œä¾‹å¦‚ï¼šnumShipsã€‚ä½†å½“å…¨å±€å˜é‡éœ€è¦å¯¹å¤–éƒ¨åŒ…å¯è§æ—¶ï¼Œé¦–ä¸ªå•è¯é¦–å­—æ¯éœ€è¦å¤§å†™(å¯è§æ€§åŸåˆ™)ã€‚ å˜é‡ä½œç”¨åŸŸçš„è§„åˆ™åŒ C è¯­è¨€ç›¸åŒï¼Œå…³äºå€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„ç†è§£ä¹Ÿå’Œ C è¯­è¨€ç›¸åŒï¼ŒGo ä¸­å¼•ç”¨ç±»å‹åŒ…æ‹¬æŒ‡é’ˆã€åˆ‡ç‰‡ã€æ˜ å°„å’Œé€šé“ï¼Œå€¼ç±»å‹å­˜å‚¨åœ¨æ ˆä¸­ï¼Œå¼•ç”¨ç±»å‹å­˜å‚¨åœ¨å †ä¸­ï¼Œä»¥ä¾¿è¿›è¡Œåƒåœ¾å›æ”¶ã€‚ ","date":"2019-10-22","objectID":"/2019/golang-syntax-3-constants-variables-and-elementary-types/:2:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€3-å¸¸é‡å˜é‡ä¸åŸºæœ¬æ•°æ®ç±»å‹","uri":"/2019/golang-syntax-3-constants-variables-and-elementary-types/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. åŸºæœ¬æ•°æ®ç±»å‹ Go æ‹¥æœ‰ 4 å¤§ç±»å…±7ç§åŸºæœ¬æ•°æ®ç±»å‹ å¸ƒå°”ç±»å‹ bool æ•°å­—ç±»å‹ï¼š æ•´å‹ intï¼Œæ ¹æ®ä½æ•°çš„ä¸åŒåŒ…æ‹¬ int8, int16, int32, int64 å››ç§ä»¥åŠç›¸å¯¹åº”çš„ uint æµ®ç‚¹å‹ floatï¼ŒåŒ…æ‹¬ float32 å’Œ float64 ä¸¤ç§ å¤æ•° complexï¼ŒåŒ…æ‹¬ complex32 å’Œ complex64 ä¸¤ç§ï¼Œå¤æ•°ç±»å‹å¹¶ä¸å¸¸ç”¨ å­—ç¬¦ç±»å‹ï¼š byteï¼Œuint8 çš„åˆ«åï¼Œå®Œå…¨ç­‰åŒ runeï¼Œint32 æ˜¯åˆ«åï¼Œå®Œå…¨ç­‰åŒ å­—ç¬¦ä¸²ç±»å‹ string ","date":"2019-10-22","objectID":"/2019/golang-syntax-3-constants-variables-and-elementary-types/:3:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€3-å¸¸é‡å˜é‡ä¸åŸºæœ¬æ•°æ®ç±»å‹","uri":"/2019/golang-syntax-3-constants-variables-and-elementary-types/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.1 å¸ƒå°”ç±»å‹ ä½¿ç”¨boolå…³é”®å­—å£°æ˜ï¼Œå€¼åªå¯ä»¥æ˜¯å¸¸é‡ true æˆ– false var b bool = true ä¸¤ä¸ªç±»å‹ç›¸åŒçš„å€¼å¯ä»¥ä½¿ç”¨å…³ç³»è¿ç®—ç¬¦æ¥è·å¾—ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„å€¼ã€‚å¸ƒå°”ç±»å‹çš„å€¼ä¹‹é—´ä¹Ÿå¯ä»¥ä½¿ç”¨é€»è¾‘è¿ç®—ç¬¦æ¥äº§ç”Ÿå¦ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¿ç®—è§„åˆ™ä¸å…¶å®ƒè¯­è¨€ç›¸åŒã€‚ ç±»å‹ç›¸åŒæ˜¯ä¸€ä¸ªå¾ˆä¸¥æ ¼çš„è§„å®šï¼Œæ¶‰åŠåˆ°äº† Go çš„æ¯”è¾ƒè§„åˆ™ï¼Œæˆ‘ä»¬å°† Go ä¸­ä¸å¯æ¯”è¾ƒç±»å‹æ€»ç»“å¦‚ä¸‹ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå…¶å®ƒç±»å‹éƒ½æ˜¯å¯æ¯”è¾ƒçš„ åˆ‡ç‰‡ç±»å‹ æ˜ å°„ç±»å‹ å‡½æ•°ç±»å‹ ä»»ä½•å­—æ®µä¸ºä¸å¯æ¯”è¾ƒç±»å‹çš„ç»“æ„ä½“ç±»å‹ï¼Œä»¥åŠä»»ä½•å…ƒç´ ç±»å‹ä¸ºä¸å¯æ¯”è¾ƒç±»å‹çš„æ•°ç»„ç±»å‹ å¯¹äºæ¥å£è€Œè¨€ï¼Œæƒ…å†µæ›´åŠ å¤æ‚ä¸€ç‚¹ï¼Œå¦‚æœå€¼çš„ç±»å‹æ˜¯æ¥å£ï¼Œé‚£ä¹ˆå®ƒä»¬å¿…é¡»å®ç°äº†ç›¸åŒçš„æ¥å£ã€‚å¦‚æœæ¡ä»¶ä¸æ»¡è¶³ï¼Œåˆ™å¿…é¡»äº‹å…ˆè¿›è¡Œç±»å‹è½¬æ¢æ‰å¯ä»¥æ¯”è¾ƒã€‚æˆ–è€…ç›´æ¥ä¸€ç‚¹ï¼Œ å¸ƒå°”å€¼ï¼ˆä»¥åŠä»»ä½•ç»“æœä¸ºå¸ƒå°”å€¼çš„è¡¨è¾¾å¼ï¼‰æœ€å¸¸ç”¨åœ¨æµç¨‹æ§åˆ¶çš„çš„æ¡ä»¶è¯­å¥ä¸­ï¼Œå¦‚ï¼šifã€for å’Œ switch ç»“æ„ã€‚ å¦å¤–å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼ŒGo ä¸­çš„å¸ƒå°”å€¼å¹¶ä¸ç­‰äºæ•°å­— 1 å’Œ 0ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥è¿›è¡Œè¿ç®—ã€‚ ","date":"2019-10-22","objectID":"/2019/golang-syntax-3-constants-variables-and-elementary-types/:3:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€3-å¸¸é‡å˜é‡ä¸åŸºæœ¬æ•°æ®ç±»å‹","uri":"/2019/golang-syntax-3-constants-variables-and-elementary-types/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.2 æ•°å­—ç±»å‹ Go ä¸­æ•°å­—ç±»å‹åˆ†ä¸ºä¸‰ç§ï¼Œæ•´å‹ã€æµ®ç‚¹å‹å’Œå¤æ•°ç±»å‹ã€‚ æ•´å‹ æ•´å‹æä¾›æœ‰ç¬¦å·å’Œæ— ç¬¦å·ä¸¤ç§ï¼Œæ¯ä¸€ç§åˆåˆ†åˆ«æä¾›å¯¹åº” 8ã€16ã€32ã€64bit å¤§å°çš„å››ç§ç±»å‹ï¼Œæ€»è®¡å…«ç§ï¼Œåˆ—è¡¨å¦‚ä¸‹ æ•´å‹ æ— ç¬¦å·æ•´å‹ int8ï¼ˆ-128 -\u003e 127ï¼‰ uint8ï¼ˆ0 -\u003e 255ï¼‰ int16ï¼ˆ-32768 -\u003e 32767ï¼‰ uint16ï¼ˆ0 -\u003e 65,535ï¼‰ int32ï¼ˆ-2,147,483,648 -\u003e 2,147,483,647ï¼‰ uint32ï¼ˆ0 -\u003e 4,294,967,295ï¼‰ int64ï¼ˆ-9,223,372,036,854,775,808 -\u003e 9,223,372,036,854,775,807ï¼‰ uint64ï¼ˆ0 -\u003e 18,446,744,073,709,551,615ï¼‰ é™¤æ­¤ä¹‹å¤–è¿˜æä¾›ä¸¤ç§ä¸å¸¦ä½æ•°çš„ç±»å‹å£°æ˜ï¼šint å’Œ uintã€‚è¿™ä¸¤ç§ç±»å‹çš„å¤§å°å–å†³äºæ‰€è¿è¡Œçš„å¹³å°å¤„ç†å™¨æ”¯æŒçš„å­—é•¿ï¼Œä¾‹å¦‚ï¼Œåœ¨ 32 ä½æ“ä½œç³»ç»Ÿä¸Šï¼Œä½¿ç”¨ 32 ä½ï¼ˆ4 ä¸ªå­—èŠ‚ï¼‰ï¼Œåœ¨ 64 ä½æ“ä½œç³»ç»Ÿä¸Šï¼Œä½¿ç”¨ 64 ä½ï¼ˆ8 ä¸ªå­—èŠ‚ï¼‰ã€‚ å°½ç®¡ int æœ‰å¯èƒ½æ˜¯ 32 ä½ï¼Œä½†åœ¨éœ€è¦æ—¶ int å’Œ int32 ä¹‹é—´ä¹Ÿå¿…é¡»æ˜¾å¼è¿›è¡Œç±»å‹è½¬æ¢ã€‚ æœ€åè¿˜æœ‰ä¸€ç§æ— ç¬¦å·æ•´å‹ uintptrï¼Œå®ƒæ²¡æœ‰æŒ‡å®šå…·ä½“çš„ bit å¤§å°ä½†è¢«è®¾å®šä¸ºè¶³å¤Ÿå®¹çº³ä¸€ä¸ªæŒ‡é’ˆã€‚uintptr ç±»å‹åªæœ‰åœ¨åº•å±‚ç¼–ç¨‹æ—¶æ‰éœ€è¦ï¼Œç‰¹åˆ«æ˜¯ Go è¯­è¨€å’Œ C è¯­è¨€å‡½æ•°åº“æˆ–æ“ä½œç³»ç»Ÿæ¥å£ç›¸äº¤äº’çš„åœ°æ–¹ï¼Œä¸€èˆ¬ç”¨äºæŒ‡é’ˆè®¡ç®—ã€‚ intå‹æ˜¯è®¡ç®—æœ€å¿«çš„ç±»å‹ï¼Œä¹Ÿæ˜¯æœ€å¸¸ä½¿ç”¨çš„ç±»å‹ã€‚ æµ®ç‚¹å‹ Go è¯­è¨€ä¸­æ²¡æœ‰ float ç±»å‹ï¼Œæ²¡æœ‰ double ç±»å‹ï¼Œåªæœ‰ float32 å’Œ float64ã€‚å®ƒä»¬çš„ç®—æœ¯è§„èŒƒç”±IEEE-754æ ‡å‡†å®šä¹‰ï¼Œè¯¥æ ‡å‡†è¢«æ‰€æœ‰ç°ä»£çš„ CPU æ”¯æŒã€‚ float32 ç²¾ç¡®åˆ°å°æ•°ç‚¹å 7 ä½ï¼Œfloat64 ç²¾ç¡®åˆ°å°æ•°ç‚¹å 15 ä½ã€‚é€šå¸¸åº”è¯¥ä¼˜å…ˆä½¿ç”¨ float64 ç±»å‹ï¼Œå› ä¸º math åŒ…ä¸­æ‰€æœ‰æœ‰å…³æ•°å­¦è¿ç®—çš„å‡½æ•°éƒ½ä¼šè¦æ±‚æ¥æ”¶è¿™ä¸ªç±»å‹ã€‚ å¤æ•°ç±»å‹ Goè¯­è¨€æ‹¥æœ‰ä¸¤ç§å¤æ•°ç±»å‹ï¼Œåˆ†åˆ«æ˜¯ complex64ï¼ˆ32 ä½å®æ•°å’Œè™šæ•°ï¼‰å’Œ complex128ï¼ˆ64 ä½å®æ•°å’Œè™šæ•°ï¼‰ã€‚ var c1 complex64 = 5 + 10i å†…ç½®çš„ complex å‡½æ•°ç”¨äºæ„å»ºå¤æ•°ï¼Œå†…ç½®çš„ real å’Œ imag å‡½æ•°åˆ†åˆ«è¿”å›å¤æ•°çš„å®éƒ¨å’Œè™šéƒ¨ï¼š var cl complex128 = complex(1, 2) // 1+2i fmt.Println(real(cl)) // \"1\" fmt.Println(imag(cl)) // \"2\" cmath åŒ…ä¸­åŒ…å«äº†ä¸€äº›æ“ä½œå¤æ•°çš„å…¬å…±æ–¹æ³•ã€‚å¦‚æœå¯¹å†…å­˜çš„è¦æ±‚ä¸æ˜¯ç‰¹åˆ«é«˜ï¼Œæœ€å¥½ä½¿ç”¨ complex128 ä½œä¸ºè®¡ç®—ç±»å‹ï¼Œå› ä¸ºç›¸å…³å‡½æ•°éƒ½ä½¿ç”¨è¿™ä¸ªç±»å‹çš„å‚æ•°ã€‚ ","date":"2019-10-22","objectID":"/2019/golang-syntax-3-constants-variables-and-elementary-types/:3:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€3-å¸¸é‡å˜é‡ä¸åŸºæœ¬æ•°æ®ç±»å‹","uri":"/2019/golang-syntax-3-constants-variables-and-elementary-types/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.3 å­—ç¬¦ç±»å‹ Goè¯­è¨€çš„å­—ç¬¦æœ‰ä¸¤ç§ï¼š byte å‹ï¼Œä»£è¡¨äº† ASCII ç çš„ä¸€ä¸ªå­—ç¬¦ã€‚ rune ç±»å‹ï¼Œä»£è¡¨ä¸€ä¸ª UTF-8 å­—ç¬¦ï¼Œå½“éœ€è¦å¤„ç†ä¸­æ–‡ã€æ—¥æ–‡æˆ–è€…å…¶ä»–å¤åˆå­—ç¬¦æ—¶ï¼Œåˆ™éœ€è¦ç”¨åˆ° rune ç±»å‹ã€‚ ä¸¥æ ¼æ¥è¯´ï¼Œå­—ç¬¦åªæ˜¯æ•´æ•°çš„ç‰¹æ®Šç”¨ä¾‹ã€‚byte ç±»å‹æ˜¯ uint8 çš„åˆ«åï¼Œåˆšå¥½ä¸€ä¸ªå­—èŠ‚ï¼Œè¶³ä»¥è¡¨ç¤ºä¼ ç»Ÿ ASCII ç¼–ç çš„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼švar ch byte = 'A'ï¼›runeæ˜¯int32çš„åˆ«åï¼Œå››ä¸ªå­—èŠ‚ï¼Œè¶³ä»¥è¡¨ç¤ºæœ€é•¿çš„UTF-8å­—ç¬¦ã€‚ å¦ä¸€æ–¹é¢ï¼Œç”±äºå­—ç¬¦åªæ˜¯æ•´æ•°çš„åˆ«åï¼Œå› æ­¤å…¶é›¶å€¼ä¹Ÿæ˜¯ 0ã€‚ å­—ç¬¦ä½¿ç”¨å•å¼•å·æ‹¬èµ·æ¥ã€‚ åŒ… unicode åŒ…å«äº†ä¸€äº›é’ˆå¯¹æµ‹è¯•å­—ç¬¦çš„éå¸¸æœ‰ç”¨çš„å‡½æ•°ï¼ˆå…¶ä¸­ ch ä»£è¡¨å­—ç¬¦ï¼‰ï¼š åˆ¤æ–­æ˜¯å¦ä¸ºå­—æ¯ï¼šunicode.IsLetter(ch) åˆ¤æ–­æ˜¯å¦ä¸ºæ•°å­—ï¼šunicode.IsDigit(ch) åˆ¤æ–­æ˜¯å¦ä¸ºç©ºç™½ç¬¦å·ï¼šunicode.IsSpace(ch) è¿™äº›å‡½æ•°è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚åŒ… utf8 æ‹¥æœ‰æ›´å¤šä¸ rune ç›¸å…³çš„å‡½æ•°ã€‚ ","date":"2019-10-22","objectID":"/2019/golang-syntax-3-constants-variables-and-elementary-types/:3:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€3-å¸¸é‡å˜é‡ä¸åŸºæœ¬æ•°æ®ç±»å‹","uri":"/2019/golang-syntax-3-constants-variables-and-elementary-types/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.4 å­—ç¬¦ä¸²ç±»å‹ å­—ç¬¦ä¸²åº•å±‚çº¦å®šæ˜¯å­—èŠ‚çš„ä¸€ä¸ªåºåˆ—ï¼Œç¼–ç æ–¹å¼å»ºè®®æ˜¯ UTF-8ï¼Œä½†ä¸æ˜¯å¿…é¡»éµå®ˆï¼Œé€šå¸¸æ˜¯ASCIIã€‚å› æ­¤å–å­—ç¬¦ä¸²å•ä¸ªå­—ç¬¦çš„ç±»å‹é€šå¸¸æ˜¯ byteï¼Œåªæœ‰é‡åˆ°ä¸­æ–‡ç­‰è¯­è¨€æ˜¯æ‰æ˜¯ runeã€‚å¦å¤–ï¼Œä½¿ç”¨ for-range ç»“æ„éå†æ—¶å­—ç¬¦ä¸²çš„å•ä¸ªå­—ç¬¦ç±»å‹æ˜¯rune å­—ç¬¦ä¸²æ˜¯å€¼ç±»å‹ï¼Œä¸”å€¼ä¸å¯å˜ï¼Œå³åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²åæ— æ³•å†æ¬¡ä¿®æ”¹å®ƒçš„å†…å®¹ Go æ”¯æŒä»¥ä¸‹ 2 ç§å½¢å¼çš„å­—ç¬¦ä¸²ï¼š è§£é‡Šå­—ç¬¦ä¸²ï¼šè¯¥ç±»å­—ç¬¦ä¸²ä½¿ç”¨åŒå¼•å·æ‹¬èµ·æ¥ï¼Œå…¶ä¸­çš„è½¬ä¹‰å­—ç¬¦å°†è¢«æ›¿æ¢ï¼Œè¿™äº›è½¬ä¹‰å­—ç¬¦åŒ…æ‹¬ï¼š \\nï¼šæ¢è¡Œç¬¦ \\rï¼šå›è½¦ç¬¦ \\tï¼štab é”® \\u æˆ– \\Uï¼šUnicode å­—ç¬¦ \\\\ï¼šåæ–œæ è‡ªèº« éè§£é‡Šå­—ç¬¦ä¸²ï¼šè¯¥ç±»å­—ç¬¦ä¸²ä½¿ç”¨åå¼•å·æ‹¬èµ·æ¥ï¼Œå½“ä½¿ç”¨å¤šè¡Œå­—ç¬¦ä¸²æ—¶ä½¿ç”¨è¿™ç§å½¢å¼ã€‚ a := `abc def` fmt.Println(a) // Output: abc def string ç±»å‹çš„é›¶å€¼ä¸ºé•¿åº¦ä¸ºé›¶çš„å­—ç¬¦ä¸²ï¼Œå³ç©ºå­—ç¬¦ä¸² \"\"ã€‚ Go ä¸­çš„å­—ç¬¦ä¸²æ˜¯æ ¹æ®é•¿åº¦é™å®šçš„ï¼Œè€Œéç‰¹æ®Šå­—ç¬¦\\0ï¼Œå…¶é•¿åº¦å¯ä»¥ä½¿ç”¨å†…ç½®å‡½æ•°len()æ¥è·å–ï¼Œé•¿åº¦çš„åŸºæœ¬å«ä¹‰æ˜¯å­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­æ‰€å å­—èŠ‚çš„ä¸ªæ•°ï¼Œæ‰€ä»¥ä¸‹é¢çš„ä¾‹å­è™½ç„¶æ˜¯ä¸¤ä¸ªä¸­æ–‡ï¼Œä½†é•¿åº¦æ˜¯6 a := \"ä¸­å›½\" fmt.Println(len(a)) // 6 å¯ä»¥å°†å­—ç¬¦ä¸²çœ‹ä½œæ•°ç»„è€Œç´¢å¼•å…¶å†…çš„å•ä¸ªå­—ç¬¦ï¼Œå¦‚ç¬¬iä¸ªå­—èŠ‚è¡¨ç¤ºä¸ºstr[i-1] ä½¿ç”¨æ‹¼æ¥ç¬¦+å¯ä»¥æ‹¼æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªå¤šè¡Œå­—ç¬¦ä¸²æ‹¼æ¥çš„ä¾‹å­ str := \"Beginning of the string \" + \"second part of the string\" +å¿…é¡»æ”¾åœ¨ç¬¬ä¸€è¡Œæœ«å°¾ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¼šåœ¨è¡Œå°¾è‡ªåŠ¨è¡¥å…¨åˆ†å·ã€‚å½“ç„¶ï¼Œ+=ä¸€æ ·å¯ç”¨äºå­—ç¬¦ä¸² s := \"hel\" + \"lo,\" s += \"world!\" fmt.Println(s) //è¾“å‡º â€œhello, world!â€ åœ¨å¾ªç¯ä¸­ä½¿ç”¨+æ‹¼æ¥å­—ç¬¦ä¸²å¹¶ä¸æ˜¯æœ€é«˜æ•ˆçš„åšæ³•ï¼Œæ›´å¥½çš„åŠæ³•æ˜¯ä½¿ç”¨string.join()ï¼Œæˆ–è€…ä½¿ç”¨å­—èŠ‚ç¼“å†²bytes.Buffer ","date":"2019-10-22","objectID":"/2019/golang-syntax-3-constants-variables-and-elementary-types/:3:4","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€3-å¸¸é‡å˜é‡ä¸åŸºæœ¬æ•°æ®ç±»å‹","uri":"/2019/golang-syntax-3-constants-variables-and-elementary-types/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.5 ç±»å‹åˆ«å ä½¿ç”¨æŸä¸ªç±»å‹æ—¶å¯ä»¥ç»™å®ƒèµ·ä¸ªåˆ«ååœ¨ç¨‹åºä¸­ä½¿ç”¨ï¼Œç”¨äºç®€åŒ–åç§°æˆ–è§£å†³åç§°å†²çª åœ¨ type TZ int ä¸­ï¼ŒTZ å°±æ˜¯ int ç±»å‹çš„æ–°åç§°ï¼ˆç”¨äºè¡¨ç¤ºç¨‹åºä¸­çš„æ—¶åŒºï¼‰ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨ TZ æ¥æ“ä½œ int ç±»å‹çš„æ•°æ®ã€‚ package main import \"fmt\" type TZ int func main() { var a, b TZ = 3, 4 c := a + b fmt.Printf(\"c has the value: %d\", c) // è¾“å‡ºï¼šc has the value: 7 } å®é™…ä¸Šï¼Œç±»å‹åˆ«åå¾—åˆ°çš„æ–°ç±»å‹å¹¶éå’ŒåŸç±»å‹å®Œå…¨ç›¸åŒï¼Œæ–°ç±»å‹ä¸ä¼šæ‹¥æœ‰åŸç±»å‹æ‰€é™„å¸¦çš„æ–¹æ³•ï¼›TZ å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªæ–¹æ³•ç”¨æ¥è¾“å‡ºæ›´åŠ äººæ€§åŒ–çš„æ—¶åŒºä¿¡æ¯ã€‚ ","date":"2019-10-22","objectID":"/2019/golang-syntax-3-constants-variables-and-elementary-types/:3:5","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€3-å¸¸é‡å˜é‡ä¸åŸºæœ¬æ•°æ®ç±»å‹","uri":"/2019/golang-syntax-3-constants-variables-and-elementary-types/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. ç±»å‹è½¬æ¢ Goè¯­è¨€ä¸­ç±»å‹è½¬æ¢æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯ä¸å­˜åœ¨éšå¼ç±»å‹è½¬æ¢ï¼Œæ‰€æœ‰çš„è½¬æ¢éƒ½å¿…é¡»æ˜¾å¼è¯´æ˜ã€‚ç±»å‹è½¬æ¢çš„åŸºæœ¬æ ¼å¼ä¸º valueOfTypeB = typeB(valueOfTypeA) ä¸¤æ¡è½¬æ¢åŸåˆ™å¦‚ä¸‹ åªæœ‰ç›¸åŒåº•å±‚ç±»å‹çš„å˜é‡é—´å¯ä»¥è¿›è¡Œç›¸äº’è½¬æ¢ï¼ˆå¦‚int16å’Œint32ï¼‰ï¼Œä¸åŒåº•å±‚ç±»å‹çš„å˜é‡ç›¸äº’è½¬æ¢ä¼šå¼•å‘ç¼–è¯‘é”™è¯¯ ç±»å‹è½¬æ¢åªæœ‰ä»å–å€¼èŒƒå›´å°çš„ç±»å‹è½¬æ¢åˆ°å–å€¼èŒƒå›´å¤§çš„ç±»å‹æ‰èƒ½æˆåŠŸï¼Œåè¿‡æ¥ä¼šå‘ç”Ÿç²¾åº¦ä¸¢å¤±ï¼ˆæˆªæ–­ï¼‰ var a,b int16 var c int32 A := int32(a) // æ ‡å‡†è½¬æ¢ B := bool(b) //ç±»å‹ä¸åŒ¹é…ï¼Œå¼•å‘ç¼–è¯‘é”™è¯¯ C := int16(c) //å–å€¼èŒƒå›´å˜å°ï¼Œç²¾åº¦ä¸¢å¤± æµ®ç‚¹å‹å¯ä»¥è½¬æ¢ä¸ºæ•´å‹ï¼Œè½¬æ¢æ—¶ä¼šå°†å°æ•°éƒ¨åˆ†å»æ‰ï¼Œåªä¿ç•™æ•´æ•°éƒ¨åˆ† a := 12.54 fmt.Println(int(a)) //è¾“å‡º12 ç²¾åº¦ä¸¢å¤±å¯ä»¥ä½¿ç”¨ä¸“é—¨çš„å‡½æ•°ä¿è¯å®‰å…¨ï¼Œå¦‚intå‹åˆ°int8 func Uint8FromInt(n int) (uint8, error) { if 0 \u003c= n \u0026\u0026 n \u003c= math.MaxUint8 { // conversion is safe return uint8(n), nil } return 0, fmt.Errorf(\"%d is out of the uint8 range\", n) } å…¶å®ƒçš„ç±»å‹è½¬æ¢åˆ™éœ€è¦ä½¿ç”¨ä¸€äº›åº“å‡½æ•° ","date":"2019-10-22","objectID":"/2019/golang-syntax-3-constants-variables-and-elementary-types/:4:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€3-å¸¸é‡å˜é‡ä¸åŸºæœ¬æ•°æ®ç±»å‹","uri":"/2019/golang-syntax-3-constants-variables-and-elementary-types/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4.1 boolä¸string Goè¯­è¨€ä¸­boolç±»å‹å€¼ä¸æ•°å­—1å’Œ0ä¸ç­‰åŒï¼Œå› æ­¤ä¸èƒ½å’Œæ•°å­—ç±»å‹ç›¸äº’è½¬æ¢ï¼ˆå¯ä»¥ç®€å•çš„ä½¿ç”¨if-elseç»“æ„å®Œæˆè¿™ä¸€åŠŸèƒ½ï¼‰ã€‚ä½†å€ŸåŠ©strconvåŒ…ï¼Œå¯ä»¥å’Œstringç±»å‹è½¬æ¢ã€‚ //string-\u003ebool b, err := strconv.ParseBool(\"true\") //bool-\u003estring s := strconv.FormatBool(true) ä¸¤ä¸ªå‡½æ•°çš„åŸå‹å¦‚ä¸‹ //ParseBoolè¿”å›å­—ç¬¦ä¸²ä»£è¡¨çš„boolå€¼ï¼Œæ¥å— 1, t, T, TRUE, true, True, 0, f, F, FALSE, false, Falseä½œä¸ºä¼ å…¥å‚æ•°ï¼Œå…¶ä»–å‚æ•°å‡è¿”å›error func ParseBool(str string) (bool, error) { switch str { case \"1\", \"t\", \"T\", \"true\", \"TRUE\", \"True\": return true, nil case \"0\", \"f\", \"F\", \"false\", \"FALSE\", \"False\": return false, nil } return false, syntaxError(\"ParseBool\", str) } // FormatBool returns \"true\" or \"false\" according to the value of b. func FormatBool(b bool) string { if b { return \"true\" } return \"false\" } ","date":"2019-10-22","objectID":"/2019/golang-syntax-3-constants-variables-and-elementary-types/:4:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€3-å¸¸é‡å˜é‡ä¸åŸºæœ¬æ•°æ®ç±»å‹","uri":"/2019/golang-syntax-3-constants-variables-and-elementary-types/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4.2 int/floatä¸string ä¸å­—ç¬¦ä¸²ç›¸å…³çš„ç±»å‹è½¬æ¢éƒ½æ˜¯é€šè¿‡strconvåŒ…å®ç°çš„ã€‚æœ€å¸¸ç”¨çš„æ˜¯Atoi(string to int)å’ŒItoa(int to string)å‡½æ•° i, err := strconv.Atoi(\"-42\") s := strconv.Itoa(-42) å‡½æ•°åŸå‹å¦‚ä¸‹ func Atoi(s string) (int, error) func Itoa(i int) string å­—ç¬¦ä¸²-\u003eæ•°å­—ç±»å‹ ParseFloat, ParseInt, å’ŒParseUintå¯ä»¥å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå¯¹åº”çš„å€¼ f, err := strconv.ParseFloat(\"3.1415\", 64) i, err := strconv.ParseInt(\"-42\", 10, 64) u, err := strconv.ParseUint(\"42\", 10, 64) æµ®ç‚¹å‹å‡½æ•°åŸå‹å¦‚ä¸‹ func ParseFloat(s string, bitSize int) (float64, error) bitSizeæŒ‡å®šäº†è¿”å›å€¼çš„ç±»å‹ï¼Œå½“bitSize=32ï¼Œè¿”å›float32ç±»å‹ï¼ˆç»“æœä»æ˜¯float64ï¼Œä½†ä¼šè½¬æ¢ä¸ºfloat32)ï¼›å½“bitSize=64ï¼Œè¿”å›float64ç±»å‹ã€‚åªæœ‰è¿™ä¸¤ç§æƒ…å†µã€‚ æ•´å‹å‡½æ•°åŸå‹å¦‚ä¸‹ func ParseInt(s string, base int, bitSize int) (i int64, err error) func ParseUint(s string, base int, bitSize int) (uint64, error) å¦‚æœbaseä¸º0é‚£ä¹ˆå®é™…ä¸Šbaseç”±stringçš„å‰ç¼€æŒ‡å®šï¼Œ0xæ„å‘³ç€base=16ï¼Œ0æ„å‘³ç€base=8ï¼Œå¦åˆ™base=10ï¼Œæœ¬è´¨ä¸Šæ˜¯è¿›åˆ¶çš„å‰ç¼€ã€‚è‹¥baseç­‰äº1ï¼Œå°äº0æˆ–è¶…è¿‡36ï¼Œè¿”å›ä¸€ä¸ªerrorã€‚ bitSizeä»ç„¶æŒ‡å®šè¿”å›å€¼ç±»å‹. å…¶å€¼ä¸º 0, 8, 16, 32, å’Œ 64 åˆ†åˆ«å¯¹åº” int, int8, int16, int32å’Œint64. bitSizeå€¼å°äº0æˆ–å¤§äº64ï¼Œè¿”å›ä¸€ä¸ªerrorã€‚ æ•°å­—ç±»å‹-\u003eå­—ç¬¦ä¸² FormatFloat, FormatInt, å’ŒFormatUintå¯ä»¥å°†å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸² s := strconv.FormatFloat(3.1415, 'E', -1, 64) s := strconv.FormatInt(-42, 16) s := strconv.FormatUint(42, 16) æµ®ç‚¹å‹çš„å‡½æ•°åŸå‹å¦‚ä¸‹ func FormatFloat(f float64, fmt byte, prec, bitSize int) string bitSizeè¡¨ç¤ºfçš„æ¥æºç±»å‹ï¼ˆ32ï¼šfloat32ã€64ï¼šfloat64ï¼‰ï¼Œä¼šæ®æ­¤è¿›è¡Œèˆå…¥ã€‚ fmtè¡¨ç¤ºæ ¼å¼ï¼šâ€˜bâ€™ (-ddddpÂ±ddd, äºŒè¿›åˆ¶æŒ‡æ•°), â€˜eâ€™ (-d.ddddeÂ±dd,åè¿›åˆ¶æŒ‡æ•°), â€˜Eâ€™ (-d.ddddEÂ±dd, åè¿›åˆ¶æŒ‡æ•°), â€˜fâ€™ (-ddd.dddd, æ²¡æœ‰æŒ‡æ•°), â€˜gâ€™ (æŒ‡æ•°å¾ˆå¤§æ—¶ç”¨â€˜e', å¦åˆ™ç”¨ â€˜fâ€™ ), â€˜Gâ€™ (æŒ‡æ•°å¾ˆå¤§æ—¶ç”¨â€˜E', å¦åˆ™ç”¨ â€˜fâ€™ ). ç²¾åº¦precæ§åˆ¶æ•°å­—çš„ä¸ªæ•° (æ’é™¤æŒ‡æ•°)ã€‚å¯¹â€™e', â€˜Eâ€™, å’Œ â€˜fâ€™ ï¼Œè¡¨ç¤ºå°æ•°ç‚¹åçš„æ•°å­—ä½æ•°. å¯¹ â€˜gâ€™ å’Œ â€˜Gâ€™ æ˜¯æœ‰æ•ˆæ•°å­—ä½æ•° (trailing zeros are removed)ã€‚precç­‰äº-1æ—¶åˆ™ä½¿ç”¨æœ€å°‘æ•°é‡ä½†åˆå¿…é¡»çš„æ•°å­—æ¥è¡¨ç¤ºfã€‚ æ•´å‹çš„å‡½æ•°åŸå‹å¦‚ä¸‹ func FormatInt(i int64, base int) string func FormatUint(i uint64, base int) string è¿”å›baseæŒ‡å®šè¿›åˆ¶çš„æ•´æ•°içš„å­—ç¬¦ä¸²å½¢å¼ï¼Œ2 \u003c= base \u003c= 36ã€‚ä½¿ç”¨å°å†™å­—æ¯ â€˜aâ€™ åˆ° â€˜zâ€™ è¡¨ç¤ºå¤§äº10çš„æ•°å­—ã€‚ å¿½ç•¥å¯èƒ½å‡ºç°çš„è½¬æ¢é”™è¯¯ï¼Œå¯ä»¥ç»™å‡ºå¦‚ä¸‹ä¾‹å­ï¼š package main import ( \"fmt\" \"strconv\" ) func main() { var orig string = \"666\" var an int var newS string an, _ = strconv.Atoi(orig) fmt.Printf(\"The integer is: %d\\n\", an) an = an + 5 newS = strconv.Itoa(an) fmt.Printf(\"The new string is: %s\\n\", newS) } //è¾“å‡ºï¼š The integer is: 666 The new string is: 671 ","date":"2019-10-22","objectID":"/2019/golang-syntax-3-constants-variables-and-elementary-types/:4:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€3-å¸¸é‡å˜é‡ä¸åŸºæœ¬æ•°æ®ç±»å‹","uri":"/2019/golang-syntax-3-constants-variables-and-elementary-types/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4.3 []runeä¸string ç”¨ for range éå†å­—ç¬¦ä¸²å¯ä»¥è¿”å›æ¯ä¸ªå­—ç¬¦ï¼Œè¿”å›çš„å­—ç¬¦ç±»å‹æ˜¯ runeã€‚ä½† []rune ç±»å‹ä¹Ÿç»å¸¸éœ€è¦è½¬æ¢ä¸º stringï¼Œå’Œå•ä¸ª rune ç±»å‹ç›¸ä¼¼ï¼Œéƒ½å¯ä»¥ç›´æ¥è¿›è¡Œæ˜¾ç¤ºç±»å‹è½¬æ¢ï¼Œå¦‚ä¸‹ï¼š a := []rune{'a', 'b', 'c'} b := 'g' c := string(a) d := string(b) fmt.Println(reflect.TypeOf(a), reflect.TypeOf(b), reflect.TypeOf(c), reflect.TypeOf(d)) fmt.Println(a, b, c, d) //Output []int32 int32 string string [97 98 99] 103 abc g ","date":"2019-10-22","objectID":"/2019/golang-syntax-3-constants-variables-and-elementary-types/:4:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€3-å¸¸é‡å˜é‡ä¸åŸºæœ¬æ•°æ®ç±»å‹","uri":"/2019/golang-syntax-3-constants-variables-and-elementary-types/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æœ¬ç¯‡ä»‹ç»Goä¸­çš„åŸºç¡€å‘½ä»¤ï¼ŒåŒ…å’Œæ¨¡å—ã€‚ ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:0:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. å‘½ä»¤ Go åœ¨å®‰è£…åè‡ªå¸¦ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œåä¸º goï¼Œç”¨æ¥ä¸‹è½½ã€ç¼–è¯‘ã€å®‰è£…ã€æµ‹è¯• Go çš„åŒ…å’Œæºæ–‡ä»¶ï¼Œå…³äº Go CLI çš„å‘å±•å†å²å’Œè®¾è®¡ç†å¿µï¼Œå¯ä»¥æŸ¥çœ‹ About the go commandï¼Œè¿™é‡Œåªä»‹ç»å¦‚ä½•ä½¿ç”¨è¿™äº›å‘½ä»¤ã€‚ Go å‘½ä»¤çš„ç”¨æ³•å¦‚ä¸‹ go \u003ccommand\u003e [arguments] å¯ç”¨å‘½ä»¤å¦‚ä¸‹ï¼Œä½¿ç”¨ go help \u003ccommand\u003e å¯è·å–å¯¹åº”å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ bug start a bug report build compile packages and dependencies clean remove object files and cached files doc show documentation for package or symbol env print Go environment information fix update packages to use new APIs fmt gofmt (reformat) package sources generate generate Go files by processing source get add dependencies to current module and install them install compile and install packages and dependencies list list packages or modules mod module maintenance run compile and run Go program test test packages tool run specified go tool version print Go version vet report likely mistakes in packages å…¶å®ƒçš„ä¸€äº›å¸®åŠ©ä¸»é¢˜å¦‚ä¸‹ï¼Œä½¿ç”¨ go help \u003ctopic\u003e å¯ä»¥æŸ¥çœ‹ç›¸å…³ä¸»é¢˜çš„è¯´æ˜ buildmode build modes c calling between Go and C cache build and test caching environment environment variables filetype file types go.mod the go.mod file gopath GOPATH environment variable gopath-get legacy GOPATH go get goproxy module proxy protocol importpath import path syntax modules modules, module versions, and more module-get module-aware go get module-auth module authentication using go.sum module-private module configuration for non-public modules packages package lists and patterns testflag testing flags testfunc testing functions æˆ‘ä»¬ä¹‹å‰å·²ç»æ¥è§¦è¿‡å‡ ç§å‘½ä»¤ï¼ŒåŒ…æ‹¬æŸ¥çœ‹ç¯å¢ƒå˜é‡çš„ go envï¼ŒæŸ¥çœ‹goç‰ˆæœ¬çš„ go versionï¼Œç”¨äºç¼–è¯‘å’Œå®‰è£…çš„go installå’Œgo buildï¼Œå·²ç»å¯¹å®ƒä»¬æœ‰äº†ä¸€å®šçš„äº†è§£ï¼Œä¸‹é¢è¯¦ç»†è§£é‡Šæ‰€æœ‰çš„å‘½ä»¤ï¼Œæ˜ç¡®å®ƒä»¬çš„ä½œç”¨ï¼Œå¼„æ¸…æ¥šå®ƒä»¬çš„åŒºåˆ«ã€‚ ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:1:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.1 command å½“å‰å‘½ä»¤ä¸€å…±17ä¸ªï¼Œä½¿ç”¨ go help \u003ccommand\u003eå¯ä»¥æŸ¥çœ‹è¿™äº›å‘½ä»¤çš„è¯¦ç»†è¯´æ˜ go build go build [-o output] [-i] [build flags] [packages] go build ç¼–è¯‘å¯¼å…¥çš„åŒ…å’Œä¾èµ–ï¼Œä½†ä¼šå¿½ç•¥æ‰ä»¥ _test.go ç»“å°¾çš„æ–‡ä»¶ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶æ˜¯ç”¨æ¥æµ‹è¯•çš„ã€‚ ç¼–è¯‘mainåŒ…æ—¶ï¼Œè¾“å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶ä¼šæ”¾åˆ°å½“å‰ç›®å½•ä¸‹ï¼Œå¯æ‰§è¡Œæ–‡ä»¶çš„åç¼€å–å†³äºæ“ä½œç³»ç»Ÿï¼Œåªæœ‰åœ¨windowsä¸‹åç¼€æ‰ä¼šæ˜¯.exeï¼Œè€Œå¯æ‰§è¡Œæ–‡ä»¶çš„åå­—åŒç¼–è¯‘çš„goæ–‡ä»¶åç›¸åŒï¼Œå¦‚ed.goä¼šç¼–è¯‘æˆed.exeã€‚ ç¼–è¯‘å¤šä¸ªåŒ…æˆ–å•ä¸ªémainåŒ…æ—¶ï¼Œç¼–è¯‘å™¨ä¸ä¼šè¾“å‡ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»…ä»…ä½œä¸ºè¿™äº›åŒ…æ˜¯å¦å¯ç¼–è¯‘çš„ä¸€ä¸ªæ£€æŸ¥ã€‚ ä»¥ hello world ç¨‹åºä¸ºä¾‹ï¼Œç¼–è¯‘åçš„ hello.exe æ–‡ä»¶ä½äºé¡¹ç›®æ ¹ç›®å½•ä¸‹ $ go build github.com/shuzang/hello $ ls go.mod go.sum gotest.exe main.go åŠ å…¥ -o å‚æ•°å¯ä»¥æŒ‡å®šè¾“å‡ºæ–‡ä»¶ï¼Œ-iåˆ™åœ¨ç¼–è¯‘åè‡ªåŠ¨æ‰§è¡Œå®‰è£…è¿‡ç¨‹ï¼ˆé»˜è®¤åªä¼šç¼–è¯‘ä¸ä¼šå®‰è£…ï¼‰ go install go install å‘½ä»¤åœ¨ç¼–è¯‘çš„åŸºç¡€ä¸Šå¢æ·»äº†å®‰è£…è¿™ä¸€æ­¥ï¼Œå®‰è£… çš„åŸºæœ¬å«ä¹‰æ˜¯å°†ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶æ”¾åˆ°æŒ‡å®šçš„ç›®å½•ï¼Œé»˜è®¤ä¸º GOBIN ç¯å¢ƒå˜é‡æŒ‡å®šçš„ç›®å½•ï¼Œå³ $GOPATH/binã€‚ä»ä»¥helloä¸ºä¾‹ï¼Œå¦‚ä¸‹å‘½ä»¤æ‰§è¡Œåï¼Œhello.exeæ–‡ä»¶å°†ä½äº$GOPATH/binç›®å½•ä¸‹ \u003e go install github.com/shuzang/hello go get go get [-d] [-t] [-u] [-v] [-insecure] [build flags] [packages] go get ç›¸æ¯” go install åˆå¤šäº†ä¸€æ­¥ï¼šè§£æä¸æ·»åŠ ä¾èµ–åˆ°å½“å‰åŒ…ã€‚å®Œæˆè¿™ä¸€æ­¥åè‡ªåŠ¨ç¼–è¯‘å’Œå®‰è£…å®ƒä»¬ã€‚ go get ä¸‹è½½çš„é»˜è®¤è·¯å¾„æ˜¯ GOPATH/pkg/mod ï¼Œé»˜è®¤ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ï¼Œä½†ç‰ˆæœ¬çš„é€‰æ‹©è§„åˆ™æ¯”è¾ƒå¤æ‚ï¼Œå¯ä»¥æŸ¥çœ‹å‘½ä»¤è¯´æ˜ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨å®ä¾‹ \u003e go get -v github.com/google/codesearch/index github.com/google/codesearch (download) github.com/google/codesearch/sparse github.com/google/codesearch/index -vå‚æ•°è¾“å‡ºä¸‹è½½å®‰è£…çš„è¯¦ç»†è¿‡ç¨‹ï¼Œå¹¶è¾“å‡ºdebugä¿¡æ¯ï¼Œå…¶å®ƒçš„ä¸€äº›å¯é€‰å‚æ•°è¯´æ˜å¦‚ä¸‹ -dåªä¸‹è½½ä¸å®‰è£… -fixåœ¨å¯¹ä¸‹è½½çš„åŒ…è§£æä¾èµ–é¡¹æˆ–ç¼–è¯‘å‰å…ˆè¿è¡Œä¿®å¤å·¥å…· -tä¸‹è½½ä¸ºæŒ‡å®šçš„åŒ…ç”Ÿæˆæµ‹è¯•éœ€è¦çš„åŒ… -uç”¨äºæ›´æ–°å·²æœ‰çš„åŒ…å’Œä¾èµ– go run ä»¥ä¸Šä¸‰ä¸ªå‘½ä»¤è™½ç„¶éƒ½åŒ…å«ç¼–è¯‘è¿‡ç¨‹ï¼Œä½†ä¹Ÿåˆ°æ­¤ä¸ºæ­¢ï¼Œåœ¨ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶åå°†ä¸å†åšä»»ä½•æ“ä½œï¼Œéœ€è¦è‡ªå·±æ¥æ‰§è¡Œã€‚go runå‘½ä»¤åˆ™åœ¨ç¼–è¯‘åç›´æ¥æ‰§è¡Œè¿è¡Œæ“ä½œï¼Œä»¥helloä¸ºä¾‹ \u003e go run github.com/shuzang/hello Hello, Go! go version go versionåœ¨æ²¡æœ‰å‚æ•°æ—¶ï¼Œä¼šæ‰“å°è‡ªèº«çš„ç‰ˆæœ¬ä¿¡æ¯ \u003e go version go version go1.13.4 windows/amd64 ä½†æ˜¯go versionåä¹Ÿå¯ä»¥è·Ÿä¸€ä¸ªç›®å½•ï¼Œè¿™æ—¶ä¼šé€’å½’çš„æŸ¥æ‰¾è¯¥ç›®å½•ä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶æ‰“å°å®ƒä»¬çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä»¥binç›®å½•ä¸ºä¾‹ PS C:\\Users\\lylw1\\go\u003e go version bin bin\\cobra.exe: go1.13.4 bin\\dlv.exe: go1.13.4 bin\\go-outline.exe: go1.13.4 bin\\go-symbols.exe: go1.13.4 bin\\gocode-gomod.exe: go1.13.4 bin\\gocode.exe: go1.13.4 bin\\godef.exe: go1.13.4 bin\\golint.exe: go1.13.4 bin\\gopkgs.exe: go1.13.4 bin\\gorename.exe: go1.13.4 bin\\goreturns.exe: go1.13.4 bin\\guru.exe: go1.13.4 bin\\hello.exe: go1.13.4 æ·»åŠ -må‚æ•°ä¼šæ‰“å°åŒ…å¯¼å…¥çš„æ¨¡å—ä¿¡æ¯ï¼Œæ·»åŠ -vå‚æ•°ä¼šå°†æ— æ³•è¯†åˆ«çš„æ–‡ä»¶ä¿¡æ¯ä¹Ÿæ‰“å°å‡ºæ¥ï¼Œä»¥stringutilä¸ºä¾‹ \u003e go version -v src/github.com/shuzang/stringutil src\\github.com\\shuzang\\stringutil\\reverse.go: not executable file go env go env [-json] [-u] [-w] [var ...] go envçš„åŸºæœ¬ä½œç”¨æ˜¯æ‰“å°goçš„ç¯å¢ƒå˜é‡ä¿¡æ¯ï¼Œæ·»åŠ -jsonå‚æ•°å¯ä»¥ä»¥ JSON çš„æ ¼å¼æ‰“å°ï¼Œä½†æ²¡æœ‰é»˜è®¤çš„è„šæœ¬å½¢å¼å¯è¯»æ€§é«˜ã€‚æ·»åŠ  -w å‚æ•°å¯ä»¥è®¾ç½®æŸä¸ªç¯å¢ƒå˜é‡çš„å€¼ï¼Œæ¯”å¦‚ \u003e go env -w GOPATH=d:\\go ä¸ä¹‹ç›¸åï¼Œé‡ç½®æŸä¸ªç¯å¢ƒå˜é‡ä¸ºé»˜è®¤å€¼å¯ä»¥ä½¿ç”¨-uå‚æ•° \u003e go env -u GOPATH å…¶å®ƒ å…¶å®ƒçš„å‘½ä»¤ä½¿ç”¨é¢‘ç‡æ²¡æœ‰ä¸Šé¢å‡ ä¸ªé«˜ï¼Œå› æ­¤åªç®€å•ä»‹ç»å…¶ä½œç”¨ï¼Œç”¨çš„æ—¶å€™å†å»æŸ¥ç”¨æ³•å³å¯ï¼Œgo testå’Œgo modä¸¤ä¸ªå‘½ä»¤ä»¥åå•ç‹¬ä»‹ç»ã€‚ go bugï¼Œä½œç”¨æ˜¯æ‰“å¼€é»˜è®¤æµè§ˆå™¨å¹¶å¯åŠ¨æ–°çš„ Bug æŠ¥å‘Šï¼Œè¯¥æŠ¥å‘ŠåŒ…å«æœ‰ç”¨çš„ç³»ç»Ÿä¿¡æ¯ã€‚ go cleanï¼Œç§»é™¤æºç åŒ…ä¸­ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶ go docï¼Œæ˜¾ç¤ºåŒ…æˆ–ç¬¦å·çš„æ–‡æ¡£ go fixï¼Œç”¨æ¥æ›´æ–°è€ç‰ˆæœ¬çš„ä»£ç åˆ°æ–°ç‰ˆæœ¬ go fmtï¼Œgoçš„ä»£ç æœ‰ä¸¥æ ¼çš„æ ¼å¼è¦æ±‚ï¼Œè¯¥å‘½ä»¤ç”¨æ¥åšæ ¼å¼åŒ–ï¼Œä½†ä¸€èˆ¬IDEéƒ½ä¼šå¸®å¿™åšè¿™ä»¶äº‹ go generateï¼Œé€šè¿‡å¤„ç†æºç ç”Ÿæˆgoæ–‡ä»¶ go listï¼Œåˆ—å‡ºå½“å‰å®‰è£…çš„åŒ…æˆ–æ¨¡å— go modï¼Œæ¨¡å—ç»´æŒ go testï¼Œè‡ªåŠ¨è¯»å–æºç ç›®å½•ä¸‹åä¸º*_test.goçš„æ–‡ä»¶è¿›è¡Œæµ‹è¯• go toolï¼Œè¿è¡ŒæŒ‡å®šçš„goå·¥å…·ï¼Œåé¢è·Ÿçš„å‚æ•°æ˜¯å…¶å®ƒå‘½ä»¤ go vetï¼Œç”¨äºæ£€æŸ¥Goè¯­è¨€æºç ä¸­çš„é™æ€é”™è¯¯ ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:1:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1.2 topic topicæœ‰15ä¸ªï¼Œæœ¬è´¨æ˜¯å¯¹Goä¸­çš„ä¸€äº›æ¦‚å¿µä½œè§£é‡Šï¼Œæ‰€ä»¥å®ƒå®é™…ä¸Šæ˜¯ä¸€äº›æ–‡æ¡£è¯´æ˜ï¼Œä½¿ç”¨go help \u003ctopic\u003eæŸ¥çœ‹ï¼Œè¿™äº›topicåŒ…æ‹¬ buildmodeï¼šæ„å»ºæ¨¡å¼çš„æè¿° cï¼šGoå’Œcçš„ç›¸äº’è°ƒç”¨ cacheï¼šæ„å»ºå’Œæµ‹è¯•ç¼“å­˜ environmentï¼šç¯å¢ƒå˜é‡ filetypeï¼šæ–‡ä»¶ç±»å‹ go.modï¼šgo.modæ–‡ä»¶ gopathï¼šGOPATHç¯å¢ƒå˜é‡ gopath-getï¼š goproxyï¼šæ¨¡å—ä»£ç†åè®® importpathï¼šå¯¼å…¥è·¯å¾„è¯­æ³• modulesï¼šæ¨¡å—ï¼Œæ¨¡å—ç‰ˆæœ¬ç­‰ modules-getï¼š packagesï¼šåŒ…åˆ—è¡¨çš„æè¿° testflagï¼šæµ‹è¯•ç¬¦å·æè¿° testfuncï¼šæµ‹è¯•å‡½æ•°æè¿° ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:1:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. åŒ… åŒ…æ˜¯Goè¯­è¨€ä»£ç ç»„ç»‡å’Œä»£ç ç¼–è¯‘çš„ä¸€ä¸ªåŸºæœ¬ç»“æ„ï¼Œä¸€ä¸ªåŒ…å¯èƒ½ç”±ä¸€ä¸ªæˆ–å¤šä¸ª.goæ–‡ä»¶ç»„æˆï¼Œè€Œä¸€ä¸ªæˆ–å¤šä¸ªåŒ…å¯ä»¥æ„æˆå®Œæ•´çš„é¡¹ç›®(ä»“åº“)ã€‚ ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:2:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.1 åŒ…å æ¯ä¸ªGoæºæ–‡ä»¶(.goæ–‡ä»¶)éƒ½å¿…é¡»åœ¨éæ³¨é‡Šçš„é¦–è¡Œå£°æ˜å±äºå“ªä¸ªåŒ… package name nameå°±æ˜¯åŒ…åï¼ŒåŒ…åçš„å‘½åéµå¾ªå‘½åè§„èŒƒï¼Œè€Œä¸”ä¸å¾—ä½¿ç”¨å¤§å†™å­—æ¯ã€‚æ¯ä¸ªGoåº”ç”¨ç¨‹åºéƒ½å¿…é¡»åŒ…å«ä¸€ä¸ªmainåŒ… ä¸€ä¸ªGoç¨‹åºé€šè¿‡importå…³é”®å­—å°†ä¸€ç»„åŒ…è¡”æ¥åœ¨ä¸€èµ·ï¼Œå¦‚ import \"fmt\" åŒ…åéœ€è¦ç”¨åŒå¼•å·åŒ…å›´ï¼Œå¤šä¸ªåŒ…å¯ä»¥ä½¿ç”¨å¤šä¸ªimportè¯­å¥ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå°æ‹¬å·å…¨éƒ¨æ”¾åœ¨ä¸€èµ·ï¼Œå¦‚ import ( \"fmt\" \"os\" \"crypto/rot13\" \"github.com/shuzang/hello\" ) åŒ…åä¹Ÿæ˜¯å¯¼å…¥è·¯å¾„çš„æœ€åä¸€ä¸ªå­—æ®µï¼Œæ¯”å¦‚crypto/rot13ï¼Œå…¶åŒ…åä¸ºrot13ï¼›github.com/shuzang/helloï¼Œå…¶åŒ…åä¸ºhello æ²¡æœ‰å¿…è¦åˆ»æ„ä½¿ç”¨ä¸åŒçš„åŒ…åï¼Œåªè¦å¯¼å…¥è·¯å¾„ä¿æŒå”¯ä¸€å³å¯ ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:2:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.2 æ ‡å‡†åº“ åƒ fmtã€os ç­‰è¿™æ ·å…·æœ‰å¸¸ç”¨åŠŸèƒ½çš„å†…ç½®åŒ…åœ¨ Go è¯­è¨€ä¸­æœ‰ 150 ä¸ªä»¥ä¸Šï¼Œå®ƒä»¬è¢«ç§°ä¸ºæ ‡å‡†åº“ï¼Œå¤§éƒ¨åˆ†å†…ç½®äºGoæœ¬èº«ï¼Œä½äºC:\\Go\\pkg\\windows_amd64ï¼Œå³$GOROOT/pkg/$GOOS__$GOARCHç›®å½•ä¸‹ï¼Œä¸éœ€è¦é¢å¤–çš„ä¸‹è½½ã€å®‰è£…å’Œç¼–è¯‘ï¼Œè¯¦ç»†åˆ—è¡¨å’Œè¯´æ˜å¯ä»¥åœ¨ Go Packages æŸ¥çœ‹ï¼Œè¿™é‡Œç®€å•ä»‹ç»ä¸€äº›å¸¸ç”¨åŒ…çš„åŸºæœ¬åŠŸèƒ½ unsafe: åŒ…å«äº†ä¸€äº›æ‰“ç ´ Go è¯­è¨€â€œç±»å‹å®‰å…¨â€çš„å‘½ä»¤ï¼Œä¸€èˆ¬çš„ç¨‹åºä¸­ä¸ä¼šè¢«ä½¿ç”¨ï¼Œå¯ç”¨åœ¨ C/C++ ç¨‹åºçš„è°ƒç”¨ä¸­ ç³»ç»Ÿæ“ä½œç±» os: æä¾›ç»™æˆ‘ä»¬ä¸€ä¸ªå¹³å°æ— å…³æ€§çš„æ“ä½œç³»ç»ŸåŠŸèƒ½æ¥å£ï¼Œé‡‡ç”¨ç±»Unixè®¾è®¡ï¼Œéšè—äº†ä¸åŒæ“ä½œç³»ç»Ÿé—´å·®å¼‚ï¼Œè®©ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿå’Œæ“ä½œç³»ç»Ÿå¯¹è±¡è¡¨ç°ä¸€è‡´ os/exec: æä¾›æˆ‘ä»¬è¿è¡Œå¤–éƒ¨æ“ä½œç³»ç»Ÿå‘½ä»¤å’Œç¨‹åºçš„æ–¹å¼ syscall: åº•å±‚çš„å¤–éƒ¨åŒ…ï¼Œæä¾›äº†æ“ä½œç³»ç»Ÿåº•å±‚è°ƒç”¨çš„åŸºæœ¬æ¥å£ archive/tar å’Œ /zip-compressï¼šå‹ç¼©(è§£å‹ç¼©)æ–‡ä»¶åŠŸèƒ½ã€‚ è¾“å…¥è¾“å‡ºç±» fmt: æä¾›äº†æ ¼å¼åŒ–è¾“å…¥è¾“å‡ºåŠŸèƒ½ io: æä¾›äº†åŸºæœ¬è¾“å…¥è¾“å‡ºåŠŸèƒ½ï¼Œå¤§å¤šæ•°æ˜¯å›´ç»•ç³»ç»ŸåŠŸèƒ½çš„å°è£… bufio: ç¼“å†²è¾“å…¥è¾“å‡ºåŠŸèƒ½çš„å°è£… path/filepath: ç”¨æ¥æ“ä½œåœ¨å½“å‰ç³»ç»Ÿä¸­çš„ç›®æ ‡æ–‡ä»¶åè·¯å¾„ flag: å¯¹å‘½ä»¤è¡Œå‚æ•°çš„æ“ä½œã€€ å­—ç¬¦ä¸²æ“ä½œç±» strings: æä¾›å¯¹å­—ç¬¦ä¸²çš„æ“ä½œ strconv: æä¾›å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºåŸºç¡€ç±»å‹çš„åŠŸèƒ½ unicode: ä¸º unicode å‹çš„å­—ç¬¦ä¸²æä¾›ç‰¹æ®Šçš„åŠŸèƒ½ regexp: æ­£åˆ™è¡¨è¾¾å¼åŠŸèƒ½ bytes: æä¾›å¯¹å­—ç¬¦å‹åˆ†ç‰‡çš„æ“ä½œ index/suffixarray: å­å­—ç¬¦ä¸²å¿«é€ŸæŸ¥è¯¢ æ•°å­¦ math: åŸºæœ¬çš„æ•°å­¦å‡½æ•° math/cmath: å¯¹å¤æ•°çš„æ“ä½œ math/rand: ä¼ªéšæœºæ•°ç”Ÿæˆ sort: ä¸ºæ•°ç»„æ’åºå’Œè‡ªå®šä¹‰é›†åˆ math/big: å¤§æ•°çš„å®ç°å’Œè®¡ç®— æ•°æ®ç»“æ„ list: åŒé“¾è¡¨ ring: ç¯å½¢é“¾è¡¨ æ—¶é—´ time: æ—¥æœŸå’Œæ—¶é—´çš„åŸºæœ¬æ“ä½œ log: è®°å½•ç¨‹åºè¿è¡Œæ—¶äº§ç”Ÿçš„æ—¥å¿—,æˆ‘ä»¬å°†åœ¨åé¢çš„ç« èŠ‚ä½¿ç”¨å®ƒ ç¼–/è§£ç  encoding/json: è¯»å–å¹¶è§£ç å’Œå†™å…¥å¹¶ç¼–ç  JSON æ•°æ® encoding/xml:ç®€å•çš„ XML1.0 è§£æå™¨ text/template:ç”Ÿæˆåƒ HTML ä¸€æ ·çš„æ•°æ®ä¸æ–‡æœ¬æ··åˆçš„æ•°æ®é©±åŠ¨æ¨¡æ¿ ç½‘ç»œ net: ç½‘ç»œæ•°æ®çš„åŸºæœ¬æ“ä½œã€‚ http: æä¾›äº†ä¸€ä¸ªå¯æ‰©å±•çš„ HTTP æœåŠ¡å™¨å’ŒåŸºç¡€å®¢æˆ·ç«¯ï¼Œè§£æ HTTP è¯·æ±‚å’Œå›å¤ã€‚ html: HTML5 è§£æå™¨ runtime: Go ç¨‹åºè¿è¡Œæ—¶çš„äº¤äº’æ“ä½œï¼Œä¾‹å¦‚åƒåœ¾å›æ”¶å’Œåç¨‹åˆ›å»ºã€‚ reflect: å®ç°é€šè¿‡ç¨‹åºè¿è¡Œæ—¶åå°„ï¼Œè®©ç¨‹åºæ“ä½œä»»æ„ç±»å‹çš„å˜é‡ã€‚ Goçš„ç”Ÿæ€è¿œä¸æ­¢è¿™äº›æ ‡å‡†åº“ï¼Œç¤¾åŒºé‡Œå­˜åœ¨å¤§é‡çš„ç¬¬ä¸‰æ–¹åŒ…æˆ–é¡¹ç›®ï¼Œåœ¨å¼€å‘è‡ªå·±çš„é¡¹ç›®æ—¶ï¼Œæœ€å¥½å…ˆæŸ¥æ‰¾ä¸‹æ˜¯å¦æœ‰å·²å­˜åœ¨çš„ç¬¬ä¸‰æ–¹åŒ…æˆ–å¯ç”¨çš„åº“ã€‚ Go Walker æ”¯æŒæ ¹æ®åŒ…ååœ¨æµ·é‡æ•°æ®ä¸­æŸ¥è¯¢ã€‚ ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:2:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.3 å¯¼å…¥åŒ… å¯¼å…¥åŒ…çš„åŸºæœ¬æ ¼å¼å¦‚ä¸‹ import \"åŒ…çš„è·¯å¾„æˆ– URL åœ°å€\" â€åŒ…çš„è·¯å¾„â€œæŒ‡å¯ä»¥æ˜¯ä»¥ä¸‹è¿™ç§å½¢å¼ import \"./pack1/pack1\" è€ŒURLåœ°å€æŒ‡çš„æ˜¯ä¸‹è½½çš„å¤–éƒ¨å®‰è£…åŒ… import \"github.com/org1/pack1â€ å¯¼å…¥æ—¶å¯ä»¥å¯¹åŒ…è¿›è¡Œé‡å‘½åï¼Œæ¯”å¦‚ import packx \"github.com/org1/pack1â€ ä¹Ÿå¯ä»¥é‡å‘½åä¸ºä¸¤ç§ç‰¹æ®Šç¬¦å·ï¼š.å’Œ_ï¼Œå‰è€…å¯ä»¥åœ¨ä½¿ç”¨æ—¶çœç•¥åŒ…åï¼Œç›´æ¥ä½¿ç”¨å¯¹å¤–éƒ¨å¯è§çš„å‡½æ•°å’Œå˜é‡ï¼Œåè€…åˆ™åªæ‰§è¡Œå…¶ä¸­çš„initå‡½æ•°å’Œåˆå§‹åŒ–å…¶å…¨å±€å˜é‡ï¼Œæ— æ³•è°ƒç”¨å‡½æ•° import . \"./pack1\" import _ \"./pack1/pack1\" ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:2:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2.4 ä½¿ç”¨è„šæœ¬ç¼–è¯‘æˆ–å®‰è£… åœ¨ Linux/OS X ä¸‹å¯ä»¥ç”¨ Makefile è„šæœ¬ å®ç°è‡ªåŠ¨æ£€æµ‹æœºå™¨æ¶æ„å¹¶è°ƒç”¨æ­£ç¡®çš„ç¼–è¯‘å™¨å’Œé“¾æ¥å™¨ include $(GOROOT)/src/Make.inc TARG=pack1 GOFILES=\\ pack1.go\\ pack1b.go\\ include $(GOROOT)/src/Make.pkg é€šè¿‡ chmod 777 ./Makefileç¡®ä¿å®ƒçš„å¯æ‰§è¡Œæ€§ï¼Œç„¶ååœ¨ç»ˆç«¯ä½¿ç”¨makeå·¥å…· ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:2:4","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. æ¨¡å— è‡ª Go 1.11 èµ·ï¼Œå¼€å§‹æ”¯æŒä½¿ç”¨ Go Module è¿›è¡ŒåŒ…ç®¡ç†ï¼Œè¿™é‡Œå‚è€ƒ Go Blog ä¸­çš„ Using Go Modules ä¸€æ–‡å¯¹å…¶è¿›è¡Œä»‹ç»ã€‚ æ¨¡å—(module)é€šè¿‡é¡¹ç›®æ ¹ç›®å½•ä¸‹go.modæ–‡ä»¶èµ·ä½œç”¨ï¼Œé¡¹ç›®ä¸­ä½¿ç”¨çš„æ‰€æœ‰åŒ…çš„é›†åˆéƒ½åœ¨è¯¥æ–‡ä»¶ä¸­å®šä¹‰ã€‚go.modæ–‡ä»¶å®šä¹‰äº†æ¨¡å—è·¯å¾„ï¼Œç”¨äºé¡¹ç›®ä¸­åŒ…çš„å¯¼å…¥è·¯å¾„ã€‚ä»¥ delve çš„go.modæ–‡ä»¶ä¸ºä¾‹ module github.com/go-delve/delve go 1.10 require ( github.com/cosiner/argv v0.0.0-20170225145430-13bacc38a0a5 github.com/cpuguy83/go-md2man v1.0.8 // indirect github.com/inconshreveable/mousetrap v1.0.0 // indirect github.com/kr/pretty v0.1.0 // indirect github.com/mattn/go-colorable v0.0.0-20170327083344-ded68f7a9561 github.com/mattn/go-isatty v0.0.3 github.com/onsi/ginkgo v1.8.0 // indirect github.com/onsi/gomega v1.5.0 // indirect github.com/peterh/liner v0.0.0-20170317030525-88609521dc4b github.com/pkg/profile v0.0.0-20170413231811-06b906832ed0 github.com/russross/blackfriday v0.0.0-20180428102519-11635eb403ff // indirect github.com/sirupsen/logrus v0.0.0-20180523074243-ea8897e79973 github.com/spf13/cobra v0.0.0-20170417170307-b6cb39589372 github.com/spf13/pflag v0.0.0-20170417173400-9e4c21054fa1 // indirect github.com/stretchr/testify v1.3.0 // indirect go.starlark.net v0.0.0-20190702223751-32f345186213 golang.org/x/arch v0.0.0-20171004143515-077ac972c2e4 golang.org/x/crypto v0.0.0-20180614174826-fd5f17ee7299 // indirect golang.org/x/sys v0.0.0-20190626221950-04f50cda93cb golang.org/x/tools v0.0.0-20181120060634-fc4f04983f62 gopkg.in/airbrake/gobrake.v2 v2.0.9 // indirect gopkg.in/check.v1 v1.0.0-20180628173108-788fd7840127 // indirect gopkg.in/gemnasium/logrus-airbrake-hook.v2 v2.1.2 // indirect gopkg.in/yaml.v2 v2.2.1 ) æ³¨æ„ï¼Œä½¿ç”¨æ¨¡å—è¿›è¡ŒåŒ…ç®¡ç†ç‹¬ç«‹äºåŸæ¥çš„ä½¿ç”¨ gopath è¿›è¡ŒåŒ…ç®¡ç†ï¼Œå¯ä»¥åœ¨ä»»æ„ä½ç½®å»ºç«‹é¡¹ç›®ã€‚å¦‚æœgo.modæ–‡ä»¶æ”¾åœ¨$GOPATH/srcï¼Œå³åŸæ¥çš„ç»Ÿä¸€å·¥ä½œåŒºï¼Œæ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œä¼šè¢«æ—§çš„GOPATHæ¨¡å¼å±è”½ã€‚è‡ª Go 1.13 å¼€å§‹ï¼Œmodule æ¨¡å¼å·²ç»æˆä¸ºäº† Go å¼€å‘çš„é»˜è®¤æ¨¡å¼ã€‚ ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:3:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.1 åˆ›å»ºæ–°æ¨¡å— åœ¨$GOPATH/srcå¤–çš„ä»»æ„ä½ç½®åˆ›å»ºé¡¹ç›®ç›®å½•ï¼Œcdè¿›å…¥è¯¥ç›®å½•ï¼Œåˆ›å»ºhello.goæ–‡ä»¶ package hello func Hello() string { return \"Hello, world.\" } ä¸ºå®ƒå†™ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶hello_test.go package hello import \"testing\" func TestHello(t *testing.T) { want := \"Hello, world.\" if got := Hello(); got != want { t.Errorf(\"Hello() = %q, want %q\", got, want) } } ç°åœ¨ï¼Œé¡¹ç›®ä¸­æœ‰äº†ä¸€ä¸ªåŒ…ï¼Œå› ä¸ºé¡¹ç›®ç›®å½•ä½äºF:/helloï¼Œæ‰§è¡Œgo testçš„ç»“æœå¦‚ä¸‹ $ go test PASS ok _/F_/hello 0.240s å› ä¸ºæˆ‘ä»¬åœ¨ $GOPATH å¤–è¿›è¡Œçš„æµ‹è¯•ï¼Œè€Œä¸”ç°åœ¨è¿˜æ²¡æœ‰go.modæ–‡ä»¶ï¼Œæ‰€ä»¥Goå‘½ä»¤ä¸çŸ¥é“å¯¼å…¥è·¯å¾„ï¼Œåªèƒ½æ ¹æ®ç›®å½•åç”Ÿæˆä¸€ä¸ªå¯¼å…¥è·¯å¾„ã€‚ç°åœ¨æˆ‘ä»¬æ¥åˆ›å»ºgo.modæ–‡ä»¶å¹¶å†æ¬¡æ‰§è¡Œgo testå‘½ä»¤ $ go mod init example.com/hello go: creating new go.mod: module example.com/hello $ go test PASS ok example.com/hello 0.214s go mod initå‘½ä»¤ç”¨äºåˆ›å»ºgo.modæ–‡ä»¶ï¼Œåˆå§‹åŒ–Goæ¨¡å—ï¼Œå…¶å†…å®¹å¦‚ä¸‹ $ pwd /f/hello $ ls go.mod hello.go hello_test.go $ cat go.mod module example.com/hello go 1.13 go.modæ–‡ä»¶ä½äºé¡¹ç›®æ ¹ç›®å½•ï¼Œå…¶ä¸­çš„æ¨¡å—è·¯å¾„ä¹Ÿåªæ˜¾ç¤ºåˆ°é¡¹ç›®æ ¹ç›®å½•ï¼Œå­ç›®å½•ä¸­åŒ…çš„å¯¼å…¥è·¯å¾„ç”±æ¨¡å—è·¯å¾„+å­ç›®å½•è·¯å¾„ç»„æˆã€‚æˆ‘ä»¬åœ¨å½“å‰é¡¹ç›®ç›®å½•ä¸‹åˆ›å»ºworldå­ç›®å½•ï¼Œå…¶å¯¼å…¥è·¯å¾„å°†ä¼šæ˜¯example.com/hello/world ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:3:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.2 æ·»åŠ ä¾èµ– ä½¿ç”¨Goæ¨¡å—çš„é¦–è¦ç›®çš„æ˜¯æå‡åˆ«çš„å¼€å‘è€…ä½¿ç”¨æˆ‘ä»¬ç¼–å†™çš„ä»£ç çš„ä½“éªŒã€‚ç¼–è¾‘hello.goæ–‡ä»¶ï¼Œå¯¼å…¥rsc.io/quoteï¼Œç„¶åç”¨å®ƒæ¥å®æ–½Hello package hello import \"rsc.io/quote\" func Hello() string { return quote.Hello() } ç°åœ¨è¿è¡Œgo test $ go test go: finding rsc.io/quote v1.5.2 go: downloading rsc.io/quote v1.5.2 go: extracting rsc.io/quote v1.5.2 go: finding rsc.io/sampler v1.3.0 go: finding golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c go: downloading rsc.io/sampler v1.3.0 go: extracting rsc.io/sampler v1.3.0 go: downloading golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c go: extracting golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c PASS ok example.com/hello 0.023s Goä½¿ç”¨go.modæ–‡ä»¶ä¸­åˆ—ä¸¾çš„ä¾èµ–æ¨¡å—ç‰ˆæœ¬æ¥è§£æå¯¼å…¥çš„åŒ…ï¼Œä½†æ˜¯å½“åœ¨go.modæ–‡ä»¶ä¸­æ‰¾ä¸åˆ°è¿™ä¸ªåŒ…æ˜¯ï¼Œå°±ä¼šè‡ªåŠ¨çš„æŸ¥æ‰¾åŒ…å«è¿™ä¸ªåŒ…çš„æ¨¡å—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œç„¶åæ·»åŠ åˆ°go.modæ–‡ä»¶ã€‚ä¸Šä¾‹ä¸­è‡ªåŠ¨ä¸‹è½½äº†æ¨¡å—rsc.io/quote v1.5.2ï¼Œè¿˜ä¸‹è½½äº†å®ƒä¾èµ–çš„ä¸¤ä¸ªå…¶å®ƒæ¨¡å—ï¼šrsc.io/samplerå’Œgolang.org/x/textã€‚ä¸è¿‡åªæœ‰ç›´æ¥ä¾èµ–ä¼šè¢«è®°å½•åˆ°go.modæ–‡ä»¶ $ cat go.mod module example.com/hello go 1.13 require rsc.io/quote v1.5.2 ä¸‹è½½çš„åŒ…ä½äº$GOPATH/pkg/modï¼Œå†æ¬¡è¿è¡Œgo testå‘½ä»¤ï¼Œå°±ä¸ä¼šé‡æ–°ä¸‹è½½äº†ï¼Œå› ä¸ºå·²ç»å­˜åœ¨ã€‚ $ go test PASS ok example.com/hello 0.020s éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå°½ç®¡ä½¿ç”¨æ¨¡å—ä½¿å¾—æ·»åŠ åŒ…ç®¡ç†ç®€å•è½»æ¾ï¼Œä½†å¹¶éæ²¡æœ‰ä»£ä»·ï¼Œå½“å‰ä»£ç çš„å®‰å…¨æ€§ã€æ­£ç¡®æ€§å’Œè®¸å¯ç­‰éƒ½ä¾èµ–äºå¯¼å…¥çš„æ¨¡å—ï¼Œå…³äºè¿™ä¸ªé—®é¢˜çš„è¯¦ç»†æè¿°å¯ä»¥æŸ¥çœ‹ Our Software Dependency Problem. å¦‚ä¸Šæ‰€è¿°ï¼Œæ·»åŠ ä¸€ä¸ªç›´æ¥ä¾èµ–é€šå¸¸ä¼šå¼•å…¥ä¸€äº›é—´æ¥çš„ä¾èµ–ï¼Œä½¿ç”¨go list -m allå¯ä»¥åˆ—ä¸¾å½“å‰æ¨¡å—å’Œå®ƒä»¬æ‰€æœ‰çš„ä¾èµ–ã€‚ $ go list -m all example.com/hello golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c rsc.io/quote v1.5.2 rsc.io/sampler v1.3.0 åœ¨go listçš„è¾“å‡ºä¸­ï¼Œå½“å‰æ¨¡å—æ˜¯ä¸»æ¨¡å—ï¼Œæ€»æ˜¯ä½äºç¬¬ä¸€è¡Œï¼Œå…¶å®ƒçš„æ¨¡å—æŒ‰æ¨¡å—è·¯å¾„é¡ºåºæ˜¾ç¤ºã€‚ go.modæ–‡ä»¶å¤–ï¼ŒGoè¿˜ç»´æŒä¸€ä¸ªåä¸ºgo.sumçš„æ–‡ä»¶ï¼ŒåŒ…å«ç‰¹å®šæ¨¡å—ç‰ˆæœ¬å†…å®¹çš„åŠ å¯†å“ˆå¸Œã€‚Goä½¿ç”¨è¯¥æ–‡ä»¶ç¡®ä¿å°†æ¥ä¸‹è½½è¯¥æ¨¡å—æ—¶å†…å®¹ä¸ç¬¬ä¸€æ¬¡ä¸‹è½½çš„å†…å®¹ç›¸åŒï¼Œä»è€Œä¿è¯æ‰€ä¾èµ–çš„æ¨¡å—æ²¡æœ‰è¢«æ¶æ„æˆ–éæ¶æ„çš„æ›´æ”¹ã€‚ $ ls go.mod go.sum hello.go hello_test.go $ cat go.sum golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c h1:qgOY6WgZO... golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c/go.mod h1:Nq... rsc.io/quote v1.5.2 h1:w5fcysjrx7yqtD/aO+QwRjYZOKnaM9Uh2b40tElTs3... rsc.io/quote v1.5.2/go.mod h1:LzX7hefJvL54yjefDEDHNONDjII0t9xZLPX... rsc.io/sampler v1.3.0 h1:7uVkIFmeBqHfdjD+gZwtXXI+RODJ2Wc4O7MPEh/Q... rsc.io/sampler v1.3.0/go.mod h1:T1hPZKmBbMNahiBKFy5HrXp6adAjACjK9... go.modå’Œgo.sumæ–‡ä»¶éƒ½åº”è¯¥åŒ…å«åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´éšç€æºä»£ç æ–‡ä»¶ä¸€èµ·æäº¤åˆ°è¿œç¨‹ä»“åº“ã€‚ ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:3:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.3 æ›´æ–°ä¾èµ– Goæ¨¡å—ä½¿ç”¨çš„ç‰ˆæœ¬å·åˆ†ä¸‰éƒ¨åˆ†ï¼šä¸»ç‰ˆæœ¬å·(major)ï¼Œæ¬¡ç‰ˆæœ¬å·(minor)å’Œä¿®è®¢ç‰ˆæœ¬å·(patch)ã€‚ä¾‹å¦‚ï¼Œv0.1.2ï¼Œä¸»ç‰ˆæœ¬å·æ˜¯0ï¼Œæ¬¡ç‰ˆæœ¬å·æ˜¯1ï¼Œä¿®è®¢ç‰ˆæœ¬å·æ˜¯2ã€‚é¦–å…ˆä»¥ä¸€ä¸ªæ¬¡ç‰ˆæœ¬å·çš„æ›´æ–°ä¸¾ä¾‹è¯´æ˜ å‰é¢go list -m allçš„è¾“å‡ºä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°golang.org/x/textä½¿ç”¨çš„ä¸æ˜¯æ ‡å‡†çš„ç‰ˆæœ¬å·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨go getå‘½ä»¤å°†å…¶æ›´æ–° $ go get golang.org/x/text go: finding golang.org/x/text v0.3.0 go: downloading golang.org/x/text v0.3.0 go: extracting golang.org/x/text v0.3.0 $ go test PASS ok example.com/hello 0.013s ç°åœ¨å†æ¬¡åˆ—ä¸¾æ‰€æœ‰çš„æ¨¡å—ä»¥åŠæŸ¥çœ‹go.modæ–‡ä»¶ $ go list -m all example.com/hello golang.org/x/text v0.3.0 rsc.io/quote v1.5.2 rsc.io/sampler v1.3.0 $ cat go.mod module example.com/hello go 1.12 require ( golang.org/x/text v0.3.0 // indirect rsc.io/quote v1.5.2 ) å¯ä»¥çœ‹åˆ°ä¸¤è€…ä¸­golang.org/x/textéƒ½å·²ç»æ›´æ–°åˆ°äº†æœ€æ–°çš„ç‰ˆæœ¬å·v0.3.0ï¼Œæ³¨é‡Šä¸­çš„indirectè¯´æ˜è¿™ä¸ªä¾èµ–ä¸æ˜¯ç›´æ¥è¢«å¼•ç”¨çš„ï¼Œåªæ˜¯è¢«å…¶å®ƒçš„æ¨¡å—é—´æ¥å¼•ç”¨ã€‚ ç°åœ¨æˆ‘ä»¬æ›´æ–°rsc.io/samplerçš„æ¬¡ç‰ˆæœ¬å· $ go get rsc.io/sampler go: finding rsc.io/sampler v1.99.99 go: downloading rsc.io/sampler v1.99.99 go: extracting rsc.io/sampler v1.99.99 $ go test --- FAIL: TestHello (0.00s) hello_test.go:8: Hello() = \"99 bottles of beer on the wall, 99 bottles of beer, ...\", want \"Hello, world.\" FAIL exit status 1 FAIL example.com/hello 0.014s æµ‹è¯•å¤±è´¥è¯´æ˜ç‰ˆæœ¬ä¸åŒ¹é…ï¼Œåˆ—ä¸¾æ‰€æœ‰å¯ç”¨ç‰ˆæœ¬ $ go list -m -versions rsc.io/sampler rsc.io/sampler v1.0.0 v1.2.0 v1.2.1 v1.3.0 v1.3.1 v1.99.99 ä¹‹å‰ä½¿ç”¨çš„æ˜¯v1.3.0ï¼Œv1.99.99ä¹Ÿè¢«è¯æ˜æ— æ³•ä½¿ç”¨ï¼Œå› æ­¤æ¢ç”¨v1.3.1 $ go get rsc.io/sampler@v1.3.1 go: finding rsc.io/sampler v1.3.1 go: downloading rsc.io/sampler v1.3.1 go: extracting rsc.io/sampler v1.3.1 $ go test PASS ok example.com/hello 0.022s é€šè¿‡@æ¥æŒ‡å®šå…·ä½“çš„ç‰ˆæœ¬å·ï¼Œgo getçš„å‚æ•°å®é™…ä¸Šåº”è¯¥å¸¦æœ‰ç‰ˆæœ¬å·ï¼Œä¸æ˜ç¡®æŒ‡å®šä¼šä½¿ç”¨é»˜è®¤çš„@latestï¼Œä»è€Œä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ã€‚ ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:3:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.4 åœ¨ä¸»ç‰ˆæœ¬å·ä¸Šæ·»åŠ ä¾èµ– ä¸»ç‰ˆæœ¬å·çš„æ›´æ–°æ˜¯ä¸åŒçš„ï¼Œä¼šçœ‹ä½œä¸€ä¸ªç‹¬ç«‹çš„ä¾èµ–ã€‚åœ¨hello.goä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„å‡½æ•°Proverb()ï¼Œå®ƒä½¿ç”¨äº†rsc.io/quoteçš„v3ç‰ˆæœ¬ï¼Œå¯¼å…¥æ ¼å¼ä¸ºrsc.io/quote/v3 package hello import ( \"rsc.io/quote\" quoteV3 \"rsc.io/quote/v3\" ) func Hello() string { return quote.Hello() } func Proverb() string { return quoteV3.Concurrency() } ç„¶åä¸ºå…¶æ·»åŠ æµ‹è¯•å‡½æ•° func TestProverb(t *testing.T) { want := \"Concurrency is not parallelism.\" if got := Proverb(); got != want { t.Errorf(\"Proverb() = %q, want %q\", got, want) } } æµ‹è¯•ç»“æœå¦‚ä¸‹ $ go test go: finding rsc.io/quote/v3 v3.1.0 go: downloading rsc.io/quote/v3 v3.1.0 go: extracting rsc.io/quote/v3 v3.1.0 PASS ok example.com/hello 0.024s ç°åœ¨æˆ‘ä»¬çš„æ¨¡å—åŒæ—¶ä¾èµ–äºrsc.io/quoteå’Œrsc.io/quote/v3 $ go list -m rsc.io/q... rsc.io/quote v1.5.2 rsc.io/quote/v3 v3.1.0 Goæ¨¡å—çš„æ¯ä¸ªä¸»ç‰ˆæœ¬å·(v1, v2, and so on)éƒ½ä½¿ç”¨ä¸€ä¸ªä¸åŒçš„æ¨¡å—è·¯å¾„ï¼Œä»v2å¼€å§‹ï¼Œè·¯å¾„å¿…é¡»ä»¥ä¸»ç‰ˆæœ¬å·ç»“å°¾ï¼Œæ¯”å¦‚rsc.io/quoteçš„v3ç‰ˆæœ¬æ¨¡å—è·¯å¾„ä¸ºrsc.io/quote/v3ï¼Œè¿™ç§æƒ¯ä¾‹ç§°ä½œ semantic import versioning ï¼Œç»™ä¸å…¼å®¹çš„åŒ…æä¾›äº†ä¸åŒçš„åå­—ã€‚ç›¸åï¼ŒåŒä¸€ä¸ªä¸»ç‰ˆæœ¬å·ï¼Œå¦‚v1.6.0åº”è¯¥å‘å‰å…¼å®¹ï¼Œå’Œrsc.io/quoteä½¿ç”¨åŒä¸€ä¸ªåå­—ï¼Œåœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œæ¯ä¸ªä¸»ç‰ˆæœ¬å·Goåªå…è®¸å‡ºç°ä¸€ç§ï¼Œæ¯”å¦‚v1.5.2å’Œv1.6.0ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼Œä½†ä¸åŒçš„ä¸»ç‰ˆæœ¬å·å¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œè¿™æ˜¯ä¸ºäº†ä½¿ç¨‹åºå¯ä»¥é€æ­¥è¿‡æ¸¡åˆ°æ–°çš„ç‰ˆæœ¬ã€‚ ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:3:4","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.5 æ›´æ–°ä¾èµ–åˆ°æ–°çš„ä¸»ç‰ˆæœ¬å· æ¯”å¦‚ä»rsc.io/quoteè¿ç§»åˆ°rsc.io/quote/v3ï¼Œç”±äºå¤§ç‰ˆæœ¬æ›´æ–°ï¼ŒæŸäº›ä¸å…¼å®¹çš„APIå¯èƒ½è¢«åˆ é™¤ã€é‡å‘½åæˆ–åšå…¶å®ƒçš„æ›´æ”¹ï¼Œé˜…è¯»æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°HelloV3ç›¸å¯¹äºHelloåšäº†å¦‚ä¸‹æ”¹åŠ¨ $ go doc rsc.io/quote/v3 package quote // import \"rsc.io/quote\" Package quote collects pithy sayings. func Concurrency() string func GlassV3() string func GoV3() string func HelloV3() string func OptV3() string æ£€æŸ¥å¹¶æ›´æ–°æˆ‘ä»¬çš„æºç  package hello import quoteV3 \"rsc.io/quote/v3\" func Hello() string { return quoteV3.HelloV3() } func Proverb() string { return quoteV3.Concurrency() } ç”±äºæ²¡æœ‰å†²çªï¼Œè¿™é‡Œå¯¼å…¥çš„åŒ…ä¸å†éœ€è¦é‡å‘½åï¼Œå› æ­¤å¯ä»¥ç»§ç»­ç®€åŒ– package hello import \"rsc.io/quote/v3\" func Hello() string { return quote.HelloV3() } func Proverb() string { return quote.Concurrency() } è¿è¡Œæµ‹è¯• $ go test PASS ok example.com/hello 0.014s ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:3:5","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.6 ç§»é™¤ä¸ä½¿ç”¨çš„ä¾èµ– æˆ‘ä»¬å·²ç»ä¸å†ä½¿ç”¨rsc.io/quoteï¼Œä½†å®ƒä¾ç„¶å­˜åœ¨äºgo list -m allçš„è¾“å‡ºå’Œgo.modæ–‡ä»¶ä¸­ $ go list -m all example.com/hello golang.org/x/text v0.3.0 rsc.io/quote v1.5.2 rsc.io/quote/v3 v3.1.0 rsc.io/sampler v1.3.1 $ cat go.mod module example.com/hello go 1.12 require ( golang.org/x/text v0.3.0 // indirect rsc.io/quote v1.5.2 rsc.io/quote/v3 v3.0.0 rsc.io/sampler v1.3.1 // indirect ) è¿™æ˜¯å› ä¸ºç¼–è¯‘å•ä¸ªåŒ…æ—¶æ— æ³•è‡ªåŠ¨æ£€æµ‹æ˜¯å¦å¯ä»¥å®‰å…¨çš„ç§»é™¤æŸä¸ªåŒ…ï¼Œåªèƒ½é€šè¿‡æ‰‹åŠ¨æ‰§è¡Œgo mod tidyå‘½ä»¤æ¸…ç†ä¸å†ä½¿ç”¨çš„ä¾èµ– $ go mod tidy $ go list -m all example.com/hello golang.org/x/text v0.3.0 rsc.io/quote/v3 v3.1.0 rsc.io/sampler v1.3.1 $ cat go.mod module example.com/hello go 1.12 require ( golang.org/x/text v0.3.0 // indirect rsc.io/quote/v3 v3.1.0 rsc.io/sampler v1.3.1 // indirect ) $ go test PASS ok example.com/hello 0.020s $ æœ€åæ˜¯å…³äºå‘å¸ƒè‡ªå·±çš„æ¨¡å—ç‰ˆæœ¬çš„æ³¨æ„ï¼Œå‚è€ƒä¸¤ç¯‡æ–‡ç«  Publishing Go Modules Go Modules: v2 and Beyond ","date":"2019-09-19","objectID":"/2019/golang-basic-grammer-2-command-package-module/:3:6","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€2-å‘½ä»¤ã€åŒ…ä¸æ¨¡å—","uri":"/2019/golang-basic-grammer-2-command-package-module/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"1. èµ·æºä¸å‘å±• Go/Golang èµ·æºäº2007å¹´ï¼Œå¹¶äº2009å¹´æ­£å¼å¯¹å¤–å‘å¸ƒï¼Œæ˜¯ä¸€ä¸ªå®Œå…¨å¼€æºçš„é¡¹ç›®ï¼ŒèƒŒåçš„æ”¯æŒè€…æ˜¯è°·æ­Œå…¬å¸ï¼Œæ ¸å¿ƒè®¾è®¡è€…æ˜¯ä¸‰ä½è‘—åITå·¥ç¨‹å¸ˆï¼šKen Thompsonï¼ŒRob Pikeï¼ŒRobert Griesemerã€‚åˆ†åˆ«æ˜¯å¦‚ä¸‹ä»å·¦åˆ°å³ä¸‰ä½ å…¶ä¸­ Ken Thompson æ˜¯ Unix æ“ä½œç³»ç»Ÿçš„è®¾è®¡è€…ï¼Œå¹¶å› æ­¤è·å¾—å›¾çµå¥–ï¼Œä¹Ÿæ˜¯Cè¯­è¨€å‰èº«Bè¯­è¨€çš„è®¾è®¡è€…ï¼ŒUTF-8 ç¼–ç è®¾è®¡è€…ä¹‹ä¸€ï¼Œè®¡ç®—æœºå²çš„é‡è¦äººç‰©ï¼Œ2006å¹´åŠ å…¥è°·æ­Œï¼Œå’Œå¦å¤–ä¸¤äººä¸€èµ·è®¾è®¡äº†Goè¯­è¨€ã€‚ Rob Pike æ˜¯ Ken çš„è€æ­æ¡£ã€‚ éšååˆæœ‰ lan Lance Taylor å’Œ Russ Cox ä¸¤äººåŠ å…¥å›¢é˜Ÿï¼Œå‰è€…æ˜¯ gccgo ç¼–è¯‘å™¨çš„ä½œè€…å’Œ cgoå·¥å…·é“¾çš„ç»´æŠ¤è€…ï¼Œåè€…åŠ å…¥å›¢é˜Ÿåç€æ‰‹Goè¯­è¨€æ ‡å‡†åº“çš„å¼€å‘ã€‚ä¸‹å›¾åˆ†åˆ«æ˜¯ä»–ä»¬ä¸¤ä¸ª Goè¯­è¨€ä»¥å›Šåœ°é¼ (Gopher)ä¸ºå›¾æ ‡å’Œå‰ç¥¥ç‰©ï¼Œè¿™æ˜¯ä¸€ç§åŸäº§äºåŠ æ‹¿å¤§çš„å•®é½¿ç±»åŠ¨ç‰©ï¼ŒGoè¯­è¨€å¼€å‘è€…ä¹Ÿä¸€èˆ¬è‡ªç§°ä¸º Gopherã€‚ä¸‹å›¾ä¸­å·¦è¾¹æ˜¯å›Šåœ°é¼ ï¼Œå³è¾¹æ˜¯ Go logo. Goè¯­è¨€ç›¸æ¯”äºå…¶å®ƒè¯­è¨€çš„æœ€å¤§ä¼˜åŠ¿åœ¨äºå®ƒçš„æ‰§è¡Œæ€§èƒ½ä¸å¼€å‘æ•ˆç‡ï¼Œè¿™å¾—ç›ŠäºGoåœ¨å¹¶å‘ç¼–ç¨‹ã€å†…å­˜å›æ”¶ç­‰è®¸å¤šæ–¹é¢çš„è‰¯å¥½è®¾è®¡ï¼Œå¹¶å› æ­¤å¤§è§„æ¨¡ç”¨äºæœåŠ¡å™¨ç¼–ç¨‹ã€ç½‘ç»œç¼–ç¨‹ã€æ•°æ®åº“å’Œäº‘å¹³å°é¢†åŸŸã€‚ æ¯”è¾ƒå‡ºåçš„Goè¯­è¨€é¡¹ç›®æœ‰(ä¸é™äºè¿™äº›) Goè¯­è¨€æœ¬èº«ï¼š https://github.com/golang/go Dockerï¼š https://www.docker.com/ kubernetesï¼š https://github.com/kubernetes/kubernetes Ethereumï¼š https://github.com/ethereum/go-ethereum fabricï¼š https://github.com/hyperledger/fabric Hugoï¼š https://github.com/gohugoio/hugo TiDBï¼š https://github.com/pingcap/tidb InfluxDBï¼š https://github.com/influxdata/influxdb ETCDï¼š https://github.com/etcd-io/etcd ä½¿ç”¨Goçš„å›½å¤–å…¬å¸æœ‰ï¼šGoogle, Docker, NetFlix, CloudFlare, Dropbox, MongoDB, Uberç­‰ ä½¿ç”¨Goçš„å›½å†…å…¬å¸æœ‰ï¼šä¸ƒç‰›ã€å­—èŠ‚è·³åŠ¨ã€bilibiliã€äº¬ä¸œã€ç™¾åº¦ï¼Œå…¶å®ƒå…¬å¸å¦‚å°ç±³ã€è…¾è®¯ã€é˜¿é‡Œç­‰ä¹Ÿéƒ½åœ¨ä½¿ç”¨Goï¼Œä½†å¯èƒ½ä¸æ˜¯ä¸»åŠ› ","date":"2019-09-13","objectID":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/:1:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€1-èƒŒæ™¯ä¸åˆæ¢","uri":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"2. è·Ÿè¸ªæœ€æ–°åŠ¨æ€ æœ€ç›´æ¥çš„æ–¹å¼æ˜¯è·Ÿè¸ªGoè¯­è¨€çš„æºç åº“ï¼Œå…³æ³¨æäº¤å†å²å’Œissue åŸå§‹ä»£ç åº“ï¼š https://go.googlesource.com/go githubé•œåƒï¼š https://github.com/golang/go å…¶å®ƒæ´»è·ƒè®ºå›æˆ–åŠ¨æ€ golang-devï¼šGoogleé‚®ä»¶åˆ—è¡¨çš„Goå¼€å‘ç»„è®¨è®ºåŒº golang-nutsï¼šGoogleé‚®ä»¶åˆ—è¡¨çš„Goè®¨è®ºç¤¾åŒº golang-announceï¼šå‘å¸ƒGoç‰ˆæœ¬æˆ–Goå¼€å‘çš„æœ€æ–°çŠ¶æ€ go.devï¼šåˆšåˆšä¸Šçº¿(2019.11.14)çš„Goå¼€å‘äººå‘˜ä¸­å¿ƒ gotimeï¼šGoçš„ä¸€ä¸ªæ’­å®¢ï¼Œæ¯å‘¨ä¸€æ›´ï¼Œå†…å®¹æœ‰å¹²è´§ @golangï¼šGo è¯­è¨€åœ¨ Twitter çš„å®˜æ–¹å¸å· æ­¤å¤–è¿˜æœ‰æ¯å¹´ä¸¾åŠçš„å‡ ä¸ªå¤§ä¼š Gopher Conï¼Œä¸¾åŠåœ°åœ¨ç¾å›½ï¼Œæ—¶é—´ä¸å®šï¼Œä»Šå¹´åœ¨7æœˆï¼Œ2020å¹´ä¼šåœ¨6æœˆä»½ä¸¾è¡Œã€‚ä¼šè®®æ€»ç»“ GopherChinaï¼Œä¸¾åŠåœ°åœ¨ä¸­å›½ï¼Œæ¯å¹´4æœˆä»½ã€‚ä¼šè®®æ€»ç»“ dotGoï¼Œä¸¾åŠåœ°åœ¨æ¬§æ´²ï¼Œæ¯å¹´3æœˆä»½ è¯¦ç»†çš„ä¼šè®®åˆ—è¡¨å¯æŸ¥çœ‹ https://github.com/golang/go/wiki/Conferences Go ä¸‹è½½åœ°å€å’Œç›¸å…³çš„æ–‡æ¡£ã€æ ‡å‡†åº“ç­‰è®¿é—®åœ°å€ä¸º å®˜ç½‘ https://golang.org/ å›½å†…çš„é•œåƒç½‘ç«™ https://golang.google.cn/ Goè¯­è¨€ä¸­æ–‡ç½‘ æ˜¯å›½å†…æœ€æ´»è·ƒçš„Goç¤¾åŒºï¼Œæ¯å‘¨ä¼šå‘è¡Œä¸€ä»½Goè¯­è¨€çˆ±å¥½è€…å‘¨åˆŠ Goç›¸å…³èµ„æ–™èšé›†æœ€å¤šçš„è¿˜æ˜¯go wiki ","date":"2019-09-13","objectID":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/:2:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€1-èƒŒæ™¯ä¸åˆæ¢","uri":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3. ä¸‹è½½å®‰è£… Windownsä¸‹å¿«é€Ÿå®‰è£…å¯ä»¥ä½¿ç”¨ chocolatey ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ \u003e choco install golang è‡ªåŠ¨é…ç½®ç¯å¢ƒå˜é‡ï¼Œå®‰è£…å®Œé‡å¯ç»ˆç«¯å³å¯ä½¿ç”¨ã€‚ä¸‹é¢å¼€å§‹ä»‹ç»å¸¸è§„çš„å®‰è£…æ–¹æ³•ï¼Œä»¥win10å’ŒUbuntuä¸ºä¾‹ã€‚ ","date":"2019-09-13","objectID":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/:3:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€1-èƒŒæ™¯ä¸åˆæ¢","uri":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.1 ä¸‹è½½ Golangä¸­å›½å®˜ç½‘ä¸‹è½½é¡µé¢ä¸º golang.google.cn/dlï¼Œä¸ºwindowsï¼ŒmacOSå’ŒLinuxä¸‰ç§ç¯å¢ƒéƒ½æä¾›äº†å®‰è£…åŒ…ã€‚ windowsé»˜è®¤ä¸‹è½½æ–‡ä»¶ä¸ºgo1.14.windows-amd64.msiï¼ŒåŒå‡»å¯åŠ¨å³å¯å®‰è£…ï¼Œé»˜è®¤å®‰è£…ä½ç½®ä¸ºC:\\Goï¼Œç¯å¢ƒå˜é‡å°†è‡ªåŠ¨è®¾ç½®ã€‚ä½†å¦‚æœä¸‹è½½äº†ä»¥.zipä¸ºåç¼€çš„ç‰ˆæœ¬ï¼Œåˆ™éœ€è¦è‡ªå·±è§£å‹åˆ°åˆé€‚çš„è·¯å¾„ï¼Œå¹¶è‡ªå·±è®¾ç½®ç¯å¢ƒå˜é‡ã€‚ Linuxé»˜è®¤ä¸‹è½½æ–‡ä»¶ä¸ºgo1.14.linux-amd64.tar.gzï¼Œå°†å…¶è§£å‹ç¼©åˆ°/usr/localï¼Œç„¶åæ‰‹åŠ¨å°†/usr/local/go/binæ·»åŠ åˆ° PATH ç¯å¢ƒå˜é‡ä¸­ã€‚ ","date":"2019-09-13","objectID":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/:3:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€1-èƒŒæ™¯ä¸åˆæ¢","uri":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.2 å®‰è£… windows msiåç¼€çš„å®‰è£…ç‰ˆæœ¬åŒå‡»å®‰è£…ï¼Œç¯å¢ƒå˜é‡å°†ä¼šè‡ªåŠ¨è®¾ç½®ï¼Œæ‰“å¼€powershellï¼Œä½¿ç”¨go envå‘½ä»¤æŸ¥çœ‹ç¯å¢ƒå˜é‡ \u003e go env set GO111MODULE= set GOARCH=amd64 set GOBIN= set GOCACHE=C:\\Users\\lylw1\\AppData\\Local\\go-build set GOENV=C:\\Users\\lylw1\\AppData\\Roaming\\go\\env set GOEXE=.exe set GOFLAGS= set GOHOSTARCH=amd64 set GOHOSTOS=windows set GOINSECURE= set GONOPROXY= set GONOSUMDB= set GOOS=windows set GOPATH=C:\\Users\\lylw1\\go set GOPRIVATE= set GOPROXY=https://goproxy.cn,direct set GOROOT=c:\\go set GOSUMDB=sum.golang.org set GOTMPDIR= set GOTOOLDIR=c:\\go\\pkg\\tool\\windows_amd64 set GCCGO=gccgo set AR=ar set CC=gcc set CXX=g++ set CGO_ENABLED=1 set GOMOD= set CGO_CFLAGS=-g -O2 set CGO_CPPFLAGS= set CGO_CXXFLAGS=-g -O2 set CGO_FFLAGS=-g -O2 set CGO_LDFLAGS=-g -O2 set PKG_CONFIG=pkg-config set GOGCCFLAGS=-m64 -mthreads -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=C:\\Users\\lylw1\\AppData\\Local\\Temp\\go-build192094374=/tmp/go-build -gno-record-gcc-switches ä½¿ç”¨ go version æŸ¥çœ‹ç‰ˆæœ¬åŒæ—¶éªŒè¯å®‰è£… \u003e go version go version go1.13.4 windows/amd64 Linux ä»¥Ubuntu 20.04 LTS ä¸ºä¾‹è¯´æ˜ï¼Œé¦–å…ˆåœ¨ golang.org/dl é¡µé¢å³å‡»è¦ä¸‹è½½çš„ç‰ˆæœ¬è·å–ä¸‹è½½é“¾æ¥ï¼Œä½¿ç”¨wgetä¸‹è½½æ–‡ä»¶ã€‚ä¹Ÿå¯ä»¥ç›´æ¥ä¸‹è½½ã€‚ $ wget https://dl.google.com/go/go1.14.linux-amd64.tar.gz å°†æ–‡ä»¶è§£å‹ç¼©åˆ°æŒ‡å®šç›®å½•/usr/localï¼Œ-Cå‚æ•°ç”¨äºæŒ‡å®šç›®æ ‡æ–‡ä»¶å¤¹ï¼Œè§£å‹ç¼©ååˆ é™¤å‹ç¼©æ–‡ä»¶ã€‚ $ sudo tar -xzf go1.14.linux-amd64.tar.gz -C /usr/local $ rm go1.14.linux-amd64.tar.gz æŸ¥çœ‹å®‰è£…ç›®å½• $ ls /usr/local bin etc games go include lib man sbin share src $ ls /usr/local/go AUTHORS CONTRIBUTORS PATENTS SECURITY.md api doc lib pkg src CONTRIBUTING.md LICENSE README.md VERSION bin favicon.ico misc robots.txt test è®¾ç½®ç¯å¢ƒå˜é‡ $ sudo nano /etc/profile # åœ¨æ‰“å¼€çš„æ–‡ä»¶æœ«å°¾æ·»åŠ ä¸‹åˆ—è¯­å¥ export PATH=$PATH:/usr/local/go/bin æ›´æ–°çš„ç¯å¢ƒå˜é‡å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤ä½¿å…¶ç›´æ¥ç”Ÿæ•ˆ $ source /etc/profile # æŸ¥çœ‹ç”Ÿæ•ˆåçš„ç¯å¢ƒå˜é‡è®¾ç½® $ go version go version go1.14 linux/amd64 Linux å…¨éƒ¨ç¯å¢ƒå˜é‡å¦‚ä¸‹ $ go env GO111MODULE=\"\" GOARCH=\"amd64\" GOBIN=\"\" GOCACHE=\"/home/shuzang/.cache/go-build\" GOENV=\"/home/shuzang/.config/go/env\" GOEXE=\"\" GOFLAGS=\"\" GOHOSTARCH=\"amd64\" GOHOSTOS=\"linux\" GOINSECURE=\"\" GONOPROXY=\"\" GONOSUMDB=\"\" GOOS=\"linux\" GOPATH=\"/home/shuzang/go\" GOPRIVATE=\"\" GOPROXY=\"https://proxy.golang.org,direct\" GOROOT=\"/usr/local/go\" GOSUMDB=\"sum.golang.org\" GOTMPDIR=\"\" GOTOOLDIR=\"/usr/local/go/pkg/tool/linux_amd64\" GCCGO=\"gccgo\" AR=\"ar\" CC=\"gcc\" CXX=\"g++\" CGO_ENABLED=\"1\" GOMOD=\"\" CGO_CFLAGS=\"-g -O2\" CGO_CPPFLAGS=\"\" CGO_CXXFLAGS=\"-g -O2\" CGO_FFLAGS=\"-g -O2\" CGO_LDFLAGS=\"-g -O2\" PKG_CONFIG=\"pkg-config\" GOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build153919612=/tmp/go-build -gno-record-gcc-switches\" æ³¨ï¼šå°†ç¯å¢ƒå˜é‡æ·»åŠ åˆ°/etc/profileå¯ä½¿goå…¨å±€å¯ç”¨ï¼Œä¹Ÿå¯æ·»åŠ åˆ°$HOME/.profileï¼Œå¯¹å½“å‰ç™»å½•ç”¨æˆ·èµ·ä½œç”¨ã€‚ æ³¨ï¼šå¯ä»¥ä½¿ç”¨apt-getå‘½ä»¤å®‰è£…ï¼Œä½†å®‰è£…çš„goä¸ä¼šæ˜¯æœ€æ–°ç‰ˆæœ¬ï¼ŒåŒæ ·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨snapå®‰è£…ï¼Œå¯ä»¥å®‰è£…æœ€æ–°ç‰ˆæœ¬ã€‚ ","date":"2019-09-13","objectID":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/:3:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€1-èƒŒæ™¯ä¸åˆæ¢","uri":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.3 ç¯å¢ƒå˜é‡è¯´æ˜ å¸¸è§„çš„ä½¿ç”¨é™¤äº†GOPATHå¤–æ— éœ€å…³å¿ƒå…¶å®ƒç¯å¢ƒå˜é‡ï¼Œä½†åœ¨è¿›è¡Œäº¤å‰ç¼–è¯‘æ—¶ï¼Œéœ€è¦è¿›è¡Œä¸€å®šçš„è®¾ç½®ï¼Œè¯¦ç»†çš„ç¯å¢ƒå˜é‡è¯´æ˜å¯ä»¥æŸ¥çœ‹ $GOPATH environment variable set correctlyï¼Œä»¥ä¸‹è§£é‡Šå‡ ä¸ªä¸»è¦çš„ç¯å¢ƒå˜é‡ã€‚ GOOSä¸GOARCHï¼šç›®æ ‡æ“ä½œç³»ç»Ÿå’Œå¤„ç†å™¨æ¶æ„ï¼Œ GOHOSTOSå’ŒGOHOSTARCHæ˜¯å®¿ä¸»æœºæ“ä½œç³»ç»Ÿå’Œå¤„ç†å™¨æ¶æ„ã€‚ GOBINï¼šç¼–è¯‘å™¨å’Œé“¾æ¥å™¨çš„å®‰è£…ä½ç½®ï¼Œé»˜è®¤æ˜¯$GOROOT/binï¼Œä¸€èˆ¬å°†å…¶è®¾ç½®ä¸ºç©ºå€¼ï¼ŒGoä¼šä½¿ç”¨é»˜è®¤å€¼ã€‚ GOROOTï¼šç”µè„‘ä¸Šå®‰è£…çš„Goçš„æ ¹ç›®å½•ï¼ŒLinuxä¸‹ä¸€èˆ¬ä¸º$HOME/goï¼Œwindowsä¸‹ä¸ºC:\\go GOPATHï¼šgo installã€go getç­‰å‘½ä»¤é»˜è®¤è·¯å¾„éƒ½æ˜¯GOPATHï¼Œæ˜¯ç¼–è¯‘åäºŒè¿›åˆ¶æ–‡ä»¶çš„å­˜æ”¾ç›®çš„åœ°ã€ä¸‹è½½ååŒ…çš„å­˜æ”¾è·¯å¾„ä»¥åŠ import åŒ…æ—¶çš„æœç´¢è·¯å¾„ æˆ‘ä»¬éœ€è¦å…³å¿ƒçš„å”¯ä¸€ä¸€ä¸ªç¯å¢ƒå˜é‡æ˜¯GOPATHï¼Œå¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤çš„GOPATHæ˜¯c:\\Users\\lylw1\\goï¼Œå…¶ä¸­lylw1æ˜¯è‡ªå·±çš„ç”¨æˆ·åã€‚ GOPATH æ‰€ä»£è¡¨çš„è·¯å¾„æ˜¯ go çš„å·¥ä½œåŒºï¼Œå¯ä»¥é€‰æ‹©ä»»æ„è‡ªå·±å–œæ¬¢çš„æ–‡ä»¶å¤¹ä½œä¸ºgoçš„å·¥ä½œåŒºï¼Œå¦‚æœä¸æƒ³ä½¿ç”¨é»˜è®¤çš„è·¯å¾„ï¼Œéœ€è¦è‡ªå·±è¿›è¡Œä¿®æ”¹ï¼Œä½¿ç”¨ go env å‘½ä»¤ \u003e go env -w GOPATH=/somewhere/else æ›´å¤šçš„ç¯å¢ƒå˜é‡ä¿®æ”¹æ–¹å¼å¯ä»¥æŸ¥çœ‹Setting GOPATHï¼Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯GOPATHä¸èƒ½è®¾ç½®ä¸ºGoçš„å®‰è£…ç›®å½•C:\\go ","date":"2019-09-13","objectID":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/:3:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€1-èƒŒæ™¯ä¸åˆæ¢","uri":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.4 å®‰è£…ç›®å½•æ¸…å• å®‰è£…å®Œæˆçš„Goæ ¹ç›®å½•ï¼ˆ$GOROOTï¼‰æ–‡ä»¶å¤¹ç»“æ„é™¤äº†README.mdï¼ŒAUTHORSï¼ŒLICENSEç­‰å¸¸è§„æ–‡ä»¶å¤–ï¼ŒåŸºæœ¬ç»“æ„åº”å¦‚ä¸‹æ‰€ç¤ºï¼š /binï¼šåŒ…å«å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¦‚ï¼šç¼–è¯‘å™¨ï¼ŒGo å·¥å…· /docï¼šåŒ…å«ç¤ºä¾‹ç¨‹åºï¼Œä»£ç å·¥å…·ï¼Œæœ¬åœ°æ–‡æ¡£ç­‰ /libï¼šåŒ…å«æ–‡æ¡£æ¨¡ç‰ˆ /miscï¼šåŒ…å«ä¸æ”¯æŒ Go ç¼–è¾‘å™¨æœ‰å…³çš„é…ç½®æ–‡ä»¶ä»¥åŠ cgo çš„ç¤ºä¾‹ /pkg/os_archï¼šåŒ…å«æ ‡å‡†åº“çš„åŒ…çš„å¯¹è±¡æ–‡ä»¶ï¼ˆ.aï¼‰ /srcï¼šåŒ…å«æºä»£ç æ„å»ºè„šæœ¬å’Œæ ‡å‡†åº“çš„åŒ…çš„å®Œæ•´æºä»£ç ï¼ˆGo æ˜¯ä¸€é—¨å¼€æºè¯­è¨€ï¼‰ /src/cmdï¼šåŒ…å« Go å’Œ C çš„ç¼–è¯‘å™¨å’Œå‘½ä»¤è¡Œè„šæœ¬ è¿™æ˜¯ä¹‹å‰çš„ä»‹ç»ï¼Œç½‘ä¸Šæœåˆ°çš„å¤šæ˜¯è¿™ä¸ªè¯´æ˜ï¼Œä½†å½“å‰è¿˜å¤šäº†apiå’Œtestä¸¤ä¸ªæ–‡ä»¶å¤¹ã€‚ ","date":"2019-09-13","objectID":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/:3:4","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€1-èƒŒæ™¯ä¸åˆæ¢","uri":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"3.5 ä»£ç ç›®å½•ç»“æ„ Go 1.13ä¹‹å‰ï¼Œæ‰€æœ‰ä»£ç åœ¨ä¸€ä¸ªå·¥ä½œåŒºï¼ŒGo 1.13åŠä¹‹åï¼Œä½¿ç”¨ Go module è¿›è¡Œç®¡ç†ï¼Œé¡¹ç›®ä»£ç ä¸å†å¿…é¡»æ”¾åˆ° GOPATH ä¸‹ã€‚æœ¬æ–‡å‡è®¾ä½¿ç”¨ Go 1.13 åŠä»¥åçš„ç‰ˆæœ¬ã€‚å¯¹äºä¹‹å‰çš„æ–¹å¼ä¸å†ä»‹ç»ã€‚ Go ç¨‹åºä»¥åŒ…ï¼ˆpackageï¼‰çš„å½¢å¼è¿›è¡Œç»„ç»‡ï¼Œä¸€ä¸ªåŒ…å°±æ˜¯ä¸€ä¸ªç›®å½•ï¼Œè¯¥ç›®å½•ä¸‹å¯èƒ½æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæºæ–‡ä»¶ï¼ŒåŒä¸€ä¸ªåŒ…çš„æ‰€æœ‰ä»£ç ä¼šè¢«ä¸€èµ·ç¼–è¯‘ã€‚å¦å¤–ï¼ŒåŒä¸€ä¸ªåŒ…ä¸­å®šä¹‰çš„å˜é‡ã€å¸¸é‡ã€ç±»å‹ã€å‡½æ•°ï¼Œå³ä½¿åœ¨ä¸åŒçš„æºæ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥ç›¸äº’è®¿é—®ã€‚ Go é¡¹ç›®ä»¥æ¨¡å—çš„æ–¹å¼è¿›è¡Œç»„ç»‡ï¼Œæ¨¡å—ï¼ˆmoduleï¼‰æ˜¯ä¸€ç»„ç›¸å…³åŒ…çš„é›†åˆã€‚ä¸€ä¸ªé¡¹ç›®é€šå¸¸æ˜¯ä¸€ä¸ªä»“åº“ï¼ˆrepositoryï¼‰ï¼Œè€Œä¸€ä¸ª Go ä»“åº“ï¼ˆrepositoryï¼‰åªèƒ½åŒ…å«ä¸€ä¸ªæ¨¡å—ï¼Œä½†å¯å¯¼å…¥ä½¿ç”¨å¤šä¸ªå…¶å®ƒæ¨¡å—ï¼Œä»“åº“æ ¹ç›®å½•ä¸‹çš„ go.mod æ–‡ä»¶ç”¨æ¥å£°æ˜è¿™äº›å¯¼å…¥æ¨¡å—çš„è·¯å¾„ã€‚å’Œ go.mod æ–‡ä»¶ä¸€èµ·ä½äºä»“åº“æ ¹ç›®å½•çš„æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„å­ç›®å½•ï¼Œæ¯ä¸ªå­ç›®å½•å¯èƒ½æ˜¯ä¸€ä¸ªåŒ…ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªå­æ¨¡å—ï¼Œæ˜¯å¦ä¸ºå­æ¨¡å—è¦çœ‹å­ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨ go.mod æ–‡ä»¶ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå°½ç®¡é¡¹ç›®ä»£ç ä»¥ä»“åº“çš„æ–¹å¼è¿›è¡Œç»„ç»‡ï¼Œä½†åœ¨ç¼–å†™å®Œæˆæ„å»ºä¹‹å‰ï¼Œä»£ç ä¸éœ€è¦ä¸Šä¼ åˆ°äº‘ç«¯ï¼Œæ¨¡å—å¯ä»¥æœ¬åœ°å­˜åœ¨ï¼Œä»“åº“å½¢å¼ä»…ä»…æ˜¯å› ä¸ºæˆ‘ä»¬æ€»æœ‰ä¸€å¤©ä¼šå°†ä»£ç ä¸Šä¼ åˆ°äº‘çš„ã€‚ æ¨¡å—çš„è·¯å¾„ä¸ä»…ä½œä¸ºå¯¼å…¥è·¯å¾„ï¼ŒåŒæ ·ä¹Ÿè¯´æ˜äº†æ¨¡å—çš„ä¸‹è½½è·¯å¾„ï¼Œæ¯”å¦‚ golang.org/x/toolsï¼Œ Go å‘½ä»¤å°†çŸ¥é“ä» https://golang.org/x/tools å»ä¸‹è½½å®ƒã€‚åŒ…çš„å¯¼å…¥è·¯å¾„æ˜¯æ¨¡å—è·¯å¾„ + åŒ…åï¼Œæ¯”å¦‚ï¼Œæ¨¡å— github.com/google/go-cmp åŒ…å«ä¸€ä¸ªåŒ…ï¼ˆå­ç›®å½•ï¼‰cmpï¼Œè¿™ä¸ªåŒ…çš„å¯¼å…¥è·¯å¾„å°±æ˜¯ github.com/google.go-cmp/cmpã€‚Go çš„æ ‡å‡†åº“å¯¼å…¥ä¸éœ€è¦æ¨¡å—è·¯å¾„å‰ç¼€ï¼Œå¯ä»¥ä»…ä½¿ç”¨åŒ…åã€‚ æœ€åï¼Œæ‰€æœ‰çš„æ¨¡å—éƒ½ä¼šä¸‹è½½åˆ° GOPATH çš„ pkg/mod ç›®å½•ä¸‹ï¼Œå¹¶è¢«æ‰€æœ‰é¡¹ç›®å…±äº«ï¼Œå› æ­¤ï¼Œæ¨¡å—ä»£ç æ˜¯åªè¯»çš„ã€‚ æœ¬éƒ¨åˆ†è¯´æ˜å¯ä»¥é˜…è¯»ç¬¬äºŒç¯‡æ–‡ç« åå†æ¥çœ‹ã€‚ ","date":"2019-09-13","objectID":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/:3:5","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€1-èƒŒæ™¯ä¸åˆæ¢","uri":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"4. ç¬¬ä¸€ä¸ªç¨‹åº ç¼–è¾‘å¹¶è¿è¡Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç¨‹åºï¼ŒæŒ‰ç…§ç¼–ç¨‹ç•Œçš„æƒ¯ä¾‹ï¼Œè¾“å‡ºhello, world!ã€‚ é¦–å…ˆåˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹å¹¶åˆå§‹åŒ–æ¨¡å—ï¼Œæ¨¡å—è·¯å¾„è‡ªè¡Œé€‰æ‹© $ mkdir hello $ cd hello $ go mod init example.com/user/hello go: creating new go.mod: module example.com/user/hello $ cat go.mod module example.com/user/hello go 1.14 $ ç„¶ååœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºhello.goæ–‡ä»¶ï¼Œä½¿å…¶åŒ…å«å¦‚ä¸‹ä»£ç  package main import \"fmt\" func main() { fmt.Println(\"Hello, world.\") } ä½¿ç”¨go installå‘½ä»¤ç¼–è¯‘å®‰è£… \u003e go install github.com/shuzang/hello è¯¥å‘½ä»¤ä¼šç¼–è¯‘ç¨‹åºå¹¶äº§ç”Ÿä¸€ä¸ªäºŒè¿›åˆ¶åŒ…ï¼Œç„¶åå°†è¯¥äºŒè¿›åˆ¶åŒ…å®‰è£…åˆ° $HOME/go/bin/hello ï¼Œå¦‚æœæ˜¯ Windowsï¼Œä¼šå®‰è£…åˆ° %USERPROFILE%\\go\\bin\\hello.exeã€‚ å®‰è£…ç›®å½•å— GOPATH å’Œ GOBIN å½±å“ï¼Œå¦‚æœ GOBIN è¢«è®¾ç½®ï¼Œåˆ™äºŒè¿›åˆ¶åŒ…ä¼šè¢«å®‰è£…åˆ°è®¾ç½®çš„ç›®å½•ï¼Œå¦‚æœ GOPATH è¢«è®¾ç½®ï¼ŒäºŒè¿›åˆ¶åŒ…å°†æŒ‰ç…§åˆ° GOPATH åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªç›®å½•çš„ bin å­ç›®å½•ï¼Œå¦‚æœéƒ½æ²¡æœ‰è¢«è®¾ç½®ï¼Œå°±ä¼šå®‰è£…åˆ°é»˜è®¤ GOPATH çš„ bin å­ç›®å½•($HOME/go or %USERPROFILE%\\go)ã€‚ go install å‘½ä»¤æ‰§è¡Œéœ€è¦åœ¨ä»“åº“æ ¹ç›®å½•ä¸‹ï¼Œä¸”ä¸‹é¢ä¸‰ä¸ªå‘½ä»¤æ˜¯ç­‰æ•ˆçš„ $ go install example.com/user/hello $ go install . $ go install å°†$GOPATH/binæ·»åŠ åˆ°ç”µè„‘çš„PATHç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·å¯ä»¥ç›´æ¥æ‰§è¡Œ $ hello Hello, world! å¯èƒ½æ˜¯å› ä¸ºæˆ‘ä½¿ç”¨chocolateyå®‰è£…çš„åŸå› ï¼Œè¿™ä¸€ç¯å¢ƒå˜é‡ä¹Ÿå·²ç»è‡ªåŠ¨è®¾å¥½äº†ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ã€‚ å®Œæˆç¼–è¾‘åï¼Œå°±å¯ä»¥ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶å·¥å…·åˆå§‹åŒ–ä»“åº“å¹¶ä¸Šä¼ ä»£ç äº†ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼ˆè¿™ä¸€æ­¥ä¸æ˜¯å¿…é¡»çš„ï¼‰ $ git init Initialized empty Git repository in C:/Users/lylw1/go/src/github.com/shuzang/hello/.git/ $ git add go.mod hello.go $ git commit -m \"initial commit\" [master (root-commit) 0b4507d] initial commit 1 file changed, 7 insertion(+) create mode 100644 go.mod hello.go ä¸€ç§æœ€æ–¹ä¾¿çš„æ–¹å¼æ˜¯å°†æ¨¡å—è·¯å¾„ä¸ä»“åº“è·¯å¾„åŒ¹é…ï¼Œæ¯”å¦‚å°†ä»¥ä¸Šæ¨¡å—å£°æ˜ä¸º github.com/username/helloï¼Œå¤šæ•°ç‰ˆæœ¬æ§åˆ¶æœåŠ¡å•†éƒ½æ”¯æŒè¿™ç§æ ¼å¼ã€‚ ","date":"2019-09-13","objectID":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/:4:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€1-èƒŒæ™¯ä¸åˆæ¢","uri":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"5. ç¼–è¾‘å™¨/IDE Golang å¼€å‘æœ€æµè¡Œçš„ä¸¤ä¸ªå·¥å…·æ˜¯ Goland å’Œ VScodeï¼Œæˆ‘è‡ªå·±æ˜¯ VScode çš„ä½¿ç”¨è€…ã€‚é™¤äº†è¿™ä¸¤ä¸ªå·¥å…·å¤–ï¼Œå®˜æ–¹è¿˜æä¾›äº†ä¸€ä»½IDEå’Œæ’ä»¶åˆ—è¡¨ã€‚ VScode ä¸­çš„ Go æ‰©å±•æä¾›äº†å¤§é‡çš„ç‰¹æ€§ï¼Œå¦‚è‡ªåŠ¨è¡¥å…¨ã€æ‚¬åœä¿¡æ¯æ˜¾ç¤ºã€æ‹¬å·åŒ¹é…ç­‰ï¼ŒåŸæœ¬å±äºç¬¬ä¸‰æ–¹å¼€å‘è€…ç»´æŠ¤ï¼Œç°åœ¨äº¤ç»™äº† Go å›¢é˜Ÿã€‚è¯¦ç»†çš„ç‰¹æ€§è¯´æ˜æŸ¥çœ‹å®˜ç½‘ï¼Œä¸‹é¢è¿›è¡Œä¸€äº›ç®€å•ä»‹ç»ã€‚ ","date":"2019-09-13","objectID":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/:5:0","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€1-èƒŒæ™¯ä¸åˆæ¢","uri":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"5.1 Goå·¥å…·é“¾ å¾®è½¯åœ¨å¼€å‘ VS Code è¿‡ç¨‹ä¸­, å®šä¹‰äº†ä¸€ç§åè®®ï¼š è¯­è¨€æœåŠ¡å™¨åè®® ï¼Œç”¨æ¥ä¸ºæ¯ç§è¯­è¨€æä¾›è¯¸å¦‚è‡ªåŠ¨å®Œæˆï¼Œä»£ç æç¤ºç­‰åŠŸèƒ½ã€‚gopls å°±æ˜¯Goè¯­è¨€çš„æœåŠ¡å™¨, å®‰è£…å‘½ä»¤ä¸º $ go get -v golang.org/x/tools/gopls äº‹å®ä¸Šï¼Œç¼–è¾‘ Go ä»£ç æ—¶å¦‚æœæ²¡æœ‰å®‰è£…ï¼ŒVScode ä¼šåœ¨å³ä¸‹è§’å¼¹å‡ºæç¤ºï¼Œåªè¦ç›´æ¥ç‚¹å‡» Install å³å¯ï¼Œä¸éœ€è¦è‡ªå·±è¾“å…¥å‘½ä»¤ã€‚åŒæ—¶ï¼Œå› ä¸ºæ²¡æœ‰è®¾ç½®go.toolsGopathï¼Œé»˜è®¤ä½¿ç”¨äº† GOPATH ä½œä¸ºå®‰è£…è·¯å¾„ go.toolsGopath setting is not set. Using GOPATH C:\\Users\\lylw1\\go Installing 1 tool at C:\\Users\\lylw1\\go\\bin in module mode. gopls Installing golang.org/x/tools/gopls SUCCEEDED Reload VS Code window to use the Go language server All tools successfully installed. You're ready to Go :). Goä»£ç çš„è°ƒè¯•éœ€è¦ delve å·¥å…· $ go get -v github.com/go-delve/delve/cmd/dlv é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€æ‰¹éœ€è¦å®‰è£…çš„åˆ†æå·¥å…·ï¼Œå¦‚ä¸‹ # Below tools are needed for the basic features of the Go extension. gocode gopkgs go-outline gocode-gomod godef goreturns æ‰€æœ‰è¿™äº›å·¥å…·åªéœ€è¦åœ¨å³ä¸‹è§’å¼¹å‡ºæç¤ºåç‚¹å‡» Install å³å¯ ä¸è¿‡ä¸Šè¿°æåˆ°çš„å¾ˆå¤šæ’ä»¶ä¸ç¿»å¢™éƒ½æ— æ³•ä¸‹è½½ï¼Œå¯ä»¥è‡ªå·±æ‰‹åŠ¨åˆ°githubä¸‹è½½ç„¶åè§£å‹åˆ°GOPATH/srcï¼Œå»ºç«‹èµ·å¯¹åº”çš„ç›®å½•ç»“æ„ï¼Œç„¶åè¿è¡Œgo installå°†å…¶å®‰è£… å¾®è½¯è®¾ç½®äº†é»˜è®¤çš„ä»£ç†æœåŠ¡å™¨ï¼Œç°åœ¨(2020.03.18)æ‰€æœ‰æ’ä»¶å‡å¯åœ¨ä¸ç¿»å¢™çš„æƒ…å†µä¸‹é¡ºåˆ©å®‰è£…ï¼Œè€Œä¸”é€Ÿåº¦å¾ˆå¿« ","date":"2019-09-13","objectID":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/:5:1","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€1-èƒŒæ™¯ä¸åˆæ¢","uri":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"5.2 ç”¨æˆ·å’Œå·¥ä½œåŒºè®¾ç½® ä½¿ç”¨ VScode éœ€è¦å…³å¿ƒçš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†æ˜¯ç”¨æˆ·å’Œå·¥ä½œåŒºè®¾ç½®ï¼Œå‡ ä¹æ‰€æœ‰çš„äº‹æƒ…éƒ½å’Œå®ƒä»¬æœ‰å…³ã€‚ è¿™æ˜¯ä¸¤ç§ä¸åŒçš„è®¾ç½®èŒƒå›´ ç”¨æˆ·è®¾ç½®ï¼šæ˜¯ä¸€ä¸ªå…¨å±€çš„è®¾ç½®ï¼Œé€‚ç”¨äºæ‰“å¼€çš„ä»»ä½•VScodeçª—å£ å·¥ä½œåŒºè®¾ç½®ï¼šå¦‚é¢˜ï¼Œé¡¹ç›®å·¥ä½œåŒºçš„è®¾ç½®ï¼Œåªé€‚ç”¨äºå¯¹åº”çš„å·¥ä½œåŒº å·¥ä½œåŒºçš„è®¾ç½®ä¼šè¦†ç›–æ‰ç”¨æˆ·è®¾ç½®ï¼Œå®ƒé’ˆå¯¹å…·ä½“çš„é¡¹ç›®ï¼Œé…ç½®æ–‡ä»¶ä½äºé¡¹ç›®æ ¹ç›®å½•.vscodeæ–‡ä»¶å¤¹ï¼Œå¯ä¸å…¶å®ƒå¼€å‘è€…å…±äº«ã€‚.vscodeæ–‡ä»¶å¤¹è¿˜ç”¨äºå­˜æ”¾è°ƒè¯•é…ç½®å’Œä»»åŠ¡é…ç½®ã€‚ ç‚¹å‡»å·¦ä¸‹è§’çš„é½¿è½®ï¼Œé€‰æ‹©è®¾ç½®ï¼Œé»˜è®¤çš„è®¾ç½®ç•Œé¢å¦‚ä¸Šï¼Œæ˜¯ä¸€ä¸ªå¯è§†åŒ–çš„ç•Œé¢ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥ä½¿ç”¨settings.jsoné…ç½®æ–‡ä»¶ ç”¨æˆ·è®¾ç½®æ–‡ä»¶åœ¨windowsä¸­ä½äº%APPDATA%\\Code\\User\\settings.json å·¥ä½œåŒºè®¾ç½®æ–‡ä»¶ä½äºæ ¹ç›®å½•çš„.vscodeæ–‡ä»¶å¤¹ä¸­ æœ€åï¼ŒVScodeå¤§é‡çš„æ“ä½œéƒ½å¯ä»¥é€šè¿‡å‘½ä»¤å®Œæˆï¼Œä½¿ç”¨å¿«æ·é”®Ctrl+Shift+På¯ä»¥æ‰“å¼€å‘½ä»¤è¾“å…¥æ¡†ã€‚ ","date":"2019-09-13","objectID":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/:5:2","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€1-èƒŒæ™¯ä¸åˆæ¢","uri":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"5.3 ç‰¹æ€§è¯´æ˜ åœ¨ç”¨æˆ·æˆ–å·¥ä½œåŒºè®¾ç½®ä¸­ï¼Œå°† go.autocompleteUnimportedPackages è®¾ä¸ºtrue ï¼Œå¯ä»¥åœ¨ä»£ç ä¸­ç‚¹å‡»åŒ…åè·³è½¬æŸ¥çœ‹åŒ…çš„å…·ä½“å†…å®¹ã€‚ é¼ æ ‡æ‚¬åœåœ¨å˜é‡ã€å‡½æ•°å’Œç»“æ„ä½“çš„åç§°ä¸Šæ–¹å¯ä»¥æŸ¥çœ‹å®ƒä»¬çš„ç­¾åç­‰ä¿¡æ¯ï¼Œè¿™ä¸€åŠŸèƒ½ç”±å‰é¢å®‰è£…çš„godefå·¥å…·å®ç°ï¼ŒåŒæ ·å¯å®Œæˆè¿™ä¸€åŠŸèƒ½çš„å·¥å…·è¿˜æœ‰godocå’Œgogetdocï¼Œé€šè¿‡åœ¨ç”¨æˆ·æˆ–å·¥ä½œåŒºè®¾ç½®ä¸­è°ƒæ•´go.docsToolæ¥åˆ‡æ¢å·¥å…·ã€‚ ä»£ç å¯¼èˆªåŠŸèƒ½æ— éœ€è®¾ç½®é»˜è®¤å®ç°ã€‚ å¯¹æºç çš„ä¿å­˜æ“ä½œä¼šè‡ªåŠ¨è§¦å‘æ ¼å¼åŒ–ã€ç¼–è¯‘å’Œä»£ç è´¨é‡æ£€æŸ¥ã€‚æ ¼å¼åŒ–å·¥å…·ä¸ºgofmtï¼Œå¯é€‰çš„æ›¿ä»£å·¥å…·æœ‰goreturnså’Œgoimportsï¼Œåœ¨ç”¨æˆ·æˆ–å·¥ä½œåŒºè®¾ç½®ä¸­è°ƒæ•´go.formatToolæ¥è®¾ç½®ã€‚ç¼–è¯‘çš„è¿‡ç¨‹ä½¿ç”¨go buildå‘½ä»¤ã€‚ä»£ç è´¨é‡æ£€æŸ¥çš„å·¥å…·ä¸ºgolintï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨gometalinterï¼Œç”¨æ¥æ£€æŸ¥ä»£ç çš„è§„èŒƒæ€§ï¼Œæ£€æŸ¥å¾—åˆ°çš„errorså’Œwarningä¼šåœ¨ç¼–è¾‘å™¨é‡Œä»¥çº¢è‰²/ç»¿è‰²æ³¢æµªçº¿æ ‡å‡ºæ¥ï¼Œä¸‹é¢çš„è¾“å‡ºçª—å£ä¹Ÿä¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ã€‚ æ‰€æœ‰å¯é€‰çš„æ›¿ä»£å·¥å…·éƒ½éœ€è¦è‡ªå·±å®‰è£…ï¼Œä½¿ç”¨å¿«æ·é”®æ‰“å¼€å‘½ä»¤é¢æ¿ï¼Œè¾“å…¥ Go: Install/Update Tools ï¼Œé€‰æ‹©è¦å®‰è£…çš„å·¥å…·ï¼Œç‚¹å‡»ç¡®å®šå³å¯ã€‚ ","date":"2019-09-13","objectID":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/:5:3","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€1-èƒŒæ™¯ä¸åˆæ¢","uri":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"5.4 ä½¿ç”¨ è°ƒè¯•ä½¿ç”¨çš„æ˜¯å‰é¢å®‰è£…çš„delveå·¥å…·ã€‚åœ¨ VScode ä¸­ï¼ŒæŒ‰F5å¯åŠ¨è°ƒè¯•ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨é»˜è®¤çš„è°ƒè¯•é…ç½®å³å¯ï¼Œä¸è¿‡è¿˜æ˜¯åº”å½“å¯¹è°ƒè¯•é…ç½®é€‰é¡¹æœ‰ä¸€å®šçš„äº†è§£ã€‚ é»˜è®¤æ˜¯æ²¡æœ‰è°ƒè¯•é…ç½®æ–‡ä»¶çš„ï¼Œå½“æˆ‘ä»¬éœ€è¦è¿›è¡Œé…ç½®æ—¶ï¼Œè¾“å…¥å‘½ä»¤ Debug: Open launch.json ï¼Œç¬¬ä¸€æ¬¡ä¼šåœ¨å·¥ä½œåŒºæ ¹ç›®å½•çš„.vscodeæ–‡ä»¶å¤¹ä¸­åˆ›å»ºlaunch.jsonæ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­é»˜è®¤çš„é…ç½®ä¿¡æ¯å¦‚ä¸‹ { \"version\": \"0.2.0\", \"configurations\": [ { \"name\": \"Launch\", \"type\": \"go\", \"request\": \"launch\", \"mode\": \"auto\", \"program\": \"${fileDirname}\", \"env\": {}, \"args\": [] } ] } å¯è®¾ç½®çš„é…ç½®å±æ€§å¯æŸ¥çœ‹Debugging Go code using VS Codeï¼Œæ›´å¤šå…³äºVScodeä¸­Goè°ƒè¯•çš„ç›¸å…³ä¿¡æ¯éƒ½å¯æŸ¥çœ‹è¯¥æ–‡æ¡£ã€‚ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯argsï¼Œè°ƒè¯•æ—¶ç¨‹åºéœ€è¦ä¼ å…¥çš„å‚æ•°æ•°ç»„æ˜¯è¯¥é…ç½®å‚æ•°çš„å€¼ è¿è¡Œç¨‹åºä½¿ç”¨å¿«æ·é”®Ctrl+F5ï¼Œå’Œè°ƒè¯•ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚ ","date":"2019-09-13","objectID":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/:5:4","tags":["Goè¯­æ³•"],"title":"Golangè¯­æ³•åŸºç¡€1-èƒŒæ™¯ä¸åˆæ¢","uri":"/2019/golang-basic-grammar-1-background-and-preliminary-exploration/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"å¦‚ä¸‹åˆ—ä»£ç ï¼Œåœ¨ä½¿ç”¨bufioåŒ…ä¸­çš„ReadStringè¯»å–å­—ç¬¦ä¸²ä¹‹åï¼Œè¿™ä¸ªå­—ç¬¦ä¸²æ— æ³•è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ¯æ¬¡ä½¿ç”¨strconv.Atoi()å‡½æ•°è¿”å›å€¼å‡ä¸º0ã€‚ inputReader := bufio.NewReader(os.Stdin) fmt.Println(\"Please input a number\") t, err := inputReader.ReadString('\\n') if err != nil { fmt.Println(\"can't read number!\") } fmt.Println(\"the number is\", t) if num, ok := strconv.Atoi(t); ok != nil { fmt.Println(\"convert to int error\", num) } //input 25 //output Please input a number the number is 25 convert to int error 0 å› ä¸ºè¿™ç§å†™æ³•å…¶å®ç»å¸¸é‡åˆ°ï¼Œä¹‹å‰ç¼–ç¨‹çš„æ—¶å€™é‡åˆ°è¿™ç§æƒ…å†µæ²¡æ€ä¹ˆæ³¨æ„ï¼Œä»¥ä¸ºæ˜¯ç®—æ³•é—®é¢˜ï¼Œå°±æ¢æ€è·¯å†™äº†ï¼Œç›´åˆ°è¿™æ¬¡åªèƒ½ç”¨è¿™ç§æ€è·¯ï¼Œæ‰å‘ç°è¿™é‡Œå‡ºç°äº†é—®é¢˜ã€‚ Stackoverflowä¸Šç›¸å…³çš„é—®é¢˜å›ç­”è¯´è¿™æ˜¯å› ä¸ºReadStringè¯»å–å­—ç¬¦ä¸²æˆåŠŸåä¼šæŠŠ'\\n'ä¸€èµ·åŠ åœ¨å­—ç¬¦ä¸²åé¢ã€‚æŸ¥æ‰¾åŒ…è¯´æ˜å‘ç°å‡½æ•°çš„åŸå‹å’Œè§£é‡Šå¦‚ä¸‹ func (b *Reader) ReadString(delim byte) (string, error) /* ReadString reads until the first occurrence of delim in the input, returning a string containing the data up to and including the delimiter. If ReadString encounters an error before finding a delimiter, it returns the data read before the error and the error itself (often io.EOF). ReadString returns err != nil if and only if the returned data does not end in delim. For simple uses, a Scanner may be more convenient. */ è¿™ç§æƒ…å†µç»™å‡ºçš„å»ºè®®æ˜¯åˆ©ç”¨strings.Trimâ€¦ç³»åˆ—å»é™¤æœ«å°¾æ·»åŠ çš„å­—ç¬¦ï¼Œæ¯”å¦‚ï¼Œå¯¹ä¸Šé¢çš„é”™è¯¯ç¨‹åº inputReader := bufio.NewReader(os.Stdin) fmt.Println(\"Please input a number\") t, err := inputReader.ReadString('\\n') if err != nil { fmt.Println(\"can't read number!\") } fmt.Println(\"the number is\", t) t = strings.TrimRight(t, \"\\n\") if num, ok := strconv.Atoi(t); ok == nil { fmt.Println(\"convert succeed\", num) } //input 25 //output Please input a number the number is 25 convert succeed 25 ","date":"2019-08-27","objectID":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-bufio%E8%AF%BB%E5%8F%96%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%97%A0%E6%B3%95%E7%9B%B4%E6%8E%A5%E8%BF%9B%E8%A1%8C%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/:0:0","tags":["Goè¯­æ³•"],"title":"GolangæŸ¥æ¼è¡¥ç¼º-bufioè¯»å–çš„å­—ç¬¦ä¸²æ— æ³•ç›´æ¥è¿›è¡Œç±»å‹è½¬æ¢","uri":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-bufio%E8%AF%BB%E5%8F%96%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%97%A0%E6%B3%95%E7%9B%B4%E6%8E%A5%E8%BF%9B%E8%A1%8C%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"PATä¹™çº§25åˆ†çš„é¢˜å¥½å¤šéœ€è¦æ ¹æ®ä¸€ä¸ªç»“æ„ä½“ç±»å‹çš„æŸä¸ªå­—æ®µè¿›è¡Œæ’åºï¼Œç¬¬ä¸€æ¬¡é‡åˆ°æ—¶ç¡®å®ä¸çŸ¥æ‰€æªï¼Œç„¶åæŸ¥äº†ä¸å°‘è§£å†³æ–¹æ¡ˆï¼Œè¿™é‡Œåšä¸ªæ€»ç»“ã€‚ è¿™ä¸€é—®é¢˜ä¸€èˆ¬å½’ç»“ä¸ºå¯¹è‡ªå®šä¹‰ç±»å‹æ’åºï¼Œå½“ç„¶ï¼ŒåŸºæœ¬æŒ‡çš„æ˜¯ç»“æ„ä½“ï¼Œæœåˆ°çš„è§£å†³æ–¹æ¡ˆä¹ŸåŸºæœ¬æ˜¯åˆ©ç”¨sortåŒ…ã€‚ sortåŒ…åŸºæœ¬çš„æ’åºéƒ½æ˜¯é’ˆå¯¹åˆ‡ç‰‡çš„ï¼Œç›´æ¥è°ƒç”¨çš„è¯èƒ½æ‰¾åˆ°æ•´å‹ã€æµ®ç‚¹å‹å’Œå­—ç¬¦ä¸²ä¸‰ç§ç±»å‹åˆ‡ç‰‡çš„æ’åºï¼Œæœ€ç®€å•çš„æ•´å‹æ’åºå¦‚ä¸‹ï¼š package main import ( \"fmt\" \"sort\" ) func main() { s := []int{5, 2, 6, 3, 1, 4} // unsorted sort.Ints(s) fmt.Println(s) } //Output:[1 2 3 4 5 6] ","date":"2019-08-16","objectID":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-%E5%AF%B9%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E6%8E%92%E5%BA%8F/:0:0","tags":["Goè¯­æ³•"],"title":"GolangæŸ¥æ¼è¡¥ç¼º-å¯¹è‡ªå®šä¹‰ç±»å‹æ’åº","uri":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-%E5%AF%B9%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E6%8E%92%E5%BA%8F/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"è°ƒç”¨sort.Sort() ä¸å°‘æ–‡ç« éƒ½æ˜¯é€šè¿‡è°ƒç”¨sort.Sort()å®ç°çš„å¯¹ç»“æ„ä½“çš„æ’åºï¼Œå¦‚youyuå²æœˆå’ŒDonneçš„æ–‡ç« å°±æ˜¯ä½¿ç”¨çš„è¿™ç§åŠæ³•ã€‚ func Sort(data Interface) Sortå‡½æ•°ä¼šè°ƒç”¨ä¸€æ¬¡data.Lenç¡®å®šé•¿åº¦ï¼Œè°ƒç”¨O(n*log(n))æ¬¡data.Lesså’Œdata.Swapè¿›è¡Œæ’åºã€‚ä½†å‡½æ•°ä¸èƒ½ä¿è¯æ’åºçš„ç¨³å®šæ€§ã€‚è€Œè°ƒç”¨Sorté¦–å…ˆéœ€è¦å®ç°ä¸€ä¸ªæ¥å£ã€‚ type Interface interface { // Len is the number of elements in the collection. Len() int // Less reports whether the element with // index i should sort before the element with index j. Less(i, j int) bool // Swap swaps the elements with indexes i and j. Swap(i, j int) } åªè¦å®ç°äº†Len, Less, Swapä¸‰ä¸ªæ–¹æ³•ï¼Œå°±èƒ½è°ƒç”¨Sortå®ç°å¯¹ç»“æ„ä½“çš„æ’åºï¼Œè€Œå…¶ä¸­ä¸»è¦å°±æ˜¯Lessæ¯”è¾ƒé€»è¾‘çš„å®ç°ã€‚ å…ˆçœ‹ä¸€ä¸‹sortåŒ…æœ¬èº«å¯¹[]intç±»å‹çš„æ’åºå®ç° // é¦–å…ˆå®šä¹‰äº†ä¸€ä¸ª[]intç±»å‹çš„åˆ«åIntSlice type IntSlice []int // è·å–æ­¤ slice çš„é•¿åº¦ func (p IntSlice) Len() int { return len(p) } // æ¯”è¾ƒä¸¤ä¸ªå…ƒç´ å¤§å° å‡åº func (p IntSlice) Less(i, j int) bool { return p[i] \u003c p[j] } // äº¤æ¢æ•°æ® func (p IntSlice) Swap(i, j int) { p[i], p[j] = p[j], p[i] } // sort.Ints()å†…éƒ¨è°ƒç”¨Sort() æ–¹æ³•å®ç°æ’åº // æ³¨æ„ è¦å…ˆå°†[]int è½¬æ¢ä¸º IntSliceç±»å‹ å› ä¸ºæ­¤ç±»å‹æ‰å®ç°äº†Interfaceçš„ä¸‰ä¸ªæ–¹æ³• func Ints(a []int) { Sort(IntSlice(a)) } ç„¶åæˆ‘ä»¬ä»¥ä¸€ä¸ªäººçš„ç»“æ„ä½“ä¸ºä¾‹ï¼Œç»“æ„ä½“ä¸­åŒ…æ‹¬å…¶å§“åå’Œå¹´é¾„ï¼ŒæŒ‰ç…§å…¶å¹´é¾„å¯¹ç»“æ„ä½“è¿›è¡Œæ’åºã€‚ type Person struct { Name string Age int } type ByAge []Person ä»¿ç…§[]intå®ç°ä¸‰ä¸ªæ–¹æ³• func (a ByAge) Len() int { return len(a) } func (a ByAge) Swap(i, j int) { a[i], a[j] = a[j], a[i] } func (a ByAge) Less(i, j int) bool { return a[i].Age \u003c a[j].Age } ç„¶åå†™ä¸ªå®Œæ•´çš„ç¨‹åºæµ‹è¯•çœ‹ä¸€çœ‹ package main import ( \"fmt\" \"sort\" ) type Person struct { Name string Age int } func (p Person) String() string { return fmt.Sprintf(\"%s: %d\", p.Name, p.Age) } // ByAge implements sort.Interface for []Person based on // the Age field. type ByAge []Person func (a ByAge) Len() int { return len(a) } func (a ByAge) Swap(i, j int) { a[i], a[j] = a[j], a[i] } func (a ByAge) Less(i, j int) bool { return a[i].Age \u003c a[j].Age } func main() { people := []Person{ {\"Bob\", 31}, {\"John\", 42}, {\"Michael\", 17}, {\"Jenny\", 26}, } fmt.Println(people) // There are two ways to sort a slice. First, one can define // a set of methods for the slice type, as with ByAge, and // call sort.Sort. In this first example we use that technique. sort.Sort(ByAge(people)) fmt.Println(people) } //è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š [Bob: 31 John: 42 Michael: 17 Jenny: 26] [Michael: 17 Jenny: 26 Bob: 31 John: 42] å¦‚æœè¦å¯¹æŸä¸ªç»“æ„ä½“ä¸­å¤šä¸ªå­—æ®µè¿›è¡Œæ’åºï¼Œå¯ä»¥åˆ©ç”¨åµŒå¥—ç»“æ„ä½“å®ç°ï¼Œå¦‚ä¸‹é¢çš„ä»£ç ï¼Œè¯¥ä»£ç æ¥è‡ªyouyuå²æœˆ package main import ( \"fmt\" \"sort\" ) type Person struct { Name string Age int } type Persons []Person // Len()æ–¹æ³•å’ŒSwap()æ–¹æ³•ä¸ç”¨å˜åŒ– // è·å–æ­¤ slice çš„é•¿åº¦ func (p Persons) Len() int { return len(p) } // äº¤æ¢æ•°æ® func (p Persons) Swap(i, j int) { p[i], p[j] = p[j], p[i] } // åµŒå¥—ç»“æ„ä½“ å°†ç»§æ‰¿ Person çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³• // æ‰€ä»¥ç›¸å½“äºSortByName ä¹Ÿå®ç°äº† Len() å’Œ Swap() æ–¹æ³• type SortByName struct{ Persons } // æ ¹æ®å…ƒç´ çš„å§“åé•¿åº¦é™åºæ’åº ï¼ˆæ­¤å¤„æŒ‰ç…§è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘å†™ï¼‰ func (p SortByName) Less(i, j int) bool { return len(p.Persons[i].Name) \u003e len(p.Persons[j].Name) } type SortByAge struct{ Persons } // æ ¹æ®å…ƒç´ çš„å¹´é¾„é™åºæ’åº ï¼ˆæ­¤å¤„æŒ‰ç…§è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘å†™ï¼‰ func (p SortByAge) Less(i, j int) bool { return p.Persons[i].Age \u003e p.Persons[j].Age } func main() { persons := Persons{ { Name: \"test123\", Age: 20, }, { Name: \"test1\", Age: 22, }, { Name: \"test12\", Age: 21, }, } fmt.Println(\"æ’åºå‰\") for _, person := range persons { fmt.Println(person.Name, \":\", person.Age) } sort.Sort(SortByName{persons}) fmt.Println(\"æ’åºå\") for _, person := range persons { fmt.Println(person.Name, \":\", person.Age) } } ","date":"2019-08-16","objectID":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-%E5%AF%B9%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E6%8E%92%E5%BA%8F/:1:0","tags":["Goè¯­æ³•"],"title":"GolangæŸ¥æ¼è¡¥ç¼º-å¯¹è‡ªå®šä¹‰ç±»å‹æ’åº","uri":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-%E5%AF%B9%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E6%8E%92%E5%BA%8F/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"è°ƒç”¨sort.Slice() æ›´ç®€å•çš„æ˜¯ç›´æ¥è°ƒç”¨sort.Slice()ï¼Œå½“ç„¶ï¼Œç”±äºgolangå®˜æ–¹çš„åŒ…è¯´æ˜ç¨³å®šæ²¡æ³•è®¿é—®ï¼Œä¸€ç›´æŸ¥çœ‹çš„æ˜¯å›½å†…çš„æ ‡å‡†åº“è¯´æ˜æ–‡æ¡£ï¼Œå®Œå…¨æ²¡æœ‰æ„è¯†åˆ°å®ƒå·²ç»è½åäº†ï¼Œå¯èƒ½è®¸ä¹…æœªæ›´æ–°ï¼Œå®Œå…¨æ²¡æœ‰æåˆ°sortåŒ…ä¸­çš„Sliceå‡½æ•°ï¼Œä½†åˆ©ç”¨è¿™ä¸ªå‡½æ•°è¿›è¡Œè‡ªå®šä¹‰ç±»å‹æ’åºæ˜¯çœŸæœ‰ç”¨ï¼Œè¿˜æ˜¯ç¿»å‡ºå»çœ‹å®˜æ–¹è¯´æ˜æ¯”è¾ƒå¥½ã€‚ func Slice(slice interface{}, less func(i, j int) bool) sort.Slice()ä»¥ç»™å®šçš„æ¯”è¾ƒå‡½æ•°æ’åºåˆ‡ç‰‡ï¼Œä½†å¹¶ä¸ä¿è¯æ’åºçš„ç¨³å®šæ€§ï¼Œæƒ³è¦ç¨³å®šæ€§ï¼Œå¯ä»¥è°ƒç”¨sort.SliceStable()ã€‚å› ä¸ºåˆ‡ç‰‡ç±»å‹çš„å¹¿æ³›ä½¿ç”¨ï¼Œè°ƒç”¨sort.Slice()èƒ½æ»¡è¶³å¤§éƒ¨åˆ†çš„éœ€æ±‚ï¼ŒåŒæ—¶å‡å°‘äº†è‡ªå·±å®ç°æ¥å£éœ€è¦å®ç°çš„Lenå’ŒSwapä¸¤ä¸ªæ–¹æ³•ï¼Œå†™æ³•ä¸Šä¹Ÿæ›´åŠ ç²¾ç‚¼ã€‚ä¸€ä¸ªä¾‹å­å¦‚ä¸‹ï¼š package main import ( \"fmt\" \"sort\" ) func main() { people := []struct { Name string Age int }{ {\"Gopher\", 7}, {\"Alice\", 55}, {\"Vera\", 24}, {\"Bob\", 75}, } sort.Slice(people, func(i, j int) bool { return people[i].Name \u003c people[j].Name }) fmt.Println(\"By name:\", people) sort.Slice(people, func(i, j int) bool { return people[i].Age \u003e people[j].Age }) fmt.Println(\"By age:\", people) } //Output By name: [{Alice 55} {Bob 75} {Gopher 7} {Vera 24}] By age: [{Bob 75} {Alice 55} {Vera 24} {Gopher 7}] å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™é‡Œçš„æ’åºç»“æœä¾èµ–äºlesså‡½æ•°çš„å†…å®¹ï¼Œå¹¶ä¸æ˜¯é»˜è®¤å‡åºï¼Œå¦‚ä¸Šè¿°ç¨‹åºã€‚ ","date":"2019-08-16","objectID":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-%E5%AF%B9%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E6%8E%92%E5%BA%8F/:2:0","tags":["Goè¯­æ³•"],"title":"GolangæŸ¥æ¼è¡¥ç¼º-å¯¹è‡ªå®šä¹‰ç±»å‹æ’åº","uri":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-%E5%AF%B9%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E6%8E%92%E5%BA%8F/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æœ€è¿‘åœ¨åˆ·PATä¹™çº§çš„é¢˜ï¼Œå› ä¸ºPATè€ƒç‚¹ä¸€èˆ¬åªæä¾›C/C++æˆ–Javaç¯å¢ƒçš„ç¼˜æ•…ï¼Œç½‘ä¸Šæ‰¾åˆ°çš„90%éƒ½æ˜¯C++ä»£ç ï¼Œå‰©ä¸‹çš„åˆç»å¤§éƒ¨åˆ†æ˜¯Javaï¼Œè¿˜æœ‰ä¸€å°éƒ¨åˆ†Pythonï¼Œå…¶ä»–è¯­è¨€è¿˜çœŸæ²¡çœ‹åˆ°ã€‚æˆ‘ç”¨goæ¥åˆ·é¢˜ï¼Œé‡åˆ°å¾ˆå¤šé—®é¢˜è¿˜çœŸçš„åªèƒ½è‡ªå·±æ…¢æ…¢ç¢ç£¨ï¼Œå€’ä¹Ÿå¾ˆæ˜¯èƒ½é”»ç‚¼äººã€‚ åœ¨PATä¹™çº§1015ï¼ˆå¾·æ‰è®ºï¼‰å’Œ1018ï¼ˆé”¤å­å‰ªåˆ€å¸ƒï¼‰ä¸¤é¢˜ä¸­ï¼Œå†ç»ä¸‡éš¾ï¼Œæ€»æœ‰æµ‹è¯•ç‚¹æ˜¾ç¤ºâ€œè¿è¡Œè¶…æ—¶â€ã€‚ä»”ç»†ä¸€æƒ³ï¼Œä¸åº”è¯¥å•Šï¼Œgoçš„ç¼–è¯‘æ‰§è¡Œé€Ÿåº¦åº”è¯¥ç®—æ¯”è¾ƒå¿«äº†ï¼Œæ¯”C++åº”è¯¥å·®ä¸äº†å¤šå°‘ï¼Œè¿™ä¹Ÿæ˜¯goçš„ä¼˜ç‚¹ï¼Œæ€ä¹ˆå°±è¿è¡Œè¶…æ—¶å‘¢ï¼Œå‰ä¸¤å¤©å†™çš„æ—¶å€™æ²¡æƒ³å‡ºæ¥ï¼Œå°±è¿™ä¹ˆæ”¾ä¸‹äº†ï¼Œä½†è¿™ä¸¤å¤©å¿ƒé‡Œä¸€ç›´æƒ¦è®°ç€ã€‚çŸ¥é“ä»Šå¤©ï¼Œæƒ³åˆ°ä¸€ä»¶äº‹ï¼Œ1015ï¼ˆå¾·æ‰è®ºï¼‰è¿˜å¥½è¯´ï¼Œæ¶‰åŠæ’åºï¼Œå¯èƒ½ç®—æ³•ä¸å¤Ÿå¥½ã€‚1018ï¼ˆé”¤å­å‰ªåˆ€å¸ƒï¼‰ä¸€é¢˜ä¸­ä¹Ÿæ²¡æ’åºï¼Œè¿™ä¹ˆå°±è¿è¡Œè¶…æ—¶äº†ï¼Œäºæ˜¯å»ç½‘ä¸Šæ‰¾åˆ°äº†Pythonè§£æ³•ï¼Œç«Ÿç„¶è¿‡äº†ï¼Œå½»åº•é™·å…¥äº†è¿·æƒ˜ï¼Œgoçš„é€Ÿåº¦è¿Pythonéƒ½æ¯”ä¸è¿‡äº†å—ï¼Œè‚¯å®šæœ‰æ²¡æ³¨æ„åˆ°çš„åœ°æ–¹ï¼Œäºæ˜¯å¼€å§‹äº†æ‰§è¡Œæ—¶é—´ä¼˜åŒ–ä¹‹æ—…ã€‚ 1018ï¼ˆé”¤å­å‰ªåˆ€å¸ƒï¼‰çš„åŸå§‹ä»£ç å¦‚ä¸‹ /*é¢˜ç›®è¯´æ˜ å¤§å®¶åº”è¯¥éƒ½ä¼šç©â€œé”¤å­å‰ªåˆ€å¸ƒâ€çš„æ¸¸æˆ,ç°ç»™å‡ºä¸¤äººçš„äº¤é”‹è®°å½•ï¼Œè¯·ç»Ÿè®¡åŒæ–¹çš„èƒœã€å¹³ã€è´Ÿæ¬¡æ•°ï¼Œå¹¶ä¸”ç»™å‡ºåŒæ–¹åˆ†åˆ«å‡ºä»€ä¹ˆæ‰‹åŠ¿çš„èƒœç®—æœ€å¤§ã€‚ è¾“å…¥æ ¼å¼ï¼š è¾“å…¥ç¬¬ 1 è¡Œç»™å‡ºæ­£æ•´æ•° Nï¼ˆâ‰¤10^5ï¼‰ï¼Œå³åŒæ–¹äº¤é”‹çš„æ¬¡æ•°ã€‚éšå N è¡Œï¼Œæ¯è¡Œç»™å‡ºä¸€æ¬¡äº¤é”‹çš„ä¿¡æ¯ï¼Œå³ç”²ã€ä¹™åŒæ–¹åŒæ—¶ç»™å‡ºçš„çš„æ‰‹åŠ¿ã€‚C ä»£è¡¨â€œé”¤å­â€ã€J ä»£è¡¨â€œå‰ªåˆ€â€ã€B ä»£è¡¨â€œå¸ƒâ€ï¼Œç¬¬ 1 ä¸ªå­—æ¯ä»£è¡¨ç”²æ–¹ï¼Œç¬¬ 2 ä¸ªä»£è¡¨ä¹™æ–¹ï¼Œä¸­é—´æœ‰ 1 ä¸ªç©ºæ ¼ã€‚ è¾“å‡ºæ ¼å¼ï¼š è¾“å‡ºç¬¬ 1ã€2 è¡Œåˆ†åˆ«ç»™å‡ºç”²ã€ä¹™çš„èƒœã€å¹³ã€è´Ÿæ¬¡æ•°ï¼Œæ•°å­—é—´ä»¥ 1 ä¸ªç©ºæ ¼åˆ†éš”ã€‚ç¬¬ 3 è¡Œç»™å‡ºä¸¤ä¸ªå­—æ¯ï¼Œåˆ†åˆ«ä»£è¡¨ç”²ã€ä¹™è·èƒœæ¬¡æ•°æœ€å¤šçš„æ‰‹åŠ¿ï¼Œä¸­é—´æœ‰ 1 ä¸ªç©ºæ ¼ã€‚å¦‚æœè§£ä¸å”¯ä¸€ï¼Œåˆ™è¾“å‡ºæŒ‰å­—æ¯åºæœ€å°çš„è§£ã€‚ è¾“å…¥æ ·ä¾‹ï¼š 10 C J J B C B B B B C C C C B J B B C J J è¾“å‡ºæ ·ä¾‹ï¼š 5 3 2 2 3 5 B B æ—¶é—´é™åˆ¶: 200 ms å†…å­˜é™åˆ¶: 64 MB ä»£ç é•¿åº¦é™åˆ¶: 16 KB */ package main import \"fmt\" func findMax(a [3]int) int { var max, index int for k, v := range a { if v \u003e max { max = v index = k } } return index } func main() { var ( n int jiawin, yiwin int jia, yi [3]int str = \"BCJ\" ) fmt.Scanln(\u0026n) for i := 0; i \u003c n; i++ { var t [2]string fmt.Scanln(\u0026t[0],\u0026t[1]) if t[0] == \"B\" \u0026\u0026 t[1] == \"C\" { jia[0]++ } else if t[0] == \"B\" \u0026\u0026 t[1] == \"J\" { yi[2]++ } else if t[0] == \"C\" \u0026\u0026 t[1] == \"B\" { yi[0]++ } else if t[0] == \"C\" \u0026\u0026 t[1] == \"J\" { jia[1]++ } else if t[0] == \"J\" \u0026\u0026 t[1] == \"B\" { jia[2]++ } else if t[0] == \"J\" \u0026\u0026 t[1] == \"C\" { yi[1]++ } } jiawin = jia[0] + jia[1] + jia[2] yiwin = yi[0] + yi[1] + yi[2] fmt.Println(jiawin, n-jiawin-yiwin, yiwin) fmt.Println(yiwin, n-jiawin-yiwin, jiawin) fmt.Printf(\"%c %c\", str[findMax(jia)], str[findMax(yi)]) } æ£€æŸ¥äº†åŠå¤©å®åœ¨æ‰¾ä¸åˆ°ä»€ä¹ˆåœ°æ–¹å¯ä»¥ä¼˜åŒ–çš„ï¼Œæ—¶é—´å¤æ‚åº¦çš„å¤§å¤´æ˜¯forå¾ªç¯ï¼Œä½†èƒ½è¿ç§»å‡ºæ¥çš„ä»£ç éƒ½å·²ç»è¿ç§»å‡ºæ¥äº†ï¼Œç»“æœå§‹ç»ˆå¦‚ä¸‹å›¾ ","date":"2019-08-16","objectID":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4%E4%BC%98%E5%8C%96/:0:0","tags":["Goè¯­æ³•"],"title":"GolangæŸ¥æ¼è¡¥ç¼º-ç¨‹åºæ‰§è¡Œæ—¶é—´ä¼˜åŒ–","uri":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4%E4%BC%98%E5%8C%96/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"I/Oæ€§èƒ½ åœ¨googleä¸Šæœgoç¨‹åºçš„æ‰§è¡Œæ—¶é—´æ€ä¹ˆä¼˜åŒ–ï¼Œæœ€ç»ˆåœ¨golang-nutsè®¨è®ºç»„å‘ç°ä¸€ä¸ªé è°±çš„é—®é¢˜ä»¥åŠæœ‰ç”¨çš„å›ç­”ã€‚ åŸæ¥æ˜¯I/Oè¯»å†™çš„é—®é¢˜ï¼ŒfmtåŒ…çš„è¯»å†™è¿™ä¹ˆä¸çœå¿ƒå—ï¼Œæ€ªä¸å¾—ï¼Œ1015å’Œ1015å¦‚æœæµ‹è¯•ç‚¹æ˜¯è¾¹ç•Œå€¼çš„è¯ï¼Œå¾ªç¯è¦æ‰§è¡Œ10000æ¬¡ï¼ŒI/Oè¯»å†™å‡ºäº†é—®é¢˜ï¼Œä¸è¶…æ—¶æ‰æ€ªã€‚çœ‹ä½œè€…åœ¨ä¹‹åçš„è®¨è®ºä¸­è¯´ä»–çš„ç¨‹åºâ€œOn my system: C runs in ~50ms, python in ~125ms and go in ~450ms.â€ä¹Ÿéš¾æ€ªPythonéƒ½èƒ½é€šè¿‡ï¼Œgoé€šè¿‡ä¸äº†äº†ã€‚ æŒ‰ç…§å…¶ä»–äººçš„å›ç­”ï¼Œä½¿ç”¨bufioåŒ…æ›¿æ¢äº†forå¾ªç¯ä¸­çš„fmtè¿›è¡Œè¯»å–ï¼Œæ”¹è¿›çš„ä»£ç å¦‚ä¸‹ï¼š package main import ( \"bufio\" \"fmt\" \"os\" \"strings\" ) func findMax(a [3]int) int { var max, index int for k, v := range a { if v \u003e max { max = v index = k } } return index } func main() { var ( n int jiawin, yiwin int jia, yi [3]int str = \"BCJ\" ) // ç”¨fmtè¯»å–è¾“å…¥ä¼šæœ‰æµ‹è¯•ç‚¹è¶…æ—¶ inputReader := bufio.NewReader(os.Stdin) fmt.Scanln(\u0026n) for i := 0; i \u003c n; i++ { s, _ := inputReader.ReadString('\\n') t := strings.Fields(s) if t[0] == \"B\" \u0026\u0026 t[1] == \"C\" { jia[0]++ } else if t[0] == \"B\" \u0026\u0026 t[1] == \"J\" { yi[2]++ } else if t[0] == \"C\" \u0026\u0026 t[1] == \"B\" { yi[0]++ } else if t[0] == \"C\" \u0026\u0026 t[1] == \"J\" { jia[1]++ } else if t[0] == \"J\" \u0026\u0026 t[1] == \"B\" { jia[2]++ } else if t[0] == \"J\" \u0026\u0026 t[1] == \"C\" { yi[1]++ } } jiawin = jia[0] + jia[1] + jia[2] yiwin = yi[0] + yi[1] + yi[2] fmt.Println(jiawin, n-jiawin-yiwin, yiwin) fmt.Println(yiwin, n-jiawin-yiwin, jiawin) fmt.Printf(\"%c %c\", str[findMax(jia)], str[findMax(yi)]) } æœç„¶é€šè¿‡äº†ï¼Œå¦‚ä¸‹å›¾ï¼Œæœ€åä¸€ä¸ªæµ‹è¯•ç‚¹28ms,ä¸€æƒ³æƒ³é¢˜ç›®æ—¶é—´é™åˆ¶æ˜¯200msï¼Œä»è¶…æ—¶åˆ°28ï¼Œè¿™æå‡ï¼Œçœ‹èµ·æ¥1015çš„å¾·æ‰è®ºä¸€é¢˜ä¹Ÿæœ‰æ•‘äº†ã€‚ ","date":"2019-08-16","objectID":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4%E4%BC%98%E5%8C%96/:1:0","tags":["Goè¯­æ³•"],"title":"GolangæŸ¥æ¼è¡¥ç¼º-ç¨‹åºæ‰§è¡Œæ—¶é—´ä¼˜åŒ–","uri":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4%E4%BC%98%E5%8C%96/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æ’åºä¼˜åŒ– 1018å¾·æ‰è®ºçš„åŸå§‹ä»£ç å¦‚ä¸‹ï¼š /* å®‹ä»£å²å­¦å®¶å¸é©¬å…‰åœ¨ã€Šèµ„æ²»é€šé‰´ã€‹ä¸­æœ‰ä¸€æ®µè‘—åçš„â€œå¾·æ‰è®ºâ€ï¼šâ€œæ˜¯æ•…æ‰å¾·å…¨å°½è°“ä¹‹åœ£äººï¼Œæ‰å¾·å…¼äº¡è°“ä¹‹æ„šäººï¼Œå¾·èƒœæ‰è°“ä¹‹å›å­ï¼Œæ‰èƒœå¾·è°“ä¹‹å°äººã€‚å‡¡å–äººä¹‹æœ¯ï¼Œè‹Ÿä¸å¾—åœ£äººï¼Œå›å­è€Œä¸ä¹‹ï¼Œä¸å…¶å¾—å°äººï¼Œä¸è‹¥å¾—æ„šäººã€‚â€ ç°ç»™å‡ºä¸€æ‰¹è€ƒç”Ÿçš„å¾·æ‰åˆ†æ•°ï¼Œè¯·æ ¹æ®å¸é©¬å…‰çš„ç†è®ºç»™å‡ºå½•å–æ’åã€‚ è¾“å…¥æ ¼å¼ï¼š è¾“å…¥ç¬¬ä¸€è¡Œç»™å‡º 3 ä¸ªæ­£æ•´æ•°ï¼Œåˆ†åˆ«ä¸ºï¼šNï¼ˆâ‰¤10^5ï¼‰ï¼Œå³è€ƒç”Ÿæ€»æ•°ï¼›Lï¼ˆâ‰¥60ï¼‰ï¼Œä¸ºå½•å–æœ€ä½åˆ†æ•°çº¿ï¼Œå³å¾·åˆ†å’Œæ‰åˆ†å‡ä¸ä½äº L çš„è€ƒç”Ÿæ‰æœ‰èµ„æ ¼è¢«è€ƒè™‘å½•å–ï¼›Hï¼ˆ\u003c100ï¼‰ï¼Œä¸ºä¼˜å…ˆå½•å–çº¿â€”â€”å¾·åˆ†å’Œæ‰åˆ†å‡ä¸ä½äºæ­¤çº¿çš„è¢«å®šä¹‰ä¸ºâ€œæ‰å¾·å…¨å°½â€ï¼Œæ­¤ç±»è€ƒç”ŸæŒ‰å¾·æ‰æ€»åˆ†ä»é«˜åˆ°ä½æ’åºï¼›æ‰åˆ†ä¸åˆ°ä½†å¾·åˆ†åˆ°çº¿çš„ä¸€ç±»è€ƒç”Ÿå±äºâ€œå¾·èƒœæ‰â€ï¼Œä¹ŸæŒ‰æ€»åˆ†æ’åºï¼Œä½†æ’åœ¨ç¬¬ä¸€ç±»è€ƒç”Ÿä¹‹åï¼›å¾·æ‰åˆ†å‡ä½äº Hï¼Œä½†æ˜¯å¾·åˆ†ä¸ä½äºæ‰åˆ†çš„è€ƒç”Ÿå±äºâ€œæ‰å¾·å…¼äº¡â€ä½†å°šæœ‰â€œå¾·èƒœæ‰â€è€…ï¼ŒæŒ‰æ€»åˆ†æ’åºï¼Œä½†æ’åœ¨ç¬¬äºŒç±»è€ƒç”Ÿä¹‹åï¼›å…¶ä»–è¾¾åˆ°æœ€ä½çº¿ L çš„è€ƒç”Ÿä¹ŸæŒ‰æ€»åˆ†æ’åºï¼Œä½†æ’åœ¨ç¬¬ä¸‰ç±»è€ƒç”Ÿä¹‹åã€‚ éšå N è¡Œï¼Œæ¯è¡Œç»™å‡ºä¸€ä½è€ƒç”Ÿçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼šå‡†è€ƒè¯å· å¾·åˆ† æ‰åˆ†ï¼Œå…¶ä¸­å‡†è€ƒè¯å·ä¸º 8 ä½æ•´æ•°ï¼Œå¾·æ‰åˆ†ä¸ºåŒºé—´ [0, 100] å†…çš„æ•´æ•°ã€‚æ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚ è¾“å‡ºæ ¼å¼ï¼š è¾“å‡ºç¬¬ä¸€è¡Œé¦–å…ˆç»™å‡ºè¾¾åˆ°æœ€ä½åˆ†æ•°çº¿çš„è€ƒç”Ÿäººæ•° Mï¼Œéšå M è¡Œï¼Œæ¯è¡ŒæŒ‰ç…§è¾“å…¥æ ¼å¼è¾“å‡ºä¸€ä½è€ƒç”Ÿçš„ä¿¡æ¯ï¼Œè€ƒç”ŸæŒ‰è¾“å…¥ä¸­è¯´æ˜çš„è§„åˆ™ä»é«˜åˆ°ä½æ’åºã€‚å½“æŸç±»è€ƒç”Ÿä¸­æœ‰å¤šäººæ€»åˆ†ç›¸åŒæ—¶ï¼ŒæŒ‰å…¶å¾·åˆ†é™åºæ’åˆ—ï¼›è‹¥å¾·åˆ†ä¹Ÿå¹¶åˆ—ï¼Œåˆ™æŒ‰å‡†è€ƒè¯å·çš„å‡åºè¾“å‡ºã€‚ è¾“å…¥æ ·ä¾‹ï¼š 14 60 80 10000001 64 90 10000002 90 60 10000011 85 80 10000003 85 80 10000004 80 85 10000005 82 77 10000006 83 76 10000007 90 78 10000008 75 79 10000009 59 90 10000010 88 45 10000012 80 100 10000013 90 99 10000014 66 60 è¾“å‡ºæ ·ä¾‹ï¼š 12 10000013 90 99 10000012 80 100 10000003 85 80 10000011 85 80 10000004 80 85 10000007 90 78 10000006 83 76 10000005 82 77 10000002 90 60 10000014 66 60 10000008 75 79 10000001 64 90 æ—¶é—´é™åˆ¶: 400 ms å†…å­˜é™åˆ¶: 64 MB ä»£ç é•¿åº¦é™åˆ¶: 16 KB */ package main import ( \"fmt\" ) //L is student level weight const L = 100000000000000 //S is student grade weight const S = 100000000000 //D is student id weight const D = 100000000 func main() { var ( n, l, h int id, de, cai int sum, level, count int student []int64 ) fmt.Scanln(\u0026n, \u0026l, \u0026h) for i := 0; i \u003c n; i++ { fmt.Scanln(\u0026id, \u0026de, \u0026cai) if de \u003e= l \u0026\u0026 cai \u003e= l { sum = de + cai if de \u003e= h \u0026\u0026 cai \u003e= h { level = 4 } else if de \u003e= h \u0026\u0026 cai \u003c h { level = 3 } else if de \u003c h \u0026\u0026 cai \u003c h \u0026\u0026 de \u003e= cai { level = 2 } else { level = 1 } tmp := level*L + sum*S + de*D + D - id student = append(student, int64(tmp)) count++ } } for i := 0; i \u003c count; i++ { for j := i; j \u003c count; j++ { if student[i] \u003c student[j] { tmp := student[i] student[i] = student[j] student[j] = tmp } } } fmt.Println(count) for i := 0; i \u003c count; i++ { id = int(D - student[i]%D) sum = int(student[i] % L / S) de = int(student[i] % S / D) cai = sum - de fmt.Println(id, de, cai) } } å…¶å®è¿™å·²ç»æ˜¯ä¼˜åŒ–è¿‡äº†ï¼Œä¹‹å‰å†™çš„æ—¶å€™ç”¨çš„æ­£è§„çš„ç»“æ„ä½“çš„æ€è·¯ï¼Œä¸ºäº†ä¼˜åŒ–ï¼Œæ”¹æˆè¿™ç§ç”¨æƒé‡çš„å‰‘èµ°åé”‹çš„æ€è·¯ã€‚ä½†æäº¤ç»“æœæ²¡æœ‰ä¸æ¯«æ”¹å˜ï¼Œè¶…æ—¶å°±æ˜¯è¶…æ—¶ã€‚ æ”¹å‘—ï¼Œç¬¬ä¸€ä¸ªforå¾ªç¯é‡Œçš„è¾“å…¥æ”¹æˆç”¨ç¼“å†²åŒºçš„bufioï¼ŒæŒ‰1018çš„æå‡å¹…åº¦ï¼Œä¼°è®¡å¯ä»¥ã€‚æ”¹è¿›éƒ¨åˆ†çš„ä»£ç å¦‚ä¸‹ã€‚ fmt.Scanln(\u0026n, \u0026l, \u0026h) inputReader := bufio.NewReader(os.Stdin) for i := 0; i \u003c n; i++ { s, _ := inputReader.ReadString('\\n') t := strings.Fields(s) id, _ = strconv.Atoi(string(t[0])) de, _ = strconv.Atoi(string(t[1])) cai, _ = strconv.Atoi(string(t[2])) //fmt.Scanln(\u0026id, \u0026de, \u0026cai) if de \u003e= l \u0026\u0026 cai \u003e= l { sum = de + cai if de \u003e= h \u0026\u0026 cai \u003e= h { level = 4 } else if de \u003e= h \u0026\u0026 cai \u003c h { level = 3 } else if de \u003c h \u0026\u0026 cai \u003c h \u0026\u0026 de \u003e= cai { level = 2 } else { level = 1 } tmp := level*L + sum*S + de*D + D - id student = append(student, int64(tmp)) count++ } } ç¬¬2ä¸ªæµ‹è¯•ç‚¹è¿‡äº†ï¼Œä½†ç¬¬3ï¼Œç¬¬4ä¸ªè¿˜æ˜¯æ²¡è¿‡ã€‚ å›å»ä¸€çœ‹ä»£ç ï¼Œå¾—ï¼Œæœ€åä¸€ä¸ªforå¾ªç¯æœ‰è¾“å‡ºï¼Œç”¨fmtåˆè´¹ä¸å°‘æ—¶é—´ï¼Œç»§ç»­æ”¹ç¼“å†²åŒºï¼Œæ­£å·§è¿™æ—¶å€™æŸ¥åˆ°äº†GOè¯­è¨€åŸºç¡€è¿›é˜¶æ•™ç¨‹ï¼šbufioåŒ…ï¼Œåˆ†æäº†bufioæå‡æ–‡ä»¶è¯»å†™æ•ˆç‡çš„åŸå› ï¼Œäºæ˜¯å‚è€ƒè¯´æ˜æ”¹äº†è¾“å‡ºï¼Œå¦‚ä¸‹ï¼š fmt.Println(count) buf := bufio.NewWriter(os.Stdout) for i := 0; i \u003c count; i++ { id = int(D - student[i]%D) sum = int(student[i] % L / S) de = int(student[i] % S / D) cai = sum - de buf.WriteString(fmt.Sprintf(\"%d %d %d\\n\", id, de, cai)) } buf.Flush() æ²¡æ€ä¹ˆèµ·ä½œç”¨ï¼Œåªæ˜¯ç¬¬2ä¸ªæµ‹è¯•ç‚¹ä»290msæå‡åˆ°äº†272msã€‚é‚£å°±åªèƒ½æ”¹æ’åºäº†ï¼Œç¨‹åºé‡Œè‡ªå·±å†™äº†ä¸¤å±‚å¾ªç¯ï¼Œæœ¬æ¥ä»¥ä¸ºèƒ½è¿‡ï¼Œçœ‹æ¥è¿˜æ˜¯å¾—ç”¨sortåŒ…ã€‚æ”¹è¿›çš„å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š package main import ( \"bufio\" \"fmt\" \"os\" \"sort\" \"strconv\" \"strings\" ) //L is student level weight const L = 100000000000000 //S is student grade weight const S = 100000000000 //D is student id weight const D = 100000000 func main() { var ( n, l, h int id, de, cai int sum, level, count int student []int64 ) fmt.Scanln(\u0026n, \u0026l, \u0026h) inputReader := bufio.NewReader(os.Stdin) for i := 0; i \u003c n; i++ { s, _ := inputReader.ReadString('\\n') t := strings.Fields(s) id, _ = strconv.Atoi(string(t[0])) de, _ = strconv.Atoi(string(t[1])) cai, _ = strconv.Atoi(string(t[2])) //fmt.Scanln(\u0026id, \u0026de, \u0026cai) if de \u003e= l \u0026\u0026 cai \u003e= l { sum = de + cai if de \u003e= h \u0026\u0026 cai \u003e= h { level = 4 } else if de \u003e= h \u0026\u0026 cai \u003c h { level = 3 } else if de \u003c h \u0026\u0026 cai \u003c h \u0026\u0026 de \u003e= cai { level = 2 } else { level = 1 } tmp := level*L + sum*S + de*D + D - id student = ap","date":"2019-08-16","objectID":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4%E4%BC%98%E5%8C%96/:2:0","tags":["Goè¯­æ³•"],"title":"GolangæŸ¥æ¼è¡¥ç¼º-ç¨‹åºæ‰§è¡Œæ—¶é—´ä¼˜åŒ–","uri":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4%E4%BC%98%E5%8C%96/"},{"categories":["Golangå­¦ä¹ ä¹‹è·¯"],"content":"æ€»ç»“ æ¶‰åŠå¤§é‡æ•°æ®çš„è¯»å†™æ—¶ï¼Œåˆ©ç”¨bufioåŒ…é€šè¿‡ç¼“å†²åŒºè¿›è¡Œè¯»å†™æ¯”fmtè¦å¿«çš„å¤šã€‚ æ’åºçš„ä»£ç å¯ä»¥è°ƒç”¨sortåŒ…ï¼Œä¸ä»…ä»…æ˜¯è‡ªå·±å†™ä¸¤å±‚å¾ªç¯æ’åºçš„é—®é¢˜ï¼Œä¸æ˜¯å¿…è¦çš„æƒ…å†µä¸‹ï¼ŒåŒæ ·çš„æ’åºç®—æ³•ï¼Œè‡ªå·±å†™çš„å¾ˆéš¾è¯´æ¯”å¾—è¿‡å°è£…å¥½çš„ã€‚æ›´ä½•å†µï¼Œæ— è®ºæ˜¯å“ªç§è¯­è¨€ï¼Œè°ƒç”¨çš„æ‰§è¡Œæ’åºç®—æ³•çš„åŒ…å…¶å®ä¸æ˜¯å•çº¯æ‰§è¡Œå¿«æ’æˆ–å †æ’åºç­‰æ¯”è¾ƒå¿«çš„æ’åºç®—æ³•ï¼Œè€Œæ˜¯æ ¹æ®è¾“å…¥åœ¨è°ƒæ•´çš„ï¼Œæ‰€ä»¥ä¸ç®¡ä¸ºäº†æ—¶é—´æ€§èƒ½è¿˜æ˜¯å†™çš„æ–¹ä¾¿ï¼Œç›´æ¥è°ƒç”¨sortåŒ…å®Œäº‹å„¿ã€‚ ","date":"2019-08-16","objectID":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4%E4%BC%98%E5%8C%96/:3:0","tags":["Goè¯­æ³•"],"title":"GolangæŸ¥æ¼è¡¥ç¼º-ç¨‹åºæ‰§è¡Œæ—¶é—´ä¼˜åŒ–","uri":"/2019/golang%E6%9F%A5%E6%BC%8F%E8%A1%A5%E7%BC%BA-%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4%E4%BC%98%E5%8C%96/"},{"categories":null,"content":"å…³äºç½‘ç«™ ä¸ªäººåšå®¢ï¼Œæ¬¢è¿äº¤æµ ","date":"2019-08-02","objectID":"/about/:1:0","tags":null,"title":"å…³äº","uri":"/about/"},{"categories":null,"content":"å…³äºæˆ‘ å›½ä¼å’¸é±¼ä¸€æš å–œæ¬¢æ•ˆç‡å’Œæç®€ï¼Œå–œæ¬¢çœ‹ç”µå½±ã€è¯»ä¹¦ã€æ—…è¡Œå’Œå¥èº« æƒ³åœ¨è¿™çŸ­çŸ­çš„ä¸€ç”Ÿä¸­ä½“éªŒè¿™ä¸–é—´ç¾å¥½çš„ä¸€åˆ‡ ","date":"2019-08-02","objectID":"/about/:2:0","tags":null,"title":"å…³äº","uri":"/about/"},{"categories":null,"content":"å…³äºç‰ˆæƒ æœ¬ç«™æ‰€æœ‰çš„åŸåˆ›æ–‡ç« å‡å— åˆ›ä½œå…±äº« ç½²å-éå•†ä¸šæ€§ 4.0 è®¸å¯åè®® / CC BY-NC 4.0 ä¿æŠ¤ã€‚ ä»»ä½•ä¸ªäººåŠåª’ä½“åœ¨è½¬è½½æœ¬ç«™åŸåˆ›å†…å®¹ï¼ˆåŒ…å«æ–‡å­—ã€è‡ªåˆ¶å›¾åƒã€æ‘„å½±ä½œå“ï¼‰æ—¶è¯·éµå®ˆä»¥ä¸‹ç‰ˆæƒè¦æ±‚ï¼š æ³¨æ˜è½¬è½½ æ³¨æ˜æ¥æºä¸ºæœ¬ç«™é¦–é¡µç½‘å€ shuzang.github.ioï¼Œæˆ–æ‰€è½¬å†…å®¹åœ¨æœ¬ç«™çš„å®Œæ•´ç½‘å€ æœ¬ç«™å›¾ç‰‡éƒ¨åˆ†æ¥è‡ªäº’è”ç½‘ã€‚ æ­¤ç±»å›¾ç‰‡çš„åŸç‰ˆæƒæ‰€æœ‰è€…å¯åœ¨ä»»ä½•æ—¶å€™ã€ä»¥ä»»ä½•ç†ç”±è¦æ±‚æœ¬ç«™åœæ­¢ä½¿ç”¨æœ‰å…³å›¾ç‰‡ï¼Œå…¶ä¸­åŒ…æ‹¬è¢«æœ¬ç«™ç¼–è¾‘ï¼ˆæ¯”å¦‚åŠ æ³¨ä¸­æ–‡è¯´æ˜ï¼‰è¿‡çš„å›¾ç‰‡ï¼Œ è”ç³»æ–¹å¼è§æœ¬ç«™é¦–é¡µã€‚ ","date":"2019-08-02","objectID":"/about/:3:0","tags":null,"title":"å…³äº","uri":"/about/"},{"categories":null,"content":"https://www.bilibili.com/video/BV1vL411E7fs?spm_id_from=333.851.b_7265636f6d6d656e64.6ï¼Œå¤±å»ä¿¡ä»» çœ‹åˆ°ä¸–å«ç»„ç»‡çš„å·¥ä½œï¼Œæå‡ä¿¡å¿ƒ çœ‹åˆ°å®¶é•¿é‡ŒçŸ­ï¼Œå‘é’±å•†å®¶ï¼Œå¤±å»ä¿¡å¿ƒ Bç«™ï¼Œæ¸©é“å†›ï¼Œã€Šä¸ºä»€ä¹ˆè´«å¯Œåˆ†åŒ–æ„ˆå‘ä¸¥é‡ã€‹å¤±å»ä¿¡å¿ƒ QQç©ºé—´ï¼Œä¸œå¤§å°çº¢æœï¼Œç¥èå·æ–°é—»ï¼Œå”¤èµ·ä¿¡å¿ƒ Bç«™ï¼Œé—«å¸…å¥‡ï¼Œå†›ç¥ç§‘æ™®è§†é¢‘ï¼Œå”¤èµ·ä¿¡å¿ƒ ç±³æ¸¸ç¤¾ï¼Œæ‰§æœ›ä¸‰åƒé‡Œä»»åŠ¡çš„è¯„è®ºï¼Œå¤±å»ä¿¡å¿ƒ é‡‘èåœˆæƒŠå‘†äº†ï¼å¸‚å€¼300å¤šäº¿ï¼Œä¸€å¹´å‡€äºæŸè¶…1000äº¿ï¼Œå‰è‘£äº‹é•¿å·²è¢«æ‰§è¡Œæ­»åˆ‘ï¼Œå¤±å»ä¿¡å¿ƒ çœ‹åˆ°ç°åœ¨æœ‰äººåœ¨åˆ»æ„åˆ¶é€ å­©å­ä¸çˆ¶æ¯çš„å¯¹ç«‹ï¼Œå‡¡æ˜¯æœ‰é—®é¢˜å°±æŠŠåŸå› å½’ç»“åˆ°çˆ¶æ¯ï¼Œå¤±å»ä¿¡å¿ƒ Bç«™ï¼Œå„¿ç«¥åˆå”±å›¢oneVoiceçš„åˆå”±ï¼Œå”¤èµ·ä¿¡å¿ƒï¼Œç»™æˆ‘å”±å“­äº†ï¼Œ éœ‡æ’¼åœ†æ¢¦ä¹‹å£°ã€ŠA Million Dreamsã€‹å‚¬æ³ªåˆå”±ç°åœºï¼_å“”å“©å“”å“©_bilibili æ´—æ¶¤å¿ƒçµçš„åˆå”±ç°åœºï¼ç«¥å£°æ¼”ç»æ²»æ„ˆè‰¯æ›²ã€ŠI Can Only Imagineã€‹_å“”å“©å“”å“©_bilibili ç½‘ç»œå®‰å…¨å­¦ä¹  \\1. cybrary https://www.cybrary.it/ \\2. securitytube http://www.securitytube.net/ \\3. hacking-tutorial https://www.hackingtutorials.org/ \\4. hack this site https://www.hackthissite.org/ \\5. hacking loops https://www.hackingloops.com/ \\6. exploit database https://www.exploit-db.com/ \\7. hellbound hackers https://hbh.sh/home \\8. hack in the box https://www.hitb.org/ â€“æ¥è‡ªç™¾åº¦ç½‘ç›˜è¶…çº§ä¼šå‘˜V5çš„åˆ†äº« hiï¼Œè¿™æ˜¯æˆ‘ç”¨ç™¾åº¦ç½‘ç›˜åˆ†äº«çš„å†…å®¹~å¤åˆ¶è¿™æ®µå†…å®¹æ‰“å¼€ã€Œç™¾åº¦ç½‘ç›˜ã€APPå³å¯è·å– é“¾æ¥:https://pan.baidu.com/s/1icooGlQL_9hRd1duifjFvg æå–ç :29d9 ","date":"0001-01-01","objectID":"/1/:0:0","tags":null,"title":"","uri":"/1/"}]